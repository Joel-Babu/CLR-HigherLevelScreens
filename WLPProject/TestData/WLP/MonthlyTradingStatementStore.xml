<?xml version="1.0" encoding="UTF-8" ?> 
<configuration>

<TCName name="SalesColumnValidation">
<PlannedSales>
<![CDATA[select lc.dept_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSS from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.dply_seq,e.loc_no,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.loc_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq]]> 
  </PlannedSales>
   <PlannedSalesTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no]]> 
  </PlannedSalesTotal>
   <ActualSales>
<![CDATA[select lc.dept_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekEnd' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq]]> 
  </ActualSales>
   <ActualSalesTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no]]> 
  </ActualSalesTotal>
  <VarSales>
<![CDATA[select pln.dept_nm,ROUND((actl.wtd - pln.wtd),0) as VAR_SLS_WTD_WTSS from 
(select lc.dept_nm,NVL(sls.wtd,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSS from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.dply_seq,e.loc_no,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.loc_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq) pln,
(select lc.dept_nm,NVL(sls.wtd,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) actl
where pln.dept_nm=actl.dept_nm]]> 
  </VarSales>
 
  <VarSalesTotal>
<![CDATA[select pln.loc_nm,ROUND((actl.wtd - pln.wtd),0) as VAR_SLS_WTD_WTSS from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) pln,
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl
where pln.loc_nm=actl.loc_nm]]> 
  </VarSalesTotal>
  <LYSales>
<![CDATA[select lc.dept_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)   
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq]]> 
  </LYSales>
    <LYSalesTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (90,85) 
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (90,85) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (90,85) 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no]]> 
  </LYSalesTotal>
  <LYSalesPct>
<![CDATA[select lc.dept_nm,
CASE  WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
    
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select cy_val.dept_nm,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.dept_nm,NVL(sls.wtd,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) cy_val
LEFT OUTER JOIN
(select lc.dept_nm,NVL(sls.wtd,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) ly_val
on cy_val.dept_nm=ly_val.dept_nm 
group by cy_val.dept_nm ) cyly_wtd
on cyly_wtd.dept_nm=lc.dept_nm]]> 
  </LYSalesPct>
  <LYSalesPctTotal>
<![CDATA[select lc.loc_nm,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100
     WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select cy_val.loc_nm,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) cy_val
LEFT OUTER JOIN
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) ly_val
on cy_val.loc_nm=ly_val.loc_nm 
group by cy_val.loc_nm) cyly_wtd
on cyly_wtd.loc_nm=lc.loc_nm]]> 
  </LYSalesPctTotal>
   <BudgetSales>
<![CDATA[select lc.dept_nm,NVL(bdgt.BDGT_SALES_WTSS,0) as BDGT_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.dply_seq order by e.dply_seq) bdgt
on lc.dply_seq=bdgt.dply_seq order by lc.dply_seq]]> 
  </BudgetSales>
  <BudgetSalesTotal>
<![CDATA[select lc.loc_nm,NVL(bdgt.BDGT_SALES_TOT_WTSS,0) as BDGT_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no]]> 
  </BudgetSalesTotal>
  <ForecastSales>
<![CDATA[select lc.dept_nm,NVL(fcst.FCST_SALES_WTSS,0) as FCST_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.frcst_sls),0) as FCST_SALES_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.dply_seq order by e.dply_seq) fcst
on lc.dply_seq=fcst.dply_seq order by lc.dply_seq]]> 
  </ForecastSales>
<ForecastSalesTotal>
<![CDATA[select lc.loc_nm,NVL(bdgt.FCST_SALES_TOT_WTSS,0) as FCST_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,ROUND(sum(e.frcst_sls),0) as FCST_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no]]> 
  </ForecastSalesTotal>
  <VarBudgetSales>
<![CDATA[select actl.dept_nm,ROUND((actl.wtd - bdgt.wtd),0) as VAR_BDGT_SLS_WTSS from 
(select lc.dept_nm,NVL(sls.wtd,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) actl,
(select lc.dept_nm,NVL(bdgt.BDGT_SALES_WTSS,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and  dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.bdgt_sls) as BDGT_SALES_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.dply_seq order by e.dply_seq) bdgt
on lc.dply_seq=bdgt.dply_seq order by lc.dply_seq) bdgt
where bdgt.dept_nm=actl.dept_nm]]> 
  </VarBudgetSales>
   <VarBudgetSalesTotal>
<![CDATA[select actl.loc_nm,ROUND((actl.wtd - bdgt.wtd),0) as VAR_BDGT_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl,
(select lc.loc_nm,NVL(bdgt.BDGT_SALES_TOT_WTSS,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.bdgt_sls) as BDGT_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no) bdgt
where bdgt.loc_nm=actl.loc_nm]]> 
  </VarBudgetSalesTotal>
  <VarFcstSales>
<![CDATA[select actl.dept_nm,ROUND((actl.wtd - fcst.wtd),0) as VAR_FCST_SLS_WTSS from 
(select lc.dept_nm,NVL(sls.wtd,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) actl,
(select lc.dept_nm,NVL(fcst.FCST_SALES_WTSS,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and  div_no='Division' and  dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.frcst_sls) as FCST_SALES_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.dply_seq order by e.dply_seq) fcst
on lc.dply_seq=fcst.dply_seq order by lc.dply_seq) fcst
where fcst.dept_nm=actl.dept_nm]]> 
  </VarFcstSales>
  <VarFcstSalesTotal>
<![CDATA[select actl.loc_nm,ROUND((actl.wtd - fcst.wtd),0) as VAR_FCST_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl,
(select lc.loc_nm,NVL(bdgt.FCST_SALES_TOT_WTSS,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.frcst_sls) as FCST_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no) fcst
where fcst.loc_nm=actl.loc_nm]]> 
  </VarFcstSalesTotal>
  <AvgBasketSales>
<![CDATA[select lc.dept_nm,
CASE WHEN nume_den.wtd_sls = 0 THEN 0 WHEN nume_den.wtd_cust = 0 THEN 100
ELSE nvl(ROUND((nume_den.wtd_sls / nume_den.wtd_cust),2),0) END as AVG_BASKET_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and  div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_cust + x.Tue_cust + x.Wed_cust + x.Thu_cust + x.Fri_cust + x.Sat_cust + x.Sun_cust) as WTD_CUST from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_WTSS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_WTSS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_WTSS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_WTSS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_WTSS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_WTSS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_WTSS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_WTSS)),0) Mon_cust,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_WTSS)),0) Tue_cust,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_WTSS)),0) Wed_cust,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_WTSS)),0) Thu_cust,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_WTSS)),0) Fri_cust,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_WTSS)),0) Sat_cust,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_WTSS)),0) Sun_cust from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) nume_den
on nume_den.dply_seq=lc.dply_seq]]> 
  </AvgBasketSales>
  <AvgBasketSalesTotal>
<![CDATA[select lc.loc_nm,
CASE WHEN nume_den.wtd_sls = 0 THEN 0 WHEN nume_den.wtd_cust = 0 THEN 100
ELSE nvl(ROUND((nume_den.wtd_sls / nume_den.wtd_cust),2),0) END as AVG_BASKET_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_cust + x.Tue_cust + x.Wed_cust + x.Thu_cust + x.Fri_cust + x.Sat_cust + x.Sun_cust) as WTD_CUST from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_WTSS)),0) Mon_cust,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_WTSS)),0) Tue_cust,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_WTSS)),0) Wed_cust,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_WTSS)),0) Thu_cust,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_WTSS)),0) Fri_cust,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_WTSS)),0) Sat_cust,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_WTSS)),0) Sun_cust from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) nume_den
on nume_den.loc_no=lc.loc_no]]> 
  </AvgBasketSalesTotal>
    <WkyMixSales>
<![CDATA[select lc.dept_nm,
CASE WHEN nume_den.ACTL_SLS_WTSS = 0 THEN 0 WHEN NVL(nume_den.ACTL_SLS_TOT_WTSS,0) = 0 THEN 0
     WHEN NVL(nume_den.ACTL_SLS_WTSS,0) = 0 AND NVL(nume_den.ACTL_SLS_TOT_WTSS,0) = 0 THEN 0
ELSE ROUND((nume_den.ACTL_SLS_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100,2) END as WKY_MIX_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and  dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select nume.dept_nm,nume.ACTL_SLS_WTSS,den.ACTL_SLS_TOT_WTSS from 
(select lc.dept_nm,NVL(sls.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.dply_seq order by h.dply_seq) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den ) nume_den
on nume_den.dept_nm=lc.dept_nm]]> 
  </WkyMixSales>
   <WkyMixSalesTotal>
<![CDATA[select nume_den.loc_nm,
CASE WHEN nume_den.ACTL_SLS_TOT_WTSS = 0 THEN 0 
ELSE ROUND((nume_den.ACTL_SLS_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100,2) END as WKY_MIX_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) nume_den]]> 
  </WkyMixSalesTotal>
 </TCName>
 <TCName name="ItemsColumnValidation">  
   <PlannedItems>
<![CDATA[select lc.dept_nm,NVL(ROUND(itm.PLN_ITM_WTSS,0),0) as PLN_ITM_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.PLN_ITM_DTS) as PLN_ITM_WTSS from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.dply_seq,e.loc_no,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.loc_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.dply_seq order by h.dply_seq) itm
on lc.dply_seq=itm.dply_seq]]> 
  </PlannedItems>
  <PlannedItemsTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(itm.PLN_ITM_TOT_WTSS,0),0) as PLN_ITM_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no]]> 
  </PlannedItemsTotal>
   <ActualItems>
<![CDATA[select lc.dept_nm,NVL(ROUND(itm.ACTL_ITM_WTSS,0),0) as ACTL_ITM_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_ITM_DTS) as ACTL_ITM_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.dply_seq,pln_itm.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e )*/ ) h 
group by h.dply_seq order by h.dply_seq) itm
on lc.dply_seq=itm.dply_seq order by lc.dply_seq]]> 
  </ActualItems>
   <ActualItemsTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(itm.ACTL_ITM_TOT_WTSS,0),0) as ACTL_ITM_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.dply_seq,pln_itm.loc_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_no]]> 
  </ActualItemsTotal>
    <PlannedItemPrice>
<![CDATA[select lc.dept_nm,
case when NVL(sls_itm.PLN_SLS_WTSS,0)=0 and NVL(sls_itm.PLN_ITM_WTSS,0)=0 then 0
when NVL(sls_itm.PLN_SLS_WTSS,0)=0 then 0 when NVL(sls_itm.PLN_ITM_WTSS,0)=0 then 100 
else NVL(ROUND((sls_itm.PLN_SLS_WTSS / sls_itm.PLN_ITM_WTSS),2),0) end as PLN_ITMPRZ_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and  dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSS,sum(h.PLN_ITM_DTS) as PLN_ITM_WTSS from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.dply_seq,e.loc_no,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.loc_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.dply_seq order by h.dply_seq) sls_itm
on lc.dply_seq=sls_itm.dply_seq]]> 
  </PlannedItemPrice>
  <PlannedItemPriceTotal>
<![CDATA[select lc.loc_nm,
case when NVL(sls_itm.PLN_SLS_TOT_WTSS,0)=0 and NVL(sls_itm.PLN_ITM_TOT_WTSS,0)=0 then 0
when NVL(sls_itm.PLN_SLS_TOT_WTSS,0)=0 then 0 when NVL(sls_itm.PLN_ITM_TOT_WTSS,0)=0 then 100 
else NVL(ROUND((sls_itm.PLN_SLS_TOT_WTSS / sls_itm.PLN_ITM_TOT_WTSS),2),0) end as PLN_ITMPRZ_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSS,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no order by h.loc_no) sls_itm
on lc.loc_no=sls_itm.loc_no]]> 
  </PlannedItemPriceTotal>
  <ActualItemPrice>
<![CDATA[select lc.dept_nm,NVL(ROUND((sls_itm.ACTL_SLS_WTSS / sls_itm.ACTL_ITM_WTSS),2),0) as ACTL_ITMPRZ_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS,sum(h.ACTL_ITM_DTS) as ACTL_ITM_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls_itm.dply_seq,pln_sls_itm.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e )*/ ) h 
group by h.dply_seq order by h.dply_seq) sls_itm
on lc.dply_seq=sls_itm.dply_seq order by lc.dply_seq]]> 
  </ActualItemPrice>
  
  <ActualItemPriceTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND((sls_itm.ACTL_SLS_TOT_WTSS / sls_itm.ACTL_ITM_TOT_WTSS),2),0) as ACTL_ITMPRZ_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls_itm.dply_seq,pln_sls_itm.loc_no,pln_sls_itm.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls_itm
on lc.loc_no=sls_itm.loc_no order by lc.loc_no]]> 
  </ActualItemPriceTotal>
  
</TCName>  
  
<TCName name="CustomersColumnValidation">  
  
  <ThisYrActlCustomers>
<![CDATA[select lc.dept_nm,NVL(ROUND(itm.ACTL_CUST_WTSS,0),0) as ACTL_CUST_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and  dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.dply_seq,pln_itm.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )*/ ) h 
group by h.dply_seq order by h.dply_seq) itm
on lc.dply_seq=itm.dply_seq order by lc.dply_seq]]> 
  </ThisYrActlCustomers>
  
  <ThisYrActlCustomersTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(itm.ACTL_CUST_TOT_WTSS,0),0) as ACTL_CUST_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.dply_seq,pln_itm.loc_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_no]]> 
  </ThisYrActlCustomersTotal>
  <PctLastYrCustomers>
<![CDATA[select lc.dept_nm,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
     
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and  dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select cy_val.dept_nm,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.dept_nm,NVL(sls.ACTL_CUST_WTSS,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and  dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.dply_seq order by h.dply_seq) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) cy_val
LEFT OUTER JOIN
(select lc.dept_nm,NVL(sls.ACTL_CUST_WTSS,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.dply_seq order by h.dply_seq) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) ly_val
on cy_val.dept_nm=ly_val.dept_nm 
group by cy_val.dept_nm ) cyly_wtd
on cyly_wtd.dept_nm=lc.dept_nm]]> 
  </PctLastYrCustomers>
  
  <PctLastYrCustomersTotal>
<![CDATA[select lc.loc_nm,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100
     WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select cy_val.loc_nm,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.loc_nm,NVL(sls.ACTL_CUST_WTSS,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) cy_val
LEFT OUTER JOIN
(select lc.loc_nm,NVL(sls.ACTL_CUST_WTSS,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) ly_val
on cy_val.loc_nm=ly_val.loc_nm 
group by cy_val.loc_nm ) cyly_wtd
on cyly_wtd.loc_nm=lc.loc_nm]]> 
  </PctLastYrCustomersTotal>
   <DataPenetrationCustomers>
<![CDATA[select nume_den.dept_nm,
CASE When nume_den.ACTL_CUST_WTSS=0 Then 0 when nume_den.ACTL_CUST_TOT_WTSS=0 Then 0
ELSE ROUND((nume_den.ACTL_CUST_WTSS / nume_den.ACTL_CUST_TOT_WTSS)*100,2) END as DATA_PEN_CUST_WTSS from 
(select nume.dept_nm,NVL(nume.ACTL_CUST_WTSS,0) as ACTL_CUST_WTSS,NVL(den.ACTL_CUST_TOT_WTSS,0) as ACTL_CUST_TOT_WTSS from 
(select lc.dply_seq,lc.dept_nm,itm.ACTL_CUST_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.dply_seq,pln_itm.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )*/ ) h 
group by h.dply_seq order by h.dply_seq) itm
on lc.dply_seq=itm.dply_seq order by lc.dply_seq) nume,
(select lc.loc_nm,itm.ACTL_CUST_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (0) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.dply_seq,pln_itm.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )*/ ) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_no) den order by nume.dply_seq) nume_den]]> 
  </DataPenetrationCustomers>
  
  <DataPenetrationCustomersTotal>
<![CDATA[select nume_den.loc_nm,
CASE When nume_den.ACTL_CUST_TOT_WTSS=0 Then 0 
ELSE ROUND((nume_den.ACTL_CUST_TOT_WTSS / nume_den.ACTL_CUST_TOT_WTSS)*100,2) END as DATA_PEN_CUST_TOT_WTSS from 
(select lc.loc_nm,NVL(itm.ACTL_CUST_TOT_WTSS,0) as ACTL_CUST_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.dply_seq,pln_itm.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )*/ ) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_no) nume_den]]> 
  </DataPenetrationCustomersTotal>
  
</TCName>  
  
<TCName name="HoursColumnValidation">  
  
  <ActualHours>
<![CDATA[select lc.dept_nm,NVL(ROUND(hrs.ACTL_HRS_DTS,2),0) as ACTL_HRS_WTSS from 
(select distinct dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq]]> 
  </ActualHours>
  
  <ActualHoursTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(hrs.ACTL_HRS_DTS,2),0) as ACTL_HRS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no]]> 
  </ActualHoursTotal>
  
  <CurrentActualHours>
<![CDATA[select z.dept_nm,NVL(ROUND(y.ACTL_HOURS_WTSS,2),0) as ACTL_HRS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.dply_seq order by e.dply_seq) y
on z.dply_seq=y.dply_seq order by z.dply_seq]]> 
  </CurrentActualHours>
  
  <CurrentActualHoursTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(y.ACTL_HOURS_TOT_WTSS,2),0) as ACTL_HRS_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on lc.loc_no=y.loc_no order by lc.loc_no]]> 
  </CurrentActualHoursTotal>
  
    <PlannedHours>
<![CDATA[select z.dept_nm,NVL(ROUND(y.PLN_HOURS_WTSS,2),0) as PLN_HRS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq,e.dept_nm 
order by e.dply_seq) y
on z.dept_nm=y.dept_nm order by z.dply_seq]]> 
  </PlannedHours>
  
  <PlannedHoursTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(sum(hrs.PLN_HOURS_TOT_WTSS),2),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm]]> 
  </PlannedHoursTotal>
  
  <CurrentPlannedHours>
<![CDATA[select z.dept_nm,NVL(ROUND(y.PLN_HOURS_WTSS,2),0) as PLN_HRS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and  dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq,e.dept_nm 
order by e.dply_seq) y
on z.dept_nm=y.dept_nm order by z.dply_seq]]> 
  </CurrentPlannedHours>
  
  <CurrentPlannedHoursTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(sum(hrs.PLN_HOURS_TOT_WTSS),2),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm]]> 
  </CurrentPlannedHoursTotal>
  
  <VarHours>
<![CDATA[select pln.dept_nm,ROUND((actl.ACTL_HRS_WTSS - pln.PLN_HRS_WTSS),2) as VAR_HRS_WTSS from 
(select z.dept_nm,NVL(y.PLN_HOURS_WTSS,0) as PLN_HRS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and  dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq,e.dept_nm 
order by e.dply_seq) y
on z.dept_nm=y.dept_nm order by z.dply_seq) pln,
(select lc.dept_nm,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_WTSS from 
(select distinct dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq) actl
where pln.dept_nm=actl.dept_nm]]> 
  </VarHours>
  
  <VarHoursTotal>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_HRS_TOT_WTSS - pln.PLN_HRS_TOT_WTSS),2) as VAR_HRS_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(hrs.PLN_HOURS_TOT_WTSS),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm) pln,
(select lc.loc_nm,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) actl
where pln.loc_nm=actl.loc_nm]]> 
  </VarHoursTotal>
  
  <CurrentVarHours>
<![CDATA[select pln.dept_nm,ROUND((actl.ACTL_HRS_WTSS - pln.PLN_HRS_WTSS),2) as VAR_HRS_WTSS from 
(select z.dept_nm,NVL(y.PLN_HOURS_WTSS,0) as PLN_HRS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq,e.dept_nm 
order by e.dply_seq) y
on z.dept_nm=y.dept_nm order by z.dply_seq) pln,
(select z.dept_nm,NVL(y.ACTL_HOURS_WTSS,0) as ACTL_HRS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.dply_seq order by e.dply_seq) y
on z.dply_seq=y.dply_seq order by z.dply_seq) actl
where pln.dept_nm=actl.dept_nm]]> 
  </CurrentVarHours>
  
  <CurrentVarHoursTotal>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_HRS_TOT_WTSS - pln.PLN_HRS_TOT_WTSS),2) as VAR_HRS_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(hrs.PLN_HOURS_TOT_WTSS),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm) pln,
(select lc.loc_nm,NVL(sum(hrs.PLN_HOURS_TOT_WTSS),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm) actl
where pln.loc_nm=actl.loc_nm]]> 
  </CurrentVarHoursTotal>
  
</TCName>

<TCName name = "WagesColumnValidation" >

  <ActualWages>
<![CDATA[select lc.dept_nm,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_WTSS from 
(select distinct dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq]]> 
  </ActualWages>
  
  <ActualWagesTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no]]> 
  </ActualWagesTotal>
  
  <CurrentActualWages>
<![CDATA[select z.dept_nm,NVL(ROUND(y.ACTL_WAGE_WTSS,0),0) as ACTL_WGE_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.dply_seq order by e.dply_seq) y
on z.dply_seq=y.dply_seq order by z.dply_seq]]> 
  </CurrentActualWages>
  
  <CurrentActualWagesTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(y.ACTL_WAGE_TOT_WTSS,0),0) as ACTL_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on lc.loc_no=y.loc_no order by lc.loc_no]]> 
  </CurrentActualWagesTotal>
  
  <ActualWagePercentage>
<![CDATA[select nume_den.dept_nm,
CASE When nume_den.ACTL_WGE_WTSS=0 Then 0 when nume_den.ACTL_SLS_WTSS=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_WTSS / nume_den.ACTL_SLS_WTSS)*100,2) END as ACTL_WGE_PCT_WTSS from 
(select nume.dept_nm,NVL(nume.ACTL_WGE_WTSS,0) as ACTL_WGE_WTSS,NVL(den.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select lc.dept_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_WTSS from 
(select distinct dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq) nume,
(select lc.dept_nm,NVL(sls.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.dply_seq order by h.dply_seq) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) den 
where nume.dept_nm=den.dept_nm) nume_den]]> 
  </ActualWagePercentage>
  
  <ActualWagePercentageTotal>
<![CDATA[select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_TOT_WTSS=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100,2) END as ACTL_WGE_PCT_TOT_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS,NVL(den.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den]]> 
  </ActualWagePercentageTotal>
  
    <CurrentActualWagePercentage>
<![CDATA[select nume_den.dept_nm,
CASE When nume_den.ACTL_WGE_WTSS=0 Then 0 when nume_den.ACTL_SLS_WTSS=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_WTSS / nume_den.ACTL_SLS_WTSS)*100,2) END as ACTL_WGE_PCT_WTSS from 
(select nume.dept_nm,NVL(nume.ACTL_WGE_WTSS,0) as ACTL_WGE_WTSS,NVL(den.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select z.dept_nm,NVL(y.ACTL_WAGE_WTSS,0) as ACTL_WGE_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.dply_seq order by e.dply_seq) y
on z.dply_seq=y.dply_seq order by z.dply_seq) nume,
(select lc.dept_nm,NVL(sls.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.dply_seq order by h.dply_seq) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) den 
where nume.dept_nm=den.dept_nm) nume_den]]> 
  </CurrentActualWagePercentage>
  
  <CurrentActualWagePercentageTotal>
<![CDATA[select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_TOT_WTSS=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100,2) END as ACTL_WGE_PCT_TOT_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS,NVL(den.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(y.ACTL_WAGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on lc.loc_no=y.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den]]> 
  </CurrentActualWagePercentageTotal>
  
  <BudgetWages>
<![CDATA[select lc.dept_nm,NVL(ROUND(bdgt.BDGT_WAGE_WTSS,0),0) as BDGT_WGE_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.bdgt_wage_amt) as BDGT_WAGE_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.dply_seq order by e.dply_seq) bdgt
on lc.dply_seq=bdgt.dply_seq order by lc.dply_seq]]> 
  </BudgetWages>
  
  <BudgetWagesTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(bdgt.BDGT_WAGE_TOT_WTSS,0),0) as BDGT_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.bdgt_wage_amt) as BDGT_WAGE_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no]]> 
  </BudgetWagesTotal>
  
  <ForecastWages>
<![CDATA[select lc.dept_nm,NVL(ROUND(fcst.FCST_WAGE_WTSS,0),0) as FCST_WGE_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null  and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.frcst_wage_amt) as FCST_WAGE_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.dply_seq order by e.dply_seq) fcst
on lc.dply_seq=fcst.dply_seq order by lc.dply_seq]]> 
  </ForecastWages>
  
  <ForecastWagesTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(fcst.FCST_WAGE_TOT_WTSS,0),0) as FCST_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.frcst_wage_amt) as FCST_WAGE_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) fcst
on lc.loc_no=fcst.loc_no order by lc.loc_no]]> 
  </ForecastWagesTotal>
  
  <BudgetWagePercentage>
<![CDATA[select dpt.dept_nm,
CASE When NVL(bdgt.BDGT_WGE_WTSS,0)=0 Then 0 When NVL(bdgt.BDGT_SLS_WTSS,0)=0 Then 0
ELSE NVL(ROUND((bdgt.BDGT_WGE_WTSS / bdgt.BDGT_SLS_WTSS)*100,2),0) END as BDGT_WGE_PCT_WTSS from 
(select dply_seq,dept_nm from dept where dept_no NOT IN (20) and div_no='Division' and div_no='Division' and dply_seq is NOT NULL) dpt
LEFT OUTER JOIN
(select src.dply_seq,sum(src.bdgt_wage_amt) as BDGT_WGE_WTSS,sum(src.bdgt_sls) as BDGT_SLS_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) src
group by src.dply_seq order by src.dply_seq)bdgt
on dpt.dply_seq=bdgt.dply_seq 
order by dpt.dply_seq]]> 
  </BudgetWagePercentage>
  
  <BudgetWagePercentageTotal>
<![CDATA[select wge.loc_nm,
CASE When wge.BDGT_WGE_TOT_WTSS=0 Then 0 When sls.BDGT_SLS_TOT_WTSS=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_WTSS / sls.BDGT_SLS_TOT_WTSS)*100,2),0) END as BDGT_WGE_PCT_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm]]> 
  </BudgetWagePercentageTotal>
  
  <ForecastWagePercentage>
<![CDATA[select dpt.dept_nm,
CASE When NVL(fcst.FCST_WGE_WTSS,0)=0 Then 0 When NVL(fcst.FCST_SLS_WTSS,0)=0 Then 0
ELSE NVL(ROUND((fcst.FCST_WGE_WTSS / fcst.FCST_SLS_WTSS)*100,2),0) END as fcst_WGE_PCT_WTSS from 
(select dply_seq,dept_nm from dept where dept_no NOT IN (20) and div_no='Division' and dply_seq is NOT NULL) dpt
LEFT OUTER JOIN
(select src.dply_seq,sum(src.frcst_wage_amt) as FCST_WGE_WTSS,sum(src.frcst_sls) as FCST_SLS_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) src
group by src.dply_seq order by src.dply_seq)fcst
on dpt.dply_seq=fcst.dply_seq 
order by dpt.dply_seq]]> 
  </ForecastWagePercentage>
  
  <ForecastWagePercentageTotal>
<![CDATA[select wge.loc_nm,
CASE When wge.FCST_WGE_TOT_WTSS=0 Then 0 When sls.FCST_SLS_TOT_WTSS=0 Then 0
ELSE NVL(ROUND((wge.FCST_WGE_TOT_WTSS / sls.FCST_SLS_TOT_WTSS)*100,2),0) END as FCST_WGE_PCT_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm]]> 
  </ForecastWagePercentageTotal>
  
  <PlannedWages>
<![CDATA[select z.dept_nm,NVL(ROUND(y.PLN_WAGE_WTSS,0),0) as PLN_WGE_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq,e.dept_nm 
order by e.dply_seq) y
on z.dept_nm=y.dept_nm order by z.dply_seq]]> 
  </PlannedWages>
  
  <PlannedWagesTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(sum(wge.PLN_WAGE_WTSS),0),0) as PLN_WGE_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm]]> 
  </PlannedWagesTotal>
  
  <PlannedWagesPercentage>
<![CDATA[select wge.dept_nm,
CASE When wge.PLN_WGE_WTSS=0 Then 0 When sls.PLN_SLS_WTSS=0 Then 0 
ELSE NVL(ROUND((wge.PLN_WGE_WTSS / sls.PLN_SLS_WTSS)*100,2),0) END as PLN_WGE_PRCNT_WTSS from
(select z.dept_nm,NVL(y.PLN_WAGE_WTSS,0) as PLN_WGE_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) y
on z.dply_seq=y.dply_seq order by z.dply_seq) wge,
(select z.dept_nm,NVL(y.PLN_SLS_WTSS,0) as PLN_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select h.dply_seq,sum(h.PLN_SLS_WTSS) as PLN_SLS_WTSS from 
(/*select * from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_WTSS,sum(e.refcst_itm_cnt) as PLN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_WTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and a.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_WTSS,sum(e.gnrt_itm) as GEN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and a.loc_no='store')
/*and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.dply_seq order by h.dply_seq) y
on z.dply_seq=y.dply_seq order by z.dply_seq) sls
where wge.dept_nm=sls.dept_nm]]> 
  </PlannedWagesPercentage>
  
  <PlannedWagesPercentageTotal>
<![CDATA[select wge.loc_nm,NVL(ROUND((wge.PLN_WGE_TOT_WTSS / sls.PLN_SLS_TOT_WTSS)*100,2),0) as PLN_WGE_PRCNT_TOT_WTSS from
(select lc.loc_nm,sum(wge.PLN_WAGE_WTSS) as PLN_WGE_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as PLN_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_WTSS) as PLN_SLS_WTSS from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_WTSS,sum(e.refcst_itm_cnt) as PLN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_WTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (90,85) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and a.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_WTSS,sum(e.gnrt_itm) as GEN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and a.loc_no='store')
/*and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm]]> 
  </PlannedWagesPercentageTotal>
  
  <PlannedCPH>
<![CDATA[select lc.dept_nm,
CASE When NVL(wge.PLN_WAGE_WTSS,0)=0 Then 0 When NVL(wge.PLN_HOURS_WTSS,0)=0 Then 0 
ELSE NVL(ROUND((wge.PLN_WAGE_WTSS / wge.PLN_HOURS_WTSS),2),0) END as PLN_CPH_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq,e.dept_nm 
order by e.dply_seq) wge
on lc.dept_nm=wge.dept_nm order by lc.dply_seq]]> 
  </PlannedCPH>
  
  <PlannedCPHTotal>
<![CDATA[select lc.loc_nm,
CASE When NVL(wge.PLN_WAGE_TOT_WTSS,0)=0 Then 0 When NVL(wge.PLN_HOURS_TOT_WTSS,0)=0 Then 0 
ELSE NVL(ROUND((wge.PLN_WAGE_TOT_WTSS / wge.PLN_HOURS_TOT_WTSS),2),0) END as PLN_CPH_TOT_WTSS from
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_no]]> 
  </PlannedCPHTotal>
  
  <ActualCPH>
<![CDATA[select lc.dept_nm,
CASE When NVL(wge.ACTL_WAGE_WTSS,0)=0 Then 0 When NVL(wge.ACTL_HOURS_WTSS,0)=0 Then 0 
ELSE NVL(ROUND((wge.ACTL_WAGE_WTSS / wge.ACTL_HOURS_WTSS),2),0) END as ACTL_CPH_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WAGE_WTSS,sum(e.actl_hrs) as ACTL_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) wge
on wge.dply_seq=lc.dply_seq order by lc.dply_seq]]> 
  </ActualCPH>
  
  <ActualCPHTotal>
<![CDATA[select lc.loc_nm,
CASE When NVL(wge.ACTL_WAGE_TOT_WTSS,0)=0 Then 0 When NVL(wge.ACTL_HOURS_TOT_WTSS,0)=0 Then 0 
ELSE NVL(ROUND((wge.ACTL_WAGE_TOT_WTSS / wge.ACTL_HOURS_TOT_WTSS),2),0) END as ACTL_CPH_TOT_WTSS from
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WAGE_TOT_WTSS,sum(e.actl_hrs) as ACTL_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_no]]> 
  </ActualCPHTotal>
  
  <VarWages>
<![CDATA[select pln.dept_nm,ROUND((actl.ACTL_WGE_PCT_WTSS - pln.BDGT_WGE_PCT_WTSS),2) as VAR_WGE_WTSS from 
(select nume_den.dept_nm,
CASE When nume_den.ACTL_WGE_WTSS=0 Then 0 when nume_den.ACTL_SLS_WTSS=0 Then 0
ELSE ((nume_den.ACTL_WGE_WTSS / nume_den.ACTL_SLS_WTSS)*100) END as ACTL_WGE_PCT_WTSS from 
(select nume.dept_nm,NVL(nume.ACTL_WGE_WTSS,0) as ACTL_WGE_WTSS,NVL(den.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select lc.dept_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_WTSS from 
(select distinct dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq) nume,
(select lc.dept_nm,NVL(sls.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.dply_seq order by h.dply_seq) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) den 
where nume.dept_nm=den.dept_nm) nume_den) actl,
(select dpt.dept_nm,
CASE When NVL(bdgt.BDGT_WGE_WTSS,0)=0 Then 0 When NVL(bdgt.BDGT_SLS_WTSS,0)=0 Then 0
ELSE NVL(ROUND((bdgt.BDGT_WGE_WTSS / bdgt.BDGT_SLS_WTSS)*100,2),0) END as BDGT_WGE_PCT_WTSS from 
(select dply_seq,dept_nm from dept where dept_no NOT IN (20) and div_no='Division' and dply_seq is NOT NULL) dpt
LEFT OUTER JOIN
(select src.dply_seq,sum(src.bdgt_wage_amt) as BDGT_WGE_WTSS,sum(src.bdgt_sls) as BDGT_SLS_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) src
group by src.dply_seq order by src.dply_seq)bdgt
on dpt.dply_seq=bdgt.dply_seq 
order by dpt.dply_seq) pln
where pln.dept_nm=actl.dept_nm]]> 
  </VarWages>
  
  <VarWagesTotal>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_WGE_PCT_TOT_WTSS - pln.BDGT_WGE_PCT_TOT_WTSS),2) as VAR_WGE_TOT_WTSS from 
(select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_TOT_WTSS=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
ELSE ((nume_den.ACTL_WGE_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100) END as ACTL_WGE_PCT_TOT_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS,NVL(den.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den) actl,
(select wge.loc_nm,
CASE When wge.BDGT_WGE_TOT_WTSS=0 Then 0 When sls.BDGT_SLS_TOT_WTSS=0 Then 0
ELSE NVL((wge.BDGT_WGE_TOT_WTSS / sls.BDGT_SLS_TOT_WTSS)*100,0) END as BDGT_WGE_PCT_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) pln
where pln.loc_nm=actl.loc_nm]]> 
  </VarWagesTotal>
  
    <VarFcstWages>
<![CDATA[select pln.dept_nm,ROUND((actl.ACTL_WGE_PCT_WTSS - pln.FCST_WGE_PCT_WTSS),2) as VAR_FCST_WGE_WTSS from 
(select nume_den.dept_nm,
CASE When nume_den.ACTL_WGE_WTSS=0 Then 0 when nume_den.ACTL_SLS_WTSS=0 Then 0
ELSE ((nume_den.ACTL_WGE_WTSS / nume_den.ACTL_SLS_WTSS)*100) END as ACTL_WGE_PCT_WTSS from 
(select nume.dept_nm,NVL(nume.ACTL_WGE_WTSS,0) as ACTL_WGE_WTSS,NVL(den.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select lc.dept_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_WTSS from 
(select distinct dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq) nume,
(select lc.dept_nm,NVL(sls.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.dply_seq order by h.dply_seq) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) den 
where nume.dept_nm=den.dept_nm) nume_den) actl,
(select dpt.dept_nm,
CASE When NVL(fcst.FCST_WGE_WTSS,0)=0 Then 0 When NVL(fcst.FCST_SLS_WTSS,0)=0 Then 0
ELSE NVL(ROUND((fcst.FCST_WGE_WTSS / fcst.FCST_SLS_WTSS)*100,2),0) END as fcst_WGE_PCT_WTSS from 
(select dply_seq,dept_nm from dept where dept_no NOT IN (20) and div_no='Division' and dply_seq is NOT NULL) dpt
LEFT OUTER JOIN
(select src.dply_seq,sum(src.frcst_wage_amt) as FCST_WGE_WTSS,sum(src.frcst_sls) as FCST_SLS_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) src
group by src.dply_seq order by src.dply_seq)fcst
on dpt.dply_seq=fcst.dply_seq 
order by dpt.dply_seq) pln
where pln.dept_nm=actl.dept_nm]]> 
  </VarFcstWages>
  
  <VarFcstWagesTotal>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_WGE_PCT_TOT_WTSS - pln.FCST_WGE_PCT_TOT_WTSS),2) as VAR_FCST_WGE_TOT_WTSS from 
(select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_TOT_WTSS=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
ELSE ((nume_den.ACTL_WGE_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100) END as ACTL_WGE_PCT_TOT_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS,NVL(den.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den) actl,
(select wge.loc_nm,
CASE When wge.FCST_WGE_TOT_WTSS=0 Then 0 When sls.FCST_SLS_TOT_WTSS=0 Then 0
ELSE NVL(((wge.FCST_WGE_TOT_WTSS / sls.FCST_SLS_TOT_WTSS)*100),0) END as FCST_WGE_PCT_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) pln
where pln.loc_nm=actl.loc_nm]]> 
  </VarFcstWagesTotal>
 <AllowedWages>
<![CDATA[select src.dept_nm,
case 
when src.ACTL_SLS_MTSS > src.BDGT_SLS_MTSS 
	then NVL(ROUND((((BDGT_WGE_PCT_MTSS * BDGT_SLS_MTSS) + ((ACTL_SLS_MTSS - BDGT_SLS_MTSS) * (PST_FACTOR_MTSS * BDGT_WGE_PCT_MTSS)))/100),0),0)
When src.ACTL_SLS_MTSS < src.BDGT_SLS_MTSS 
	then NVL(ROUND((((BDGT_WGE_PCT_MTSS * BDGT_SLS_MTSS) + ((ACTL_SLS_MTSS - BDGT_SLS_MTSS) * (NGT_FACTOR_MTSS * BDGT_WGE_PCT_MTSS)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_MTSS * ACTL_SLS_MTSS)/100),0),0) end as ALWD_WGE_MTSS from 

(select actl_sls.dept_nm,rte_fct.wk_id,actl_sls.ACTL_SLS_MTSS,rte_fct.PST_FACTOR_MTSS,rte_fct.NGT_FACTOR_MTSS,
bdgt_wge_pct.BDGT_WGE_PCT_MTSS,bdgt_wge_pct.BDGT_WGE_MTSS,bdgt_wge_pct.BDGT_SLS_MTSS from

(select lc.dept_nm,NVL(ROUND(sls.wtd,0),0) as ACTL_SLS_MTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,sum(z.wtd) as WTD from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_MTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_MTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_MTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_MTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_MTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_MTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_MTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_MTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z
group by z.dply_seq order by z.dply_seq) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_MTSS,NVL(src.ngt_factor,1) as NGT_FACTOR_MTSS from 
(select perd_desc,wk_id from wk where wk_id  between 'WeekStart' and 'WeekStart') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id  between 'WeekStart' and 'WeekStart') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select dpt.dept_nm,NVL(ROUND(bdgt.bdgt_wage_amt,0),0) as BDGT_WGE_MTSS, NVL(ROUND(bdgt.bdgt_sls,0),0) as BDGT_SLS_MTSS,
CASE When NVL(bdgt.bdgt_wage_amt,0)=0 and NVL(bdgt.bdgt_sls,0)=0 Then 0
When NVL(bdgt.bdgt_wage_amt,0)=0 Then 0 When NVL(bdgt.bdgt_sls,0)=0 Then 0
ELSE NVL(ROUND((bdgt.bdgt_wage_amt / bdgt.bdgt_sls)*100,5),0) END as BDGT_WGE_PCT_MTSS from 
(select dply_seq,dept_nm from dept where dept_no NOT IN (20) and div_no='Division' and dply_seq is NOT NULL) dpt
LEFT OUTER JOIN
(select e.dply_seq,e.dept_nm,sum(e.bdgt_wage_amt) as bdgt_wage_amt, sum(e.bdgt_sls) as bdgt_sls from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e 
group by e.dply_seq,e.dept_nm order by e.dply_seq) bdgt
on dpt.dply_seq=bdgt.dply_seq and dpt.dept_nm=bdgt.dept_nm
order by dpt.dply_seq) bdgt_wge_pct

where actl_sls.dept_nm=bdgt_wge_pct.dept_nm) src]]> 
  </AllowedWages> 
  <AllowedWagesTotal>
<![CDATA[select src.loc_nm,
case 
when src.ACTL_SLS_TOT_MTSS > src.BDGT_SLS_TOT_MTSS 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_MTSS * BDGT_SLS_TOT_MTSS) + ((ACTL_SLS_TOT_MTSS - BDGT_SLS_TOT_MTSS) * (PST_FACTOR_TOT_MTSS * BDGT_WGE_PCT_TOT_MTSS)))/100),0),0)
When src.ACTL_SLS_TOT_MTSS < src.BDGT_SLS_TOT_MTSS 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_MTSS * BDGT_SLS_TOT_MTSS) + ((ACTL_SLS_TOT_MTSS - BDGT_SLS_TOT_MTSS) * (NGT_FACTOR_TOT_MTSS * BDGT_WGE_PCT_TOT_MTSS)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_TOT_MTSS * ACTL_SLS_TOT_MTSS)/100),0),0) end as ALWD_WGE_TOT_MTSS from 

(select actl_sls.loc_nm,rte_fct.wk_id,actl_sls.ACTL_SLS_TOT_MTSS,rte_fct.PST_FACTOR_TOT_MTSS,rte_fct.NGT_FACTOR_TOT_MTSS,
bdgt_wge_pct.BDGT_WGE_PCT_TOT_MTSS,bdgt_wge_pct.BDGT_WGE_TOT_MTSS,bdgt_wge_pct.BDGT_SLS_TOT_MTSS from

(select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as ACTL_SLS_TOT_MTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,sum(z.wtd) as WTD from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_MTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_MTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_MTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_MTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_MTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_MTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_MTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z
group by z.loc_no order by z.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_TOT_MTSS,NVL(src.ngt_factor,1) as NGT_FACTOR_TOT_MTSS from 
(select perd_desc,wk_id from wk where wk_id  between 'WeekStart' and 'WeekStart') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id  between 'WeekStart' and 'WeekStart') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select wge.loc_nm,NVL(ROUND(wge.BDGT_WGE_TOT_MTSS,0),0) as BDGT_WGE_TOT_MTSS, NVL(ROUND(sls.BDGT_SLS_TOT_MTSS,0),0) as BDGT_SLS_TOT_MTSS,
CASE When NVL(wge.BDGT_WGE_TOT_MTSS,0)=0 and NVL(sls.BDGT_SLS_TOT_MTSS,0)=0 Then 0
When NVL(wge.BDGT_WGE_TOT_MTSS,0)=0 Then 0 When NVL(sls.BDGT_SLS_TOT_MTSS,0)=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_MTSS / sls.BDGT_SLS_TOT_MTSS)*100,5),0) END as BDGT_WGE_PCT_TOT_MTSS from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_MTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_MTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) bdgt_wge_pct

where actl_sls.loc_nm=bdgt_wge_pct.loc_nm order by actl_sls.loc_nm,rte_fct.wk_id) src
order by src.loc_nm ]]> 
  </AllowedWagesTotal>  
  </TCName>
  
  <TCName name="LonglifeseafoodSalesColumnValidation">

   <PlannedSalesLL>
<![CDATA[select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'store LLANDDD' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no]]> 
  </PlannedSalesLL>
  <PlannedSalesSD>
<![CDATA[select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'store LLANDDD' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no]]> 
  </PlannedSalesSD> 
   <ActualSalesLL>
<![CDATA[select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no]]> 
  </ActualSalesLL>
  <ActualSalesSD>
<![CDATA[select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no]]> 
  </ActualSalesSD>
 
  <VarSalesLL>
<![CDATA[select pln.loc_nm,ROUND((actl.wtd - pln.wtd),0) as VAR_SLS_WTD_WTSS from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store LLANDDD' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) pln,
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl
where pln.loc_nm=actl.loc_nm]]> 
  </VarSalesLL>
  <VarSalesSD>
<![CDATA[select pln.loc_nm,ROUND((actl.wtd - pln.wtd),0) as VAR_SLS_WTD_WTSS from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store LLANDDD' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) pln,
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl
where pln.loc_nm=actl.loc_nm]]> 
  </VarSalesSD>
    <LYSalesLL>
<![CDATA[select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no]]> 
  </LYSalesLL>
  <LYSalesSD>
<![CDATA[select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no]]> 
  </LYSalesSD>
  <LYSalesPctLL>
<![CDATA[select lc.loc_nm,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100
     WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select cy_val.loc_nm,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) cy_val
LEFT OUTER JOIN
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) ly_val
on cy_val.loc_nm=ly_val.loc_nm 
group by cy_val.loc_nm) cyly_wtd
on cyly_wtd.loc_nm=lc.loc_nm]]> 
  </LYSalesPctLL>
  <LYSalesPctSD>
<![CDATA[select lc.loc_nm,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100
     WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select cy_val.loc_nm,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) cy_val
LEFT OUTER JOIN
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) ly_val
on cy_val.loc_nm=ly_val.loc_nm 
group by cy_val.loc_nm) cyly_wtd
on cyly_wtd.loc_nm=lc.loc_nm]]> 
  </LYSalesPctSD>
  <BudgetSalesLL>
<![CDATA[select lc.loc_nm,NVL(bdgt.BDGT_SALES_TOT_WTSS,0) as BDGT_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no]]> 
  </BudgetSalesLL>
  <BudgetSalesSD>
<![CDATA[select lc.loc_nm,NVL(bdgt.BDGT_SALES_TOT_WTSS,0) as BDGT_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no]]> 
  </BudgetSalesSD> 
<ForecastSalesLL>
<![CDATA[select lc.loc_nm,NVL(bdgt.FCST_SALES_TOT_WTSS,0) as FCST_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,ROUND(sum(e.frcst_sls),0) as FCST_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no]]> 
  </ForecastSalesLL>
  <ForecastSalesSD>
<![CDATA[select lc.loc_nm,NVL(bdgt.FCST_SALES_TOT_WTSS,0) as FCST_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,ROUND(sum(e.frcst_sls),0) as FCST_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no]]> 
  </ForecastSalesSD>
  
   <VarBudgetSalesLL>
<![CDATA[select actl.loc_nm,ROUND((actl.wtd - bdgt.wtd),0) as VAR_BDGT_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl,
(select lc.loc_nm,NVL(bdgt.BDGT_SALES_TOT_WTSS,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.bdgt_sls) as BDGT_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no) bdgt
where bdgt.loc_nm=actl.loc_nm]]> 
  </VarBudgetSalesLL>
 <VarBudgetSalesSD>
<![CDATA[select actl.loc_nm,ROUND((actl.wtd - bdgt.wtd),0) as VAR_BDGT_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl,
(select lc.loc_nm,NVL(bdgt.BDGT_SALES_TOT_WTSS,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.bdgt_sls) as BDGT_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no) bdgt
where bdgt.loc_nm=actl.loc_nm]]> 
  </VarBudgetSalesSD>
  <VarFcstSalesLL>
<![CDATA[select actl.loc_nm,ROUND((actl.wtd - fcst.wtd),0) as VAR_FCST_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl,
(select lc.loc_nm,NVL(bdgt.FCST_SALES_TOT_WTSS,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.frcst_sls) as FCST_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no) fcst
where fcst.loc_nm=actl.loc_nm]]> 
  </VarFcstSalesLL>
  <VarFcstSalesSD>
<![CDATA[select actl.loc_nm,ROUND((actl.wtd - fcst.wtd),0) as VAR_FCST_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl,
(select lc.loc_nm,NVL(bdgt.FCST_SALES_TOT_WTSS,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.frcst_sls) as FCST_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no) fcst
where fcst.loc_nm=actl.loc_nm]]> 
  </VarFcstSalesSD>
  <AvgBasketSalesLL>
<![CDATA[select lc.loc_nm,
CASE WHEN nume_den.wtd_sls = 0 THEN 0 WHEN nume_den.wtd_cust = 0 THEN 100
ELSE nvl(ROUND((nume_den.wtd_sls / nume_den.wtd_cust),2),0) END as AVG_BASKET_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_cust + x.Tue_cust + x.Wed_cust + x.Thu_cust + x.Fri_cust + x.Sat_cust + x.Sun_cust) as WTD_CUST from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_WTSS)),0) Mon_cust,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_WTSS)),0) Tue_cust,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_WTSS)),0) Wed_cust,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_WTSS)),0) Thu_cust,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_WTSS)),0) Fri_cust,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_WTSS)),0) Sat_cust,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_WTSS)),0) Sun_cust from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) nume_den
on nume_den.loc_no=lc.loc_no]]> 
  </AvgBasketSalesLL>
  <AvgBasketSalesSD>
<![CDATA[select lc.loc_nm,
CASE WHEN nume_den.wtd_sls = 0 THEN 0 WHEN nume_den.wtd_cust = 0 THEN 100
ELSE nvl(ROUND((nume_den.wtd_sls / nume_den.wtd_cust),2),0) END as AVG_BASKET_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_cust + x.Tue_cust + x.Wed_cust + x.Thu_cust + x.Fri_cust + x.Sat_cust + x.Sun_cust) as WTD_CUST from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_WTSS)),0) Mon_cust,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_WTSS)),0) Tue_cust,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_WTSS)),0) Wed_cust,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_WTSS)),0) Thu_cust,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_WTSS)),0) Fri_cust,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_WTSS)),0) Sat_cust,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_WTSS)),0) Sun_cust from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) nume_den
on nume_den.loc_no=lc.loc_no]]> 
  </AvgBasketSalesSD>  
   <WkyMixSalesLL>
<![CDATA[select lc.loc_nm,
CASE WHEN nume_den.ACTL_SLS_WTSS = 0 THEN 0 WHEN NVL(nume_den.ACTL_SLS_TOT_WTSS,0) = 0 THEN 0
     WHEN NVL(nume_den.ACTL_SLS_WTSS,0) = 0 AND NVL(nume_den.ACTL_SLS_TOT_WTSS,0) = 0 THEN 0
ELSE ROUND((nume_den.ACTL_SLS_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100,2) END as WKY_MIX_SLS_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select nume.loc_nm,nume.ACTL_SLS_WTSS,den.ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(sls.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den ) nume_den
on nume_den.loc_nm=lc.loc_nm order by lc.loc_nm]]> 
  </WkyMixSalesLL>
  <WkyMixSalesSD>
<![CDATA[select lc.loc_nm,
CASE WHEN nume_den.ACTL_SLS_WTSS = 0 THEN 0 WHEN NVL(nume_den.ACTL_SLS_TOT_WTSS,0) = 0 THEN 0
     WHEN NVL(nume_den.ACTL_SLS_WTSS,0) = 0 AND NVL(nume_den.ACTL_SLS_TOT_WTSS,0) = 0 THEN 0
ELSE ROUND((nume_den.ACTL_SLS_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100,2) END as WKY_MIX_SLS_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select nume.loc_nm,nume.ACTL_SLS_WTSS,den.ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(sls.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,90,20,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den ) nume_den
on nume_den.loc_nm=lc.loc_nm order by lc.loc_nm]]> 
  </WkyMixSalesSD>
 </TCName>
 <TCName name="LLandseafoodItemsColumnValidation">  
   
  <PlannedItemsLL>
<![CDATA[select lc.loc_nm,NVL(ROUND(itm.PLN_ITM_TOT_WTSS,0),0) as PLN_ITM_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no]]> 
  </PlannedItemsLL>
   <PlannedItemsSD>
<![CDATA[select lc.loc_nm,NVL(ROUND(itm.PLN_ITM_TOT_WTSS,0),0) as PLN_ITM_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no   IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no]]> 
  </PlannedItemsSD>
   <ActualItemsLL>
<![CDATA[select lc.loc_nm,NVL(ROUND(itm.ACTL_ITM_TOT_WTSS,0),0) as ACTL_ITM_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.dply_seq,pln_itm.loc_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_no]]> 
  </ActualItemsLL>
   <ActualItemsSD>
<![CDATA[select lc.loc_nm,NVL(ROUND(itm.ACTL_ITM_TOT_WTSS,0),0) as ACTL_ITM_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.dply_seq,pln_itm.loc_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_no]]> 
  </ActualItemsSD>  
  <PlannedItemPriceLL>
<![CDATA[select lc.loc_nm,
case when NVL(sls_itm.PLN_SLS_TOT_WTSS,0)=0 and NVL(sls_itm.PLN_ITM_TOT_WTSS,0)=0 then 0
when NVL(sls_itm.PLN_SLS_TOT_WTSS,0)=0 then 0 when NVL(sls_itm.PLN_ITM_TOT_WTSS,0)=0 then 100 
else NVL(ROUND((sls_itm.PLN_SLS_TOT_WTSS / sls_itm.PLN_ITM_TOT_WTSS),2),0) end as PLN_ITMPRZ_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSS,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  in (Department )
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  in (Department )
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  in (Department )
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no order by h.loc_no) sls_itm
on lc.loc_no=sls_itm.loc_no]]> 
  </PlannedItemPriceLL>
  
  <PlannedItemPriceSD>
<![CDATA[select lc.loc_nm,
case when NVL(sls_itm.PLN_SLS_TOT_WTSS,0)=0 and NVL(sls_itm.PLN_ITM_TOT_WTSS,0)=0 then 0
when NVL(sls_itm.PLN_SLS_TOT_WTSS,0)=0 then 0 when NVL(sls_itm.PLN_ITM_TOT_WTSS,0)=0 then 100 
else NVL(ROUND((sls_itm.PLN_SLS_TOT_WTSS / sls_itm.PLN_ITM_TOT_WTSS),2),0) end as PLN_ITMPRZ_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSS,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  in (Department )
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  in (Department )
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  in (Department )
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no order by h.loc_no) sls_itm
on lc.loc_no=sls_itm.loc_no]]> 
  </PlannedItemPriceSD>
  
  <ActualItemPriceLL>
<![CDATA[select lc.loc_nm,NVL(ROUND((sls_itm.ACTL_SLS_TOT_WTSS / sls_itm.ACTL_ITM_TOT_WTSS),2),0) as ACTL_ITMPRZ_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls_itm.dply_seq,pln_sls_itm.loc_no,pln_sls_itm.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls_itm
on lc.loc_no=sls_itm.loc_no order by lc.loc_no]]> 
  </ActualItemPriceLL>
  <ActualItemPriceSD>
<![CDATA[select lc.loc_nm,NVL(ROUND((sls_itm.ACTL_SLS_TOT_WTSS / sls_itm.ACTL_ITM_TOT_WTSS),2),0) as ACTL_ITMPRZ_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls_itm.dply_seq,pln_sls_itm.loc_no,pln_sls_itm.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls_itm
on lc.loc_no=sls_itm.loc_no order by lc.loc_no]]> 
  </ActualItemPriceSD>
  
</TCName>  
  
<TCName name="LonglifeseafoodCustomersColumnValidation">  
  
  
  
  <ThisYrActlCustomersLL>
<![CDATA[select lc.loc_nm,NVL(ROUND(itm.ACTL_CUST_TOT_WTSS,0),0) as ACTL_CUST_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.dply_seq,pln_itm.loc_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_no]]> 
  </ThisYrActlCustomersLL>
  <ThisYrActlCustomersSD>
<![CDATA[select lc.loc_nm,NVL(ROUND(itm.ACTL_CUST_TOT_WTSS,0),0) as ACTL_CUST_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.dply_seq,pln_itm.loc_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_no]]> 
  </ThisYrActlCustomersSD>
  
  <PctLastYrCustomersLL>
<![CDATA[select lc.loc_nm,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100
     WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select cy_val.loc_nm,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.loc_nm,NVL(sls.ACTL_CUST_WTSS,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) cy_val
LEFT OUTER JOIN
(select lc.loc_nm,NVL(sls.ACTL_CUST_WTSS,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) ly_val
on cy_val.loc_nm=ly_val.loc_nm 
group by cy_val.loc_nm ) cyly_wtd
on cyly_wtd.loc_nm=lc.loc_nm]]> 
  </PctLastYrCustomersLL>
   
  <PctLastYrCustomersSD>
<![CDATA[select lc.loc_nm,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100
     WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select cy_val.loc_nm,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.loc_nm,NVL(sls.ACTL_CUST_WTSS,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) cy_val
LEFT OUTER JOIN
(select lc.loc_nm,NVL(sls.ACTL_CUST_WTSS,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) ly_val
on cy_val.loc_nm=ly_val.loc_nm 
group by cy_val.loc_nm ) cyly_wtd
on cyly_wtd.loc_nm=lc.loc_nm]]> 
  </PctLastYrCustomersSD>
  <DataPenetrationCustomersLL>
<![CDATA[select nume_den.loc_nm,
CASE When nume_den.ACTL_CUST_WTSS=0 Then 0 when nume_den.ACTL_CUST_TOT_WTSS=0 Then 0
ELSE ROUND((nume_den.ACTL_CUST_WTSS / nume_den.ACTL_CUST_TOT_WTSS)*100,2) END as DATA_PEN_CUST_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_CUST_WTSS,0) as ACTL_CUST_WTSS,NVL(den.ACTL_CUST_TOT_WTSS,0) as ACTL_CUST_TOT_WTSS from 
(select lc.loc_nm,itm.ACTL_CUST_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart'and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_nm) nume,
(select lc.loc_nm,itm.ACTL_CUST_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  in  (0) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart'and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_no) den order by nume.loc_nm) nume_den]]> 
  </DataPenetrationCustomersLL>
  <DataPenetrationCustomersSD>
<![CDATA[select nume_den.loc_nm,
CASE When nume_den.ACTL_CUST_WTSS=0 Then 0 when nume_den.ACTL_CUST_TOT_WTSS=0 Then 0
ELSE ROUND((nume_den.ACTL_CUST_WTSS / nume_den.ACTL_CUST_TOT_WTSS)*100,2) END as DATA_PEN_CUST_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_CUST_WTSS,0) as ACTL_CUST_WTSS,NVL(den.ACTL_CUST_TOT_WTSS,0) as ACTL_CUST_TOT_WTSS from 
(select lc.loc_nm,itm.ACTL_CUST_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart'and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_nm) nume,
(select lc.loc_nm,itm.ACTL_CUST_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  in  (0) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart'and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_no) den order by nume.loc_nm) nume_den]]> 
  </DataPenetrationCustomersSD>
</TCName>  
  
<TCName name="LonglifeseafoodHoursColumnValidation">  
  
 
  
  <ActualHoursLL>
<![CDATA[select lc.loc_nm,NVL(ROUND(hrs.ACTL_HRS_DTS,2),0) as ACTL_HRS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no]]> 
  </ActualHoursLL>
   <ActualHoursSD>
<![CDATA[select lc.loc_nm,NVL(ROUND(hrs.ACTL_HRS_DTS,2),0) as ACTL_HRS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no]]> 
  </ActualHoursSD>
  
  
  
  
  <CurrentActualHoursLL>
<![CDATA[select lc.loc_nm,NVL(ROUND(y.ACTL_HOURS_TOT_WTSS,2),0) as ACTL_HRS_TOT_WTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on lc.loc_no=y.loc_no order by lc.loc_no]]> 
  </CurrentActualHoursLL>
    <CurrentActualHoursSD>
<![CDATA[select lc.loc_nm,NVL(ROUND(y.ACTL_HOURS_TOT_WTSS,2),0) as ACTL_HRS_TOT_WTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on lc.loc_no=y.loc_no order by lc.loc_no]]> 
  </CurrentActualHoursSD>
    
  
  <PlannedHoursLL>
<![CDATA[select lc.loc_nm,NVL(ROUND(sum(hrs.PLN_HOURS_TOT_WTSS),2),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm]]> 
  </PlannedHoursLL>
  <PlannedHoursSD>
<![CDATA[select lc.loc_nm,NVL(ROUND(sum(hrs.PLN_HOURS_TOT_WTSS),2),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm]]> 
  </PlannedHoursSD>
  
  
  <CurrentPlannedHoursLL>
<![CDATA[select lc.loc_nm,NVL(ROUND(sum(hrs.PLN_HOURS_TOT_WTSS),2),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm]]> 
  </CurrentPlannedHoursLL>
  <CurrentPlannedHoursLL>
<![CDATA[select lc.loc_nm,NVL(ROUND(sum(hrs.PLN_HOURS_TOT_WTSS),2),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm]]> 
  </CurrentPlannedHoursLL>
  
  
  <VarHoursLL>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_HRS_TOT_WTSS - pln.PLN_HRS_TOT_WTSS),2) as VAR_HRS_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(hrs.PLN_HOURS_TOT_WTSS),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm) pln,
(select lc.loc_nm,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) actl
where pln.loc_nm=actl.loc_nm]]> 
  </VarHoursLL>
  <VarHoursSD>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_HRS_TOT_WTSS - pln.PLN_HRS_TOT_WTSS),2) as VAR_HRS_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(hrs.PLN_HOURS_TOT_WTSS),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm) pln,
(select lc.loc_nm,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) actl
where pln.loc_nm=actl.loc_nm]]> 
  </VarHoursSD>
  
  
  <CurrentVarHoursLL>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_HRS_TOT_WTSS - pln.PLN_HRS_TOT_WTSS),2) as VAR_HRS_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(hrs.PLN_HOURS_TOT_WTSS),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm) pln,
(select lc.loc_nm,NVL(sum(hrs.PLN_HOURS_TOT_WTSS),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm) actl
where pln.loc_nm=actl.loc_nm]]> 
  </CurrentVarHoursLL>
  <CurrentVarHoursSD>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_HRS_TOT_WTSS - pln.PLN_HRS_TOT_WTSS),2) as VAR_HRS_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(hrs.PLN_HOURS_TOT_WTSS),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm) pln,
(select lc.loc_nm,NVL(sum(hrs.PLN_HOURS_TOT_WTSS),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm) actl
where pln.loc_nm=actl.loc_nm]]> 
  </CurrentVarHoursSD>
</TCName>

<TCName name = "LonglifeseafoodwagesColumnValidation" >

 
  
  <ActualWagesLL>
<![CDATA[select lc.loc_nm,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no]]> 
  </ActualWagesLL>
  <ActualWagesSD>
<![CDATA[select lc.loc_nm,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no]]> 
  </ActualWagesSD>
  

  
  <CurrentActualWagesLL>
<![CDATA[select lc.loc_nm,NVL(ROUND(y.ACTL_WAGE_TOT_WTSS,0),0) as ACTL_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on lc.loc_no=y.loc_no order by lc.loc_no]]> 
  </CurrentActualWagesLL>
  <CurrentActualWagesSD>
<![CDATA[select lc.loc_nm,NVL(ROUND(y.ACTL_WAGE_TOT_WTSS,0),0) as ACTL_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on lc.loc_no=y.loc_no order by lc.loc_no]]> 
  </CurrentActualWagesSD>
  
  
  <ActualWagePercentageLL>
<![CDATA[select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_TOT_WTSS=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100,2) END as ACTL_WGE_PCT_TOT_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS,NVL(den.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den]]> 
  </ActualWagePercentageLL>
  <ActualWagePercentageSD>
<![CDATA[select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_TOT_WTSS=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100,2) END as ACTL_WGE_PCT_TOT_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS,NVL(den.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den]]> 
  </ActualWagePercentageSD>
   
  
  <CurrentActualWagePercentageLL>
<![CDATA[select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_TOT_WTSS=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100,2) END as ACTL_WGE_PCT_TOT_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS,NVL(den.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(y.ACTL_WAGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on lc.loc_no=y.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den]]> 
  </CurrentActualWagePercentageLL>
  <CurrentActualWagePercentageSD>
<![CDATA[select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_TOT_WTSS=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100,2) END as ACTL_WGE_PCT_TOT_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS,NVL(den.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(y.ACTL_WAGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on lc.loc_no=y.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den]]> 
  </CurrentActualWagePercentageSD>
  
  
  <BudgetWagesLL>
<![CDATA[select lc.loc_nm,NVL(ROUND(bdgt.BDGT_WAGE_TOT_WTSS,0),0) as BDGT_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.bdgt_wage_amt) as BDGT_WAGE_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no]]> 
  </BudgetWagesLL>
  <BudgetWagesSD>
<![CDATA[select lc.loc_nm,NVL(ROUND(bdgt.BDGT_WAGE_TOT_WTSS,0),0) as BDGT_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.bdgt_wage_amt) as BDGT_WAGE_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no]]> 
  </BudgetWagesSD>
  
  
  <ForecastWagesLL>
<![CDATA[select lc.loc_nm,NVL(ROUND(fcst.FCST_WAGE_TOT_WTSS,0),0) as FCST_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.frcst_wage_amt) as FCST_WAGE_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) fcst
on lc.loc_no=fcst.loc_no order by lc.loc_no]]> 
  </ForecastWagesLL>
  <ForecastWagesSD>
<![CDATA[select lc.loc_nm,NVL(ROUND(fcst.FCST_WAGE_TOT_WTSS,0),0) as FCST_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.frcst_wage_amt) as FCST_WAGE_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) fcst
on lc.loc_no=fcst.loc_no order by lc.loc_no]]> 
  </ForecastWagesSD>
  
 
  
  <BudgetWagePercentageLL>
<![CDATA[select wge.loc_nm,
CASE When wge.BDGT_WGE_TOT_WTSS=0 Then 0 When sls.BDGT_SLS_TOT_WTSS=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_WTSS / sls.BDGT_SLS_TOT_WTSS)*100,2),0) END as BDGT_WGE_PCT_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm]]> 
  </BudgetWagePercentageLL>
   <BudgetWagePercentageSD>
<![CDATA[select wge.loc_nm,
CASE When wge.BDGT_WGE_TOT_WTSS=0 Then 0 When sls.BDGT_SLS_TOT_WTSS=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_WTSS / sls.BDGT_SLS_TOT_WTSS)*100,2),0) END as BDGT_WGE_PCT_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm]]> 
  </BudgetWagePercentageSD>
  
  
  <ForecastWagePercentageLL>
<![CDATA[select wge.loc_nm,
CASE When wge.FCST_WGE_TOT_WTSS=0 Then 0 When sls.FCST_SLS_TOT_WTSS=0 Then 0
ELSE NVL(ROUND((wge.FCST_WGE_TOT_WTSS / sls.FCST_SLS_TOT_WTSS)*100,2),0) END as FCST_WGE_PCT_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm]]> 
  </ForecastWagePercentageLL>
  <ForecastWagePercentageSD>
<![CDATA[select wge.loc_nm,
CASE When wge.FCST_WGE_TOT_WTSS=0 Then 0 When sls.FCST_SLS_TOT_WTSS=0 Then 0
ELSE NVL(ROUND((wge.FCST_WGE_TOT_WTSS / sls.FCST_SLS_TOT_WTSS)*100,2),0) END as FCST_WGE_PCT_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm]]> 
  </ForecastWagePercentageSD>
 
  
  <PlannedWagesLL>
<![CDATA[select lc.loc_nm,NVL(ROUND(sum(wge.PLN_WAGE_WTSS),0),0) as PLN_WGE_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm]]> 
  </PlannedWagesLL>
  <PlannedWagesSD>
<![CDATA[select lc.loc_nm,NVL(ROUND(sum(wge.PLN_WAGE_WTSS),0),0) as PLN_WGE_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm]]> 
  </PlannedWagesSD>
  
 
  
  <PlannedWagesPercentageLL>
<![CDATA[select wge.loc_nm,NVL(ROUND((wge.PLN_WGE_TOT_WTSS / sls.PLN_SLS_TOT_WTSS)*100,2),0) as PLN_WGE_PRCNT_TOT_WTSS from
(select lc.loc_nm,sum(wge.PLN_WAGE_WTSS) as PLN_WGE_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as PLN_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store LLANDDD' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_WTSS) as PLN_SLS_WTSS from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_WTSS,sum(e.refcst_itm_cnt) as PLN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  in (Department )
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_WTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and a.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_WTSS,sum(e.gnrt_itm) as GEN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  in (Department )
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and a.loc_no='store')
/*and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm]]> 
  </PlannedWagesPercentageLL>
   <PlannedWagesPercentageSD>
<![CDATA[select wge.loc_nm,NVL(ROUND((wge.PLN_WGE_TOT_WTSS / sls.PLN_SLS_TOT_WTSS)*100,2),0) as PLN_WGE_PRCNT_TOT_WTSS from
(select lc.loc_nm,sum(wge.PLN_WAGE_WTSS) as PLN_WGE_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as PLN_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store LLANDDD' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_WTSS) as PLN_SLS_WTSS from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_WTSS,sum(e.refcst_itm_cnt) as PLN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  in (Department )
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_WTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and a.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_WTSS,sum(e.gnrt_itm) as GEN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  in (Department )
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and a.loc_no='store')
/*and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm]]> 
  </PlannedWagesPercentageSD>
  
  
  <PlannedCPHLL>
<![CDATA[select lc.loc_nm,
CASE When NVL(wge.PLN_WAGE_TOT_WTSS,0)=0 Then 0 When NVL(wge.PLN_HOURS_TOT_WTSS,0)=0 Then 0 
ELSE NVL(ROUND((wge.PLN_WAGE_TOT_WTSS / wge.PLN_HOURS_TOT_WTSS),2),0) END as PLN_CPH_TOT_WTSS from
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_no]]> 
  </PlannedCPHLL>
<PlannedCPHSD>
<![CDATA[select lc.loc_nm,
CASE When NVL(wge.PLN_WAGE_TOT_WTSS,0)=0 Then 0 When NVL(wge.PLN_HOURS_TOT_WTSS,0)=0 Then 0 
ELSE NVL(ROUND((wge.PLN_WAGE_TOT_WTSS / wge.PLN_HOURS_TOT_WTSS),2),0) END as PLN_CPH_TOT_WTSS from
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_no]]> 
  </PlannedCPHSD>  
  
  
  <ActualCPHLL>
<![CDATA[select lc.loc_nm,
CASE When NVL(wge.ACTL_WAGE_TOT_WTSS,0)=0 Then 0 When NVL(wge.ACTL_HOURS_TOT_WTSS,0)=0 Then 0 
ELSE NVL(ROUND((wge.ACTL_WAGE_TOT_WTSS / wge.ACTL_HOURS_TOT_WTSS),2),0) END as ACTL_CPH_TOT_WTSS from
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WAGE_TOT_WTSS,sum(e.actl_hrs) as ACTL_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_no]]> 
  </ActualCPHLL>
  <ActualCPHSD>
<![CDATA[select lc.loc_nm,
CASE When NVL(wge.ACTL_WAGE_TOT_WTSS,0)=0 Then 0 When NVL(wge.ACTL_HOURS_TOT_WTSS,0)=0 Then 0 
ELSE NVL(ROUND((wge.ACTL_WAGE_TOT_WTSS / wge.ACTL_HOURS_TOT_WTSS),2),0) END as ACTL_CPH_TOT_WTSS from
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WAGE_TOT_WTSS,sum(e.actl_hrs) as ACTL_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_no]]> 
  </ActualCPHSD>
  
  
  
  <VarWagesLL>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_WGE_PCT_TOT_WTSS - pln.BDGT_WGE_PCT_TOT_WTSS),2) as VAR_WGE_TOT_WTSS from 
(select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_TOT_WTSS=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
ELSE ((nume_den.ACTL_WGE_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100) END as ACTL_WGE_PCT_TOT_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS,NVL(den.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den) actl,
(select wge.loc_nm,
CASE When wge.BDGT_WGE_TOT_WTSS=0 Then 0 When sls.BDGT_SLS_TOT_WTSS=0 Then 0
ELSE NVL((wge.BDGT_WGE_TOT_WTSS / sls.BDGT_SLS_TOT_WTSS)*100,0) END as BDGT_WGE_PCT_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) pln
where pln.loc_nm=actl.loc_nm]]> 
  </VarWagesLL>
  <VarWagesSD>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_WGE_PCT_TOT_WTSS - pln.BDGT_WGE_PCT_TOT_WTSS),2) as VAR_WGE_TOT_WTSS from 
(select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_TOT_WTSS=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
ELSE ((nume_den.ACTL_WGE_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100) END as ACTL_WGE_PCT_TOT_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS,NVL(den.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den) actl,
(select wge.loc_nm,
CASE When wge.BDGT_WGE_TOT_WTSS=0 Then 0 When sls.BDGT_SLS_TOT_WTSS=0 Then 0
ELSE NVL((wge.BDGT_WGE_TOT_WTSS / sls.BDGT_SLS_TOT_WTSS)*100,0) END as BDGT_WGE_PCT_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) pln
where pln.loc_nm=actl.loc_nm]]> 
  </VarWagesSD>
  
    
  
  <VarFcstWagesLL>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_WGE_PCT_TOT_WTSS - pln.FCST_WGE_PCT_TOT_WTSS),2) as VAR_FCST_WGE_TOT_WTSS from 
(select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_TOT_WTSS=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
ELSE ((nume_den.ACTL_WGE_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100) END as ACTL_WGE_PCT_TOT_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS,NVL(den.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den) actl,
(select wge.loc_nm,
CASE When wge.FCST_WGE_TOT_WTSS=0 Then 0 When sls.FCST_SLS_TOT_WTSS=0 Then 0
ELSE NVL(((wge.FCST_WGE_TOT_WTSS / sls.FCST_SLS_TOT_WTSS)*100),0) END as FCST_WGE_PCT_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'store LLANDDD' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'store LLANDDD' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) pln
where pln.loc_nm=actl.loc_nm]]> 
  </VarFcstWagesLL>
   <VarFcstWagesSD>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_WGE_PCT_TOT_WTSS - pln.FCST_WGE_PCT_TOT_WTSS),2) as VAR_FCST_WGE_TOT_WTSS from 
(select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_TOT_WTSS=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
ELSE ((nume_den.ACTL_WGE_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100) END as ACTL_WGE_PCT_TOT_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS,NVL(den.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den) actl,
(select wge.loc_nm,
CASE When wge.FCST_WGE_TOT_WTSS=0 Then 0 When sls.FCST_SLS_TOT_WTSS=0 Then 0
ELSE NVL(((wge.FCST_WGE_TOT_WTSS / sls.FCST_SLS_TOT_WTSS)*100),0) END as FCST_WGE_PCT_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'store LLANDDD' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'store LLANDDD' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) pln
where pln.loc_nm=actl.loc_nm]]> 
  </VarFcstWagesSD>
 
  <AllowedWagesLL>
<![CDATA[select src.loc_nm,
case 
when src.ACTL_SLS_TOT_MTSS > src.BDGT_SLS_TOT_MTSS 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_MTSS * BDGT_SLS_TOT_MTSS) + ((ACTL_SLS_TOT_MTSS - BDGT_SLS_TOT_MTSS) * (PST_FACTOR_TOT_MTSS * BDGT_WGE_PCT_TOT_MTSS)))/100),0),0)
When src.ACTL_SLS_TOT_MTSS < src.BDGT_SLS_TOT_MTSS 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_MTSS * BDGT_SLS_TOT_MTSS) + ((ACTL_SLS_TOT_MTSS - BDGT_SLS_TOT_MTSS) * (NGT_FACTOR_TOT_MTSS * BDGT_WGE_PCT_TOT_MTSS)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_TOT_MTSS * ACTL_SLS_TOT_MTSS)/100),0),0) end as ALWD_WGE_TOT_MTSS from 

(select actl_sls.loc_nm,rte_fct.wk_id,actl_sls.ACTL_SLS_TOT_MTSS,rte_fct.PST_FACTOR_TOT_MTSS,rte_fct.NGT_FACTOR_TOT_MTSS,
bdgt_wge_pct.BDGT_WGE_PCT_TOT_MTSS,bdgt_wge_pct.BDGT_WGE_TOT_MTSS,bdgt_wge_pct.BDGT_SLS_TOT_MTSS from

(select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as ACTL_SLS_TOT_MTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,sum(z.wtd) as WTD from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_MTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_MTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_MTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_MTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_MTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_MTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_MTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z
group by z.loc_no order by z.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_TOT_MTSS,NVL(src.ngt_factor,1) as NGT_FACTOR_TOT_MTSS from 
(select perd_desc,wk_id from wk where wk_id  between 'WeekStart' and 'WeekStart') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id  between 'WeekStart' and 'WeekStart') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select wge.loc_nm,NVL(ROUND(wge.BDGT_WGE_TOT_MTSS,0),0) as BDGT_WGE_TOT_MTSS, NVL(ROUND(sls.BDGT_SLS_TOT_MTSS,0),0) as BDGT_SLS_TOT_MTSS,
CASE When NVL(wge.BDGT_WGE_TOT_MTSS,0)=0 and NVL(sls.BDGT_SLS_TOT_MTSS,0)=0 Then 0
When NVL(wge.BDGT_WGE_TOT_MTSS,0)=0 Then 0 When NVL(sls.BDGT_SLS_TOT_MTSS,0)=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_MTSS / sls.BDGT_SLS_TOT_MTSS)*100,5),0) END as BDGT_WGE_PCT_TOT_MTSS from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_MTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_MTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) bdgt_wge_pct

where actl_sls.loc_nm=bdgt_wge_pct.loc_nm order by actl_sls.loc_nm,rte_fct.wk_id) src
order by src.loc_nm ]]> 
  </AllowedWagesLL> 
<AllowedWagesSD>
<![CDATA[select src.loc_nm,
case 
when src.ACTL_SLS_TOT_MTSS > src.BDGT_SLS_TOT_MTSS 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_MTSS * BDGT_SLS_TOT_MTSS) + ((ACTL_SLS_TOT_MTSS - BDGT_SLS_TOT_MTSS) * (PST_FACTOR_TOT_MTSS * BDGT_WGE_PCT_TOT_MTSS)))/100),0),0)
When src.ACTL_SLS_TOT_MTSS < src.BDGT_SLS_TOT_MTSS 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_MTSS * BDGT_SLS_TOT_MTSS) + ((ACTL_SLS_TOT_MTSS - BDGT_SLS_TOT_MTSS) * (NGT_FACTOR_TOT_MTSS * BDGT_WGE_PCT_TOT_MTSS)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_TOT_MTSS * ACTL_SLS_TOT_MTSS)/100),0),0) end as ALWD_WGE_TOT_MTSS from 

(select actl_sls.loc_nm,rte_fct.wk_id,actl_sls.ACTL_SLS_TOT_MTSS,rte_fct.PST_FACTOR_TOT_MTSS,rte_fct.NGT_FACTOR_TOT_MTSS,
bdgt_wge_pct.BDGT_WGE_PCT_TOT_MTSS,bdgt_wge_pct.BDGT_WGE_TOT_MTSS,bdgt_wge_pct.BDGT_SLS_TOT_MTSS from

(select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as ACTL_SLS_TOT_MTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,sum(z.wtd) as WTD from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_MTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_MTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_MTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_MTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_MTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_MTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_MTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no  IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z
group by z.loc_no order by z.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_TOT_MTSS,NVL(src.ngt_factor,1) as NGT_FACTOR_TOT_MTSS from 
(select perd_desc,wk_id from wk where wk_id  between 'WeekStart' and 'WeekStart') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id  between 'WeekStart' and 'WeekStart') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select wge.loc_nm,NVL(ROUND(wge.BDGT_WGE_TOT_MTSS,0),0) as BDGT_WGE_TOT_MTSS, NVL(ROUND(sls.BDGT_SLS_TOT_MTSS,0),0) as BDGT_SLS_TOT_MTSS,
CASE When NVL(wge.BDGT_WGE_TOT_MTSS,0)=0 and NVL(sls.BDGT_SLS_TOT_MTSS,0)=0 Then 0
When NVL(wge.BDGT_WGE_TOT_MTSS,0)=0 Then 0 When NVL(sls.BDGT_SLS_TOT_MTSS,0)=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_MTSS / sls.BDGT_SLS_TOT_MTSS)*100,5),0) END as BDGT_WGE_PCT_TOT_MTSS from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_MTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_MTSS from 
(select loc_no,loc_nm,'Store LLANDDD' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) bdgt_wge_pct

where actl_sls.loc_nm=bdgt_wge_pct.loc_nm order by actl_sls.loc_nm,rte_fct.wk_id) src
order by src.loc_nm ]]> 
  </AllowedWagesSD>  
  </TCName>
  
</configuration>