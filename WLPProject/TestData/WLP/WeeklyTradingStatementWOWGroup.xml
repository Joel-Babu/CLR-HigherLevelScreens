<?xml version="1.0" encoding="UTF-8" ?> 
<configuration>
<TCName name = "SalesColumnValidationNewTable" >
	  <BudgetSales>
<![CDATA[select lc.fin_wk_no,NVL(bdgt.BDGT_SALES_TOT_WTSWG,0) as BDGT_SLS_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_TOT_WTSWG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (0,20,85,90) 
 /*and d.dept_no=ld.dept_no and a.loc_no=ld.loc_no*/
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.wk_id order by e.wk_id) bdgt
on lc.wk_id=bdgt.wk_id order by lc.wk_id]]> 
  </BudgetSales>
  
  <BudgetSalesTotal>
<![CDATA[select 'Total' as Tot,NVL(bdgt.BDGT_SALES_TOT_WTSWG,0) as BDGT_SLS_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_TOT_WTSWG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (0,20,85,90) 
 /*and d.dept_no=ld.dept_no and a.loc_no=ld.loc_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.perd_desc order by e.perd_desc) bdgt
on lc.perd_desc=bdgt.perd_desc order by lc.perd_desc]]> 
  </BudgetSalesTotal>
  
  <ForecastSales>
<![CDATA[select lc.fin_wk_no,NVL(bdgt.FCST_SALES_TOT_WTSWG,0) as FCST_SLS_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,ROUND(sum(e.frcst_sls),0) as FCST_SALES_TOT_WTSWG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (0,20,85,90) 
/*and d.dept_no=ld.dept_no and a.loc_no=ld.loc_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.wk_id order by e.wk_id) bdgt
on lc.wk_id=bdgt.wk_id order by lc.wk_id]]> 
  </ForecastSales>
  
  <ForecastSalesTotal>
<![CDATA[select 'Total' as Tot,NVL(bdgt.FCST_SALES_TOT_WTSWG,0) as FCST_SLS_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,ROUND(sum(e.frcst_sls),0) as FCST_SALES_TOT_WTSWG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (0,20,85,90) 
/*and d.dept_no=ld.dept_no and a.loc_no=ld.loc_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.perd_desc order by e.perd_desc) bdgt
on lc.perd_desc=bdgt.perd_desc order by lc.perd_desc]]> 
  </ForecastSalesTotal>
  
   	<MonthlyPlannedSales>
	<![CDATA[select f.fin_wk_no,NVL(e.PLAN_SALES,0) as PLN_SLS_WTSWG from 
	(select distinct wk_id,fin_wk_no from ww_wlp.wk where perd_desc='Month' order by wk_id) f
	LEFT OUTER JOIN 
    (select z.wk_id,sum(PLAN_SALES) as PLAN_SALES from 
    (select * from 
    (select b.wk_id,a.loc_no,ROUND(sum(a.mgr_wky_sls),0) as PLAN_SALES 
    from ww_wlp.mgr_wky_pln a,wk b 
	where a.div_no in ('Division') and a.loc_no in (select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
    group by b.wk_id,a.loc_no order by b.wk_id,a.loc_no) c 
    UNION 
    select * from 
    (select b.wk_id,a.loc_no,Round(sum(gnrt_sls),0) as GEN_SALES 
    from ww_wlp.fcst a,wk b
	where a.div_no in ('Division') and a.loc_no in (select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.dept_no NOT IN (0,20,85,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
  and (a.loc_no,b.wk_id) NOT IN
	(select loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no in ('Division') and loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
	group by b.wk_id,a.loc_no order by b.wk_id,a.loc_no) d) z 
    group by z.wk_id order by z.wk_id) e 
    on f.wk_id=e.wk_id order by f.wk_id]]>
	</MonthlyPlannedSales>
  
	<MonthlyPlannedSalesTotal>
	<![CDATA[select 'Total' as Tot,NVL(ROUND(e.PLAN_SALES,0),0) as PLN_SLS_TOT_WTSWG from 
	(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
    (select z.perd_desc,sum(PLAN_SALES) as PLAN_SALES from 
    (select * from 
    (select b.perd_desc,a.loc_no,ROUND(sum(a.mgr_wky_sls),0) as PLAN_SALES 
    from ww_wlp.mgr_wky_pln a,wk b 
	where a.div_no in ('Division') and a.loc_no in (select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
    group by b.perd_desc,a.loc_no order by b.perd_desc,a.loc_no) c 
    UNION 
    select * from 
    (select b.perd_desc,a.loc_no,ROUND(sum(gnrt_sls),0) as GEN_SALES 
    from ww_wlp.fcst a,wk b
	where a.div_no in ('Division') and a.loc_no in (select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.dept_no NOT IN (0,20,85,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
  and (a.loc_no,b.wk_id) NOT IN
	(select loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no in ('Division') and loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
	group by b.perd_desc,a.loc_no order by b.perd_desc,a.loc_no) d) z 
    group by z.perd_desc order by z.perd_desc) e 
    on lc.perd_desc=e.perd_desc order by lc.perd_desc]]>
	</MonthlyPlannedSalesTotal>
	
	<WeeklyPlannedSales>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(sls.PLN_SLS_WTSWG,0),0) as PLN_SLS_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select h.wk_id,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSWG from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy--, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
--and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')))*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust 
from ww_wlp.fcst a, loc b, wk c , dept d, day dy/*, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')))
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')))
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) g*/) sec_prty) h 
group by h.wk_id order by h.wk_id) sls
on lc.wk_id=sls.wk_id order by lc.wk_id]]> 
  </WeeklyPlannedSales>
  
  <WeeklyPlannedSalesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(sls.PLN_SLS_WTSWG,0),0) as PLN_SLS_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select h.perd_desc,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSWG from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy--, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
--and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')))*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust 
from ww_wlp.fcst a, loc b, wk c , dept d, day dy/*, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')))
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')))
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) g*/) sec_prty) h 
group by h.perd_desc order by h.perd_desc) sls
on lc.perd_desc=sls.perd_desc]]> 
  </WeeklyPlannedSalesTotal>
 
 
  <ActualSales>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(sls.ACTL_SLS_WTSWG,0),0) as ACTL_SLS_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select h.wk_id,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSWG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) f ) h 
group by h.wk_id order by h.wk_id) sls
on lc.wk_id=sls.wk_id order by lc.wk_id]]> 
  </ActualSales>
  
  <ActualSalesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(sls.ACTL_SLS_WTSWG,0),0) as ACTL_SLS_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select h.perd_desc,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSWG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) f ) h 
group by h.perd_desc order by h.perd_desc) sls
on lc.perd_desc=sls.perd_desc order by lc.perd_desc]]> 
  </ActualSalesTotal>
</TCName>

<TCName name = "WagesColumnValidationNewTable" >
	  <BudgetWages>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(bdgt.BDGT_WAGE_TOT_WTSWG,0),0) as BDGT_WGE_TOT_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.bdgt_wage_amt) as BDGT_WAGE_TOT_WTSWG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (20,27,28) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.wk_id order by e.wk_id) bdgt
on lc.wk_id=bdgt.wk_id order by lc.wk_id]]> 
  </BudgetWages>
  
  <BudgetWagesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(bdgt.BDGT_WAGE_TOT_WTSWG,0),0) as BDGT_WGE_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.bdgt_wage_amt) as BDGT_WAGE_TOT_WTSWG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (20,27,28) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.perd_desc order by e.perd_desc) bdgt
on lc.perd_desc=bdgt.perd_desc order by lc.perd_desc]]> 
  </BudgetWagesTotal>
  
  <ForecastWages>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(fcst.FCST_WAGE_WTSWG,0),0) as FCST_WGE_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.frcst_wage_amt) as FCST_WAGE_WTSWG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (20,27,28) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.wk_id order by e.wk_id) fcst
on lc.wk_id=fcst.wk_id order by lc.wk_id]]> 
  </ForecastWages>
  
  <ForecastWagesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(fcst.FCST_WAGE_TOT_WTSWG,0),0) as FCST_WGE_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.frcst_wage_amt) as FCST_WAGE_TOT_WTSWG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (20,27,28) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.perd_desc order by e.perd_desc) fcst
on lc.perd_desc=fcst.perd_desc order by lc.perd_desc]]> 
  </ForecastWagesTotal>
  
  	<MonthlyPlannedWages> 
	<![CDATA[select lc.fin_wk_no,NVL(e.PLN_WAGE_WTSWG,0) as PLN_WGE_WTSWG from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
	LEFT OUTER JOIN 
  (select z.wk_id,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSWG from 
  (select * from (select d.wk_id,d.div_no,ROUND(sum(d.MGR_WKY_WGE),0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id,d.div_no order by d.wk_id,d.div_no) 
  UNION 
  select * from (select d.wk_id,d.div_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id,d.div_no order by d.wk_id,d.div_no)) z
  group by z.wk_id order by z.wk_id) e 
  on e.wk_id=lc.wk_id order by lc.wk_id]]>
	</MonthlyPlannedWages>
	
  <MonthlyPlannedWagesTotal>
	<![CDATA[select lc.perd_desc,NVL(e.PLN_WAGE_WTSWG,0) as PLN_WGE_TOT_WTSWG from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSWG from 
  (select * from (select d.perd_desc,d.div_no,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.div_no order by d.perd_desc,d.div_no) 
  UNION 
  select * from (select d.perd_desc,d.div_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c/* , loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.div_no order by d.perd_desc,d.div_no)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc]]>
	</MonthlyPlannedWagesTotal>
	
	  <WeeklyPlannedWages>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(wge.PLN_WAGE_WTSWG,0),0) as PLN_WGE_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSWG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSWG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division')
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) wge
on wge.wk_id=lc.wk_id order by lc.wk_id]]> 
  </WeeklyPlannedWages>
  
    <WeeklyPlannedWagesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(wge.PLN_WAGE_WTSWG,0),0) as PLN_WGE_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSWG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSWG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division')
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) wge
on wge.perd_desc=lc.perd_desc order by lc.perd_desc]]> 
  </WeeklyPlannedWagesTotal>
  
  <ActualWages>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) hrs
on hrs.wk_id=lc.wk_id order by lc.wk_id]]> 
  </ActualWages>
  
    <ActualWagesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) hrs
on hrs.perd_desc=lc.perd_desc order by lc.perd_desc]]> 
  </ActualWagesTotal>
</TCName>

<TCName name = "WagePercentageColumnValidationNewTable" >
	<BudgetWagePercentage>
<![CDATA[select wge.fin_wk_no,
CASE When NVL(wge.BDGT_WGE_WTSWG,0)=0 and NVL(sls.BDGT_SLS_WTSWG,0)=0 Then 0
When NVL(wge.BDGT_WGE_WTSWG,0)=0 Then 0 When NVL(sls.BDGT_SLS_WTSWG,0)=0 Then 0
ELSE ROUND((wge.BDGT_WGE_WTSWG / sls.BDGT_SLS_WTSWG)*100,2) END as BDGT_WGE_PCT_WTSWG from 
(select lc.fin_wk_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no in ('Division') and a.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (20,27,28) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.wk_id=bdgt.wk_id 
group by lc.fin_wk_no order by lc.fin_wk_no) wge,
(select lc.fin_wk_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no in ('Division') and a.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (0,20,85,90) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.wk_id=bdgt.wk_id 
group by lc.fin_wk_no order by lc.fin_wk_no) sls
where wge.fin_wk_no=sls.fin_wk_no]]> 
  </BudgetWagePercentage>
  
  <BudgetWagePercentageTotal>
<![CDATA[select 'Total' as Tot,
CASE When NVL(wge.BDGT_WGE_TOT_WTSWG,0)=0 and NVL(sls.BDGT_SLS_TOT_WTSWG,0)=0 Then 0
When NVL(wge.BDGT_WGE_TOT_WTSWG,0)=0 Then 0 When NVL(sls.BDGT_SLS_TOT_WTSWG,0)=0 Then 0
ELSE ROUND((wge.BDGT_WGE_TOT_WTSWG / sls.BDGT_SLS_TOT_WTSWG)*100,2) END as BDGT_WGE_PCT_TOT_WTSWG from 
(select lc.perd_desc,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no in ('Division') and a.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (20,27,28) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.perd_desc=bdgt.perd_desc 
group by lc.perd_desc order by lc.perd_desc) wge,
(select lc.perd_desc,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no in ('Division') and a.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (0,20,85,90) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.perd_desc=bdgt.perd_desc 
group by lc.perd_desc order by lc.perd_desc) sls
where wge.perd_desc=sls.perd_desc order by wge.perd_desc]]> 
  </BudgetWagePercentageTotal>
  
    <ForecastWagePercentage>
<![CDATA[select wge.fin_wk_no,
CASE When NVL(wge.FCST_WGE_WTSWG,0)=0 and NVL(sls.FCST_SLS_WTSWG,0)=0 Then 0
When NVL(wge.FCST_WGE_WTSWG,0)=0 Then 0 When NVL(sls.FCST_SLS_WTSWG,0)=0 Then 0
ELSE ROUND((wge.FCST_WGE_WTSWG / sls.FCST_SLS_WTSWG)*100,2) END as FCST_WGE_PCT_WTSWG from 
(select lc.fin_wk_no,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no in ('Division') and a.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (20,27,28) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.wk_id=fcst.wk_id 
group by lc.fin_wk_no order by lc.fin_wk_no) wge,
(select lc.fin_wk_no,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no in ('Division') and a.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (0,20,85,90) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.wk_id=fcst.wk_id 
group by lc.fin_wk_no order by lc.fin_wk_no) sls
where wge.fin_wk_no=sls.fin_wk_no order by wge.fin_wk_no]]> 
  </ForecastWagePercentage>
  
  <ForecastWagePercentageTotal>
<![CDATA[select 'Total' as Tot,
CASE When NVL(wge.FCST_WGE_TOT_WTSWG,0)=0 and NVL(sls.FCST_SLS_TOT_WTSWG,0)=0 Then 0
When NVL(wge.FCST_WGE_TOT_WTSWG,0)=0 Then 0 When NVL(sls.FCST_SLS_TOT_WTSWG,0)=0 Then 0
ELSE ROUND((wge.FCST_WGE_TOT_WTSWG / sls.FCST_SLS_TOT_WTSWG)*100,2) END as FCST_WGE_PCT_TOT_WTSWG from 
(select lc.perd_desc,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no in ('Division') and a.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (20,27,28) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.perd_desc=fcst.perd_desc 
group by lc.perd_desc order by lc.perd_desc) wge,
(select lc.perd_desc,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no in ('Division') and a.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (0,20,85,90) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.perd_desc=fcst.perd_desc 
group by lc.perd_desc order by lc.perd_desc) sls
where wge.perd_desc=sls.perd_desc order by wge.perd_desc]]> 
  </ForecastWagePercentageTotal>
  
    <MonthlyPlannedWagePercentage>
	<![CDATA[select pln_wge.fin_wk_no,
	case when NVL(pln_wge.PLN_WGE_WTSWG,0)=0 and NVL(pln_sls.PLN_SLS_WTSWG,0)=0 then 0 
	when NVL(pln_wge.PLN_WGE_WTSWG,0)=0 then 0 when NVL(pln_sls.PLN_SLS_WTSWG,0)=0 then 0 
	else ROUND((pln_wge.PLN_WGE_WTSWG / pln_sls.PLN_SLS_WTSWG)*100,2) end as PLN_WGE_PCT_WTSWG from 
  (select lc.fin_wk_no,NVL(e.PLN_WAGE_WTSWG,0) as PLN_WGE_WTSWG from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
	LEFT OUTER JOIN 
  (select z.wk_id,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSWG from 
  (select * from (select d.wk_id,d.div_no,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id,d.div_no order by d.wk_id,d.div_no) 
  UNION 
  select * from (select d.wk_id,d.div_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id,d.div_no order by d.wk_id,d.div_no)) z
  group by z.wk_id order by z.wk_id) e 
  on e.wk_id=lc.wk_id order by lc.wk_id) pln_wge,
  (select f.fin_wk_no,NVL(e.PLAN_SALES,0) as PLN_SLS_WTSWG from 
	(select distinct wk_id,fin_wk_no from ww_wlp.wk where perd_desc='Month' order by wk_id) f
	LEFT OUTER JOIN 
    (select z.wk_id,sum(PLAN_SALES) as PLAN_SALES from 
    (select * from 
    (select b.wk_id,a.loc_no,ROUND(sum(a.mgr_wky_sls),0) as PLAN_SALES 
    from ww_wlp.mgr_wky_pln a,wk b 
	where a.div_no in ('Division') and a.loc_no in (select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
    group by b.wk_id,a.loc_no order by b.wk_id,a.loc_no) c 
    UNION 
    select * from 
    (select b.wk_id,a.loc_no,Round(sum(gnrt_sls),0) as GEN_SALES 
    from ww_wlp.fcst a,wk b
	where a.div_no in ('Division') and a.loc_no in (select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.dept_no NOT IN (0,20,85,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
  and (a.loc_no,b.wk_id) NOT IN
	(select loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no in ('Division') and loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
	group by b.wk_id,a.loc_no order by b.wk_id,a.loc_no) d) z 
    group by z.wk_id order by z.wk_id) e 
    on f.wk_id=e.wk_id order by f.wk_id) pln_sls 
  where pln_wge.fin_wk_no=pln_sls.fin_wk_no order by pln_wge.fin_wk_no]]>
	</MonthlyPlannedWagePercentage>

  <MonthlyPlannedWagePercentageTotal>
	<![CDATA[select 'Total' as Tot,
	case when NVL(pln_wge.PLN_WGE_TOT_WTSWG,0)=0 and NVL(pln_sls.PLN_SLS_TOT_WTSWG,0)=0 then 0 
	when NVL(pln_wge.PLN_WGE_TOT_WTSWG,0)=0 then 0 when NVL(pln_sls.PLN_SLS_TOT_WTSWG,0)=0 then 0 
	else ROUND((pln_wge.PLN_WGE_TOT_WTSWG / pln_sls.PLN_SLS_TOT_WTSWG)*100,2) end as PLN_WGE_PCT_TOT_WTSWG from 
  (select lc.perd_desc,NVL(e.PLN_WAGE_WTSWG,0) as PLN_WGE_TOT_WTSWG from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSWG from 
  (select * from (select d.perd_desc,d.div_no,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.div_no order by d.perd_desc,d.div_no) 
  UNION 
  select * from (select d.perd_desc,d.div_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.div_no order by d.perd_desc,d.div_no)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc) pln_wge,
	(select lc.perd_desc,NVL(ROUND(e.PLAN_SALES,0),0) as PLN_SLS_TOT_WTSWG from 
	(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
    (select z.perd_desc,sum(PLAN_SALES) as PLAN_SALES from 
    (select * from 
    (select b.perd_desc,a.loc_no,ROUND(sum(a.mgr_wky_sls),0) as PLAN_SALES 
    from ww_wlp.mgr_wky_pln a,wk b 
	where a.div_no in ('Division') and a.loc_no in (select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
    group by b.perd_desc,a.loc_no order by b.perd_desc,a.loc_no) c 
    UNION 
    select * from 
    (select b.perd_desc,a.loc_no,ROUND(sum(gnrt_sls),0) as GEN_SALES 
    from ww_wlp.fcst a,wk b
	where a.div_no in ('Division') and a.loc_no in (select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.dept_no NOT IN (0,20,85,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
  and (a.loc_no,b.wk_id) NOT IN
	(select loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no in ('Division') and loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
	group by b.perd_desc,a.loc_no order by b.perd_desc,a.loc_no) d) z 
    group by z.perd_desc order by z.perd_desc) e 
    on lc.perd_desc=e.perd_desc order by lc.perd_desc) pln_sls 
  where pln_wge.perd_desc=pln_sls.perd_desc order by pln_wge.perd_desc]]>
	</MonthlyPlannedWagePercentageTotal>
	
	  <WeeklyPlannedWagePercentage>
<![CDATA[select wge.fin_wk_no,
case when NVL(wge.PLN_WGE_WTSWG,0)=0 and NVL(sls.PLN_SLS_WTSWG,0)=0 then 0 
when NVL(wge.PLN_WGE_WTSWG,0)=0 then 0 when NVL(sls.PLN_SLS_WTSWG,0)=0 then 0 
else ROUND((wge.PLN_WGE_WTSWG / sls.PLN_SLS_WTSWG)*100,2) end as PLN_WGE_PRCNT_WTSWG from
(select lc.fin_wk_no,NVL(wge.PLN_WAGE_WTSWG,0) as PLN_WGE_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSWG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSWG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division')
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) wge
on wge.wk_id=lc.wk_id order by lc.wk_id) wge,
(select lc.fin_wk_no,NVL(sls.PLN_SLS_WTSWG,0) as PLN_SLS_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select h.wk_id,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSWG from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy--, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
--and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')))*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust 
from ww_wlp.fcst a, loc b, wk c , dept d, day dy/*, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')))
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')))
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) g*/) sec_prty) h 
group by h.wk_id order by h.wk_id) sls
on lc.wk_id=sls.wk_id) sls
where wge.fin_wk_no=sls.fin_wk_no]]> 
  </WeeklyPlannedWagePercentage>
  
  <WeeklyPlannedWagePercentageTotal>
<![CDATA[select 'Total' as Tot,
case when NVL(wge.PLN_WGE_TOT_WTSWG,0)=0 and NVL(sls.PLN_SLS_TOT_WTSWG,0)=0 then 0 
when NVL(wge.PLN_WGE_TOT_WTSWG,0)=0 then 0 when NVL(sls.PLN_SLS_TOT_WTSWG,0)=0 then 0 
else ROUND((wge.PLN_WGE_TOT_WTSWG / sls.PLN_SLS_TOT_WTSWG)*100,2) end as PLN_WGE_PRCNT_TOT_WTSWG from
(select lc.perd_desc,NVL(wge.PLN_WAGE_WTSWG,0) as PLN_WGE_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSWG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSWG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division')
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) wge
on wge.perd_desc=lc.perd_desc order by lc.perd_desc) wge,
(select lc.perd_desc,NVL(sls.PLN_SLS_WTSWG,0) as PLN_SLS_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select h.perd_desc,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSWG from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy--, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
--and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')))*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust 
from ww_wlp.fcst a, loc b, wk c , dept d, day dy/*, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')))
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')))
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) g*/) sec_prty) h 
group by h.perd_desc order by h.perd_desc) sls
on lc.perd_desc=sls.perd_desc) sls
where wge.perd_desc=sls.perd_desc]]> 
  </WeeklyPlannedWagePercentageTotal>
  
    <ActualWagePercentage>
<![CDATA[select wge.fin_wk_no,
case when NVL(wge.ACTL_WGE_WTSWG,0)=0 and NVL(sls.ACTL_SLS_WTSWG,0)=0 then 0 
when NVL(wge.ACTL_WGE_WTSWG,0)=0 then 0 when NVL(sls.ACTL_SLS_WTSWG,0)=0 then 0 
else ROUND((wge.ACTL_WGE_WTSWG / sls.ACTL_SLS_WTSWG)*100,2) end as ACTL_WGE_PRCNT_WTSWG from
(select lc.fin_wk_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) hrs
on hrs.wk_id=lc.wk_id order by lc.wk_id) wge,
(select lc.fin_wk_no,NVL(sls.ACTL_SLS_WTSWG,0) as ACTL_SLS_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select h.wk_id,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSWG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) f ) h 
group by h.wk_id order by h.wk_id) sls
on lc.wk_id=sls.wk_id order by lc.wk_id) sls
where wge.fin_wk_no=sls.fin_wk_no]]> 
  </ActualWagePercentage>
  
  <ActualWagePercentageTotal>
<![CDATA[select 'Total' as Tot,
case when NVL(wge.ACTL_WGE_TOT_WTSWG,0)=0 and NVL(sls.ACTL_SLS_TOT_WTSWG,0)=0 then 0 
when NVL(wge.ACTL_WGE_TOT_WTSWG,0)=0 then 0 when NVL(sls.ACTL_SLS_TOT_WTSWG,0)=0 then 0 
else ROUND((wge.ACTL_WGE_TOT_WTSWG / sls.ACTL_SLS_TOT_WTSWG)*100,2) end as ACTL_WGE_PRCNT_TOT_WTSWG from
(select lc.perd_desc,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) hrs
on hrs.perd_desc=lc.perd_desc order by lc.perd_desc) wge,
(select lc.perd_desc,NVL(sls.ACTL_SLS_WTSWG,0) as ACTL_SLS_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select h.perd_desc,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSWG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) f ) h 
group by h.perd_desc order by h.perd_desc) sls
on lc.perd_desc=sls.perd_desc order by lc.perd_desc) sls
where wge.perd_desc=sls.perd_desc]]> 
  </ActualWagePercentageTotal>
</TCName>

<TCName name = "ORColumnValidationNewTable" >
	<MonthlyPlannedOR>
	<![CDATA[select sms_hrs.fin_wk_no,
	case when NVL(sms_hrs.SMS_HRS_WTSWG,0)=0 and NVL(pln_hrs.PLN_HRS_WTSWG,0)=0 then 0 
	when NVL(sms_hrs.SMS_HRS_WTSWG,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_WTSWG,0)=0 then 0 
	else ROUND((sms_hrs.SMS_HRS_WTSWG / pln_hrs.PLN_HRS_WTSWG)*100,1) end as PLN_OR_WTSWG from 
	(select lc.fin_wk_no,NVL(y.SMS_HOURS_WTSWG,0) as SMS_HRS_WTSWG from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
  LEFT OUTER JOIN
	(select C.wk_id,sum(C.SMS_HOURS_WTSWG) as SMS_HOURS_WTSWG from 
  (select a.wk_id,a.div_no,NVL(ROUND(((ROUND((((sum(fix_hrs) + Sum(vol_hrs))*100)/25),0)*25)/100),2),0) as SMS_HOURS_WTSWG from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,
	a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
  from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d /*,loc_dept ld */
	where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no and d.dept_no NOT IN (20,27,28) 
  and b.perd_desc in ('Month') and c.div_no in ('Division') and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division'))
  /*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no*/ ) A
	group by a.wk_id,a.div_no order by a.wk_id,a.div_no) C 
  group by C.wk_id order by c.wk_id) y
	on lc.wk_id=y.wk_id order by lc.wk_id)sms_hrs,
	(select lc.fin_wk_no,NVL(e.PLN_HOURS_WTSWG,0) as PLN_HRS_WTSWG from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
	LEFT OUTER JOIN 
  (select z.wk_id,sum(PLN_HOURS_WTSWG) as PLN_HOURS_WTSWG from 
  (select * from (select d.wk_id,d.div_no,ROUND(sum(d.MGR_WKY_HRS),0) as PLN_HOURS_WTSWG from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id,d.div_no order by d.wk_id,d.div_no) 
  UNION 
  select * from (select d.wk_id,d.div_no,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_WTSWG from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id,d.div_no order by d.wk_id,d.div_no)) z
  group by z.wk_id order by z.wk_id) e 
  on e.wk_id=lc.wk_id order by lc.wk_id) pln_hrs 
	where sms_hrs.fin_wk_no=pln_hrs.fin_wk_no order by sms_hrs.fin_wk_no]]>
	</MonthlyPlannedOR>
  
  <MonthlyPlannedORTotal>
	<![CDATA[select 'Total' as Tot,
	case when NVL(sms_hrs.SMS_HRS_TOT_WTSWG,0)=0 and NVL(pln_hrs.PLN_HRS_TOT_WTSWG,0)=0 then 0 
	when NVL(sms_hrs.SMS_HRS_TOT_WTSWG,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_TOT_WTSWG,0)=0 then 0 
	else ROUND((sms_hrs.SMS_HRS_TOT_WTSWG / pln_hrs.PLN_HRS_TOT_WTSWG)*100,1) end as PLN_OR_TOT_WTSWG from 
	(select lc.perd_desc,NVL(y.SMS_HOURS_TOT_WTSWG,0) as SMS_HRS_TOT_WTSWG from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
  LEFT OUTER JOIN
	(select C.perd_desc,sum(C.SMS_HOURS_WTSWG) as SMS_HOURS_TOT_WTSWG from 
  (select a.perd_desc,a.div_no,NVL(ROUND(((ROUND((((sum(fix_hrs) + Sum(vol_hrs))*100)/25),0)*25)/100),2),0) as SMS_HOURS_WTSWG from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,
	a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
  from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d /*,loc_dept ld */
	where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no and d.dept_no NOT IN (20,27,28) 
  and b.perd_desc in ('Month') and c.div_no in ('Division') and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division'))
  /*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no*/ ) A
	group by a.perd_desc,a.div_no order by a.perd_desc,a.div_no) C 
  group by C.perd_desc order by c.perd_desc) y
	on lc.perd_desc=y.perd_desc order by lc.perd_desc)sms_hrs,
	(select lc.perd_desc,NVL(e.PLN_HOURS_WTSWG,0) as PLN_HRS_TOT_WTSWG from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_HOURS_WTSWG) as PLN_HOURS_WTSWG from 
  (select * from (select d.perd_desc,d.div_no,ROUND(sum(d.MGR_WKY_HRS),0) as PLN_HOURS_WTSWG from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.div_no order by d.perd_desc,d.div_no) 
  UNION 
  select * from (select d.perd_desc,d.div_no,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_WTSWG from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.div_no order by d.perd_desc,d.div_no)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc) pln_hrs 
	where sms_hrs.perd_desc=pln_hrs.perd_desc order by sms_hrs.perd_desc]]>
	</MonthlyPlannedORTotal>
	
	<WeeklyPlannedOR>
	<![CDATA[select sms_hrs.fin_wk_no,
	CASE When NVL(sms_hrs.SMS_HRS_WTSWG,0)=0 and NVL(pln_hrs.PLN_HRS_WTSWG,0)=0 Then 0 
	When NVL(sms_hrs.SMS_HRS_WTSWG,0)=0 Then 0 When NVL(pln_hrs.PLN_HRS_WTSWG,0)=0 Then 0 
	ELSE ROUND((sms_hrs.SMS_HRS_WTSWG / pln_hrs.PLN_HRS_WTSWG)*100,1) END as PLN_OR_WTSWG from 
(select lc.fin_wk_no,NVL(sum(SMS_HOURS_MPS),0) as SMS_HRS_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc 
LEFT OUTER JOIN
(select c.wk_id,C.div_no,NVL(ROUND(((ROUND((((sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT))*100)/25),0)*25)/100),2),0) as SMS_HOURS_MPS from 
(select A.div_no,A.rgn_no,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
from ww_wlp.lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d /*, loc_dept ld */
where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
and d.dept_no NOT IN (20,27,28) and b.perd_desc='Month' and c.div_no in ('Division') and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division'))
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no*/) A 
group by A.div_no,A.rgn_no,A.wk_id,A.dept_no order by A.div_no,A.rgn_no,A.wk_id,A.dept_no) C 
group by c.wk_id,C.div_no order by c.wk_id,c.div_no) y
on lc.wk_id=y.wk_id group by lc.fin_wk_no order by lc.fin_wk_no) sms_hrs, 
(select lc.fin_wk_no,NVL(sum(e.PLN_HOURS_WPS),0) as PLN_HRS_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select z.wk_id,z.div_no,NVL(ROUND(sum(PLN_HOURS_WPS),0),0) as PLN_HOURS_WPS from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm,
(sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))) as PLN_WAGE_WPS,
(sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d /*,loc_dept ld */
where a.wk_id=b.wk_id and b.perd_desc='Month' 
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no in ('Division') and a.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division'))
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (20,27,28)
/*and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no*/
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,b.perd_desc,b.wk_id,d.dply_seq) z
group by z.wk_id,z.div_no order by z.wk_id,z.div_no) e
on e.wk_id=lc.wk_id group by lc.fin_wk_no order by lc.fin_wk_no) pln_hrs 
where sms_hrs.fin_wk_no=pln_hrs.fin_wk_no]]>
	</WeeklyPlannedOR>
  
    <WeeklyPlannedORTotal>
	<![CDATA[select 'Total' as Tot,
	CASE When NVL(sms_hrs.SMS_HRS_TOT_WTSWG,0)=0 and NVL(pln_hrs.PLN_HRS_TOT_WTSWG,0)=0 Then 0 
	When NVL(sms_hrs.SMS_HRS_TOT_WTSWG,0)=0 Then 0 When NVL(pln_hrs.PLN_HRS_TOT_WTSWG,0)=0 Then 0 
	ELSE ROUND((sms_hrs.SMS_HRS_TOT_WTSWG / pln_hrs.PLN_HRS_TOT_WTSWG)*100,1) END as PLN_OR_TOT_WTSWG from 
(select lc.perd_desc,NVL(sum(y.SMS_HOURS_WTSWG),0) as SMS_HRS_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select c.perd_desc,c.wk_id,C.div_no,NVL(ROUND(((ROUND((((sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT))*100)/25),0)*25)/100),2),0) as SMS_HOURS_WTSWG from 
(select A.div_no,A.perd_desc,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
from ww_wlp.lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d /*, loc_dept ld */
where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
and d.dept_no NOT IN (20,27,28) and b.perd_desc='Month' and c.div_no in ('Division') and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division'))
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no*/) A 
group by A.div_no,A.perd_desc,A.wk_id,A.dept_no order by A.div_no,A.perd_desc,A.wk_id,A.dept_no) C 
group by c.perd_desc,c.wk_id,C.div_no order by c.perd_desc,c.wk_id,C.div_no) y
on lc.perd_desc=y.perd_desc group by lc.perd_desc order by lc.perd_desc) sms_hrs, 
(select lc.perd_desc,NVL(sum(e.PLN_HOURS_WTSWG),0) as PLN_HRS_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select z.perd_desc,z.wk_id,z.div_no,NVL(ROUND(sum(PLN_HOURS_WPS),0),0) as PLN_HOURS_WTSWG from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm,
(sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))) as PLN_WAGE_WPS,
(sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d /*,loc_dept ld */
where a.wk_id=b.wk_id and b.perd_desc='Month' 
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no in ('Division') and a.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division'))
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (20,27,28)
/*and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no*/
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,b.perd_desc,b.wk_id,d.dply_seq) z
group by z.perd_desc,z.wk_id,z.div_no order by z.perd_desc,z.wk_id,z.div_no) e
on e.perd_desc=lc.perd_desc group by lc.perd_desc order by lc.perd_desc) pln_hrs 
where sms_hrs.perd_desc=pln_hrs.perd_desc]]>
	</WeeklyPlannedORTotal>
	
	<ActualOR>
	<![CDATA[select actl_sms.fin_wk_no,
	case when NVL(actl_sms.ACTL_SMS_WTSWG,0)=0 and NVL(actl_hrs.ACTL_HRS_WTSWG,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_WTSWG,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_WTSWG,0)=0 then 0 
	else NVL(ROUND((actl_sms.ACTL_SMS_WTSWG / actl_hrs.ACTL_HRS_WTSWG)*100,1),0) end as ACTL_OR_WTSWG from
(select lc.fin_wk_no,NVL(xy.WK_TO_DT_TOT,0) as ACTL_SMS_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select  wk_id,Sum(ACTL_SMS_DTSG) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as ACTL_SMS_DTSG
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no in ('Division') 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no in ('Division')
where w.perd_desc='Month' and A.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by wk_id) xy
on lc.wk_id=xy.wk_id order by lc.wk_id)actl_sms,
(select lc.fin_wk_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
/*and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) hrs
on hrs.wk_id=lc.wk_id order by lc.wk_id)actl_hrs
where actl_sms.fin_wk_no=actl_hrs.fin_wk_no order by actl_sms.fin_wk_no]]> 
</ActualOR>

<ActualORTotal>
	<![CDATA[select 'Total' as Tot,
	case when NVL(actl_sms.ACTL_SMS_TOT_WTSWG,0)=0 and NVL(actl_hrs.ACTL_HRS_TOT_WTSWG,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_TOT_WTSWG,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_TOT_WTSWG,0)=0 then 0 
	else NVL(ROUND((actl_sms.ACTL_SMS_TOT_WTSWG / actl_hrs.ACTL_HRS_TOT_WTSWG)*100,1),0) end as ACTL_OR_TOT_WTSWG from
(select lc.perd_desc,NVL(xy.WK_TO_DT_TOT,2) as ACTL_SMS_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select perd_desc,Sum(ACTL_SMS_DTSG) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as ACTL_SMS_DTSG
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.perd_desc,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.perd_desc,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,W.perd_desc,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no in ('Division') 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no in ('Division')
where w.perd_desc='Month' and A.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division'))
and A.day_of_wk in (0,1,2,3,4,5,6)
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.perd_desc,LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by perd_desc) xy
on lc.perd_desc=xy.perd_desc order by lc.perd_desc)actl_sms,
(select lc.perd_desc,NVL(hrs.ACTL_HRS_DTS,2) as ACTL_HRS_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
/*and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) hrs
on hrs.perd_desc=lc.perd_desc order by lc.perd_desc)actl_hrs
where actl_sms.perd_desc=actl_hrs.perd_desc order by actl_sms.perd_desc]]> 
</ActualORTotal>
</TCName>

<TCName name = "CPHColumnValidationNewTable" >
	<MonthlyPlannedCPH>
	<![CDATA[[select pln_wge.fin_wk_no,
	case when NVL(pln_wge.PLN_WGE_WTSWG,0)=0 and NVL(pln_hrs.PLN_HRS_WTSWG,0)=0 then 0 
	when NVL(pln_wge.PLN_WGE_WTSWG,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_WTSWG,0)=0 then 0 
	else ROUND((pln_wge.PLN_WGE_WTSWG / pln_hrs.PLN_HRS_WTSWG),2) end as PLN_CPH_WTSWG from 
  (select lc.fin_wk_no,NVL(e.PLN_WAGE_WTSWG,0) as PLN_WGE_WTSWG from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
	LEFT OUTER JOIN 
  (select z.wk_id,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSWG from 
  (select * from (select d.wk_id,d.div_no,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id,d.div_no order by d.wk_id,d.div_no) 
  UNION 
  select * from (select d.wk_id,d.div_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id,d.div_no order by d.wk_id,d.div_no)) z
  group by z.wk_id order by z.wk_id) e 
  on e.wk_id=lc.wk_id order by lc.wk_id) pln_wge,
  (select lc.fin_wk_no,NVL(e.PLN_HOURS_WTSWG,0) as PLN_HRS_WTSWG from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
	LEFT OUTER JOIN 
  (select z.wk_id,sum(PLN_HOURS_WTSWG) as PLN_HOURS_WTSWG from 
  (select * from (select d.wk_id,d.div_no,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_WTSWG from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id,d.div_no order by d.wk_id,d.div_no) 
  UNION 
  select * from (select d.wk_id,d.div_no,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_WTSWG from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id,d.div_no order by d.wk_id,d.div_no)) z
  group by z.wk_id order by z.wk_id) e 
  on e.wk_id=lc.wk_id order by lc.wk_id) pln_hrs 
  where pln_wge.fin_wk_no=pln_hrs.fin_wk_no order by pln_wge.fin_wk_no]]>
	</MonthlyPlannedCPH>
  
	<MonthlyPlannedCPHTotal>
	<![CDATA[select 'Total' as Tot,
	case when NVL(pln_wge.PLN_WGE_TOT_WTSWG,0)=0 and NVL(pln_hrs.PLN_HRS_TOT_WTSWG,0)=0 then 0 
	when NVL(pln_wge.PLN_WGE_TOT_WTSWG,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_TOT_WTSWG,0)=0 then 0 
	else ROUND((pln_wge.PLN_WGE_TOT_WTSWG / pln_hrs.PLN_HRS_TOT_WTSWG),2) end as PLN_CPH_TOT_WTSWG from 
  (select lc.perd_desc,NVL(e.PLN_WAGE_WTSWG,0) as PLN_WGE_TOT_WTSWG from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSWG from 
  (select * from (select d.perd_desc,d.div_no,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.div_no order by d.perd_desc,d.div_no) 
  UNION 
  select * from (select d.perd_desc,d.div_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.div_no order by d.perd_desc,d.div_no)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc) pln_wge,
  (select lc.perd_desc,NVL(e.PLN_HOURS_WTSWG,0) as PLN_HRS_TOT_WTSWG from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_HOURS_WTSWG) as PLN_HOURS_WTSWG from 
  (select * from (select d.perd_desc,d.div_no,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_WTSWG from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.div_no order by d.perd_desc,d.div_no) 
  UNION 
  select * from (select d.perd_desc,d.div_no,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_WTSWG from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.div_no order by d.perd_desc,d.div_no)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc) pln_hrs 
  where pln_wge.perd_desc=pln_hrs.perd_desc order by pln_wge.perd_desc]]>
	</MonthlyPlannedCPHTotal>
	
	  <WeeklyPlannedCPH>
<![CDATA[select wge_hrs.fin_wk_no,
CASE When NVL(wge_hrs.PLN_WGE_WTSWG,0)=0 and NVL(wge_hrs.PLN_HRS_WTSWG,0)=0 Then 0 
When NVL(wge_hrs.PLN_WGE_WTSWG,0)=0 Then 0 When NVL(wge_hrs.PLN_HRS_WTSWG,0)=0 Then 0 
ELSE ROUND((wge_hrs.PLN_WGE_WTSWG / wge_hrs.PLN_HRS_WTSWG),2) END as PLN_CPH_WTSWG from
(select lc.fin_wk_no,NVL(sum(e.PLN_WAGE_WPS),0) as PLN_WGE_WTSWG,NVL(sum(e.PLN_HOURS_WPS),0) as PLN_HRS_WTSWG from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select z.wk_id,z.div_no,NVL(ROUND(sum(PLN_WAGE_WPS),9),0) as PLN_WAGE_WPS,NVL(ROUND(sum(PLN_HOURS_WPS),9),0) as PLN_HOURS_WPS from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm,
(sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))) as PLN_WAGE_WPS,
(sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d/*,loc_dept ld */
where a.wk_id=b.wk_id and b.perd_desc='Month' 
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no in ('Division') and a.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division'))
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (20,27,28)
/*and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no*/
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,b.perd_desc,b.wk_id,d.dply_seq) z
group by z.wk_id,z.div_no order by z.wk_id,z.div_no) e
on e.wk_id=lc.wk_id group by lc.fin_wk_no order by lc.fin_wk_no) wge_hrs
order by wge_hrs.fin_wk_no]]> 
  </WeeklyPlannedCPH>
  
  <WeeklyPlannedCPHTotal>
<![CDATA[select 'Total' as Tot,
CASE When NVL(wge_hrs.PLN_WGE_TOT_WTSWG,0)=0 and NVL(wge_hrs.PLN_HRS_TOT_WTSWG,0)=0 Then 0 
When NVL(wge_hrs.PLN_WGE_TOT_WTSWG,0)=0 Then 0 When NVL(wge_hrs.PLN_HRS_TOT_WTSWG,0)=0 Then 0 
ELSE ROUND((wge_hrs.PLN_WGE_TOT_WTSWG / wge_hrs.PLN_HRS_TOT_WTSWG),2) END as PLN_CPH_TOT_WTSWG from
(select lc.perd_desc,NVL(sum(e.PLN_WAGE_WPS),0) as PLN_WGE_TOT_WTSWG,NVL(sum(e.PLN_HOURS_WPS),0) as PLN_HRS_TOT_WTSWG from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select z.perd_desc,z.wk_id,z.div_no,NVL(ROUND(sum(PLN_WAGE_WPS),9),0) as PLN_WAGE_WPS,NVL(ROUND(sum(PLN_HOURS_WPS),9),0) as PLN_HOURS_WPS from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm,
(sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))) as PLN_WAGE_WPS,
(sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d/*,loc_dept ld */
where a.wk_id=b.wk_id and b.perd_desc='Month' 
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no in ('Division') and a.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division'))
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no in ('Division') and a.dept_no NOT IN (20,27,28)
/*and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no*/
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,b.perd_desc,b.wk_id,d.dply_seq) z
group by z.perd_desc,z.wk_id,z.div_no order by z.perd_desc,z.wk_id,z.div_no) e
on e.perd_desc=lc.perd_desc group by lc.perd_desc order by lc.perd_desc) wge_hrs
order by wge_hrs.perd_desc]]> 
  </WeeklyPlannedCPHTotal>
  
  <ActualCPH>
<![CDATA[select lc.fin_wk_no,
CASE When NVL(wge_hrs.ACTL_WGE_WTSWG,0)=0 and NVL(wge_hrs.ACTL_HRS_WTSWG,0)=0 Then 0 
When NVL(wge_hrs.ACTL_WGE_WTSWG,0)=0 Then 0 When NVL(wge_hrs.ACTL_HRS_WTSWG,0)=0 Then 0 
ELSE ROUND((wge_hrs.ACTL_WGE_WTSWG / wge_hrs.ACTL_HRS_WTSWG),2) END as ACTL_CPH_WTSWG from
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.actl_wage_amt) as ACTL_WGE_WTSWG,sum(e.actl_hrs) as ACTL_HRS_WTSWG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c, dept d/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
/*and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) wge_hrs
on wge_hrs.wk_id=lc.wk_id order by lc.wk_id]]> 
  </ActualCPH>
  
  <ActualCPHTotal>
<![CDATA[select 'Total' as Tot,
CASE When NVL(wge_hrs.ACTL_WGE_TOT_WTSWG,0)=0 and NVL(wge_hrs.ACTL_HRS_TOT_WTSWG,0)=0 Then 0 
When NVL(wge_hrs.ACTL_WGE_TOT_WTSWG,0)=0 Then 0 When NVL(wge_hrs.ACTL_HRS_TOT_WTSWG,0)=0 Then 0 
ELSE ROUND((wge_hrs.ACTL_WGE_TOT_WTSWG / wge_hrs.ACTL_HRS_TOT_WTSWG),2) END as ACTL_CPH_TOT_WTSWG from
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.actl_wage_amt) as ACTL_WGE_TOT_WTSWG,sum(e.actl_hrs) as ACTL_HRS_TOT_WTSWG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c, dept d/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no in ('Division') and b.loc_no in 
(select b.loc_no from loc b where b.div_no in ('Division')) and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no in ('Division') 
/*and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) wge_hrs 
on wge_hrs.perd_desc=lc.perd_desc order by lc.perd_desc]]> 
  </ActualCPHTotal>
</TCName>

</configuration>