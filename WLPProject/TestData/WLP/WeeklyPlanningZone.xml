<?xml version="1.0" encoding="UTF-8"?>

<configuration>

<TCName name = "SalesHistoryFirstWeek" >
	<SalesHistory>
	<![CDATA[select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no]]>
	</SalesHistory>
	<SalesHistoryTotal>
	<![CDATA[select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no]]>
	</SalesHistoryTotal>
</TCName>

<TCName name = "SalesHistorySecondWeek" >
		<SalesHistory>
	<![CDATA[select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no]]>
	</SalesHistory>
	<SalesHistoryTotal>
	<![CDATA[select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no]]>
	</SalesHistoryTotal>
</TCName>

<TCName name = "SalesHistoryThirdWeek" >
		<SalesHistory>
	<![CDATA[select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no]]>
	</SalesHistory>
	<SalesHistoryTotal>
	<![CDATA[select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no]]>
	</SalesHistoryTotal>
</TCName>

<TCName name = "SalesHistoryFourthWeek" >
		<SalesHistory>
	<![CDATA[select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no]]>
	</SalesHistory>
	<SalesHistoryTotal>
	<![CDATA[select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no]]>
	</SalesHistoryTotal>
</TCName>

<TCName name = "WagesHistoryFirstWeek" >
	<WagesHistory>
	<![CDATA[select V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear' ) 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no]]>
	</WagesHistory>
	<WagesHistoryTotal>
	<![CDATA[select x.zone_no,ROUND(sum(x.ACTL_WAGE_MPZ),0) as ACTL_WAGE_TOT_MPZ from 
(select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V
group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
group by x.zone_no order by x.zone_no]]>
	</WagesHistoryTotal>
</TCName>

<TCName name = "WagesHistorySecondWeek" >
	<WagesHistory>
	<![CDATA[select V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear' ) 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no]]>
	</WagesHistory>
	<WagesHistoryTotal>
	<![CDATA[select x.zone_no,ROUND(sum(x.ACTL_WAGE_MPZ),0) as ACTL_WAGE_TOT_MPZ from 
(select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V
group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
group by x.zone_no order by x.zone_no]]>
	</WagesHistoryTotal>
</TCName>

<TCName name = "WagesHistoryThirdWeek" >
	<WagesHistory>
	<![CDATA[select V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear' ) 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no]]>
	</WagesHistory>
	<WagesHistoryTotal>
	<![CDATA[select x.zone_no,ROUND(sum(x.ACTL_WAGE_MPZ),0) as ACTL_WAGE_TOT_MPZ from 
(select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V
group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
group by x.zone_no order by x.zone_no]]>
	</WagesHistoryTotal>
</TCName>

<TCName name = "WagesHistoryFourthWeek" >
	<WagesHistory>
	<![CDATA[select V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear' ) 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no]]>
	</WagesHistory>
	<WagesHistoryTotal>
	<![CDATA[select x.zone_no,ROUND(sum(x.ACTL_WAGE_MPZ),0) as ACTL_WAGE_TOT_MPZ from 
(select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V
group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
group by x.zone_no order by x.zone_no]]>
	</WagesHistoryTotal>
</TCName>

<TCName name = "ItemsHistoryFirsthWeek" >
	<ItemsHistory>
	<![CDATA[select J.ar_no,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_ITEM) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_itm_cnt) as ACTL_ITEM from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no]]>
	</ItemsHistory>
	<ItemsHistoryTotal>
	<![CDATA[select K.zone_no,ROUND(sum(K.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_ITEM) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_itm_cnt) as ACTL_ITEM from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no]]>
	</ItemsHistoryTotal>
</TCName>

<TCName name = "ItemsHistorySecondWeek" >
	<ItemsHistory>
	<![CDATA[select J.ar_no,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_ITEM) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_itm_cnt) as ACTL_ITEM from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no]]>
	</ItemsHistory>
	<ItemsHistoryTotal>
	<![CDATA[select K.zone_no,ROUND(sum(K.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_ITEM) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_itm_cnt) as ACTL_ITEM from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no]]>
	</ItemsHistoryTotal>
</TCName>

<TCName name = "ItemsHistoryThirdWeek" >
	<ItemsHistory>
	<![CDATA[select J.ar_no,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_ITEM) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_itm_cnt) as ACTL_ITEM from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no]]>
	</ItemsHistory>
	<ItemsHistoryTotal>
	<![CDATA[select K.zone_no,ROUND(sum(K.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_ITEM) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_itm_cnt) as ACTL_ITEM from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no]]>
	</ItemsHistoryTotal>
</TCName>

<TCName name = "ItemsHistoryFourthWeek" >
	<ItemsHistory>
	<![CDATA[select J.ar_no,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_ITEM) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_itm_cnt) as ACTL_ITEM from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no]]>
	</ItemsHistory>
	<ItemsHistoryTotal>
	<![CDATA[select K.zone_no,ROUND(sum(K.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_ITEM) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_itm_cnt) as ACTL_ITEM from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no]]>
	</ItemsHistoryTotal>
</TCName>

<TCName name = "CustomersHistoryFirsthWeek" >
	<CustomerHistory>
	<![CDATA[select J.ar_no,ROUND(sum(J.ACTL_CUST_MPG),0) as ACTL_CUST_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_CUSTS,0) as ACTL_CUST_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_CUSTS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_CUST) as ACTL_CUSTS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_cust_cnt) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no IN (90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no]]>
	</CustomerHistory>
	<CustomerHistoryTotal>
	<![CDATA[select K.zone_no,ROUND(sum(K.ACTL_CUST_MPZ),0) as ACTL_CUST_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_CUST_MPG),0) as ACTL_CUST_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_CUSTS,0) as ACTL_CUST_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_CUSTS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_CUST) as ACTL_CUSTS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_cust_cnt) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no IN (90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no ]]>
	</CustomerHistoryTotal>
</TCName>

<TCName name = "CustomersHistorySecondWeek" >
	<CustomerHistory>
	<![CDATA[select J.ar_no,ROUND(sum(J.ACTL_CUST_MPG),0) as ACTL_CUST_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_CUSTS,0) as ACTL_CUST_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_CUSTS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_CUST) as ACTL_CUSTS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_cust_cnt) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no IN (90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no]]>
	</CustomerHistory>
	<CustomerHistoryTotal>
	<![CDATA[select K.zone_no,ROUND(sum(K.ACTL_CUST_MPZ),0) as ACTL_CUST_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_CUST_MPG),0) as ACTL_CUST_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_CUSTS,0) as ACTL_CUST_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_CUSTS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_CUST) as ACTL_CUSTS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_cust_cnt) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no IN (90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no ]]>
	</CustomerHistoryTotal>
</TCName>

<TCName name = "CustomersHistoryThirdWeek" >
	<CustomerHistory>
	<![CDATA[select J.ar_no,ROUND(sum(J.ACTL_CUST_MPG),0) as ACTL_CUST_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_CUSTS,0) as ACTL_CUST_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_CUSTS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_CUST) as ACTL_CUSTS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_cust_cnt) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no IN (90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no]]>
	</CustomerHistory>
	<CustomerHistoryTotal>
	<![CDATA[select K.zone_no,ROUND(sum(K.ACTL_CUST_MPZ),0) as ACTL_CUST_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_CUST_MPG),0) as ACTL_CUST_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_CUSTS,0) as ACTL_CUST_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_CUSTS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_CUST) as ACTL_CUSTS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_cust_cnt) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no IN (90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no ]]>
	</CustomerHistoryTotal>
</TCName>

<TCName name = "CustomersHistoryFourthWeek" >
	<CustomerHistory>
	<![CDATA[select J.ar_no,ROUND(sum(J.ACTL_CUST_MPG),0) as ACTL_CUST_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_CUSTS,0) as ACTL_CUST_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_CUSTS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_CUST) as ACTL_CUSTS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_cust_cnt) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no IN (90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no]]>
	</CustomerHistory>
	<CustomerHistoryTotal>
	<![CDATA[select K.zone_no,ROUND(sum(K.ACTL_CUST_MPZ),0) as ACTL_CUST_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_CUST_MPG),0) as ACTL_CUST_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_CUSTS,0) as ACTL_CUST_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_CUSTS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_CUST) as ACTL_CUSTS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_cust_cnt) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no IN (90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no ]]>
	</CustomerHistoryTotal>
</TCName>

<TCName name = "PaidHoursHistoryFirsthWeek" >
	<PaidHoursHistory>
	<![CDATA[select V.ar_no,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no]]>
	</PaidHoursHistory>
	<PaidHoursHistoryTotal>
	<![CDATA[select x.zone_no,sum(x.ACTL_HRS_MPZ) as ACTL_HRS_TOT_MPZ from 
(select V.zone_no,V.ar_no,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V
group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x 
group by x.zone_no order by x.zone_no]]>
	</PaidHoursHistoryTotal>
</TCName>

<TCName name = "PaidHoursHistorySecondWeek" >
	<PaidHoursHistory>
	<![CDATA[select V.ar_no,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no]]>
	</PaidHoursHistory>
	<PaidHoursHistoryTotal>
	<![CDATA[select x.zone_no,sum(x.ACTL_HRS_MPZ) as ACTL_HRS_TOT_MPZ from 
(select V.zone_no,V.ar_no,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V
group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x 
group by x.zone_no order by x.zone_no]]>
	</PaidHoursHistoryTotal>
</TCName>

<TCName name = "PaidHoursHistoryThirdWeek" >
	<PaidHoursHistory>
	<![CDATA[select V.ar_no,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no]]>
	</PaidHoursHistory>
	<PaidHoursHistoryTotal>
	<![CDATA[select x.zone_no,sum(x.ACTL_HRS_MPZ) as ACTL_HRS_TOT_MPZ from 
(select V.zone_no,V.ar_no,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V
group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x 
group by x.zone_no order by x.zone_no]]>
	</PaidHoursHistoryTotal>
</TCName>

<TCName name = "PaidHoursHistoryFourthWeek" >
	<PaidHoursHistory>
	<![CDATA[select V.ar_no,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no]]>
	</PaidHoursHistory>
	<PaidHoursHistoryTotal>
	<![CDATA[select x.zone_no,sum(x.ACTL_HRS_MPZ) as ACTL_HRS_TOT_MPZ from 
(select V.zone_no,V.ar_no,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V
group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x 
group by x.zone_no order by x.zone_no]]>
	</PaidHoursHistoryTotal>
</TCName>

<TCName name = "CPHHistoryFirsthWeek" >
	<CPHHistory>
	<![CDATA[select x.ar_no,
	CASE When x.ACTL_WAGE_MPZ=0 and x.ACTL_HRS_MPZ=0 Then 0 
	When x.ACTL_WAGE_MPZ=0 Then 0 When x.ACTL_HRS_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_WAGE_MPZ / x.ACTL_HRS_MPZ),2) END as ACTL_CPH_MPZ from 
(select V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no) x order by x.ar_no]]>
	</CPHHistory>
	<CPHHistoryTotal>
	<![CDATA[select x.zone_no,
	CASE When x.ACTL_WAGE_TOT_MPZ=0 and x.ACTL_HRS_TOT_MPZ=0 Then 0 
	When x.ACTL_WAGE_TOT_MPZ=0 Then 0 When x.ACTL_HRS_TOT_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_WAGE_TOT_MPZ / x.ACTL_HRS_TOT_MPZ),2) END as ACTL_CPH_TOT_MPZ from 
(select W.zone_no,sum(w.ACTL_WAGE_MPZ) as ACTL_WAGE_TOT_MPZ,sum(w.ACTL_HRS_MPZ) as ACTL_HRS_TOT_MPZ from 
(select V.zone_no,V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) V
group by V.zone_no,V.ar_no order by V.ar_no,V.ar_no) W 
group by W.zone_no order by W.zone_no) x order by x.zone_no]]>
	</CPHHistoryTotal>
</TCName>

<TCName name = "CPHHistorySecondWeek" >
	<CPHHistory>
	<![CDATA[select x.ar_no,
	CASE When x.ACTL_WAGE_MPZ=0 and x.ACTL_HRS_MPZ=0 Then 0 
	When x.ACTL_WAGE_MPZ=0 Then 0 When x.ACTL_HRS_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_WAGE_MPZ / x.ACTL_HRS_MPZ),2) END as ACTL_CPH_MPZ from 
(select V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no) x order by x.ar_no]]>
	</CPHHistory>
	<CPHHistoryTotal>
	<![CDATA[select x.zone_no,
	CASE When x.ACTL_WAGE_TOT_MPZ=0 and x.ACTL_HRS_TOT_MPZ=0 Then 0 
	When x.ACTL_WAGE_TOT_MPZ=0 Then 0 When x.ACTL_HRS_TOT_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_WAGE_TOT_MPZ / x.ACTL_HRS_TOT_MPZ),2) END as ACTL_CPH_TOT_MPZ from 
(select W.zone_no,sum(w.ACTL_WAGE_MPZ) as ACTL_WAGE_TOT_MPZ,sum(w.ACTL_HRS_MPZ) as ACTL_HRS_TOT_MPZ from 
(select V.zone_no,V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) V
group by V.zone_no,V.ar_no order by V.ar_no,V.ar_no) W 
group by W.zone_no order by W.zone_no) x order by x.zone_no]]>
	</CPHHistoryTotal>
</TCName>

<TCName name = "CPHHistoryThirdWeek" >
	<CPHHistory>
	<![CDATA[select x.ar_no,
	CASE When x.ACTL_WAGE_MPZ=0 and x.ACTL_HRS_MPZ=0 Then 0 
	When x.ACTL_WAGE_MPZ=0 Then 0 When x.ACTL_HRS_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_WAGE_MPZ / x.ACTL_HRS_MPZ),2) END as ACTL_CPH_MPZ from 
(select V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no) x order by x.ar_no]]>
	</CPHHistory>
	<CPHHistoryTotal>
	<![CDATA[select x.zone_no,
	CASE When x.ACTL_WAGE_TOT_MPZ=0 and x.ACTL_HRS_TOT_MPZ=0 Then 0 
	When x.ACTL_WAGE_TOT_MPZ=0 Then 0 When x.ACTL_HRS_TOT_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_WAGE_TOT_MPZ / x.ACTL_HRS_TOT_MPZ),2) END as ACTL_CPH_TOT_MPZ from 
(select W.zone_no,sum(w.ACTL_WAGE_MPZ) as ACTL_WAGE_TOT_MPZ,sum(w.ACTL_HRS_MPZ) as ACTL_HRS_TOT_MPZ from 
(select V.zone_no,V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) V
group by V.zone_no,V.ar_no order by V.ar_no,V.ar_no) W 
group by W.zone_no order by W.zone_no) x order by x.zone_no]]>
	</CPHHistoryTotal>
</TCName>

<TCName name = "CPHHistoryFourthWeek" >
	<CPHHistory>
	<![CDATA[select x.ar_no,
	CASE When x.ACTL_WAGE_MPZ=0 and x.ACTL_HRS_MPZ=0 Then 0 
	When x.ACTL_WAGE_MPZ=0 Then 0 When x.ACTL_HRS_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_WAGE_MPZ / x.ACTL_HRS_MPZ),2) END as ACTL_CPH_MPZ from 
(select V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no) x order by x.ar_no]]>
	</CPHHistory>
	<CPHHistoryTotal>
	<![CDATA[select x.zone_no,
	CASE When x.ACTL_WAGE_TOT_MPZ=0 and x.ACTL_HRS_TOT_MPZ=0 Then 0 
	When x.ACTL_WAGE_TOT_MPZ=0 Then 0 When x.ACTL_HRS_TOT_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_WAGE_TOT_MPZ / x.ACTL_HRS_TOT_MPZ),2) END as ACTL_CPH_TOT_MPZ from 
(select W.zone_no,sum(w.ACTL_WAGE_MPZ) as ACTL_WAGE_TOT_MPZ,sum(w.ACTL_HRS_MPZ) as ACTL_HRS_TOT_MPZ from 
(select V.zone_no,V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) V
group by V.zone_no,V.ar_no order by V.ar_no,V.ar_no) W 
group by W.zone_no order by W.zone_no) x order by x.zone_no]]>
	</CPHHistoryTotal>
</TCName>

<TCName name = "WagePercentageHistoryFirsthWeek" >
	<WagePercentageHistory>
	<![CDATA[select x.ar_no,
	CASE When x.ACTL_WAGE_MPZ=0 and y.ACTL_SLS_MPZ=0 Then 0
	When x.ACTL_WAGE_MPZ=0 Then 0 When y.ACTL_SLS_MPZ=0 Then 100 
	ELSE ROUND((x.ACTL_WAGE_MPZ / y.ACTL_SLS_MPZ)*100,2) END as ACTL_WGE_PRCNT_MPZ from 
(select V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no) x,
(select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no) y where x.ar_no=y.ar_no order by x.ar_no]]>
	</WagePercentageHistory>
	<WagePercentageHistoryTotal>
	<![CDATA[select x.zone_no,
	CASE When x.ACTL_WAGE_TOT_MPZ=0 and y.ACTL_SLS_TOT_MPZ=0 Then 0
	When x.ACTL_WAGE_TOT_MPZ=0 Then 0 When y.ACTL_SLS_TOT_MPZ=0 Then 100 
	ELSE ROUND((x.ACTL_WAGE_TOT_MPZ / y.ACTL_SLS_TOT_MPZ)*100,2) END as ACTL_WGE_PRCNT_TOT_MPZ from 
(select x.zone_no,ROUND(sum(x.ACTL_WAGE_MPZ),0) as ACTL_WAGE_TOT_MPZ from 
(select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V
group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
group by x.zone_no order by x.zone_no) x,
(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no) y where x.zone_no=y.zone_no order by x.zone_no]]>
	</WagePercentageHistoryTotal>
</TCName>

<TCName name = "WagePercentageHistorySecondWeek" >
	<WagePercentageHistory>
	<![CDATA[select x.ar_no,
	CASE When x.ACTL_WAGE_MPZ=0 and y.ACTL_SLS_MPZ=0 Then 0
	When x.ACTL_WAGE_MPZ=0 Then 0 When y.ACTL_SLS_MPZ=0 Then 100 
	ELSE ROUND((x.ACTL_WAGE_MPZ / y.ACTL_SLS_MPZ)*100,2) END as ACTL_WGE_PRCNT_MPZ from 
(select V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no) x,
(select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no) y where x.ar_no=y.ar_no order by x.ar_no]]>
	</WagePercentageHistory>
	<WagePercentageHistoryTotal>
	<![CDATA[select x.zone_no,
	CASE When x.ACTL_WAGE_TOT_MPZ=0 and y.ACTL_SLS_TOT_MPZ=0 Then 0
	When x.ACTL_WAGE_TOT_MPZ=0 Then 0 When y.ACTL_SLS_TOT_MPZ=0 Then 100 
	ELSE ROUND((x.ACTL_WAGE_TOT_MPZ / y.ACTL_SLS_TOT_MPZ)*100,2) END as ACTL_WGE_PRCNT_TOT_MPZ from 
(select x.zone_no,ROUND(sum(x.ACTL_WAGE_MPZ),0) as ACTL_WAGE_TOT_MPZ from 
(select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V
group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
group by x.zone_no order by x.zone_no) x,
(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no) y where x.zone_no=y.zone_no order by x.zone_no]]>
	</WagePercentageHistoryTotal>
</TCName>

<TCName name = "WagePercentageHistoryThirdWeek" >
	<WagePercentageHistory>
	<![CDATA[select x.ar_no,
	CASE When x.ACTL_WAGE_MPZ=0 and y.ACTL_SLS_MPZ=0 Then 0
	When x.ACTL_WAGE_MPZ=0 Then 0 When y.ACTL_SLS_MPZ=0 Then 100 
	ELSE ROUND((x.ACTL_WAGE_MPZ / y.ACTL_SLS_MPZ)*100,2) END as ACTL_WGE_PRCNT_MPZ from 
(select V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no) x,
(select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no) y where x.ar_no=y.ar_no order by x.ar_no]]>
	</WagePercentageHistory>
	<WagePercentageHistoryTotal>
	<![CDATA[select x.zone_no,
	CASE When x.ACTL_WAGE_TOT_MPZ=0 and y.ACTL_SLS_TOT_MPZ=0 Then 0
	When x.ACTL_WAGE_TOT_MPZ=0 Then 0 When y.ACTL_SLS_TOT_MPZ=0 Then 100 
	ELSE ROUND((x.ACTL_WAGE_TOT_MPZ / y.ACTL_SLS_TOT_MPZ)*100,2) END as ACTL_WGE_PRCNT_TOT_MPZ from 
(select x.zone_no,ROUND(sum(x.ACTL_WAGE_MPZ),0) as ACTL_WAGE_TOT_MPZ from 
(select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V
group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
group by x.zone_no order by x.zone_no) x,
(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no) y where x.zone_no=y.zone_no order by x.zone_no]]>
	</WagePercentageHistoryTotal>
</TCName>

<TCName name = "WagePercentageHistoryFourthWeek" >
	<WagePercentageHistory>
	<![CDATA[select x.ar_no,
	CASE When x.ACTL_WAGE_MPZ=0 and y.ACTL_SLS_MPZ=0 Then 0
	When x.ACTL_WAGE_MPZ=0 Then 0 When y.ACTL_SLS_MPZ=0 Then 100 
	ELSE ROUND((x.ACTL_WAGE_MPZ / y.ACTL_SLS_MPZ)*100,2) END as ACTL_WGE_PRCNT_MPZ from 
(select V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no) x,
(select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no) y where x.ar_no=y.ar_no order by x.ar_no]]>
	</WagePercentageHistory>
	<WagePercentageHistoryTotal>
	<![CDATA[select x.zone_no,
	CASE When x.ACTL_WAGE_TOT_MPZ=0 and y.ACTL_SLS_TOT_MPZ=0 Then 0
	When x.ACTL_WAGE_TOT_MPZ=0 Then 0 When y.ACTL_SLS_TOT_MPZ=0 Then 100 
	ELSE ROUND((x.ACTL_WAGE_TOT_MPZ / y.ACTL_SLS_TOT_MPZ)*100,2) END as ACTL_WGE_PRCNT_TOT_MPZ from 
(select x.zone_no,ROUND(sum(x.ACTL_WAGE_MPZ),0) as ACTL_WAGE_TOT_MPZ from 
(select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V
group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
group by x.zone_no order by x.zone_no) x,
(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no) y where x.zone_no=y.zone_no order by x.zone_no]]>
	</WagePercentageHistoryTotal>
</TCName>

<TCName name = "ItemPriceHistoryFirsthWeek" >
	<ItemPriceHistory>
	<![CDATA[select x.ar_no,
	CASE When x.ACTL_SLS_MPZ=0 and x.ACTL_ITM_MPZ=0 Then 0 
	When x.ACTL_SLS_MPZ=0 Then 0 When x.ACTL_ITM_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_SLS_MPZ / x.ACTL_ITM_MPZ),2) END as ACTL_ITM_PRZ_MPZ from 
(select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no) x order by x.ar_no]]>
	</ItemPriceHistory>
	<ItemPriceHistoryTotal>
	<![CDATA[select x.zone_no,
	CASE When x.ACTL_SLS_TOT_MPZ=0 and x.ACTL_ITM_TOT_MPZ=0 Then 0 
	When x.ACTL_SLS_TOT_MPZ=0 Then 0 When x.ACTL_ITM_TOT_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_SLS_TOT_MPZ / x.ACTL_ITM_TOT_MPZ),2) END as ACTL_ITM_PRZ_TOT_MPZ from 
(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ,ROUND(sum(K.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no) x]]>
	</ItemPriceHistoryTotal>
</TCName>

<TCName name = "ItemPriceHistorySecondWeek" >
	<ItemPriceHistory>
	<![CDATA[select x.ar_no,
	CASE When x.ACTL_SLS_MPZ=0 and x.ACTL_ITM_MPZ=0 Then 0 
	When x.ACTL_SLS_MPZ=0 Then 0 When x.ACTL_ITM_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_SLS_MPZ / x.ACTL_ITM_MPZ),2) END as ACTL_ITM_PRZ_MPZ from 
(select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no) x order by x.ar_no]]>
	</ItemPriceHistory>
	<ItemPriceHistoryTotal>
	<![CDATA[select x.zone_no,
	CASE When x.ACTL_SLS_TOT_MPZ=0 and x.ACTL_ITM_TOT_MPZ=0 Then 0 
	When x.ACTL_SLS_TOT_MPZ=0 Then 0 When x.ACTL_ITM_TOT_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_SLS_TOT_MPZ / x.ACTL_ITM_TOT_MPZ),2) END as ACTL_ITM_PRZ_TOT_MPZ from 
(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ,ROUND(sum(K.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no) x]]>
	</ItemPriceHistoryTotal>
</TCName>

<TCName name = "ItemPriceHistoryThirdWeek" >
	<ItemPriceHistory>
	<![CDATA[select x.ar_no,
	CASE When x.ACTL_SLS_MPZ=0 and x.ACTL_ITM_MPZ=0 Then 0 
	When x.ACTL_SLS_MPZ=0 Then 0 When x.ACTL_ITM_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_SLS_MPZ / x.ACTL_ITM_MPZ),2) END as ACTL_ITM_PRZ_MPZ from 
(select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no) x order by x.ar_no]]>
	</ItemPriceHistory>
	<ItemPriceHistoryTotal>
	<![CDATA[select x.zone_no,
	CASE When x.ACTL_SLS_TOT_MPZ=0 and x.ACTL_ITM_TOT_MPZ=0 Then 0 
	When x.ACTL_SLS_TOT_MPZ=0 Then 0 When x.ACTL_ITM_TOT_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_SLS_TOT_MPZ / x.ACTL_ITM_TOT_MPZ),2) END as ACTL_ITM_PRZ_TOT_MPZ from 
(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ,ROUND(sum(K.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no) x]]>
	</ItemPriceHistoryTotal>
</TCName>

<TCName name = "ItemPriceHistoryFourthWeek" >
	<ItemPriceHistory>
	<![CDATA[select x.ar_no,
	CASE When x.ACTL_SLS_MPZ=0 and x.ACTL_ITM_MPZ=0 Then 0 
	When x.ACTL_SLS_MPZ=0 Then 0 When x.ACTL_ITM_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_SLS_MPZ / x.ACTL_ITM_MPZ),2) END as ACTL_ITM_PRZ_MPZ from 
(select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no) x order by x.ar_no]]>
	</ItemPriceHistory>
	<ItemPriceHistoryTotal>
	<![CDATA[select x.zone_no,
	CASE When x.ACTL_SLS_TOT_MPZ=0 and x.ACTL_ITM_TOT_MPZ=0 Then 0 
	When x.ACTL_SLS_TOT_MPZ=0 Then 0 When x.ACTL_ITM_TOT_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_SLS_TOT_MPZ / x.ACTL_ITM_TOT_MPZ),2) END as ACTL_ITM_PRZ_TOT_MPZ from 
(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ,ROUND(sum(K.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no) x]]>
	</ItemPriceHistoryTotal>
</TCName>

<TCName name = "ORHistoryFirstWeek" >
	<ORHistory>
	<![CDATA[select actl_sms.ar_no,
	case when NVL(actl_sms.ACTL_SMS_WTSZ,0)=0 and NVL(actl_hrs.ACTL_HRS_WTSZ,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_WTSZ,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_WTSZ,0)=0 then 100  
	else NVL(ROUND((actl_sms.ACTL_SMS_WTSZ / actl_hrs.ACTL_HRS_WTSZ)*100,0),0) end as ACTL_OR_WTSZ from
(select lc.ar_no,NVL(xy.ACTL_SMS_DTSG,0) as ACTL_SMS_WTSZ from 
(select distinct ar_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' order by ar_no) lc
LEFT OUTER JOIN
(select xyz.ar_no,sum(xyz.ACTL_SMS_DTSG) as ACTL_SMS_DTSG from 
(select * from 
(select  ar_no,Sum(ACTL_SMS_DTSG) as ACTL_SMS_DTSG from 
(select distinct src.*,
(CASE
when 
--task_nm<>'Major Fill' and 
dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
--When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when 
--task_nm<>'Major Fill' and 
dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSG
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,
LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
--when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
--(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When 
--LL.task_nm <> 'Major Fill' and 
LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When 
--LL.task_nm <> 'Major Fill' and 
LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select 
Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, 
dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and 
A.loc_no IN (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by ar_no order by ar_no) xy) xyz
group by xyz.ar_no order by xyz.ar_no) xy
on lc.ar_no=xy.ar_no order by lc.ar_no) actl_sms,
(select lc.ar_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_WTSZ from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone'  order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone'  and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) hrs
on hrs.ar_no=lc.ar_no order by lc.ar_no) actl_hrs
where actl_hrs.ar_no=actl_sms.ar_no order by actl_sms.ar_no]]>
	</ORHistory>
	<ORHistoryTotal>
	<![CDATA[select actl_sms.zone_no,
	case when NVL(actl_sms.ACTL_SMS_TOT_WTSZ,0)=0 and NVL(actl_hrs.ACTL_HRS_TOT_WTSZ,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_TOT_WTSZ,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_TOT_WTSZ,0)=0 then 100  
	else NVL(ROUND((actl_sms.ACTL_SMS_TOT_WTSZ / actl_hrs.ACTL_HRS_TOT_WTSZ)*100,0),0) end as ACTL_OR_TOT_WTSZ from
(select lc.zone_no,NVL(sum(xy.ACTL_SMS_DTSG),0) as ACTL_SMS_TOT_WTSZ from 
(select distinct zone_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' order by zone_no) lc
LEFT OUTER JOIN
(select  zone_no,ar_no,ROUND(Sum(ACTL_SMS_DTSG),2) as ACTL_SMS_DTSG from 
(select distinct src.*,
(CASE
when 
--task_nm<>'Major Fill' and 
dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
--When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when 
--task_nm<>'Major Fill' and 
dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSG
from
(select 
LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,
LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
--when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
--(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When 
--LL.task_nm <> 'Major Fill' and 
LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When 
--LL.task_nm <> 'Major Fill' and 
LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select 
Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, 
dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' 
and A.loc_no IN (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by zone_no,ar_no order by zone_no,ar_no) xy
on lc.zone_no=xy.zone_no group by lc.zone_no order by lc.zone_no)actl_sms,
(select lc.zone_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_WTSZ from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone'  order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone'  and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) hrs
on hrs.zone_no=lc.zone_no order by lc.zone_no)actl_hrs
where actl_hrs.zone_no=actl_sms.zone_no order by actl_sms.zone_no]]>
	</ORHistoryTotal>
</TCName>

<TCName name = "ORHistorySecondWeek" >
<ORHistory>
	<![CDATA[select actl_sms.ar_no,
	case when NVL(actl_sms.ACTL_SMS_WTSZ,0)=0 and NVL(actl_hrs.ACTL_HRS_WTSZ,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_WTSZ,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_WTSZ,0)=0 then 100  
	else NVL(ROUND((actl_sms.ACTL_SMS_WTSZ / actl_hrs.ACTL_HRS_WTSZ)*100,0),0) end as ACTL_OR_WTSZ from
(select lc.ar_no,NVL(xy.ACTL_SMS_DTSG,0) as ACTL_SMS_WTSZ from 
(select distinct ar_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' order by ar_no) lc
LEFT OUTER JOIN
(select xyz.ar_no,sum(xyz.ACTL_SMS_DTSG) as ACTL_SMS_DTSG from 
(select * from 
(select  ar_no,Sum(ACTL_SMS_DTSG) as ACTL_SMS_DTSG from 
(select distinct src.*,
(CASE
when 
--task_nm<>'Major Fill' and 
dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
--When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when 
--task_nm<>'Major Fill' and 
dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSG
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,
LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
--when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
--(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When 
--LL.task_nm <> 'Major Fill' and 
LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When 
--LL.task_nm <> 'Major Fill' and 
LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select 
Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, 
dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and 
A.loc_no IN (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by ar_no order by ar_no) xy) xyz
group by xyz.ar_no order by xyz.ar_no) xy
on lc.ar_no=xy.ar_no order by lc.ar_no) actl_sms,
(select lc.ar_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_WTSZ from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone'  order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone'  and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) hrs
on hrs.ar_no=lc.ar_no order by lc.ar_no) actl_hrs
where actl_hrs.ar_no=actl_sms.ar_no order by actl_sms.ar_no]]>
	</ORHistory>
	<ORHistoryTotal>
	<![CDATA[select actl_sms.zone_no,
	case when NVL(actl_sms.ACTL_SMS_TOT_WTSZ,0)=0 and NVL(actl_hrs.ACTL_HRS_TOT_WTSZ,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_TOT_WTSZ,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_TOT_WTSZ,0)=0 then 100  
	else NVL(ROUND((actl_sms.ACTL_SMS_TOT_WTSZ / actl_hrs.ACTL_HRS_TOT_WTSZ)*100,0),0) end as ACTL_OR_TOT_WTSZ from
(select lc.zone_no,NVL(sum(xy.ACTL_SMS_DTSG),0) as ACTL_SMS_TOT_WTSZ from 
(select distinct zone_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' order by zone_no) lc
LEFT OUTER JOIN
(select  zone_no,ar_no,ROUND(Sum(ACTL_SMS_DTSG),2) as ACTL_SMS_DTSG from 
(select distinct src.*,
(CASE
when 
--task_nm<>'Major Fill' and 
dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
--When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when 
--task_nm<>'Major Fill' and 
dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSG
from
(select 
LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,
LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
--when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
--(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When 
--LL.task_nm <> 'Major Fill' and 
LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When 
--LL.task_nm <> 'Major Fill' and 
LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select 
Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, 
dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' 
and A.loc_no IN (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by zone_no,ar_no order by zone_no,ar_no) xy
on lc.zone_no=xy.zone_no group by lc.zone_no order by lc.zone_no)actl_sms,
(select lc.zone_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_WTSZ from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone'  order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone'  and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) hrs
on hrs.zone_no=lc.zone_no order by lc.zone_no)actl_hrs
where actl_hrs.zone_no=actl_sms.zone_no order by actl_sms.zone_no]]>
	</ORHistoryTotal>
</TCName>

<TCName name = "ORHistoryThirdWeek" >
<ORHistory>
	<![CDATA[select actl_sms.ar_no,
	case when NVL(actl_sms.ACTL_SMS_WTSZ,0)=0 and NVL(actl_hrs.ACTL_HRS_WTSZ,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_WTSZ,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_WTSZ,0)=0 then 100  
	else NVL(ROUND((actl_sms.ACTL_SMS_WTSZ / actl_hrs.ACTL_HRS_WTSZ)*100,0),0) end as ACTL_OR_WTSZ from
(select lc.ar_no,NVL(xy.ACTL_SMS_DTSG,0) as ACTL_SMS_WTSZ from 
(select distinct ar_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' order by ar_no) lc
LEFT OUTER JOIN
(select xyz.ar_no,sum(xyz.ACTL_SMS_DTSG) as ACTL_SMS_DTSG from 
(select * from 
(select  ar_no,Sum(ACTL_SMS_DTSG) as ACTL_SMS_DTSG from 
(select distinct src.*,
(CASE
when 
--task_nm<>'Major Fill' and 
dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
--When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when 
--task_nm<>'Major Fill' and 
dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSG
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,
LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
--when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
--(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When 
--LL.task_nm <> 'Major Fill' and 
LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When 
--LL.task_nm <> 'Major Fill' and 
LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select 
Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, 
dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and 
A.loc_no IN (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by ar_no order by ar_no) xy) xyz
group by xyz.ar_no order by xyz.ar_no) xy
on lc.ar_no=xy.ar_no order by lc.ar_no) actl_sms,
(select lc.ar_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_WTSZ from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone'  order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone'  and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) hrs
on hrs.ar_no=lc.ar_no order by lc.ar_no) actl_hrs
where actl_hrs.ar_no=actl_sms.ar_no order by actl_sms.ar_no]]>
	</ORHistory>
	<ORHistoryTotal>
	<![CDATA[select actl_sms.zone_no,
	case when NVL(actl_sms.ACTL_SMS_TOT_WTSZ,0)=0 and NVL(actl_hrs.ACTL_HRS_TOT_WTSZ,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_TOT_WTSZ,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_TOT_WTSZ,0)=0 then 100  
	else NVL(ROUND((actl_sms.ACTL_SMS_TOT_WTSZ / actl_hrs.ACTL_HRS_TOT_WTSZ)*100,0),0) end as ACTL_OR_TOT_WTSZ from
(select lc.zone_no,NVL(sum(xy.ACTL_SMS_DTSG),0) as ACTL_SMS_TOT_WTSZ from 
(select distinct zone_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' order by zone_no) lc
LEFT OUTER JOIN
(select  zone_no,ar_no,ROUND(Sum(ACTL_SMS_DTSG),2) as ACTL_SMS_DTSG from 
(select distinct src.*,
(CASE
when 
--task_nm<>'Major Fill' and 
dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
--When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when 
--task_nm<>'Major Fill' and 
dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSG
from
(select 
LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,
LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
--when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
--(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When 
--LL.task_nm <> 'Major Fill' and 
LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When 
--LL.task_nm <> 'Major Fill' and 
LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select 
Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, 
dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' 
and A.loc_no IN (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by zone_no,ar_no order by zone_no,ar_no) xy
on lc.zone_no=xy.zone_no group by lc.zone_no order by lc.zone_no)actl_sms,
(select lc.zone_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_WTSZ from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone'  order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone'  and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) hrs
on hrs.zone_no=lc.zone_no order by lc.zone_no)actl_hrs
where actl_hrs.zone_no=actl_sms.zone_no order by actl_sms.zone_no]]>
	</ORHistoryTotal>
</TCName>

<TCName name = "ORHistoryFourthWeek" >
<ORHistory>
	<![CDATA[select actl_sms.ar_no,
	case when NVL(actl_sms.ACTL_SMS_WTSZ,0)=0 and NVL(actl_hrs.ACTL_HRS_WTSZ,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_WTSZ,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_WTSZ,0)=0 then 100  
	else NVL(ROUND((actl_sms.ACTL_SMS_WTSZ / actl_hrs.ACTL_HRS_WTSZ)*100,0),0) end as ACTL_OR_WTSZ from
(select lc.ar_no,NVL(xy.ACTL_SMS_DTSG,0) as ACTL_SMS_WTSZ from 
(select distinct ar_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' order by ar_no) lc
LEFT OUTER JOIN
(select xyz.ar_no,sum(xyz.ACTL_SMS_DTSG) as ACTL_SMS_DTSG from 
(select * from 
(select  ar_no,Sum(ACTL_SMS_DTSG) as ACTL_SMS_DTSG from 
(select distinct src.*,
(CASE
when 
--task_nm<>'Major Fill' and 
dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
--When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when 
--task_nm<>'Major Fill' and 
dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSG
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,
LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
--when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
--(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When 
--LL.task_nm <> 'Major Fill' and 
LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When 
--LL.task_nm <> 'Major Fill' and 
LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select 
Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, 
dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and 
A.loc_no IN (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by ar_no order by ar_no) xy) xyz
group by xyz.ar_no order by xyz.ar_no) xy
on lc.ar_no=xy.ar_no order by lc.ar_no) actl_sms,
(select lc.ar_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_WTSZ from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone'  order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone'  and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) hrs
on hrs.ar_no=lc.ar_no order by lc.ar_no) actl_hrs
where actl_hrs.ar_no=actl_sms.ar_no order by actl_sms.ar_no]]>
	</ORHistory>
	<ORHistoryTotal>
	<![CDATA[select actl_sms.zone_no,
	case when NVL(actl_sms.ACTL_SMS_TOT_WTSZ,0)=0 and NVL(actl_hrs.ACTL_HRS_TOT_WTSZ,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_TOT_WTSZ,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_TOT_WTSZ,0)=0 then 100  
	else NVL(ROUND((actl_sms.ACTL_SMS_TOT_WTSZ / actl_hrs.ACTL_HRS_TOT_WTSZ)*100,0),0) end as ACTL_OR_TOT_WTSZ from
(select lc.zone_no,NVL(sum(xy.ACTL_SMS_DTSG),0) as ACTL_SMS_TOT_WTSZ from 
(select distinct zone_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' order by zone_no) lc
LEFT OUTER JOIN
(select  zone_no,ar_no,ROUND(Sum(ACTL_SMS_DTSG),2) as ACTL_SMS_DTSG from 
(select distinct src.*,
(CASE
when 
--task_nm<>'Major Fill' and 
dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
--When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when 
--task_nm<>'Major Fill' and 
dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSG
from
(select 
LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,
LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
--when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
--(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When 
--LL.task_nm <> 'Major Fill' and 
LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When 
--LL.task_nm <> 'Major Fill' and 
LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select 
Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, 
dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' 
and A.loc_no IN (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by zone_no,ar_no order by zone_no,ar_no) xy
on lc.zone_no=xy.zone_no group by lc.zone_no order by lc.zone_no)actl_sms,
(select lc.zone_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_WTSZ from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone'  order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone'  and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) hrs
on hrs.zone_no=lc.zone_no order by lc.zone_no)actl_hrs
where actl_hrs.zone_no=actl_sms.zone_no order by actl_sms.zone_no]]>
	</ORHistoryTotal>
</TCName>

<TCName name = "BudgetSales_CurrentMonth">
	<BudgetSales>
	<![CDATA[select x.ar_no,ROUND(sum(x.BDGT_SLS_MPG),0) as BDGT_SLS_MPZ from 
(select f.ar_no,f.loc_nm,NVL(g.BDGT_SALES_MPG,0) as BDGT_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_SALES) as BDGT_SALES_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm) x
group by x.ar_no order by x.ar_no]]>
	</BudgetSales>
	<BudgetSalesTotal>
	<![CDATA[select y.zone_no,ROUND(sum(y.BDGT_SLS_MPZ),0) as BDGT_SLS_TOT_MPZ from 
(select x.zone_no,x.ar_no,ROUND(sum(x.BDGT_SLS_MPG),0) as BDGT_SLS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.BDGT_SALES_MPG,0) as BDGT_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_SALES) as BDGT_SALES_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm order by f.zone_no,f.ar_no) x
group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no ) y
group by y.zone_no order by y.zone_no]]>
	</BudgetSalesTotal>
	<ForecastSales>
	<![CDATA[select x.ar_no,ROUND(sum(x.frcst_sls_MPG),0) as frcst_sls_MPZ from 
(select f.ar_no,f.loc_nm,NVL(g.fcst_SALES_MPG,0) as frcst_sls_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(fcst_SALES) as fcst_SALES_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(frcst_sls) as fcst_SALES, sum(frcst_wage_amt) as fcst_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm) x
group by x.ar_no order by x.ar_no]]>
	</ForecastSales>
	<ForecastSalesTotal>
	<![CDATA[select y.zone_no,ROUND(sum(y.frcst_sls_MPZ),0) as frcst_sls_TOT_MPZ from 
(select x.zone_no,x.ar_no,ROUND(sum(x.frcst_sls_MPG),0) as frcst_sls_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.fcst_SALES_MPG,0) as frcst_sls_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(fcst_SALES) as fcst_SALES_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(frcst_sls) as fcst_SALES, sum(frcst_wage_amt) as fcst_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm order by f.zone_no,f.ar_no) x
group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no ) y
group by y.zone_no order by y.zone_no]]>
	</ForecastSalesTotal>
</TCName>

<TCName name = "PlannedSales_CurrentMonth">
	<PlannedSales>
	<![CDATA[select g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_WPZ from 
(select f.ar_no,f.loc_nm,NVL(sum(e.PLN_SALES),0) as PLN_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(a.SALES) as PLN_SALES 
from WW_WLP.PLN_FCST_CMB_VW a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and a.proc_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.dept_no NOT IN (0,90,20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e
on f.loc_nm=e.loc_nm group by f.ar_no,f.loc_nm order by f.ar_no) g
group by g.ar_no order by g.ar_no]]>
	</PlannedSales>
	<PlannedSalesTotal>
	<![CDATA[select y.zone_no,ROUND(sum(y.PLN_SLS_MPZ),0) as PLN_SLS_TOT_WPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL((sum(e.PLN_SALES)),0) as PLN_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
( select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(a.SALES) as PLN_SALES 
from WW_WLP.PLN_FCST_CMB_VW a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and a.proc_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.dept_no NOT IN (0,90,20) 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e
on f.loc_nm=e.loc_nm group by f.zone_no,f.ar_no,f.loc_nm order by f.zone_no,f.ar_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no]]>
	</PlannedSalesTotal>
</TCName>

<TCName name = "GeneratedSales_CurrentMonth">
	<GeneratedSales>
	<![CDATA[select f.ar_no,ROUND(sum(GEN_SLS_MPG),0) as GEN_SLS_MPZ from 
(select e.ar_no,e.loc_nm,NVL(d.GEN_SALES_MPG,0) as GEN_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) e
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,a.loc_no,(sum(a.gnrt_sls)) as GEN_SALES_MPG
from WW_WLP.fcst a,WW_WLP.WK b, ww_wlp.loc c
where a.fcst_dte between b.WK_STRT and b.WK_END and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.loc_no=c.loc_no and c.div_no='Division' and rgn_no='Region' and zone_no='Zone' and c.wlp_live_ind in ('Y','N') 
and a.Dept_no NOT IN (0,20,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm) d
on d.loc_nm=e.loc_nm) f group by f.ar_no order by f.ar_no]]>
	</GeneratedSales>
	<GeneratedSalesTotal>
	<![CDATA[select y.zone_no,ROUND(sum(y.GEN_SLS_MPZ),0) as GEN_SLS_TOT_MPZ from 
(select f.zone_no,f.ar_no,ROUND(sum(GEN_SLS_MPG),0) as GEN_SLS_MPZ from 
(select e.zone_no,e.ar_no,e.loc_nm,NVL(d.GEN_SALES_MPG,0) as GEN_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) e
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,a.loc_no,(sum(a.gnrt_sls)) as GEN_SALES_MPG
from WW_WLP.fcst a,WW_WLP.WK b, ww_wlp.loc c
where a.fcst_dte between b.WK_STRT and b.WK_END and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.loc_no=c.loc_no and c.div_no='Division' and rgn_no='Region' and zone_no='Zone' and c.wlp_live_ind in ('Y','N') 
and a.Dept_no NOT IN (0,20,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm) d
on d.loc_nm=e.loc_nm) f group by f.zone_no,f.ar_no order by f.zone_no,f.ar_no) y
group by y.zone_no order by y.zone_no]]>
	</GeneratedSalesTotal>
</TCName>

<TCName name = "VarToBUDSales_CurrentMonth">
	<VartoBUD>
	<![CDATA[select R.ar_no,(R.PLN_SLS_MPZ - S.BDGT_SLS_MPZ) as VAR_TO_BDGT_SLS_WPZ from 
(select g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from 
(select f.ar_no,f.loc_nm,NVL(sum(e.PLN_SALES),0) as PLN_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(a.SALES) as PLN_SALES 
from WW_WLP.PLN_FCST_CMB_VW a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and a.proc_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.dept_no NOT IN (0,90,20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e
on f.loc_nm=e.loc_nm group by f.ar_no,f.loc_nm order by f.ar_no) g
group by g.ar_no order by g.ar_no) R,
(select x.ar_no,ROUND(sum(x.BDGT_SLS_MPG),0) as BDGT_SLS_MPZ from 
(select f.ar_no,f.loc_nm,NVL(g.BDGT_SALES_MPG,0) as BDGT_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_SALES) as BDGT_SALES_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm) x
group by x.ar_no order by x.ar_no) S where R.ar_no=S.ar_no order by R.ar_no]]>
	</VartoBUD>
	<VartoBUDTotal>
	<![CDATA[select R.zone_no,(R.PLN_SLS_TOT_MPZ - S.BDGT_SLS_TOT_MPZ) as VAR_TO_BDGT_SLS_TOT_MPZ from 
(select y.zone_no,ROUND(sum(y.PLN_SLS_MPZ),0) as PLN_SLS_TOT_MPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL((sum(e.PLN_SALES)),0) as PLN_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
( select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(a.SALES) as PLN_SALES 
from WW_WLP.PLN_FCST_CMB_VW a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and a.proc_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.dept_no NOT IN (0,90,20) 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e
on f.loc_nm=e.loc_nm group by f.zone_no,f.ar_no,f.loc_nm order by f.zone_no,f.ar_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) R,
(select y.zone_no,ROUND(sum(y.BDGT_SLS_MPZ),0) as BDGT_SLS_TOT_MPZ from 
(select x.zone_no,x.ar_no,ROUND(sum(x.BDGT_SLS_MPG),0) as BDGT_SLS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.BDGT_SALES_MPG,0) as BDGT_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_SALES) as BDGT_SALES_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm order by f.zone_no,f.ar_no) x
group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no ) y
group by y.zone_no order by y.zone_no) S where R.zone_no=S.zone_no order by R.zone_no]]>
	</VartoBUDTotal>
	<VartoFCST>
	<![CDATA[select R.ar_no,(R.PLN_SLS_MPZ - S.FRCST_SLS_MPZ) as VAR_TO_FRCST_SLS_WPZ from 
(select g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from 
(select f.ar_no,f.loc_nm,NVL(sum(e.PLAN_SALES),0) as PLN_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as PLAN_SALES 
from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id 
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(a.SALES) as PLN_SALES 
from WW_WLP.PLN_FCST_CMB_VW a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and a.proc_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and a.wk_id=b.wk_id 
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' )
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e
on f.loc_nm=e.loc_nm group by f.ar_no,f.loc_nm order by f.ar_no) g
group by g.ar_no order by g.ar_no) R,
(select x.ar_no,ROUND(sum(x.FRCST_SLS_MPG),0) as FRCST_SLS_MPZ from 
(select f.ar_no,f.loc_nm,NVL(g.fcst_SALES_MPG,0) as FRCST_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(fcst_SALES) as fcst_SALES_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(FRCST_SLS) as fcst_SALES, sum(frcst_wage_amt) as fcst_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm) x
group by x.ar_no order by x.ar_no) S where R.ar_no=S.ar_no order by R.ar_no]]>
	</VartoFCST>
	<VartoFCSTTotal>
	<![CDATA[select R.zone_no,(R.PLN_SLS_TOT_MPZ - S.FRCST_SLS_TOT_MPZ) as VAR_TO_FRCST_SLS_TOT_MPZ from 
(select y.zone_no,ROUND(sum(y.PLN_SLS_MPZ),0) as PLN_SLS_TOT_MPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(sum(e.PLAN_SALES),0) as PLN_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as PLAN_SALES 
from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id 
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(a.SALES) as GEN_SALES 
from WW_WLP.PLN_FCST_CMB_VW a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and a.proc_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and a.wk_id=b.wk_id 
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' )
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e
on f.loc_nm=e.loc_nm group by f.zone_no,f.ar_no,f.loc_nm order by f.zone_no,f.ar_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) R,
(select y.zone_no,ROUND(sum(y.FRCST_SLS_MPZ),0) as FRCST_SLS_TOT_MPZ from 
(select x.zone_no,x.ar_no,ROUND(sum(x.FRCST_SLS_MPG),0) as FRCST_SLS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.fcst_SALES_MPG,0) as FRCST_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(fcst_SALES) as fcst_SALES_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(FRCST_SLS) as fcst_SALES, sum(frcst_wage_amt) as fcst_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm order by f.zone_no,f.ar_no) x
group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no ) y
group by y.zone_no order by y.zone_no) S where R.zone_no=S.zone_no order by R.zone_no]]>
	</VartoFCSTTotal>
</TCName>

<TCName name = "PercentageLYsales_CurrentMonth">
	<PercentLYSales>
	<![CDATA[select pln_sls.ar_no,
	CASE When pln_sls.PLN_SLS_MPZ=0 and actl_sls.LY_ACTL_SLS_MPZ=0 Then 0 
	When pln_sls.PLN_SLS_MPZ=0 Then -100 When actl_sls.LY_ACTL_SLS_MPZ=0 Then 100  
	ELSE ROUND(((pln_sls.PLN_SLS_MPZ / actl_sls.LY_ACTL_SLS_MPZ)-1)*100,2) END as LY_PRCNT_SLS_MPZ from 
(select g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from 
(select f.ar_no,f.loc_nm,NVL(sum(e.PLN_SALES),0) as PLN_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(a.SALES) as PLN_SALES 
from WW_WLP.PLN_FCST_CMB_VW a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and a.proc_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.dept_no NOT IN (0,90,20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e
on f.loc_nm=e.loc_nm group by f.ar_no,f.loc_nm order by f.ar_no) g
group by g.ar_no order by g.ar_no) pln_sls,
(select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as LY_ACTL_SLS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no) actl_sls where pln_sls.ar_no=actl_sls.ar_no]]>
	</PercentLYSales>
	<PercentLYSalesTotal>
	<![CDATA[select pln_sls.zone_no,
	CASE When pln_sls.PLN_SLS_TOT_MPZ=0 and actl_sls.LY_ACTL_SLS_TOT_MPZ=0 Then 0 
	When pln_sls.PLN_SLS_TOT_MPZ=0 Then -100 When actl_sls.LY_ACTL_SLS_TOT_MPZ=0 Then 100  
	ELSE ROUND(((pln_sls.PLN_SLS_TOT_MPZ / actl_sls.LY_ACTL_SLS_TOT_MPZ)-1)*100,2) END as LY_PRCNT_SLS_TOT_MPZ from 
(select y.zone_no,ROUND(sum(y.PLN_SLS_MPZ),0) as PLN_SLS_TOT_MPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL((sum(e.PLN_SALES)),0) as PLN_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
( select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(a.SALES) as PLN_SALES 
from WW_WLP.PLN_FCST_CMB_VW a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and a.proc_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.dept_no NOT IN (0,90,20) 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e
on f.loc_nm=e.loc_nm group by f.zone_no,f.ar_no,f.loc_nm order by f.zone_no,f.ar_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) pln_sls,
(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as LY_ACTL_SLS_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no) actl_sls where pln_sls.zone_no=actl_sls.zone_no order by pln_sls.zone_no]]>
	</PercentLYSalesTotal>
</TCName>

<TCName name = "BudgetPercentageSales_CurrentMonth">
	<BudgetPercentage>
	<![CDATA[select pln_sls.ar_no,
	CASE When pln_sls.PLN_SLS_WPG=0 and bdgt_sls.BDGT_SLS_WPG=0 Then 0 
	When pln_sls.PLN_SLS_WPG=0 Then -100 When bdgt_sls.BDGT_SLS_WPG=0 Then 100 
	ELSE ROUND(((pln_sls.PLN_SLS_WPG/bdgt_sls.BDGT_SLS_WPG)-1)*100,2) END as BDGT_PRCNT_SLS_WPG from 
(select g.ar_no,sum(g.PLN_SLS_MPG) as PLN_SLS_WPG from 
(select f.ar_no,f.loc_nm,NVL(sum(e.PLN_SALES),0) as PLN_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(a.SALES) as PLN_SALES 
from WW_WLP.PLN_FCST_CMB_VW a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and a.proc_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.dept_no NOT IN (0,90,20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e
on f.loc_nm=e.loc_nm group by f.ar_no,f.loc_nm order by f.ar_no) g
group by g.ar_no order by g.ar_no) pln_sls,
(select d.ar_no,ROUND(sum(d.BDGT_SLS_WPG),0) as BDGT_SLS_WPG from 
(select f.ar_no,f.loc_nm,NVL(g.BDGT_SALES_WPG,0) as BDGT_SLS_WPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,ROUND(sum(BDGT_SALES),0) as BDGT_SALES_WPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no ='FinWeek' and fin_yr = 'FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm and f.ar_no=g.ar_no) d
group by d.ar_no order by d.ar_no) bdgt_sls where pln_sls.ar_no=bdgt_sls.ar_no]]>
	</BudgetPercentage>
	<BudgetPercentageTotal>
	<![CDATA[select pln_sls.zone_no,
	CASE When pln_sls.PLN_SLS_TOT_WPZ=0 and bdgt_sls.BDGT_SLS_TOT_WPZ=0 Then 0 
	When pln_sls.PLN_SLS_TOT_WPZ=0 Then -100 When bdgt_sls.BDGT_SLS_TOT_WPZ=0 Then 100  
	ELSE ROUND(((pln_sls.PLN_SLS_TOT_WPZ / bdgt_sls.BDGT_SLS_TOT_WPZ)-1)*100,2) END as BDGT_PRCNT_SLS_TOT_WPZ from 
(select y.zone_no,ROUND(sum(y.PLN_SLS_MPZ),0) as PLN_SLS_TOT_WPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL((sum(e.PLN_SALES)),0) as PLN_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
( select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(a.SALES) as PLN_SALES 
from WW_WLP.PLN_FCST_CMB_VW a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and a.proc_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.dept_no NOT IN (0,90,20) 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e
on f.loc_nm=e.loc_nm group by f.zone_no,f.ar_no,f.loc_nm order by f.zone_no,f.ar_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) pln_sls,
(select y.zone_no,ROUND(sum(y.BDGT_SLS_MPZ),0) as BDGT_SLS_TOT_WPZ from 
(select x.zone_no,x.ar_no,ROUND(sum(x.BDGT_SLS_MPG),0) as BDGT_SLS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.BDGT_SALES_MPG,0) as BDGT_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_SALES) as BDGT_SALES_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm order by f.zone_no,f.ar_no) x
group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no ) y
group by y.zone_no order by y.zone_no) bdgt_sls where pln_sls.zone_no=bdgt_sls.zone_no order by pln_sls.zone_no]]>
	</BudgetPercentageTotal>
	<ForecastPercentage>
	<![CDATA[select pln_sls.ar_no,
	CASE When pln_sls.PLN_SLS_WPG=0 and FRCST_SLS.FRCST_SLS_WPG=0 Then 0 
	When pln_sls.PLN_SLS_WPG=0 Then -100 When FRCST_SLS.FRCST_SLS_WPG=0 Then 100  
	ELSE ROUND(((pln_sls.PLN_SLS_WPG/FRCST_SLS.FRCST_SLS_WPG)-1)*100,2) END as FCST_PRCNT_SLS_WPG from 
(select g.ar_no,ROUND(sum(g.PLN_SLS_WPG),0) as PLN_SLS_WPG from 
(select f.ar_no,f.loc_nm,NVL(sum(e.PLAN_SALES),0) as PLN_SLS_WPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as PLAN_SALES 
from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id 
and b.fin_wk_no ='FinWeek' and b.fin_yr = 'FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id) c UNION select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(sales) as GEN_SALES 
from ww_wlp.pln_fcst_cmb_vw a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and a.proc_dte between b.wk_strt and b.wk_end and b.fin_wk_no ='FinWeek' and b.fin_yr = 'FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and a.wk_id=b.wk_id 
and b.fin_wk_no ='FinWeek' and b.fin_yr = 'FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' )
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e
on f.loc_nm=e.loc_nm group by f.ar_no,f.loc_nm order by f.ar_no) g
group by g.ar_no order by g.ar_no) pln_sls,
(select d.ar_no,ROUND(sum(d.FRCST_SLS_WPG),0) as FRCST_SLS_WPG from 
(select f.ar_no,f.loc_nm,NVL(g.fcst_SALES_WPG,0) as FRCST_SLS_WPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(fcst_SALES) as fcst_SALES_WPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(FRCST_SLS) as fcst_SALES, sum(frcst_wage_amt) as fcst_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no ='FinWeek' and fin_yr = 'FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm and f.ar_no=g.ar_no) d
group by d.ar_no order by d.ar_no) FRCST_SLS where pln_sls.ar_no=FRCST_SLS.ar_no]]>
	</ForecastPercentage>
	<ForecastPercentageTotal>
	<![CDATA[select pln_sls.zone_no,
	CASE When pln_sls.PLN_SLS_TOT_WPZ=0 and FRCST_SLS.FRCST_SLS_TOT_WPZ=0 Then 0 
	When pln_sls.PLN_SLS_TOT_WPZ=0 Then -100 When FRCST_SLS.FRCST_SLS_TOT_WPZ=0 Then 100  
	ELSE ROUND(((pln_sls.PLN_SLS_TOT_WPZ / FRCST_SLS.FRCST_SLS_TOT_WPZ)-1)*100,2) END as FCST_PRCNT_SLS_TOT_WPZ from 
(select y.zone_no,ROUND(sum(y.PLN_SLS_MPZ),0) as PLN_SLS_TOT_WPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(sum(e.PLAN_SALES),0) as PLN_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as PLAN_SALES 
from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id 
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(a.SALES) as PLN_SALES 
from WW_WLP.PLN_FCST_CMB_VW a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and a.proc_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and a.wk_id=b.wk_id 
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' )
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e
on f.loc_nm=e.loc_nm group by f.zone_no,f.ar_no,f.loc_nm order by f.zone_no,f.ar_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) pln_sls,
(select y.zone_no,ROUND(sum(y.FRCST_SLS_MPZ),0) as FRCST_SLS_TOT_WPZ from 
(select x.zone_no,x.ar_no,ROUND(sum(x.FRCST_SLS_MPG),0) as FRCST_SLS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.fcst_SALES_MPG,0) as FRCST_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(fcst_SALES) as fcst_SALES_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(FRCST_SLS) as fcst_SALES, sum(frcst_wage_amt) as fcst_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm order by f.zone_no,f.ar_no) x
group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no ) y
group by y.zone_no order by y.zone_no) FRCST_SLS where pln_sls.zone_no=FRCST_SLS.zone_no order by pln_sls.zone_no]]>
	</ForecastPercentageTotal>
</TCName>

<TCName name = "BudgetWages_CurrentMonth">
	<BudgetWages>
	<![CDATA[select x.ar_no,ROUND(sum(x.BDGT_WGE_MPG),0) as BDGT_WGE_MPZ from 
(select f.ar_no,f.loc_nm,NVL(g.BDGT_WAGE_MPG,0) as BDGT_WGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_WAGE) as BDGT_WAGE_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (20)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm ) x
group by x.ar_no order by x.ar_no]]>
	</BudgetWages>
	<BudgetWagesTotal>
	<![CDATA[select y.zone_no,ROUND(sum(y.BDGT_WGE_MPZ),0) as BDGT_WGE_TOT_MPZ from 
(select x.zone_no,x.ar_no,ROUND(sum(x.BDGT_WGE_MPG),0) as BDGT_WGE_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.BDGT_WAGE_MPG,0) as BDGT_WGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_WAGE) as BDGT_WAGE_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (20)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm ) x
group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no) y
group by y.zone_no order by y.zone_no]]>
	</BudgetWagesTotal>
	<ForecastWages>
	<![CDATA[select x.ar_no,ROUND(sum(x.fcst_WGE_MPG),0) as fcst_WGE_MPZ from 
(select f.ar_no,f.loc_nm,NVL(g.fcst_WAGE_MPG,0) as fcst_WGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(fcst_WAGE) as fcst_WAGE_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(FRCST_SLS) as fcst_SALES, sum(frcst_wage_amt) as fcst_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (20)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm ) x
group by x.ar_no order by x.ar_no]]>
	</ForecastWages>
	<ForecastWagesTotal>
	<![CDATA[select y.zone_no,ROUND(sum(y.fcst_WGE_MPZ),0) as fcst_WGE_TOT_MPZ from 
(select x.zone_no,x.ar_no,ROUND(sum(x.fcst_WGE_MPG),0) as fcst_WGE_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.fcst_WAGE_MPG,0) as fcst_WGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(fcst_WAGE) as fcst_WAGE_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(FRCST_SLS) as fcst_SALES, sum(frcst_wage_amt) as fcst_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (20)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm ) x
group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no) y
group by y.zone_no order by y.zone_no]]>
	</ForecastWagesTotal>
</TCName>

<TCName name = "PlannedWages_CurrentMonth">
	<PlannedWages>
	<![CDATA[select g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_MPZ from 
(select f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g group by g.ar_no order by g.ar_no]]>
	</PlannedWages>
	<PlannedWagesTotal>
	<![CDATA[select y.zone_no,ROUND(sum(y.PLN_WAGE_MPZ),0) as PLN_WAGE_TOT_MPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no ]]>
	</PlannedWagesTotal>
</TCName>

<TCName name = "PlannedLYWages_CurrentMonth">
	<PlannedLYWages>
	<![CDATA[select pln_wge_cy.ar_no,
	CASE When pln_wge_cy.PLN_WAGE_CY_MPZ=0 and actl_wge_ly.ACTL_WAGE_LY_MPZ=0 Then 0 
	When pln_wge_cy.PLN_WAGE_CY_MPZ=0 Then -100 When actl_wge_ly.ACTL_WAGE_LY_MPZ=0 Then 100  
	ELSE ROUND(((pln_wge_cy.PLN_WAGE_CY_MPZ / actl_wge_ly.ACTL_WAGE_LY_MPZ)-1)*100,2) END as LY_PRCNT_WAGE_MPZ from
(select g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_CY_MPZ from 
(select f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g
group by g.ar_no order by g.ar_no) pln_wge_cy,
(select V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_LY_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='LYFinYr') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no) actl_wge_ly where pln_wge_cy.ar_no=actl_wge_ly.ar_no]]>
	</PlannedLYWages>
	<PlannedLYWagesTotal>
	<![CDATA[Select pln_wge_cy.zone_no,
	CASE When pln_wge_cy.PLN_WAGE_CY_TOT_MPZ=0 and actl_wge_ly.ACTL_WAGE_LY_TOT_MPZ=0 Then 0 
	When pln_wge_cy.PLN_WAGE_CY_TOT_MPZ=0 Then -100 When actl_wge_ly.ACTL_WAGE_LY_TOT_MPZ=0 Then 100  
	ELSE ROUND(((pln_wge_cy.PLN_WAGE_CY_TOT_MPZ / actl_wge_ly.ACTL_WAGE_LY_TOT_MPZ)-1)*100,2) END as LY_PRCNT_WAGE_TOT_MPZ from
(select y.zone_no,ROUND(sum(y.PLN_WAGE_MPZ),0) as PLN_WAGE_CY_TOT_MPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*ere d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) pln_wge_cy,
(select x.zone_no,ROUND(sum(x.ACTL_WAGE_MPZ),0) as ACTL_WAGE_LY_TOT_MPZ from 
(select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='LYFinYr') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V
group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
group by x.zone_no order by x.zone_no) actl_wge_ly where pln_wge_cy.zone_no=actl_wge_ly.zone_no order by pln_wge_cy.zone_no]]>
	</PlannedLYWagesTotal>
</TCName>

<TCName name = "BudgetWagesPercentage_CurrentMonth">
	<BudgetWagesPercentage>
	<![CDATA[select bdgt_wge.ar_no,
	CASE When bdgt_wge.BDGT_WGE_MPZ=0 and bdgt_sls.BDGT_SLS_MPZ=0 Then 0 
	When bdgt_wge.BDGT_WGE_MPZ=0 Then 0 When bdgt_sls.BDGT_SLS_MPZ=0 Then 100  
	ELSE ROUND((bdgt_wge.BDGT_WGE_MPZ / bdgt_sls.BDGT_SLS_MPZ)*100,2) END as BDGT_WGE_PRCNT_MPZ from 
(select x.ar_no,ROUND(sum(x.BDGT_WGE_MPG),0) as BDGT_WGE_MPZ from 
(select f.ar_no,f.loc_nm,NVL(g.BDGT_WAGE_MPG,0) as BDGT_WGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_WAGE) as BDGT_WAGE_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (20)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm ) x
group by x.ar_no order by x.ar_no) bdgt_wge,
(select x.ar_no,ROUND(sum(x.BDGT_SLS_MPG),0) as BDGT_SLS_MPZ from 
(select f.ar_no,f.loc_nm,NVL(g.BDGT_SALES_MPG,0) as BDGT_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_SALES) as BDGT_SALES_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm ) x
group by x.ar_no order by x.ar_no) bdgt_sls where bdgt_wge.ar_no=bdgt_sls.ar_no order by bdgt_wge.ar_no]]>
	</BudgetWagesPercentage>
	<BudgetWagesPercentageTotal>
	<![CDATA[select bdgt_wge.zone_no,
	CASE When bdgt_wge.BDGT_WGE_TOT_MPZ=0 and bdgt_sls.BDGT_SLS_TOT_MPZ=0 Then 0 
	When bdgt_wge.BDGT_WGE_TOT_MPZ=0 Then 0 When bdgt_sls.BDGT_SLS_TOT_MPZ=0 Then 100  
	ELSE ROUND((bdgt_wge.BDGT_WGE_TOT_MPZ / bdgt_sls.BDGT_SLS_TOT_MPZ)*100,2) END as BDGT_WGE_PRCNT_TOT_MPZ from 
(select y.zone_no,ROUND(sum(y.BDGT_WGE_MPZ),0) as BDGT_WGE_TOT_MPZ from 
(select x.zone_no,x.ar_no,ROUND(sum(x.BDGT_WGE_MPG),0) as BDGT_WGE_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.BDGT_WAGE_MPG,0) as BDGT_WGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_WAGE) as BDGT_WAGE_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (20)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm ) x
group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no) y
group by y.zone_no order by y.zone_no) bdgt_wge,
(select y.zone_no,ROUND(sum(y.BDGT_SLS_MPZ),0) as BDGT_SLS_TOT_MPZ from 
(select x.zone_no,x.ar_no,ROUND(sum(x.BDGT_SLS_MPG),0) as BDGT_SLS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.BDGT_SALES_MPG,0) as BDGT_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_SALES) as BDGT_SALES_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm ) x
group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no) y
group by y.zone_no order by y.zone_no) bdgt_sls where bdgt_wge.zone_no=bdgt_sls.zone_no order by bdgt_wge.zone_no]]>
	</BudgetWagesPercentageTotal>
	<ForecastWagesPercentage>
	<![CDATA[select fcst_wge.ar_no,
	CASE When fcst_wge.fcst_WGE_MPZ=0 and FRCST_SLS.FRCST_SLS_MPZ=0 Then 0 
	When fcst_wge.fcst_WGE_MPZ=0 Then 0 When FRCST_SLS.FRCST_SLS_MPZ=0 Then 100  
	ELSE ROUND((fcst_wge.fcst_WGE_MPZ / FRCST_SLS.FRCST_SLS_MPZ)*100,2) END as fcst_WGE_PRCNT_MPZ from 
(select x.ar_no,ROUND(sum(x.fcst_WGE_MPG),0) as fcst_WGE_MPZ from 
(select f.ar_no,f.loc_nm,NVL(g.fcst_WAGE_MPG,0) as fcst_WGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(fcst_WAGE) as fcst_WAGE_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(FRCST_SLS) as fcst_SALES, sum(frcst_wage_amt) as fcst_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (20)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm ) x
group by x.ar_no order by x.ar_no) fcst_wge,
(select x.ar_no,ROUND(sum(x.FRCST_SLS_MPG),0) as FRCST_SLS_MPZ from 
(select f.ar_no,f.loc_nm,NVL(g.fcst_SALES_MPG,0) as FRCST_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(fcst_SALES) as fcst_SALES_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(FRCST_SLS) as fcst_SALES, sum(frcst_wage_amt) as fcst_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm ) x
group by x.ar_no order by x.ar_no) FRCST_SLS where fcst_wge.ar_no=FRCST_SLS.ar_no order by fcst_wge.ar_no]]>
	</ForecastWagesPercentage>
	<ForecastWagesPercentageTotal>
	<![CDATA[select fcst_wge.zone_no,
	CASE When fcst_wge.fcst_WGE_TOT_MPZ=0 and FRCST_SLS.FRCST_SLS_TOT_MPZ=0 Then 0 
	When fcst_wge.fcst_WGE_TOT_MPZ=0 Then 0 When FRCST_SLS.FRCST_SLS_TOT_MPZ=0 Then 100  
	ELSE ROUND((fcst_wge.fcst_WGE_TOT_MPZ / FRCST_SLS.FRCST_SLS_TOT_MPZ)*100,2) END as fcst_WGE_PRCNT_TOT_MPZ from 
(select y.zone_no,ROUND(sum(y.fcst_WGE_MPZ),0) as fcst_WGE_TOT_MPZ from 
(select x.zone_no,x.ar_no,ROUND(sum(x.fcst_WGE_MPG),0) as fcst_WGE_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.fcst_WAGE_MPG,0) as fcst_WGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(fcst_WAGE) as fcst_WAGE_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(FRCST_SLS) as fcst_SALES, sum(frcst_wage_amt) as fcst_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (20)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm ) x
group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no) y
group by y.zone_no order by y.zone_no) fcst_wge,
(select y.zone_no,ROUND(sum(y.FRCST_SLS_MPZ),0) as FRCST_SLS_TOT_MPZ from 
(select x.zone_no,x.ar_no,ROUND(sum(x.FRCST_SLS_MPG),0) as FRCST_SLS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.fcst_SALES_MPG,0) as FRCST_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(fcst_SALES) as fcst_SALES_MPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(FRCST_SLS) as fcst_SALES, sum(frcst_wage_amt) as fcst_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.loc_nm=g.loc_nm ) x
group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no) y
group by y.zone_no order by y.zone_no) FRCST_SLS where fcst_wge.zone_no=FRCST_SLS.zone_no order by fcst_wge.zone_no]]>
	</ForecastWagesPercentageTotal>
</TCName>

<TCName name = "PlannedWagesPercentage_CurrentMonth">
	<PlannedWagesPercentage>
	<![CDATA[select x.ar_no, 
	CASE When x.PLN_WAGE_MPZ=0 and y.PLN_SLS_MPZ=0 Then 0 
	When x.PLN_WAGE_MPZ=0 Then 0 When y.PLN_SLS_MPZ=0 Then 100  
	ELSE ROUND((x.PLN_WAGE_MPZ / y.PLN_SLS_MPZ)*100,2) END as PLN_WGE_PRCNT_MPZ from 
(select g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_MPZ from 
(select f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g
group by g.ar_no order by g.ar_no) x,
(select g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from 
(select f.ar_no,f.loc_nm,NVL(sum(e.PLAN_SALES),0) as PLN_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as PLAN_SALES 
from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id 
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id) c
UNION*/
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(a.SALES) as PLAN_SALES 
from WW_WLP.PLN_FCST_CMB_VW a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and a.proc_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.dept_no NOT IN (0,90,20) /*and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and a.wk_id=b.wk_id 
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' )*/
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e
on f.loc_nm=e.loc_nm group by f.ar_no,f.loc_nm order by f.ar_no) g
group by g.ar_no order by g.ar_no) y where x.ar_no=y.ar_no]]>
	</PlannedWagesPercentage>
	<PlannedWagesPercentageTotal>
	<![CDATA[select x.zone_no, 
	CASE When x.PLN_WAGE_TOT_MPZ=0 and y.PLN_SLS_TOT_WPZ=0 Then 0 
	When x.PLN_WAGE_TOT_MPZ=0 Then 0 When y.PLN_SLS_TOT_WPZ=0 Then 100  
	ELSE ROUND((x.PLN_WAGE_TOT_MPZ / y.PLN_SLS_TOT_WPZ)*100,2) END as PLN_TOT_WGE_PRCNT_MPZ from 
(select y.zone_no,ROUND(sum(y.PLN_WAGE_MPZ),0) as PLN_WAGE_TOT_MPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_WGE) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) x,
(select y.zone_no,ROUND(sum(y.PLN_SLS_MPZ),0) as PLN_SLS_TOT_WPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL((sum(e.PLAN_SALES)),0) as PLN_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as PLAN_SALES 
from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id 
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id) c
UNION*/
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(a.SALES) as PLAN_SALES 
from WW_WLP.PLN_FCST_CMB_VW a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and a.proc_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.dept_no NOT IN (0,90,20) /*and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and a.wk_id=b.wk_id 
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' )*/
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e
on f.loc_nm=e.loc_nm group by f.zone_no,f.ar_no,f.loc_nm order by f.zone_no,f.ar_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) y where x.zone_no=y.zone_no]]>
	</PlannedWagesPercentageTotal>
</TCName>

<TCName name = "LYWagesPercentage_CurrentMonth">
	<LYWagesPercentage>
	<![CDATA[select actl_wge_ly.ar_no,
	CASE When actl_wge_ly.ACTL_WAGE_LY_MPZ=0 and actl_sls_ly.ACTL_SLS_LY_MPZ=0 Then 0 
	When actl_wge_ly.ACTL_WAGE_LY_MPZ=0 Then 0 When actl_sls_ly.ACTL_SLS_LY_MPZ=0 Then 100  
	ELSE ROUND((actl_wge_ly.ACTL_WAGE_LY_MPZ / actl_sls_ly.ACTL_SLS_LY_MPZ)*100,2) END as LY_WAGE_PRCNT_MPZ from
(select V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_LY_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='LYFinYr') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no) actl_wge_ly,
(select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_LY_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no) actl_sls_ly where actl_wge_ly.ar_no=actl_sls_ly.ar_no]]>
	</LYWagesPercentage>
	<LYWagesPercentageTotal>
	<![CDATA[select actl_wge_ly.zone_no,
	CASE When actl_wge_ly.ACTL_WAGE_LY_TOT_MPZ=0 and actl_sls_ly.ACTL_SLS_LY_TOT_MPZ=0 Then 0 
	When actl_wge_ly.ACTL_WAGE_LY_TOT_MPZ=0 Then 0 When actl_sls_ly.ACTL_SLS_LY_TOT_MPZ=0 Then 100  
	ELSE ROUND((actl_wge_ly.ACTL_WAGE_LY_TOT_MPZ / actl_sls_ly.ACTL_SLS_LY_TOT_MPZ)*100,2) END as LY_WAGE_PRCNT_TOT_MPZ from
(select x.zone_no,ROUND(sum(x.ACTL_WAGE_MPZ),0) as ACTL_WAGE_LY_TOT_MPZ from 
(select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='LYFinYr') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V
group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
group by x.zone_no order by x.zone_no) actl_wge_ly,
(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_LY_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no) actl_sls_ly where actl_wge_ly.zone_no=actl_sls_ly.zone_no order by actl_wge_ly.zone_no ]]>
	</LYWagesPercentageTotal>
</TCName>

<TCName name = "SMSHours_CurrentMonth">
	<SMSHours>
	<![CDATA[select g.ar_no,NVL(ROUND(((ROUND(((sum(g.SMS_HRS_MPG)*100)/25),0)*25)/100),2),0) as SMS_HRS_MPZ from
(select x.ar_no,x.loc_nm,NVL(y.SMS_HOURS_MPS,0) as SMS_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) x
LEFT OUTER JOIN
(select C.loc_no,C.loc_nm,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPS from 
(select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
from ww_wlp.lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d 
where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
and d.dept_no!=20 and b.fin_wk_no='FinWeek' and fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') A
group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C
group by C.loc_no,C.loc_nm order by c.loc_no) y
on x.loc_nm=y.loc_nm order by x.loc_no) g
group by g.ar_no order by g.ar_no]]>
	</SMSHours>
	<SMSHoursTotal>
	<![CDATA[select y.zone_no,NVL(ROUND(((ROUND(((sum(y.SMS_HRS_MPZ)*100)/25),0)*25)/100),0),0) as SMS_HRS_TOT_MPZ from 
(select g.zone_no,g.ar_no,sum(g.SMS_HRS_MPG) as SMS_HRS_MPZ from
(select x.zone_no,x.ar_no,x.loc_nm,NVL(y.SMS_HOURS_MPS,0) as SMS_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) x
LEFT OUTER JOIN
(select C.loc_no,C.loc_nm,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPS from 
(select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
from ww_wlp.lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d 
where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
and d.dept_no!=20 and b.fin_wk_no='FinWeek' and fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') A
group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C
group by C.loc_no,C.loc_nm order by c.loc_no) y
on x.loc_nm=y.loc_nm order by x.zone_no,x.ar_no,x.loc_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no ]]>
	</SMSHoursTotal>
</TCName>

<TCName name = "PlannedHours_CurrentMonth">
	<PlannedHours>
	<![CDATA[select g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
(select f.ar_no,f.loc_nm,NVL(e.PLN_HRS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and c.ar_no= 'Area' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g
group by g.ar_no order by g.ar_no]]>
	</PlannedHours>
	<PlannedHoursTotal>
	<![CDATA[select y.zone_no,ROUND(sum(y.PLN_HRS_MPZ),0) as PLN_HRS_TOT_MPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_HRS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and c.ar_no= 'Area' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no]]>
	</PlannedHoursTotal>
</TCName>

<TCName name = "HoursLY_CurrentMonth">
	<HoursLY>
	<![CDATA[select pln_hrs_cy.ar_no,
	CASE When pln_hrs_cy.PLN_HRS_CY_MPZ=0 and actl_hrs_ly.ACTL_HRS_LY_MPZ=0 Then 0 
	When pln_hrs_cy.PLN_HRS_CY_MPZ=0 Then -100 When actl_hrs_ly.ACTL_HRS_LY_MPZ=0 Then 100  
	ELSE ROUND(((pln_hrs_cy.PLN_HRS_CY_MPZ / actl_hrs_ly.ACTL_HRS_LY_MPZ)-1)*100,0) END as LY_PRCNT_HRS_MPZ from 
(select g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_CY_MPZ from 
(select f.ar_no,f.loc_nm,NVL(e.PLN_HRS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g
group by g.ar_no order by g.ar_no) pln_hrs_cy,
(select V.ar_no,sum(V.ACTL_HRS_MPG) as ACTL_HRS_LY_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='LYFinYr') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no) actl_hrs_ly 
where pln_hrs_cy.ar_no=actl_hrs_ly.ar_no]]>
	</HoursLY>
	<HoursLYTotal>
	<![CDATA[select pln_hrs_cy.zone_no,
	CASE When pln_hrs_cy.PLN_HRS_CY_TOT_MPZ=0 and actl_hrs_ly.ACTL_HRS_LY_TOT_MPZ=0 Then 0 
	When pln_hrs_cy.PLN_HRS_CY_TOT_MPZ=0 Then -100 When actl_hrs_ly.ACTL_HRS_LY_TOT_MPZ=0 Then 100  	
	ELSE ROUND(((pln_hrs_cy.PLN_HRS_CY_TOT_MPZ / actl_hrs_ly.ACTL_HRS_LY_TOT_MPZ)-1)*100,0) END as LY_PRCNT_HRS_TOT_MPZ from 
(select y.zone_no,ROUND(sum(y.PLN_HRS_MPZ),0) as PLN_HRS_CY_TOT_MPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_HRS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) pln_hrs_cy,
(select x.zone_no,sum(x.ACTL_HRS_MPZ) as ACTL_HRS_LY_TOT_MPZ from 
(select V.zone_no,V.ar_no,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='LYFinYr') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V
group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x 
group by x.zone_no order by x.zone_no) actl_hrs_ly 
where pln_hrs_cy.zone_no=actl_hrs_ly.zone_no order by pln_hrs_cy.zone_no]]>
	</HoursLYTotal>
</TCName>

<TCName name = "PlannedOR_CurrentMonth">
	<plannedOR>
	<![CDATA[select sms_hrs.ar_no,
	CASE When sms_hrs.SMS_HRS_MPZ=0 and pln_hrs.PLN_HRS_MPZ=0 Then 0 
	When sms_hrs.SMS_HRS_MPZ=0 Then 0 When pln_hrs.PLN_HRS_MPZ=0 Then 100  
	ELSE ROUND((sms_hrs.SMS_HRS_MPZ / pln_hrs.PLN_HRS_MPZ)*100,2) END as PLN_OR_MPZ from 
(select g.ar_no,sum(g.SMS_HRS_MPG) as SMS_HRS_MPZ from
(select x.ar_no,x.loc_nm,NVL(y.SMS_HOURS_MPS,0) as SMS_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) x
LEFT OUTER JOIN
(select C.loc_no,C.loc_nm,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPS from 
(select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
from ww_wlp.lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d 
where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
and d.dept_no!=20 and b.fin_wk_no='FinWeek' and fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') A
group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C
group by C.loc_no,C.loc_nm order by c.loc_no) y
on x.loc_nm=y.loc_nm order by x.loc_no) g
group by g.ar_no order by g.ar_no) sms_hrs,
(select g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
(select f.ar_no,f.loc_nm,NVL(e.PLN_HRS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and c.ar_no= 'Area' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g
group by g.ar_no order by g.ar_no) pln_hrs where sms_hrs.ar_no=pln_hrs.ar_no]]>
	</plannedOR>
	<plannedORTotal>
	<![CDATA[select sms_hrs.zone_no,
	CASE When sms_hrs.SMS_HRS_TOT_MPZ=0 and pln_hrs.PLN_HRS_TOT_MPZ=0 Then 0 
	When sms_hrs.SMS_HRS_TOT_MPZ=0 Then 0 When pln_hrs.PLN_HRS_TOT_MPZ=0 Then 100  
	ELSE ROUND((sms_hrs.SMS_HRS_TOT_MPZ / pln_hrs.PLN_HRS_TOT_MPZ)*100,2) END as PLN_OR_TOT_MPZ from 
(select y.zone_no,sum(y.SMS_HRS_MPZ) as SMS_HRS_TOT_MPZ from 
(select g.zone_no,g.ar_no,sum(g.SMS_HRS_MPG) as SMS_HRS_MPZ from
(select x.zone_no,x.ar_no,x.loc_nm,NVL(y.SMS_HOURS_MPS,0) as SMS_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) x
LEFT OUTER JOIN
(select C.loc_no,C.loc_nm,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPS from 
(select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
from ww_wlp.lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d 
where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
and d.dept_no!=20 and b.fin_wk_no='FinWeek' and fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') A
group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C
group by C.loc_no,C.loc_nm order by c.loc_no) y
on x.loc_nm=y.loc_nm order by x.zone_no,x.ar_no,x.loc_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) sms_hrs,
(select y.zone_no,ROUND(sum(y.PLN_HRS_MPZ),0) as PLN_HRS_TOT_MPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_HRS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) pln_hrs where sms_hrs.zone_no=pln_hrs.zone_no order by sms_hrs.zone_no]]>
	</plannedORTotal>
</TCName>

<TCName name = "PlannedCPH_CurrentMonth">
	<PlannedCPH>
	<![CDATA[select pln_wge.ar_no,
	CASE When pln_wge.PLN_WAGE_MPZ=0 and pln_hrs.PLN_HRS_MPZ=0 Then 0 
	When pln_wge.PLN_WAGE_MPZ=0 Then 0 When pln_hrs.PLN_HRS_MPZ=0 Then 100  
	ELSE ROUND((pln_wge.PLN_WAGE_MPZ / pln_hrs.PLN_HRS_MPZ),2) END as PLN_CPH_MPG from 
(select g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_MPZ from 
(select f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g
group by g.ar_no order by g.ar_no) pln_wge
LEFT OUTER JOIN
(select g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
(select f.ar_no,f.loc_nm,NVL(e.PLN_HRS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and c.ar_no= 'Area' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g
group by g.ar_no order by g.ar_no) pln_hrs ON pln_wge.AR_NO=pln_hrs.AR_NO]]>
	</PlannedCPH>
	<PlannedCPHTotal>
	<![CDATA[select sms_hrs.zone_no,
	CASE When pln_hrs.PLN_WAGE_TOT_MPZ=0 and sms_hrs.PLN_HRS_TOT_MPZ=0 Then 0 
	When pln_hrs.PLN_WAGE_TOT_MPZ=0 Then 0 When sms_hrs.PLN_HRS_TOT_MPZ=0 Then 100  
	ELSE ROUND((pln_hrs.PLN_WAGE_TOT_MPZ / sms_hrs.PLN_HRS_TOT_MPZ),2) END as PLN_OR_TOT_MPZ from 
(select y.zone_no,ROUND(sum(y.PLN_HRS_MPZ),0) as PLN_HRS_TOT_MPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.BASE_HOURS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as BASE_HOURS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) sms_hrs
LEFT OUTER JOIN
(select y.zone_no,ROUND(sum(y.PLN_WAGE_MPZ),0) as PLN_WAGE_TOT_MPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.BASE_COST_MNTH_PLN_STR,0) as PLN_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as BASE_COST_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) pln_hrs ON sms_hrs.zone_no=pln_hrs.zone_no]]>
	</PlannedCPHTotal>
</TCName>

<TCName name = "GrowthLYCPH_CurrentMonth">
	<GrowthLYCPH>
	<![CDATA[select pln_cph_cy.ar_no,
	CASE When pln_cph_cy.PLN_CPH_CY_MPZ=0 and actl_cph_ly.ACTL_CPH_LY_MPZ=0 Then 0 
	When pln_cph_cy.PLN_CPH_CY_MPZ=0 Then -100 When actl_cph_ly.ACTL_CPH_LY_MPZ=0 Then 100  
	ELSE ROUND(((pln_cph_cy.PLN_CPH_CY_MPZ / actl_cph_ly.ACTL_CPH_LY_MPZ)-1)*100,2) END as GROWTH_LY_CPH_MPZ from 
(select pln_wge.ar_no,
CASE When pln_wge.PLN_WAGE_MPZ=0 and pln_hrs.PLN_HRS_MPZ=0 Then 0 
When pln_wge.PLN_WAGE_MPZ=0 Then 0 When pln_hrs.PLN_HRS_MPZ=0 Then 100  
ELSE ROUND((pln_wge.PLN_WAGE_MPZ / pln_hrs.PLN_HRS_MPZ),2) END as PLN_CPH_CY_MPZ from 
(select g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_MPZ from 
(select f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g
group by g.ar_no order by g.ar_no) pln_wge,
(select g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
(select f.ar_no,f.loc_nm,NVL(e.BASE_HOURS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as BASE_HOURS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d/* where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g
group by g.ar_no order by g.ar_no) pln_hrs where pln_wge.ar_no=pln_hrs.ar_no) pln_cph_cy,
(select x.ar_no,
CASE When x.ACTL_WAGE_MPZ=0 and x.ACTL_HRS_MPZ=0 Then 0 
When x.ACTL_WAGE_MPZ=0 Then 0 When x.ACTL_HRS_MPZ=0 Then 100  
ELSE ROUND((x.ACTL_WAGE_MPZ / x.ACTL_HRS_MPZ),2) END as ACTL_CPH_LY_MPZ from 
(select V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='LYFinYr') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no) x order by x.ar_no) actl_cph_ly where pln_cph_cy.ar_no=actl_cph_ly.ar_no]]>
	</GrowthLYCPH>
	<GrowthLYCPHTotal>
	<![CDATA[select pln_cph_cy.zone_no,
	CASE When pln_cph_cy.PLN_CPH_CY_TOT_MPZ=0 and actl_cph_ly.ACTL_CPH_LY_TOT_MPZ=0 Then 0 
	When pln_cph_cy.PLN_CPH_CY_TOT_MPZ=0 Then -100 When actl_cph_ly.ACTL_CPH_LY_TOT_MPZ=0 Then 100  
	ELSE ROUND(((pln_cph_cy.PLN_CPH_CY_TOT_MPZ / actl_cph_ly.ACTL_CPH_LY_TOT_MPZ)-1)*100,2) END as GROWTH_LY_CPH_TOT_MPZ from 
(select pln_wge.zone_no,
CASE When pln_wge.PLN_WAGE_TOT_MPZ=0 and pln_hrs.PLN_HRS_TOT_MPZ=0 Then 0 
When pln_wge.PLN_WAGE_TOT_MPZ=0 Then 0 When pln_hrs.PLN_HRS_TOT_MPZ=0 Then 100  
ELSE ROUND((pln_wge.PLN_WAGE_TOT_MPZ / pln_hrs.PLN_HRS_TOT_MPZ),2) END as PLN_CPH_CY_TOT_MPZ from 
(select y.zone_no,ROUND(sum(y.PLN_WAGE_MPZ),0) as PLN_WAGE_TOT_MPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) pln_wge,
(select y.zone_no,ROUND(sum(y.PLN_HRS_MPZ),0) as PLN_HRS_TOT_MPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_HRS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) pln_hrs where pln_wge.zone_no=pln_hrs.zone_no order by pln_wge.zone_no) pln_cph_cy,
(select x.zone_no,
CASE When x.ACTL_WAGE_TOT_MPZ=0 and x.ACTL_HRS_TOT_MPZ=0 Then 0 
When x.ACTL_WAGE_TOT_MPZ=0 Then 0 When x.ACTL_HRS_TOT_MPZ=0 Then 100  
ELSE ROUND((x.ACTL_WAGE_TOT_MPZ / x.ACTL_HRS_TOT_MPZ),2) END as ACTL_CPH_LY_TOT_MPZ from 
(select W.zone_no,sum(w.ACTL_WAGE_MPZ) as ACTL_WAGE_TOT_MPZ,sum(w.ACTL_HRS_MPZ) as ACTL_HRS_TOT_MPZ from 
(select V.zone_no,V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='LYFinYr') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) V
group by V.zone_no,V.ar_no order by V.ar_no,V.ar_no) W 
group by W.zone_no order by W.zone_no) x order by x.zone_no) actl_cph_ly where pln_cph_cy.zone_no=actl_cph_ly.zone_no order by pln_cph_cy.zone_no]]>
	</GrowthLYCPHTotal>
</TCName>

<TCName name = "PlannedItemPrice_CurrentMonth" >
	<PlannedItemPrice>
	<![CDATA[select x.ar_no,
	CASE When x.ACTL_SLS_MPZ=0 and x.ACTL_ITM_MPZ=0 Then 0 
	When x.ACTL_SLS_MPZ=0 Then 0 When x.ACTL_ITM_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_SLS_MPZ / x.ACTL_ITM_MPZ),2) END as ACTL_ITM_PRZ_MPZ from 
(select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.sales) as ACTL_SALES,sum(a.ITEMS) as ACTL_ITEMS from WW_WLP.PLN_FCST_CMB_VW a,WW_WLP.WK b, ww_wlp.loc c
where a.PROC_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no) x order by x.ar_no]]>
	</PlannedItemPrice>
	<PlannedItemPriceTotal>
	<![CDATA[select x.zone_no,
	CASE When x.ACTL_SLS_TOT_MPZ=0 and x.ACTL_ITM_TOT_MPZ=0 Then 0 
	When x.ACTL_SLS_TOT_MPZ=0 Then 0 When x.ACTL_ITM_TOT_MPZ=0 Then 100  
	ELSE ROUND((x.ACTL_SLS_TOT_MPZ / x.ACTL_ITM_TOT_MPZ),2) END as ACTL_ITM_PRZ_TOT_MPZ from 
(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ,ROUND(sum(K.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.SALES) as ACTL_SALES,sum(a.ITEMS) as ACTL_ITEMS from WW_WLP.PLN_FCST_CMB_VW a,WW_WLP.WK b, ww_wlp.loc c
where a.PROC_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no) x]]>
	</PlannedItemPriceTotal>
</TCName>

<TCName name = "PlannedItems_CurrentMonth" >
	<PlannedItems>
	<![CDATA[select J.ar_no,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ITEM) as ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.items) as ITEM from WW_WLP.PLN_FCST_CMB_VW a,WW_WLP.WK b, ww_wlp.loc c
where a.PROC_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no]]>
	</PlannedItems>
	<PlannedItemsTotal>
	<![CDATA[select K.zone_no,ROUND(sum(K.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ITEM) as ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.items) as ITEM from WW_WLP.PLN_FCST_CMB_VW a,WW_WLP.WK b, ww_wlp.loc c
where a.PROC_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no]]>
	</PlannedItemsTotal>
</TCName>

<TCName name = "PlannedIPLHitems_CurrentMonth" >
	<PlannedIPLHitems>
	<![CDATA[select PLN_HRS.ar_no,
	CASE When ITM.ACTL_ITM_MPZ=0 and PLN_HRS.PLN_HRS_MPZ=0 Then 0 
	When ITM.ACTL_ITM_MPZ=0 Then 0 When PLN_HRS.PLN_HRS_MPZ=0 Then 100  
	ELSE ROUND((ITM.ACTL_ITM_MPZ / PLN_HRS.PLN_HRS_MPZ),0) END as PLN_ITM_IPLH from
(select J.ar_no,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ITEM) as ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.items) as ITEM from WW_WLP.PLN_FCST_CMB_VW a,WW_WLP.WK b, ww_wlp.loc c
where a.PROC_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no) itm
LEFT OUTER JOIN
(select g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
(select f.ar_no,f.loc_nm,NVL(e.BASE_HOURS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as BASE_HOURS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g
group by g.ar_no order by g.ar_no) PLN_HRS on ITM.ar_no=PLN_HRS.ar_no]]>
	</PlannedIPLHitems>
	<PlannedIPLHitemsTotal>
	<![CDATA[select PLN_HRS.zone_no,
	CASE When ITM.ACTL_ITM_TOT_MPZ=0 and PLN_HRS.PLN_HRS_TOT_MPZ=0 Then 0 
	When ITM.ACTL_ITM_TOT_MPZ=0 Then 0 When PLN_HRS.PLN_HRS_TOT_MPZ=0 Then 100  
	ELSE ROUND((ITM.ACTL_ITM_TOT_MPZ / PLN_HRS.PLN_HRS_TOT_MPZ),0) END as PLN_ITM_IPLH from
(select K.zone_no,ROUND(sum(K.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ITEM) as ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.items) as ITEM from WW_WLP.PLN_FCST_CMB_VW a,WW_WLP.WK b, ww_wlp.loc c
where a.PROC_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no) itm
LEFT OUTER JOIN
(select y.zone_no,ROUND(sum(y.PLN_HRS_MPZ),0) as PLN_HRS_TOT_MPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.BASE_HOURS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear') d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as BASE_HOURS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and DEPT_NO NOT IN (20)) d /*where d.loc_no NOT IN (select a.loc_no from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear')*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) PLN_HRS on ITM.zone_no=PLN_HRS.zone_no]]>
	</PlannedIPLHitemsTotal>
</TCName>

<TCName name = "PlannedPercentOnLY_CurrentMonth" >
	<PlannedpercentonLY>
	<![CDATA[select pln_itm_prz_cy.ar_no,
	CASE When pln_itm_prz_cy.ACTL_ITM_PRZ_MPZ=0 and actl_itm_prz_ly.ACTL_ITM_PRZ_MPZ=0 Then 0 
	When pln_itm_prz_cy.ACTL_ITM_PRZ_MPZ=0 Then -100 When actl_itm_prz_ly.ACTL_ITM_PRZ_MPZ=0 Then 100  
	ELSE NVl(ROUND(((pln_itm_prz_cy.ACTL_ITM_PRZ_MPZ / actl_itm_prz_ly.ACTL_ITM_PRZ_MPZ)-1)*100,2),0) END as PLN_PRCNT_LY_ITM_PRZ_WPS from 
(select x.ar_no,
CASE When x.ACTL_SLS_MPZ=0 and x.ACTL_ITM_MPZ=0 Then 0 
When x.ACTL_SLS_MPZ=0 Then 0 When x.ACTL_ITM_MPZ=0 Then 100  
ELSE ROUND((x.ACTL_SLS_MPZ / x.ACTL_ITM_MPZ),9) END as ACTL_ITM_PRZ_MPZ from 
(select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.sales) as ACTL_SALES,sum(a.ITEMS) as ACTL_ITEMS from WW_WLP.PLN_FCST_CMB_VW a,WW_WLP.WK b, ww_wlp.loc c
where a.PROC_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no) x order by x.ar_no) pln_itm_prz_cy
LEFT OUTER JOIN
(select x.ar_no,
CASE When x.ACTL_SLS_MPZ=0 and x.ACTL_ITM_MPZ=0 Then 0 
When x.ACTL_SLS_MPZ=0 Then 0 When x.ACTL_ITM_MPZ=0 Then 100  
ELSE ROUND((x.ACTL_SLS_MPZ / x.ACTL_ITM_MPZ),9) END as ACTL_ITM_PRZ_MPZ from 
(select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.ar_no order by J.ar_no) x order by x.ar_no) actl_itm_prz_ly
ON pln_itm_prz_cy.ar_no=actl_itm_prz_ly.ar_no]]>
	</PlannedpercentonLY>
	<PlannedpercentonLYTotal>
	<![CDATA[select pln_itm_prz_cy.zone_no,
	CASE When pln_itm_prz_cy.ACTL_ITM_PRZ_TOT_MPZ=0 and actl_itm_prz_ly.ACTL_ITM_PRZ_TOT_MPZ=0 Then 0 
	When pln_itm_prz_cy.ACTL_ITM_PRZ_TOT_MPZ=0 Then -100 When actl_itm_prz_ly.ACTL_ITM_PRZ_TOT_MPZ=0 Then 100  
	ELSE ROUND(((pln_itm_prz_cy.ACTL_ITM_PRZ_TOT_MPZ / actl_itm_prz_ly.ACTL_ITM_PRZ_TOT_MPZ)-1)*100,2) END as PLN_PRCNT_LY_ITM_PRZ_TOT_WPS from 
(select x.zone_no,
CASE When x.ACTL_SLS_TOT_MPZ=0 and x.ACTL_ITM_TOT_MPZ=0 Then 0 
When x.ACTL_SLS_TOT_MPZ=0 Then 0 When x.ACTL_ITM_TOT_MPZ=0 Then 100  
ELSE ROUND((x.ACTL_SLS_TOT_MPZ / x.ACTL_ITM_TOT_MPZ),9) END as ACTL_ITM_PRZ_TOT_MPZ from 
(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ,ROUND(sum(K.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.SALES) as ACTL_SALES,sum(a.ITEMS) as ACTL_ITEMS from WW_WLP.PLN_FCST_CMB_VW a,WW_WLP.WK b, ww_wlp.loc c
where a.PROC_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no) x) pln_itm_prz_cy
LEFT OUTER JOIN
(select x.zone_no,
CASE When x.ACTL_SLS_TOT_MPZ=0 and x.ACTL_ITM_TOT_MPZ=0 Then 0 
When x.ACTL_SLS_TOT_MPZ=0 Then 0 When x.ACTL_ITM_TOT_MPZ=0 Then 100  
ELSE ROUND((x.ACTL_SLS_TOT_MPZ / x.ACTL_ITM_TOT_MPZ),9) END as ACTL_ITM_PRZ_TOT_MPZ from 
(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ,ROUND(sum(K.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from 
(select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from 
(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as ACTL_ITEMS from 
(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
where a.TXN_DTE between b.WK_STRT and b.WK_END
and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr' and a.loc_no=c.loc_no
and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
group by k.zone_no order by zone_no) x) actl_itm_prz_ly
ON pln_itm_prz_cy.zone_no=actl_itm_prz_ly.zone_no]]>
	</PlannedpercentonLYTotal>
</TCName>

<TCName name = "BGDT_FCST_OR_CurrentMonth" >
	<BudgetOR>
	<![CDATA[select src.ar_no,
case when (select datavalue from ADT_TRL_TOGGLE_BDGT_HOUR_OR where updtime in (select max(updtime) from ADT_TRL_TOGGLE_BDGT_HOUR_OR)) 
in ('Hide Budget Hour and OR%','Show Budget Hour Hide Budget OR%') then 0
else src.BDGT_OR_WPZ end as BDGT_OR_WPZ from 
(select x.ar_no,
	case when NVL(x.BDGT_SMS_WPZ,0)=0 and NVL(x.BDGT_HRS_WPZ,0)=0 then 0 
	when NVL(x.BDGT_SMS_WPZ,0)=0 then 0 when NVL(x.BDGT_HRS_WPZ,0)=0 then 100  
	else NVL(ROUND((x.BDGT_SMS_WPZ / x.BDGT_HRS_WPZ) * 100,2),0) end as BDGT_OR_WPZ from 
	(select f.ar_no,sum(g.BDGT_SMS_WPG) as BDGT_SMS_WPZ,sum(g.BDGT_HRS_WPG) as BDGT_HRS_WPZ from 
	(select distinct ar_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' order by ar_no) f
	LEFT OUTER JOIN
	(select C.ar_no,C.loc_no,C.loc_nm,sum(bdgt_sms_hrs) as BDGT_SMS_WPG,sum(bdgt_hrs) as BDGT_HRS_WPG from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,nvl(bdgt_sms_hrs,0) as bdgt_sms_hrs, nvl(bdgt_hrs,0) as bdgt_hrs 
	from WW_WLP.wky_bdgt a,loc b, wk d 
	where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' 
	and a.wk_id=d.wk_id and a.dept_no NOT IN (20)
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
	group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
	on f.ar_no=g.ar_no group by f.ar_no order by f.ar_no) x
	order by x.ar_no) src
order by src.ar_no

]]>
	</BudgetOR>
	<BudgetORTotal>
	<![CDATA[select src.zone_no,
case when (select datavalue from ADT_TRL_TOGGLE_BDGT_HOUR_OR where updtime in (select max(updtime) from ADT_TRL_TOGGLE_BDGT_HOUR_OR)) 
in ('Hide Budget Hour and OR%','Show Budget Hour Hide Budget OR%') then 0
else src.BDGT_OR_TOT_WPZ end as BDGT_OR_TOT_WPZ from 
(select x.zone_no,
	case when NVL(x.BDGT_SMS_TOT_WPZ,0)=0 and NVL(x.BDGT_HRS_TOT_WPZ,0)=0 then 0 
	when NVL(x.BDGT_SMS_TOT_WPZ,0)=0 then 0 when NVL(x.BDGT_HRS_TOT_WPZ,0)=0 then 100  
	else NVL(ROUND((x.BDGT_SMS_TOT_WPZ / x.BDGT_HRS_TOT_WPZ) * 100,2),0) end as BDGT_OR_TOT_WPZ from 
	(select f.zone_no,sum(g.BDGT_SMS_WPG) as BDGT_SMS_TOT_WPZ,sum(g.BDGT_HRS_WPG) as BDGT_HRS_TOT_WPZ from 
	(select distinct zone_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' order by zone_no) f
	LEFT OUTER JOIN
	(select C.zone_no,C.ar_no,sum(bdgt_sms_hrs) as BDGT_SMS_WPG,sum(bdgt_hrs) as BDGT_HRS_WPG from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,nvl(bdgt_sms_hrs,0) as bdgt_sms_hrs, nvl(bdgt_hrs,0) as bdgt_hrs 
	from WW_WLP.wky_bdgt a,loc b, wk d 
	where a.wk_id in (select wk_id from ww_wlp.wk where fin_wk_no='FinWeek' and fin_yr='FinYear') 
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' 
	and a.wk_id=d.wk_id and a.dept_no NOT IN (20)
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
	group by C.zone_no,C.ar_no order by C.zone_no,C.ar_no) g
	on f.zone_no=g.zone_no group by f.zone_no order by f.zone_no) x
	order by x.zone_no) src
order by src.zone_no
]]>
	</BudgetORTotal>
	
	<ForecastOR>
	<![CDATA[select sms_hrs.ar_no,
	CASE When sms_hrs.SMS_HRS_MPZ=0 and pln_hrs.PLN_HRS_MPZ=0 Then 0 
	When sms_hrs.SMS_HRS_MPZ=0 Then 0 When pln_hrs.PLN_HRS_MPZ=0 Then 100  
	ELSE ROUND((sms_hrs.SMS_HRS_MPZ / pln_hrs.PLN_HRS_MPZ)*100,0) END as PLN_OR_MPZ from 
	(select g.ar_no,sum(g.SMS_HRS_MPG) as SMS_HRS_MPZ from
	(select x.ar_no,x.loc_nm,NVL(y.SMS_HOURS_MPS,0) as SMS_HRS_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	order by div_no,rgn_no,zone_no,ar_no,loc_no) x
	LEFT OUTER JOIN
	(select C.loc_no,C.loc_nm,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPS from 
	(select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
	from ww_wlp.lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d 
	where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
	and d.dept_no!=20 and b.fin_wk_no='FinWeek' and fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') A
	group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C
	group by C.loc_no,C.loc_nm order by c.loc_no) y
	on x.loc_nm=y.loc_nm order by x.loc_no) g
	group by g.ar_no order by g.ar_no) sms_hrs,
	(select g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
	(select f.ar_no,f.loc_nm,NVL(e.PLN_HOURS_MPS,0) as PLN_HRS_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	order by div_no,rgn_no,zone_no,ar_no,loc_no) f
	LEFT OUTER JOIN
	(select d.loc_no,d.loc_nm,sum(d.plan_paid_hours) as PLN_HOURS_MPS from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,NVL(plan_paid_hours,0) as plan_paid_hours 
	from ww_wlp.mnth_fcst a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
	and DEPT_NO NOT IN (20)) d 
	group by d.loc_no,d.loc_nm order by d.loc_no) e on e.loc_nm=f.loc_nm order by f.loc_no) g
	group by g.ar_no order by g.ar_no) pln_hrs where sms_hrs.ar_no=pln_hrs.ar_no]]>
	</ForecastOR>
	<ForecastORTotal>
	<![CDATA[select sms_hrs.zone_no,
	CASE When sms_hrs.SMS_HRS_TOT_MPZ=0 and pln_hrs.PLN_HRS_TOT_MPZ=0 Then 0 
	When sms_hrs.SMS_HRS_TOT_MPZ=0 Then 0 When pln_hrs.PLN_HRS_TOT_MPZ=0 Then 100  
	ELSE ROUND((sms_hrs.SMS_HRS_TOT_MPZ / pln_hrs.PLN_HRS_TOT_MPZ)*100,0) END as PLN_OR_TOT_MPZ from 
	(select y.zone_no,sum(y.SMS_HRS_MPZ) as SMS_HRS_TOT_MPZ from 
	(select g.zone_no,g.ar_no,sum(g.SMS_HRS_MPG) as SMS_HRS_MPZ from
	(select x.zone_no,x.ar_no,x.loc_nm,NVL(y.SMS_HOURS_MPS,0) as SMS_HRS_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	order by div_no,rgn_no,zone_no,ar_no,loc_no) x
	LEFT OUTER JOIN
	(select C.loc_no,C.loc_nm,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPS from 
	(select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
	from ww_wlp.lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d 
	where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
	and d.dept_no!=20 and b.fin_wk_no='FinWeek' and fin_yr='FinYear' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') A
	group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C
	group by C.loc_no,C.loc_nm order by c.loc_no) y
	on x.loc_nm=y.loc_nm order by x.zone_no,x.ar_no,x.loc_no) g
	group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
	group by y.zone_no order by y.zone_no) sms_hrs,
	(select y.zone_no,ROUND(sum(y.PLN_HRS_MPZ),0) as PLN_HRS_TOT_MPZ from 
	(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
	(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_HOURS_MPS,0) as PLN_HRS_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	order by div_no,rgn_no,zone_no,ar_no,loc_no) f
	LEFT OUTER JOIN
	(select d.loc_no,d.loc_nm,sum(d.plan_paid_hours) as PLN_HOURS_MPS from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,NVL(plan_paid_hours,0) as plan_paid_hours
	from ww_wlp.mnth_fcst a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
	and DEPT_NO NOT IN (20)) d 
	group by d.loc_no,d.loc_nm order by d.loc_no) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
	group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
	group by y.zone_no order by y.zone_no) pln_hrs where sms_hrs.zone_no=pln_hrs.zone_no order by sms_hrs.zone_no]]>
	</ForecastORTotal>
</TCName>

<TCName name="MonthlyViewMetricsValidation">  
<Sales>
<![CDATA[select f.fin_wk_no,NVL(e.PLAN_SALES,0) as PLN_SLS_WTSZ from 
	(select distinct wk_id,fin_wk_no from ww_wlp.wk where perd_desc='Month' order by wk_id) f
	LEFT OUTER JOIN 
    (select z.wk_id,sum(PLAN_SALES) as PLAN_SALES from 
    (select * from 
    (select b.wk_id,a.loc_no,ROUND(sum(a.mgr_wky_sls),0) as PLAN_SALES 
    from ww_wlp.mgr_wky_pln a,wk b 
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
    group by b.wk_id,a.loc_no order by b.wk_id,a.loc_no) c 
    UNION 
    select * from 
    (select b.wk_id,a.loc_no,Round(sum(gnrt_sls),0) as GEN_SALES 
    from ww_wlp.fcst a,wk b
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.dept_no NOT IN (0,20,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
  and (a.loc_no,b.wk_id) NOT IN
	(select loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
	group by b.wk_id,a.loc_no order by b.wk_id,a.loc_no) d) z 
    group by z.wk_id order by z.wk_id) e 
    on f.wk_id=e.wk_id order by f.wk_id]]>
</Sales>
<SalesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(sum(e.PLN_SLS_WTSZ),0),0) as PLN_SLS_TOT_WTSZ from 
	(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
    (select f.perd_desc,f.fin_wk_no,NVL(e.PLAN_SALES,0) as PLN_SLS_WTSZ from 
	(select distinct perd_desc,wk_id,fin_wk_no from ww_wlp.wk where perd_desc='Month' order by wk_id) f
	LEFT OUTER JOIN 
    (select z.perd_desc,z.wk_id,sum(PLAN_SALES) as PLAN_SALES from 
    (select * from 
    (select b.perd_desc,b.wk_id,a.loc_no,ROUND(sum(a.mgr_wky_sls),0) as PLAN_SALES 
    from ww_wlp.mgr_wky_pln a,wk b 
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
    group by b.perd_desc,b.wk_id,a.loc_no order by b.perd_desc,b.wk_id,a.loc_no) c 
    UNION 
    select * from 
    (select b.perd_desc,b.wk_id,a.loc_no,Round(sum(gnrt_sls),0) as GEN_SALES 
    from ww_wlp.fcst a,wk b
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.dept_no NOT IN (0,20,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
  and (a.loc_no,b.wk_id) NOT IN
	(select loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
	group by b.perd_desc,b.wk_id,a.loc_no order by b.perd_desc,b.wk_id,a.loc_no) d) z 
    group by z.perd_desc,z.wk_id order by z.perd_desc,z.wk_id) e 
    on f.perd_desc=e.perd_desc and f.wk_id=e.wk_id order by f.perd_desc,f.wk_id) e 
    on lc.perd_desc=e.perd_desc group by lc.perd_desc order by lc.perd_desc]]>
</SalesTotal>

<Wages>
<![CDATA[select lc.fin_wk_no,NVL(e.PLN_WAGE_WTSZ,0) as PLN_WGE_WTSZ from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
	LEFT OUTER JOIN 
  (select z.wk_id,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSZ from 
  (select * from (select d.wk_id,d.ar_no,ROUND(sum(d.MGR_WKY_WGE),0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id,d.ar_no order by d.wk_id,d.ar_no) 
  UNION 
  select * from (select d.wk_id,d.ar_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20)
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id,d.ar_no order by d.wk_id,d.ar_no)) z
  group by z.wk_id order by z.wk_id) e 
  on e.wk_id=lc.wk_id order by lc.wk_id]]>
</Wages>
<WagesTotal>
<![CDATA[select lc.perd_desc,NVL(e.PLN_WAGE_WTSZ,0) as PLN_WGE_TOT_WTSZ from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSZ from 
  (select * from (select d.perd_desc,d.ar_no,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.ar_no order by d.perd_desc,d.ar_no) 
  UNION 
  select * from (select d.perd_desc,d.ar_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c/* , loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20)
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.ar_no order by d.perd_desc,d.ar_no)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc]]>
</WagesTotal>

<WagePercentage>
<![CDATA[select pln_wge.fin_wk_no,
	case when NVL(pln_wge.PLN_WGE_WTSZ,0)=0 and NVL(pln_sls.PLN_SLS_WTSZ,0)=0 then 0 
	when NVL(pln_wge.PLN_WGE_WTSZ,0)=0 then 0 when NVL(pln_sls.PLN_SLS_WTSZ,0)=0 then 100  
	else ROUND((pln_wge.PLN_WGE_WTSZ / pln_sls.PLN_SLS_WTSZ)*100,2) end as PLN_WGE_PCT_WTSZ from 
  (select lc.fin_wk_no,NVL(e.PLN_WAGE_WTSZ,0) as PLN_WGE_WTSZ from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
	LEFT OUTER JOIN 
  (select z.wk_id,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSZ from 
  (select * from (select d.wk_id,d.ar_no,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id,d.ar_no order by d.wk_id,d.ar_no) 
  UNION 
  select * from (select d.wk_id,d.ar_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id,d.ar_no order by d.wk_id,d.ar_no)) z
  group by z.wk_id order by z.wk_id) e 
  on e.wk_id=lc.wk_id order by lc.wk_id) pln_wge,
  (select f.fin_wk_no,NVL(e.PLAN_SALES,0) as PLN_SLS_WTSZ from 
	(select distinct wk_id,fin_wk_no from ww_wlp.wk where perd_desc='Month' order by wk_id) f
	LEFT OUTER JOIN 
    (select z.wk_id,sum(PLAN_SALES) as PLAN_SALES from 
    (select * from 
    (select b.wk_id,a.loc_no,ROUND(sum(a.mgr_wky_sls),0) as PLAN_SALES 
    from ww_wlp.mgr_wky_pln a,wk b 
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
    group by b.wk_id,a.loc_no order by b.wk_id,a.loc_no) c 
    UNION 
    select * from 
    (select b.wk_id,a.loc_no,Round(sum(gnrt_sls),0) as GEN_SALES 
    from ww_wlp.fcst a,wk b
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.dept_no NOT IN (0,20,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
  and (a.loc_no,b.wk_id) NOT IN
	(select loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
	group by b.wk_id,a.loc_no order by b.wk_id,a.loc_no) d) z 
    group by z.wk_id order by z.wk_id) e 
    on f.wk_id=e.wk_id order by f.wk_id) pln_sls 
  where pln_wge.fin_wk_no=pln_sls.fin_wk_no order by pln_wge.fin_wk_no]]>
</WagePercentage>
<WagePercentageTotal>
<![CDATA[select 'Total' as Tot,
	case when NVL(pln_wge.PLN_WGE_TOT_WTSZ,0)=0 and NVL(pln_sls.PLN_SLS_TOT_WTSZ,0)=0 then 0 
	when NVL(pln_wge.PLN_WGE_TOT_WTSZ,0)=0 then 0 when NVL(pln_sls.PLN_SLS_TOT_WTSZ,0)=0 then 100  
	else ROUND((pln_wge.PLN_WGE_TOT_WTSZ / pln_sls.PLN_SLS_TOT_WTSZ)*100,2) end as PLN_WGE_PCT_TOT_WTSZ from 
  (select lc.perd_desc,NVL(e.PLN_WAGE_WTSZ,0) as PLN_WGE_TOT_WTSZ from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSZ from 
  (select * from (select d.perd_desc,d.ar_no,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.ar_no order by d.perd_desc,d.ar_no) 
  UNION 
  select * from (select d.perd_desc,d.ar_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.ar_no order by d.perd_desc,d.ar_no)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc) pln_wge,
	(select lc.perd_desc,NVL(ROUND(e.PLAN_SALES,0),0) as PLN_SLS_TOT_WTSZ from 
	(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
    (select z.perd_desc,sum(PLAN_SALES) as PLAN_SALES from 
    (select * from 
    (select b.perd_desc,a.loc_no,ROUND(sum(a.mgr_wky_sls),0) as PLAN_SALES 
    from ww_wlp.mgr_wky_pln a,wk b 
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
    group by b.perd_desc,a.loc_no order by b.perd_desc,a.loc_no) c 
    UNION 
    select * from 
    (select b.perd_desc,a.loc_no,ROUND(sum(gnrt_sls),0) as GEN_SALES 
    from ww_wlp.fcst a,wk b
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.dept_no NOT IN (0,20,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
  and (a.loc_no,b.wk_id) NOT IN
	(select loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
	group by b.perd_desc,a.loc_no order by b.perd_desc,a.loc_no) d) z 
    group by z.perd_desc order by z.perd_desc) e 
    on lc.perd_desc=e.perd_desc order by lc.perd_desc) pln_sls 
  where pln_wge.perd_desc=pln_sls.perd_desc order by pln_wge.perd_desc]]>
</WagePercentageTotal>

<CPHValue>
<![CDATA[select pln_wge.fin_wk_no,
	case when NVL(pln_wge.PLN_WGE_WTSZ,0)=0 and NVL(pln_hrs.PLN_HRS_WTSZ,0)=0 then 0 
	when NVL(pln_wge.PLN_WGE_WTSZ,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_WTSZ,0)=0 then 100  
	else ROUND((pln_wge.PLN_WGE_WTSZ / pln_hrs.PLN_HRS_WTSZ),2) end as PLN_CPH_WTSZ from 
  (select lc.fin_wk_no,NVL(e.PLN_WAGE_WTSZ,0) as PLN_WGE_WTSZ from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
	LEFT OUTER JOIN 
  (select z.wk_id,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSZ from 
  (select * from (select d.wk_id,d.ar_no,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id,d.ar_no order by d.wk_id,d.ar_no) 
  UNION 
  select * from (select d.wk_id,d.ar_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id,d.ar_no order by d.wk_id,d.ar_no)) z
  group by z.wk_id order by z.wk_id) e 
  on e.wk_id=lc.wk_id order by lc.wk_id) pln_wge,
  (select lc.fin_wk_no,NVL(e.PLN_HOURS_WTSZ,0) as PLN_HRS_WTSZ from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
	LEFT OUTER JOIN 
  (select z.wk_id,sum(PLN_HOURS_WTSZ) as PLN_HOURS_WTSZ from 
  (select * from (select d.wk_id,d.ar_no,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_WTSZ from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id,d.ar_no order by d.wk_id,d.ar_no) 
  UNION 
  select * from (select d.wk_id,d.ar_no,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_WTSZ from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id,d.ar_no order by d.wk_id,d.ar_no)) z
  group by z.wk_id order by z.wk_id) e 
  on e.wk_id=lc.wk_id order by lc.wk_id) pln_hrs 
  where pln_wge.fin_wk_no=pln_hrs.fin_wk_no order by pln_wge.fin_wk_no]]>
</CPHValue>
<CPHTotal>
<![CDATA[select 'Total' as Tot,
	case when NVL(pln_wge.PLN_WGE_TOT_WTSZ,0)=0 and NVL(pln_hrs.PLN_HRS_TOT_WTSZ,0)=0 then 0 
	when NVL(pln_wge.PLN_WGE_TOT_WTSZ,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_TOT_WTSZ,0)=0 then 100  
	else ROUND((pln_wge.PLN_WGE_TOT_WTSZ / pln_hrs.PLN_HRS_TOT_WTSZ),2) end as PLN_CPH_TOT_WTSZ from 
  (select lc.perd_desc,NVL(e.PLN_WAGE_WTSZ,0) as PLN_WGE_TOT_WTSZ from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSZ from 
  (select * from (select d.perd_desc,d.ar_no,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.ar_no order by d.perd_desc,d.ar_no) 
  UNION 
  select * from (select d.perd_desc,d.ar_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.ar_no order by d.perd_desc,d.ar_no)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc) pln_wge,
  (select lc.perd_desc,NVL(e.PLN_HOURS_WTSZ,0) as PLN_HRS_TOT_WTSZ from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_HOURS_WTSZ) as PLN_HOURS_WTSZ from 
  (select * from (select d.perd_desc,d.ar_no,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_WTSZ from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.ar_no order by d.perd_desc,d.ar_no) 
  UNION 
  select * from (select d.perd_desc,d.ar_no,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_WTSZ from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.ar_no order by d.perd_desc,d.ar_no)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc) pln_hrs 
  where pln_wge.perd_desc=pln_hrs.perd_desc order by pln_wge.perd_desc]]>
</CPHTotal>

<PlanPaidHours>
<![CDATA[select lc.fin_wk_no,NVL(e.PLN_HOURS_WTSZ,0) as PLN_HRS_WTSZ from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
	LEFT OUTER JOIN 
  (select z.wk_id,sum(PLN_HOURS_MPS) as PLN_HOURS_WTSZ from 
  (select * from (select d.wk_id,d.ar_no,ROUND(sum(d.MGR_WKY_HRS),2) as PLN_HOURS_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id,d.ar_no order by d.wk_id,d.ar_no) 
  UNION 
  select * from (select d.wk_id,d.ar_no,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),2) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20)
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id,d.ar_no order by d.wk_id,d.ar_no)) z
  group by z.wk_id order by z.wk_id) e 
  on e.wk_id=lc.wk_id order by lc.wk_id]]>
</PlanPaidHours>
<PlanPaidHoursTotal>
<![CDATA[select lc.perd_desc,NVL(e.PLN_HOURS_WTSZ,0) as PLN_HRS_TOT_WTSZ from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_HOURS_MPS) as PLN_HOURS_WTSZ from 
  (select * from (select d.perd_desc,d.ar_no,ROUND(sum(d.MGR_WKY_HRS),2) as PLN_HOURS_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.ar_no order by d.perd_desc,d.ar_no) 
  UNION 
  select * from (select d.perd_desc,d.ar_no,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),2) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c/* , loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20)
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.ar_no order by d.perd_desc,d.ar_no)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc]]>
</PlanPaidHoursTotal>

<ORPercentage>
<![CDATA[select sms_hrs.fin_wk_no,
	case when NVL(sms_hrs.SMS_HRS_WTSZ,0)=0 and NVL(pln_hrs.PLN_HRS_WTSZ,0)=0 then 0 
	when NVL(sms_hrs.SMS_HRS_WTSZ,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_WTSZ,0)=0 then 100  
	else ROUND((sms_hrs.SMS_HRS_WTSZ / pln_hrs.PLN_HRS_WTSZ)*100,1) end as PLN_OR_WTSZ from 
	(select lc.fin_wk_no,NVL(y.SMS_HOURS_WTSZ,0) as SMS_HRS_WTSZ from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
  LEFT OUTER JOIN
	(select C.wk_id,sum(C.SMS_HOURS_WTSZ) as SMS_HOURS_WTSZ from 
  (select a.wk_id,a.ar_no,NVL(ROUND(((ROUND((((sum(fix_hrs) + Sum(vol_hrs))*100)/25),9)*25)/100),9),0) as SMS_HOURS_WTSZ from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,
	a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
  from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d /*,loc_dept ld */
	where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no and d.dept_no!=20 
  and b.perd_desc in ('Month') and c.div_no='Division' and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone')
  /*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no*/ ) A
	group by a.wk_id,a.ar_no order by a.wk_id,a.ar_no) C 
  group by C.wk_id order by c.wk_id) y
	on lc.wk_id=y.wk_id order by lc.wk_id)sms_hrs,
	(select lc.fin_wk_no,NVL(e.PLN_HOURS_WTSZ,0) as PLN_HRS_WTSZ from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
	LEFT OUTER JOIN 
  (select z.wk_id,sum(PLN_HOURS_WTSZ) as PLN_HOURS_WTSZ from 
  (select * from (select d.wk_id,d.ar_no,ROUND(sum(d.MGR_WKY_HRS),9) as PLN_HOURS_WTSZ from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id,d.ar_no order by d.wk_id,d.ar_no) 
  UNION 
  select * from (select d.wk_id,d.ar_no,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_WTSZ from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id,d.ar_no order by d.wk_id,d.ar_no)) z
  group by z.wk_id order by z.wk_id) e 
  on e.wk_id=lc.wk_id order by lc.wk_id) pln_hrs 
	where sms_hrs.fin_wk_no=pln_hrs.fin_wk_no order by sms_hrs.fin_wk_no]]>
</ORPercentage>
<ORPercentageTotal>
<![CDATA[select 'Total' as Tot,
	case when NVL(sms_hrs.SMS_HRS_TOT_WTSZ,0)=0 and NVL(pln_hrs.PLN_HRS_TOT_WTSZ,0)=0 then 0 
	when NVL(sms_hrs.SMS_HRS_TOT_WTSZ,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_TOT_WTSZ,0)=0 then 100  
	else ROUND((sms_hrs.SMS_HRS_TOT_WTSZ / pln_hrs.PLN_HRS_TOT_WTSZ)*100,1) end as PLN_OR_TOT_WTSZ from 
	(select lc.perd_desc,NVL(y.SMS_HOURS_TOT_WTSZ,0) as SMS_HRS_TOT_WTSZ from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
  LEFT OUTER JOIN
	(select C.perd_desc,sum(C.SMS_HOURS_WTSZ) as SMS_HOURS_TOT_WTSZ from 
  (select a.perd_desc,a.ar_no,NVL(ROUND(((ROUND((((sum(fix_hrs) + Sum(vol_hrs))*100)/25),0)*25)/100),2),0) as SMS_HOURS_WTSZ from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,
	a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
  from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d /*,loc_dept ld */
	where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no and d.dept_no!=20 
  and b.perd_desc in ('Month') and c.div_no='Division' and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone')
  /*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no*/ ) A
	group by a.perd_desc,a.ar_no order by a.perd_desc,a.ar_no) C 
  group by C.perd_desc order by c.perd_desc) y
	on lc.perd_desc=y.perd_desc order by lc.perd_desc)sms_hrs,
	(select lc.perd_desc,NVL(e.PLN_HOURS_WTSZ,0) as PLN_HRS_TOT_WTSZ from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_HOURS_WTSZ) as PLN_HOURS_WTSZ from 
  (select * from (select d.perd_desc,d.ar_no,ROUND(sum(d.MGR_WKY_HRS),0) as PLN_HOURS_WTSZ from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.ar_no order by d.perd_desc,d.ar_no) 
  UNION 
  select * from (select d.perd_desc,d.ar_no,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_WTSZ from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.ar_no order by d.perd_desc,d.ar_no)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc) pln_hrs 
	where sms_hrs.perd_desc=pln_hrs.perd_desc order by sms_hrs.perd_desc]]>
</ORPercentageTotal>
</TCName>


<TCName name = "PlannedBudgetAndForecastRate" >
/*	<PlannedBudgetRate>
	<![CDATA[select rslt.ar_no,sum(OVERSPENT_BDGT_RATE_WPS) as OVERSPENT_BDGT_RATE_WPZ from 
(select src.div_no,src.rgn_no,src.zone_no,src.ar_no,src.loc_nm,src.dept_nm,
case 
when src.PLN_SLS_WPS > src.BDGT_SLS_WPS 
then NVL(ROUND((src.PLN_WGE_WPS - ((((src.PST_FACTOR_WPS * src.BDGT_WGE_PCT_WPS) * (src.PLN_SLS_WPS - src.BDGT_SLS_WPS)) + src.BDGT_WGE_WPS))),0),0)
When src.PLN_SLS_WPS < src.BDGT_SLS_WPS 
then NVL(ROUND((src.PLN_WGE_WPS - ((((src.NGT_FACTOR_WPS * src.BDGT_WGE_PCT_WPS) * (src.PLN_SLS_WPS - src.BDGT_SLS_WPS)) + src.BDGT_WGE_WPS))),0),0)
else NVL(ROUND((src.PLN_WGE_WPS - src.BDGT_WGE_WPS),0),0)
end as OVERSPENT_BDGT_RATE_WPS from 
(select a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.dept_nm,b.wk_id,
a.PLN_WGE_WPS,b.PST_FACTOR_WPS,b.NGT_FACTOR_WPS,c.BDGT_WGE_PCT_WPS,d.PLN_SLS_WPS,c.BDGT_WGE_WPS,C.BDGT_SLS_WPS from

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_no,lc.loc_nm,lc.dept_no,lc.dply_seq,lc.dept_nm,
NVL(pln_wge.pln_wge_wps,0) as PLN_WGE_WPS,NVL(pln_wge.pln_hrs_wps,0) as PLN_HRS_WPS from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,c.dply_seq,c.dept_nm from loc_dept a,loc b, dept c
where a.div_no=b.div_no and a.loc_no=b.loc_no 
and a.div_no='Division' and b.rgn_no='Region' and b.zone_no in ('Zone') and b.wlp_live_ind in ('Y','N') and a.dept_no not in (20)
and a.div_no=c.div_no and a.dept_no=c.dept_no
and b.div_no=c.div_no
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,c.dply_seq) lc
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm, b.wk_id,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HRS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq,b.wk_id) pln_wge
on lc.div_no=pln_wge.div_no and lc.rgn_no=pln_wge.rgn_no and lc.zone_no=pln_wge.zone_no and lc.ar_no=pln_wge.ar_no and lc.loc_no=pln_wge.loc_no
and lc.loc_nm=pln_wge.loc_nm and lc.dept_no=pln_wge.dept_no and lc.dply_seq=pln_wge.dply_seq and lc.dept_nm=pln_wge.dept_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,lc.dply_seq) a,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_WPS,NVL(src.ngt_factor,1) as NGT_FACTOR_WPS from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99,'Region') group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) b,

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_no,lc.loc_nm,lc.dept_no,lc.dply_seq,lc.dept_nm,
NVL(bdgt_wge_pct.bdgt_wge_wps,0) as BDGT_WGE_WPS,NVL(bdgt_wge_pct.bdgt_sls_wps,0) as BDGT_SLS_WPS,NVL(bdgt_wge_pct.BDGT_WGE_PCT_WPS,0) as BDGT_WGE_PCT_WPS from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,c.dply_seq,c.dept_nm from loc_dept a,loc b, dept c
where a.div_no=b.div_no and a.loc_no=b.loc_no 
and a.div_no='Division' and b.rgn_no='Region' and b.zone_no in ('Zone') and b.wlp_live_ind in ('Y','N') and a.dept_no not in (20)
and a.div_no=c.div_no and a.dept_no=c.dept_no
and b.div_no=c.div_no
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,c.dply_seq) lc
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
NVL(ROUND(a.bdgt_wage_amt,0),0) as BDGT_WGE_WPS, NVL(ROUND(a.bdgt_sls,0),0) as BDGT_SLS_WPS,
case when nvl(a.bdgt_wage_amt,0)=0 and nvl(a.bdgt_sls,0)=0 then 0 
when nvl(a.bdgt_wage_amt,0)=0 then 0 when nvl(a.bdgt_sls,0)=0 then 0 
else ROUND((a.bdgt_wage_amt / a.bdgt_sls)*100,2) end as BDGT_WGE_PCT_WPS
from ww_wlp.wky_bdgt a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85)
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq) bdgt_wge_pct
on lc.div_no=bdgt_wge_pct.div_no and lc.rgn_no=bdgt_wge_pct.rgn_no and lc.zone_no=bdgt_wge_pct.zone_no and lc.ar_no=bdgt_wge_pct.ar_no and lc.loc_no=bdgt_wge_pct.loc_no
and lc.loc_nm=bdgt_wge_pct.loc_nm and lc.dept_no=bdgt_wge_pct.dept_no and lc.dply_seq=bdgt_wge_pct.dply_seq and lc.dept_nm=bdgt_wge_pct.dept_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,lc.dply_seq) c,

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_no,lc.loc_nm,lc.dept_no,lc.dply_seq,lc.dept_nm,
NVL(pln_sls.PLN_SLS_WPS,0) as PLN_SLS_WPS from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,c.dply_seq,c.dept_nm from loc_dept a,loc b, dept c
where a.div_no=b.div_no and a.loc_no=b.loc_no 
and a.div_no='Division' and b.rgn_no='Region' and b.zone_no in ('Zone') and b.wlp_live_ind in ('Y','N') and a.dept_no not in (20)
and a.div_no=c.div_no and a.dept_no=c.dept_no
and b.div_no=c.div_no
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,c.dply_seq) lc
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dept_no,e.dply_seq,e.dept_nm,sum(e.PLN_SLS_WPS) as PLN_SLS_WPS from  
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLN_SLS_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SLS_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,85)
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select loc_no,dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLN_SLS_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq,mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq) d ) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dept_no,e.dply_seq,e.dept_nm
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq) pln_sls
on lc.div_no=pln_sls.div_no and lc.rgn_no=pln_sls.rgn_no and lc.zone_no=pln_sls.zone_no and lc.ar_no=pln_sls.ar_no and lc.loc_no=pln_sls.loc_no
and lc.loc_nm=pln_sls.loc_nm and lc.dept_no=pln_sls.dept_no and lc.dply_seq=pln_sls.dply_seq and lc.dept_nm=pln_sls.dept_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,lc.dply_seq) d

where a.loc_nm=c.loc_nm and a.loc_nm=d.loc_nm and c.loc_nm=d.loc_nm
and a.dept_nm=c.dept_nm and a.dept_nm=d.dept_nm and c.dept_nm=d.dept_nm) src) rslt
group by rslt.ar_no order by rslt.ar_no]]>
	</PlannedBudgetRate>
	<PlannedBudgetRateTotal>
	<![CDATA[select rslt.zone_no,sum(OVERSPENT_BDGT_RATE_WPS) as OVERSPENT_BDGT_RATE_TOT_WPZ from 
(select src.div_no,src.rgn_no,src.zone_no,src.ar_no,src.loc_nm,src.dept_nm,
case 
when src.PLN_SLS_WPS > src.BDGT_SLS_WPS 
then NVL(ROUND((src.PLN_WGE_WPS - ((((src.PST_FACTOR_WPS * src.BDGT_WGE_PCT_WPS) * (src.PLN_SLS_WPS - src.BDGT_SLS_WPS)) + src.BDGT_WGE_WPS))),0),0)
When src.PLN_SLS_WPS < src.BDGT_SLS_WPS 
then NVL(ROUND((src.PLN_WGE_WPS - ((((src.NGT_FACTOR_WPS * src.BDGT_WGE_PCT_WPS) * (src.PLN_SLS_WPS - src.BDGT_SLS_WPS)) + src.BDGT_WGE_WPS))),0),0)
else NVL(ROUND((src.PLN_WGE_WPS - src.BDGT_WGE_WPS),0),0)
end as OVERSPENT_BDGT_RATE_WPS from 
(select a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.dept_nm,b.wk_id,
a.PLN_WGE_WPS,b.PST_FACTOR_WPS,b.NGT_FACTOR_WPS,c.BDGT_WGE_PCT_WPS,d.PLN_SLS_WPS,c.BDGT_WGE_WPS,C.BDGT_SLS_WPS from

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_no,lc.loc_nm,lc.dept_no,lc.dply_seq,lc.dept_nm,
NVL(pln_wge.pln_wge_wps,0) as PLN_WGE_WPS,NVL(pln_wge.pln_hrs_wps,0) as PLN_HRS_WPS from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,c.dply_seq,c.dept_nm from loc_dept a,loc b, dept c
where a.div_no=b.div_no and a.loc_no=b.loc_no 
and a.div_no='Division' and b.rgn_no='Region' and b.zone_no in ('Zone') and b.wlp_live_ind in ('Y','N') and a.dept_no not in (20)
and a.div_no=c.div_no and a.dept_no=c.dept_no
and b.div_no=c.div_no
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,c.dply_seq) lc
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm, b.wk_id,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HRS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq,b.wk_id) pln_wge
on lc.div_no=pln_wge.div_no and lc.rgn_no=pln_wge.rgn_no and lc.zone_no=pln_wge.zone_no and lc.ar_no=pln_wge.ar_no and lc.loc_no=pln_wge.loc_no
and lc.loc_nm=pln_wge.loc_nm and lc.dept_no=pln_wge.dept_no and lc.dply_seq=pln_wge.dply_seq and lc.dept_nm=pln_wge.dept_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,lc.dply_seq) a,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_WPS,NVL(src.ngt_factor,1) as NGT_FACTOR_WPS from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99,'Region') group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) b,

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_no,lc.loc_nm,lc.dept_no,lc.dply_seq,lc.dept_nm,
NVL(bdgt_wge_pct.bdgt_wge_wps,0) as BDGT_WGE_WPS,NVL(bdgt_wge_pct.bdgt_sls_wps,0) as BDGT_SLS_WPS,NVL(bdgt_wge_pct.BDGT_WGE_PCT_WPS,0) as BDGT_WGE_PCT_WPS from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,c.dply_seq,c.dept_nm from loc_dept a,loc b, dept c
where a.div_no=b.div_no and a.loc_no=b.loc_no 
and a.div_no='Division' and b.rgn_no='Region' and b.zone_no in ('Zone') and b.wlp_live_ind in ('Y','N') and a.dept_no not in (20)
and a.div_no=c.div_no and a.dept_no=c.dept_no
and b.div_no=c.div_no
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,c.dply_seq) lc
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
NVL(ROUND(a.bdgt_wage_amt,0),0) as BDGT_WGE_WPS, NVL(ROUND(a.bdgt_sls,0),0) as BDGT_SLS_WPS,
case when nvl(a.bdgt_wage_amt,0)=0 and nvl(a.bdgt_sls,0)=0 then 0 
when nvl(a.bdgt_wage_amt,0)=0 then 0 when nvl(a.bdgt_sls,0)=0 then 0 
else ROUND((a.bdgt_wage_amt / a.bdgt_sls)*100,2) end as BDGT_WGE_PCT_WPS
from ww_wlp.wky_bdgt a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85)
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq) bdgt_wge_pct
on lc.div_no=bdgt_wge_pct.div_no and lc.rgn_no=bdgt_wge_pct.rgn_no and lc.zone_no=bdgt_wge_pct.zone_no and lc.ar_no=bdgt_wge_pct.ar_no and lc.loc_no=bdgt_wge_pct.loc_no
and lc.loc_nm=bdgt_wge_pct.loc_nm and lc.dept_no=bdgt_wge_pct.dept_no and lc.dply_seq=bdgt_wge_pct.dply_seq and lc.dept_nm=bdgt_wge_pct.dept_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,lc.dply_seq) c,

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_no,lc.loc_nm,lc.dept_no,lc.dply_seq,lc.dept_nm,
NVL(pln_sls.PLN_SLS_WPS,0) as PLN_SLS_WPS from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,c.dply_seq,c.dept_nm from loc_dept a,loc b, dept c
where a.div_no=b.div_no and a.loc_no=b.loc_no 
and a.div_no='Division' and b.rgn_no='Region' and b.zone_no in ('Zone') and b.wlp_live_ind in ('Y','N') and a.dept_no not in (20)
and a.div_no=c.div_no and a.dept_no=c.dept_no
and b.div_no=c.div_no
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,c.dply_seq) lc
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dept_no,e.dply_seq,e.dept_nm,sum(e.PLN_SLS_WPS) as PLN_SLS_WPS from  
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLN_SLS_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SLS_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,85)
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select loc_no,dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLN_SLS_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq,mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq) d ) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dept_no,e.dply_seq,e.dept_nm
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq) pln_sls
on lc.div_no=pln_sls.div_no and lc.rgn_no=pln_sls.rgn_no and lc.zone_no=pln_sls.zone_no and lc.ar_no=pln_sls.ar_no and lc.loc_no=pln_sls.loc_no
and lc.loc_nm=pln_sls.loc_nm and lc.dept_no=pln_sls.dept_no and lc.dply_seq=pln_sls.dply_seq and lc.dept_nm=pln_sls.dept_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,lc.dply_seq) d

where a.loc_nm=c.loc_nm and a.loc_nm=d.loc_nm and c.loc_nm=d.loc_nm
and a.dept_nm=c.dept_nm and a.dept_nm=d.dept_nm and c.dept_nm=d.dept_nm) src) rslt
group by rslt.zone_no order by rslt.zone_no]]>
	</PlannedBudgetRateTotal>
	<PlannedForecsatRate>
	<![CDATA[select rslt.ar_no,sum(OVERSPENT_FRCST_RATE_WPS) as OVERSPENT_FRCST_RATE_WPZ from 
(select src.div_no,src.rgn_no,src.zone_no,src.ar_no,src.loc_nm,src.dept_nm,
case 
when src.PLN_SLS_WPS > src.FRCST_SLS_WPS 
then NVL(ROUND((src.PLN_WGE_WPS - ((((src.PST_FACTOR_WPS * src.FRCST_WGE_PCT_WPS) * (src.PLN_SLS_WPS - src.FRCST_SLS_WPS)) + src.FRCST_WGE_WPS))),0),0)
When src.PLN_SLS_WPS < src.FRCST_SLS_WPS 
then NVL(ROUND((src.PLN_WGE_WPS - ((((src.NGT_FACTOR_WPS * src.FRCST_WGE_PCT_WPS) * (src.PLN_SLS_WPS - src.FRCST_SLS_WPS)) + src.FRCST_WGE_WPS))),0),0)
else NVL(ROUND((src.PLN_WGE_WPS - src.FRCST_WGE_WPS),0),0)
end as OVERSPENT_FRCST_RATE_WPS from 
(select a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.dept_nm,b.wk_id,
a.PLN_WGE_WPS,b.PST_FACTOR_WPS,b.NGT_FACTOR_WPS,c.FRCST_WGE_PCT_WPS,d.PLN_SLS_WPS,c.FRCST_WGE_WPS,C.FRCST_SLS_WPS from

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_no,lc.loc_nm,lc.dept_no,lc.dply_seq,lc.dept_nm,
NVL(pln_wge.pln_wge_wps,0) as PLN_WGE_WPS,NVL(pln_wge.pln_hrs_wps,0) as PLN_HRS_WPS from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,c.dply_seq,c.dept_nm from loc_dept a,loc b, dept c
where a.div_no=b.div_no and a.loc_no=b.loc_no 
and a.div_no='Division' and b.rgn_no='Region' and b.zone_no in ('Zone') and b.wlp_live_ind in ('Y','N') and a.dept_no not in (20)
and a.div_no=c.div_no and a.dept_no=c.dept_no
and b.div_no=c.div_no
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,c.dply_seq) lc
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm, b.wk_id,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HRS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq,b.wk_id) pln_wge
on lc.div_no=pln_wge.div_no and lc.rgn_no=pln_wge.rgn_no and lc.zone_no=pln_wge.zone_no and lc.ar_no=pln_wge.ar_no and lc.loc_no=pln_wge.loc_no
and lc.loc_nm=pln_wge.loc_nm and lc.dept_no=pln_wge.dept_no and lc.dply_seq=pln_wge.dply_seq and lc.dept_nm=pln_wge.dept_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,lc.dply_seq) a,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_WPS,NVL(src.ngt_factor,1) as NGT_FACTOR_WPS from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99,'Region') group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) b,

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_no,lc.loc_nm,lc.dept_no,lc.dply_seq,lc.dept_nm,
NVL(FRCST_wge_pct.FRCST_wge_wps,0) as FRCST_WGE_WPS,NVL(FRCST_wge_pct.FRCST_sls_wps,0) as FRCST_SLS_WPS,NVL(FRCST_wge_pct.FRCST_WGE_PCT_WPS,0) as FRCST_WGE_PCT_WPS from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,c.dply_seq,c.dept_nm from loc_dept a,loc b, dept c
where a.div_no=b.div_no and a.loc_no=b.loc_no 
and a.div_no='Division' and b.rgn_no='Region' and b.zone_no in ('Zone') and b.wlp_live_ind in ('Y','N') and a.dept_no not in (20)
and a.div_no=c.div_no and a.dept_no=c.dept_no
and b.div_no=c.div_no
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,c.dply_seq) lc
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
NVL(ROUND(a.FRCST_wage_amt,0),0) as FRCST_WGE_WPS, NVL(ROUND(a.FRCST_sls,0),0) as FRCST_SLS_WPS,
case when nvl(a.FRCST_wage_amt,0)=0 and nvl(a.FRCST_sls,0)=0 then 0 
when nvl(a.FRCST_wage_amt,0)=0 then 0 when nvl(a.FRCST_sls,0)=0 then 0 
else ROUND((a.FRCST_wage_amt / a.FRCST_sls)*100,2) end as FRCST_WGE_PCT_WPS
from ww_wlp.mnth_fcst a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85)
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq) FRCST_wge_pct
on lc.div_no=FRCST_wge_pct.div_no and lc.rgn_no=FRCST_wge_pct.rgn_no and lc.zone_no=FRCST_wge_pct.zone_no and lc.ar_no=FRCST_wge_pct.ar_no and lc.loc_no=FRCST_wge_pct.loc_no
and lc.loc_nm=FRCST_wge_pct.loc_nm and lc.dept_no=FRCST_wge_pct.dept_no and lc.dply_seq=FRCST_wge_pct.dply_seq and lc.dept_nm=FRCST_wge_pct.dept_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,lc.dply_seq) c,

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_no,lc.loc_nm,lc.dept_no,lc.dply_seq,lc.dept_nm,
NVL(pln_sls.PLN_SLS_WPS,0) as PLN_SLS_WPS from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,c.dply_seq,c.dept_nm from loc_dept a,loc b, dept c
where a.div_no=b.div_no and a.loc_no=b.loc_no 
and a.div_no='Division' and b.rgn_no='Region' and b.zone_no in ('Zone') and b.wlp_live_ind in ('Y','N') and a.dept_no not in (20)
and a.div_no=c.div_no and a.dept_no=c.dept_no
and b.div_no=c.div_no
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,c.dply_seq) lc
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dept_no,e.dply_seq,e.dept_nm,sum(e.PLN_SLS_WPS) as PLN_SLS_WPS from  
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLN_SLS_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SLS_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,85)
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select loc_no,dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLN_SLS_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq,mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq) d ) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dept_no,e.dply_seq,e.dept_nm
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq) pln_sls
on lc.div_no=pln_sls.div_no and lc.rgn_no=pln_sls.rgn_no and lc.zone_no=pln_sls.zone_no and lc.ar_no=pln_sls.ar_no and lc.loc_no=pln_sls.loc_no
and lc.loc_nm=pln_sls.loc_nm and lc.dept_no=pln_sls.dept_no and lc.dply_seq=pln_sls.dply_seq and lc.dept_nm=pln_sls.dept_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,lc.dply_seq) d

where a.loc_nm=c.loc_nm and a.loc_nm=d.loc_nm and c.loc_nm=d.loc_nm
and a.dept_nm=c.dept_nm and a.dept_nm=d.dept_nm and c.dept_nm=d.dept_nm) src) rslt
group by rslt.ar_no order by rslt.ar_no]]>
	</PlannedForecsatRate>
	<PlannedForecsatRateTotal>
	<![CDATA[select rslt.zone_no,sum(OVERSPENT_FRCST_RATE_WPS) as OVERSPENT_FRCST_RATE_TOT_WPZ from 
(select src.div_no,src.rgn_no,src.zone_no,src.ar_no,src.loc_nm,src.dept_nm,
case 
when src.PLN_SLS_WPS > src.FRCST_SLS_WPS 
then NVL(ROUND((src.PLN_WGE_WPS - ((((src.PST_FACTOR_WPS * src.FRCST_WGE_PCT_WPS) * (src.PLN_SLS_WPS - src.FRCST_SLS_WPS)) + src.FRCST_WGE_WPS))),0),0)
When src.PLN_SLS_WPS < src.FRCST_SLS_WPS 
then NVL(ROUND((src.PLN_WGE_WPS - ((((src.NGT_FACTOR_WPS * src.FRCST_WGE_PCT_WPS) * (src.PLN_SLS_WPS - src.FRCST_SLS_WPS)) + src.FRCST_WGE_WPS))),0),0)
else NVL(ROUND((src.PLN_WGE_WPS - src.FRCST_WGE_WPS),0),0)
end as OVERSPENT_FRCST_RATE_WPS from 
(select a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.dept_nm,b.wk_id,
a.PLN_WGE_WPS,b.PST_FACTOR_WPS,b.NGT_FACTOR_WPS,c.FRCST_WGE_PCT_WPS,d.PLN_SLS_WPS,c.FRCST_WGE_WPS,C.FRCST_SLS_WPS from

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_no,lc.loc_nm,lc.dept_no,lc.dply_seq,lc.dept_nm,
NVL(pln_wge.pln_wge_wps,0) as PLN_WGE_WPS,NVL(pln_wge.pln_hrs_wps,0) as PLN_HRS_WPS from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,c.dply_seq,c.dept_nm from loc_dept a,loc b, dept c
where a.div_no=b.div_no and a.loc_no=b.loc_no 
and a.div_no='Division' and b.rgn_no='Region' and b.zone_no in ('Zone') and b.wlp_live_ind in ('Y','N') and a.dept_no not in (20)
and a.div_no=c.div_no and a.dept_no=c.dept_no
and b.div_no=c.div_no
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,c.dply_seq) lc
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm, b.wk_id,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HRS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq,b.wk_id) pln_wge
on lc.div_no=pln_wge.div_no and lc.rgn_no=pln_wge.rgn_no and lc.zone_no=pln_wge.zone_no and lc.ar_no=pln_wge.ar_no and lc.loc_no=pln_wge.loc_no
and lc.loc_nm=pln_wge.loc_nm and lc.dept_no=pln_wge.dept_no and lc.dply_seq=pln_wge.dply_seq and lc.dept_nm=pln_wge.dept_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,lc.dply_seq) a,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_WPS,NVL(src.ngt_factor,1) as NGT_FACTOR_WPS from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99,'Region') group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) b,

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_no,lc.loc_nm,lc.dept_no,lc.dply_seq,lc.dept_nm,
NVL(FRCST_wge_pct.FRCST_wge_wps,0) as FRCST_WGE_WPS,NVL(FRCST_wge_pct.FRCST_sls_wps,0) as FRCST_SLS_WPS,NVL(FRCST_wge_pct.FRCST_WGE_PCT_WPS,0) as FRCST_WGE_PCT_WPS from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,c.dply_seq,c.dept_nm from loc_dept a,loc b, dept c
where a.div_no=b.div_no and a.loc_no=b.loc_no 
and a.div_no='Division' and b.rgn_no='Region' and b.zone_no in ('Zone') and b.wlp_live_ind in ('Y','N') and a.dept_no not in (20)
and a.div_no=c.div_no and a.dept_no=c.dept_no
and b.div_no=c.div_no
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,c.dply_seq) lc
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
NVL(ROUND(a.FRCST_wage_amt,0),0) as FRCST_WGE_WPS, NVL(ROUND(a.FRCST_sls,0),0) as FRCST_SLS_WPS,
case when nvl(a.FRCST_wage_amt,0)=0 and nvl(a.FRCST_sls,0)=0 then 0 
when nvl(a.FRCST_wage_amt,0)=0 then 0 when nvl(a.FRCST_sls,0)=0 then 0 
else ROUND((a.FRCST_wage_amt / a.FRCST_sls)*100,2) end as FRCST_WGE_PCT_WPS
from ww_wlp.mnth_fcst a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85)
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq) FRCST_wge_pct
on lc.div_no=FRCST_wge_pct.div_no and lc.rgn_no=FRCST_wge_pct.rgn_no and lc.zone_no=FRCST_wge_pct.zone_no and lc.ar_no=FRCST_wge_pct.ar_no and lc.loc_no=FRCST_wge_pct.loc_no
and lc.loc_nm=FRCST_wge_pct.loc_nm and lc.dept_no=FRCST_wge_pct.dept_no and lc.dply_seq=FRCST_wge_pct.dply_seq and lc.dept_nm=FRCST_wge_pct.dept_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,lc.dply_seq) c,

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_no,lc.loc_nm,lc.dept_no,lc.dply_seq,lc.dept_nm,
NVL(pln_sls.PLN_SLS_WPS,0) as PLN_SLS_WPS from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,c.dply_seq,c.dept_nm from loc_dept a,loc b, dept c
where a.div_no=b.div_no and a.loc_no=b.loc_no 
and a.div_no='Division' and b.rgn_no='Region' and b.zone_no in ('Zone') and b.wlp_live_ind in ('Y','N') and a.dept_no not in (20)
and a.div_no=c.div_no and a.dept_no=c.dept_no
and b.div_no=c.div_no
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,c.dply_seq) lc
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dept_no,e.dply_seq,e.dept_nm,sum(e.PLN_SLS_WPS) as PLN_SLS_WPS from  
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLN_SLS_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SLS_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,85)
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select loc_no,dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLN_SLS_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone') and wlp_live_ind in ('Y','N') )
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,85)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq,mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,d.dply_seq) d ) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dept_no,e.dply_seq,e.dept_nm
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq) pln_sls
on lc.div_no=pln_sls.div_no and lc.rgn_no=pln_sls.rgn_no and lc.zone_no=pln_sls.zone_no and lc.ar_no=pln_sls.ar_no and lc.loc_no=pln_sls.loc_no
and lc.loc_nm=pln_sls.loc_nm and lc.dept_no=pln_sls.dept_no and lc.dply_seq=pln_sls.dply_seq and lc.dept_nm=pln_sls.dept_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,lc.dply_seq) d

where a.loc_nm=c.loc_nm and a.loc_nm=d.loc_nm and c.loc_nm=d.loc_nm
and a.dept_nm=c.dept_nm and a.dept_nm=d.dept_nm and c.dept_nm=d.dept_nm) src) rslt
group by rslt.zone_no order by rslt.zone_no]]>
	</PlannedForecsatRateTotal> */
</TCName>

<TCName name = "PlannedBDGTRate_CurrentMonth" >
	<PositiveFactor>
	<![CDATA[select PST_FACTOR_WPS from 
(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_WPS,NVL(src.ngt_factor,1) as NGT_FACTOR_WPS from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) order by wk_id]]>
	</PositiveFactor>
<NegativeFactor>
	<![CDATA[select NGT_FACTOR_WPS from 
(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_WPS,NVL(src.ngt_factor,1) as NGT_FACTOR_WPS from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) order by wk_id]]>
	</NegativeFactor>
</TCName>

</configuration>

