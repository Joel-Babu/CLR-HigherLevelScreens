<?xml version="1.0" encoding="UTF-8"?>

<configuration>

<TCName name = "SalesHistoryFirstMonth_WeekData">
	<SalesHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select S.perd_desc,S.wk_id,S.ACTL_SALES from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90)
	group by b.perd_desc,b.wk_id order by b.wk_id) S) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</SalesHistoryWeekData>
	/*
	<SalesHistoryTotalWeekData>
	<![CDATA[select J.loc_nm,ROUND(sum(J.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from (select T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_SALES from 
	(select lc.loc_nm,b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b,loc lc where a.TXN_DTE between b.WK_STRT 
	and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) and a.loc_no=lc.loc_no
	group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm]]>
	</SalesHistoryTotalWeekData>   */
</TCName>

<TCName name = "SalesHistorySecondMonth_WeekData">
	<SalesHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select S.perd_desc,S.wk_id,S.ACTL_SALES from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90)
	group by b.perd_desc,b.wk_id order by b.wk_id) S) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</SalesHistoryWeekData>
	/*
	<SalesHistoryTotalWeekData>
	<![CDATA[select J.loc_nm,ROUND(sum(J.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from (select T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_SALES from 
	(select lc.loc_nm,b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b,loc lc where a.TXN_DTE between b.WK_STRT 
	and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) and a.loc_no=lc.loc_no
	group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm]]>
	</SalesHistoryTotalWeekData>   */
</TCName>

<TCName name = "SalesHistoryThirdMonth_WeekData">
	<SalesHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select S.perd_desc,S.wk_id,S.ACTL_SALES from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90)
	group by b.perd_desc,b.wk_id order by b.wk_id) S) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</SalesHistoryWeekData>
	/*
	<SalesHistoryTotalWeekData>
	<![CDATA[select J.loc_nm,ROUND(sum(J.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from (select T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_SALES from 
	(select lc.loc_nm,b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b,loc lc where a.TXN_DTE between b.WK_STRT 
	and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) and a.loc_no=lc.loc_no
	group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm]]>
	</SalesHistoryTotalWeekData>   */
</TCName>

<TCName name = "SalesHistoryFourthMonth_WeekData">
	<SalesHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select S.perd_desc,S.wk_id,S.ACTL_SALES from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90)
	group by b.perd_desc,b.wk_id order by b.wk_id) S) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</SalesHistoryWeekData>
	/*
	<SalesHistoryTotalWeekData>
	<![CDATA[select J.loc_nm,ROUND(sum(J.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from (select T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_SALES from 
	(select lc.loc_nm,b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b,loc lc where a.TXN_DTE between b.WK_STRT 
	and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) and a.loc_no=lc.loc_no
	group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm]]>
	</SalesHistoryTotalWeekData>   */
</TCName>

<TCName name = "ItemsHistoryFirsthMonth_WeekData">
	<ItemsHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(U.ACTL_ITM,0) as ACTL_ITM_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select S.perd_desc,S.wk_id,S.ACTL_ITM from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITM from WW_WLP.DLY_SLS a,WW_WLP.WK b
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90)
	group by b.perd_desc,b.wk_id order by b.wk_id) S) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</ItemsHistoryWeekData>
	/*
	<ItemHistoryTotalWeekData>
	<![CDATA[select J.loc_nm,ROUND(sum(J.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from (select T.loc_nm,NVL(U.ACTL_ITM,0) as ACTL_ITM_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_ITM from (select lc.loc_nm,b.perd_desc,b.wk_id,
	ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITM from WW_WLP.DLY_SLS a,WW_WLP.WK b, loc lc where a.TXN_DTE between b.WK_STRT and b.WK_END
	and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) and a.loc_no=lc.loc_no
	group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm]]>
	</ItemHistoryTotalWeekData>   */
</TCName>

<TCName name = "ItemsHistorySecondMonth_WeekData">
	<ItemsHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(U.ACTL_ITM,0) as ACTL_ITM_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select S.perd_desc,S.wk_id,S.ACTL_ITM from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITM from WW_WLP.DLY_SLS a,WW_WLP.WK b
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90)
	group by b.perd_desc,b.wk_id order by b.wk_id) S) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</ItemsHistoryWeekData>
	/*
	<ItemHistoryTotalWeekData>
	<![CDATA[select J.loc_nm,ROUND(sum(J.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from (select T.loc_nm,NVL(U.ACTL_ITM,0) as ACTL_ITM_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_ITM from (select lc.loc_nm,b.perd_desc,b.wk_id,
	ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITM from WW_WLP.DLY_SLS a,WW_WLP.WK b, loc lc where a.TXN_DTE between b.WK_STRT and b.WK_END
	and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) and a.loc_no=lc.loc_no
	group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm]]>
	</ItemHistoryTotalWeekData>   */
</TCName>

<TCName name = "ItemsHistoryThirdMonth_WeekData">
	<ItemsHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(U.ACTL_ITM,0) as ACTL_ITM_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select S.perd_desc,S.wk_id,S.ACTL_ITM from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITM from WW_WLP.DLY_SLS a,WW_WLP.WK b
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90)
	group by b.perd_desc,b.wk_id order by b.wk_id) S) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</ItemsHistoryWeekData>
	/*
	<ItemHistoryTotalWeekData>
	<![CDATA[select J.loc_nm,ROUND(sum(J.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from (select T.loc_nm,NVL(U.ACTL_ITM,0) as ACTL_ITM_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_ITM from (select lc.loc_nm,b.perd_desc,b.wk_id,
	ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITM from WW_WLP.DLY_SLS a,WW_WLP.WK b, loc lc where a.TXN_DTE between b.WK_STRT and b.WK_END
	and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) and a.loc_no=lc.loc_no
	group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm]]>
	</ItemHistoryTotalWeekData>   */
</TCName>

<TCName name = "ItemsHistoryFourthMonth_WeekData">
	<ItemsHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(U.ACTL_ITM,0) as ACTL_ITM_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select S.perd_desc,S.wk_id,S.ACTL_ITM from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITM from WW_WLP.DLY_SLS a,WW_WLP.WK b
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90)
	group by b.perd_desc,b.wk_id order by b.wk_id) S) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</ItemsHistoryWeekData>
	/*
	<ItemHistoryTotalWeekData>
	<![CDATA[select J.loc_nm,ROUND(sum(J.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from (select T.loc_nm,NVL(U.ACTL_ITM,0) as ACTL_ITM_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_ITM from (select lc.loc_nm,b.perd_desc,b.wk_id,
	ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITM from WW_WLP.DLY_SLS a,WW_WLP.WK b, loc lc where a.TXN_DTE between b.WK_STRT and b.WK_END
	and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) and a.loc_no=lc.loc_no
	group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm]]>
	</ItemHistoryTotalWeekData>   */
</TCName>

<TCName name = "CustomersHistoryFirsthMonth_WeekData">
	<CustomerHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(U.ACTL_CUST,0) as ACTL_CUST_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select S.perd_desc,S.wk_id,S.ACTL_CUST from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_cust_cnt),0) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no IN (90)
	group by b.perd_desc,b.wk_id order by b.wk_id) S) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</CustomerHistoryWeekData>
	/*
	<CustomersHistoryTotalWeekData>
	<![CDATA[select J.loc_nm,ROUND(sum(J.ACTL_CUST_MPZ),0) as ACTL_CUST_TOT_MPZ from (select T.loc_nm,NVL(U.ACTL_CUST,0) as ACTL_CUST_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_CUST from 
	(select lc.loc_nm,b.perd_desc,b.wk_id, ROUND(sum(a.actl_cust_cnt),0) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b,loc lc
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no IN (90)
	and a.loc_no=lc.loc_no group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm]]>
	</CustomersHistoryTotalWeekData>   */
</TCName>

<TCName name = "CustomersHistorySecondMonth_WeekData">
	<CustomerHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(U.ACTL_CUST,0) as ACTL_CUST_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select S.perd_desc,S.wk_id,S.ACTL_CUST from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_cust_cnt),0) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no IN (90)
	group by b.perd_desc,b.wk_id order by b.wk_id) S) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</CustomerHistoryWeekData>
	/*
	<CustomersHistoryTotalWeekData>
	<![CDATA[select J.loc_nm,ROUND(sum(J.ACTL_CUST_MPZ),0) as ACTL_CUST_TOT_MPZ from (select T.loc_nm,NVL(U.ACTL_CUST,0) as ACTL_CUST_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_CUST from 
	(select lc.loc_nm,b.perd_desc,b.wk_id, ROUND(sum(a.actl_cust_cnt),0) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b,loc lc
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no IN (90)
	and a.loc_no=lc.loc_no group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm]]>
	</CustomersHistoryTotalWeekData>   */
</TCName>

<TCName name = "CustomersHistoryThirdMonth_WeekData">
	<CustomerHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(U.ACTL_CUST,0) as ACTL_CUST_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select S.perd_desc,S.wk_id,S.ACTL_CUST from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_cust_cnt),0) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no IN (90)
	group by b.perd_desc,b.wk_id order by b.wk_id) S) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</CustomerHistoryWeekData>
	/*
	<CustomersHistoryTotalWeekData>
	<![CDATA[select J.loc_nm,ROUND(sum(J.ACTL_CUST_MPZ),0) as ACTL_CUST_TOT_MPZ from (select T.loc_nm,NVL(U.ACTL_CUST,0) as ACTL_CUST_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_CUST from 
	(select lc.loc_nm,b.perd_desc,b.wk_id, ROUND(sum(a.actl_cust_cnt),0) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b,loc lc
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no IN (90)
	and a.loc_no=lc.loc_no group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm]]>
	</CustomersHistoryTotalWeekData>   */
</TCName>

<TCName name = "CustomersHistoryFourthMonth_WeekData">
	<CustomerHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(U.ACTL_CUST,0) as ACTL_CUST_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select S.perd_desc,S.wk_id,S.ACTL_CUST from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_cust_cnt),0) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no IN (90)
	group by b.perd_desc,b.wk_id order by b.wk_id) S) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</CustomerHistoryWeekData>
	/*
	<CustomersHistoryTotalWeekData>
	<![CDATA[select J.loc_nm,ROUND(sum(J.ACTL_CUST_MPZ),0) as ACTL_CUST_TOT_MPZ from (select T.loc_nm,NVL(U.ACTL_CUST,0) as ACTL_CUST_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_CUST from 
	(select lc.loc_nm,b.perd_desc,b.wk_id, ROUND(sum(a.actl_cust_cnt),0) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b,loc lc
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no IN (90)
	and a.loc_no=lc.loc_no group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm]]>
	</CustomersHistoryTotalWeekData>   */
</TCName>

<TCName name = "WagesHistoryFirsthMonth_WeekData">
	<WagesHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from 
	ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20
	group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C
	group by C.wk_id order by c.wk_id) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</WagesHistoryWeekData>
	/*
	<WagesHistoryTotalWeekData>
	<![CDATA[select T.loc_nm,ROUND(NVL(sum(U.ACTL_WAGE_MNTH_STR),0),0) as ACTL_WAGE_TOT_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T
	LEFT OUTER JOIN (select c.loc_nm,c.wk_id,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
	from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_nm,C.wk_id order by c.loc_nm,c.wk_id) U
	on T.loc_nm=U.loc_nm  group by T.loc_nm]]>
	</WagesHistoryTotalWeekData>   */
</TCName>

<TCName name = "WagesHistoryFourthMonth_WeekData">
	<WagesHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from 
	ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20
	group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C
	group by C.wk_id order by c.wk_id) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</WagesHistoryWeekData>
	/*
	<WagesHistoryTotalWeekData>
	<![CDATA[select T.loc_nm,ROUND(NVL(sum(U.ACTL_WAGE_MNTH_STR),0),0) as ACTL_WAGE_TOT_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T
	LEFT OUTER JOIN (select c.loc_nm,c.wk_id,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
	from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_nm,C.wk_id order by c.loc_nm,c.wk_id) U
	on T.loc_nm=U.loc_nm  group by T.loc_nm]]>
	</WagesHistoryTotalWeekData>   */
</TCName>

<TCName name = "WagesHistorySecondMonth_WeekData">
	<WagesHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from 
	ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20
	group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C
	group by C.wk_id order by c.wk_id) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</WagesHistoryWeekData>
	/*
	<WagesHistoryTotalWeekData>
	<![CDATA[select T.loc_nm,ROUND(NVL(sum(U.ACTL_WAGE_MNTH_STR),0),0) as ACTL_WAGE_TOT_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T
	LEFT OUTER JOIN (select c.loc_nm,c.wk_id,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
	from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_nm,C.wk_id order by c.loc_nm,c.wk_id) U
	on T.loc_nm=U.loc_nm  group by T.loc_nm]]>   */
	</WagesHistoryTotalWeekData>
</TCName>

<TCName name = "WagesHistoryThirdMonth_WeekData">
	<WagesHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from 
	ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20
	group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C
	group by C.wk_id order by c.wk_id) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</WagesHistoryWeekData>
	/*
	<WagesHistoryTotalWeekData>
	<![CDATA[select T.loc_nm,ROUND(NVL(sum(U.ACTL_WAGE_MNTH_STR),0),0) as ACTL_WAGE_TOT_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T
	LEFT OUTER JOIN (select c.loc_nm,c.wk_id,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
	from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_nm,C.wk_id order by c.loc_nm,c.wk_id) U
	on T.loc_nm=U.loc_nm  group by T.loc_nm]]>
	</WagesHistoryTotalWeekData>*/
</TCName>

<TCName name = "PaidHoursHistoryFirsthMonth_WeekData">
	<PaidHoursHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(ROUND(((ROUND(((U.ACTL_HRS_MNTH_STR*100)/25),0)*25)/100),2),0) as ACTL_HRS_MPZ from 
	(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from 
	ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20
	group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C
	group by C.wk_id order by c.wk_id) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</PaidHoursHistoryWeekData>
	/*
	<PaidHoursHistoryTotalWeekData>
	<![CDATA[select T.loc_nm,NVL(sum(ROUND(((ROUND((((U.ACTL_HRS_MNTH_STR)*100)/25),0)*25)/100),2)),0) as ACTL_HRS_TOT_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T
	LEFT OUTER JOIN (select C.loc_nm,c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
	from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.loc_nm,C.wk_id order by c.wk_id) U
	on T.loc_nm=U.loc_nm  group by T.loc_nm]]>
	</PaidHoursHistoryTotalWeekData>   */
</TCName>

<TCName name = "PaidHoursHistorySecondMonth_WeekData">
	<PaidHoursHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(ROUND(((ROUND(((U.ACTL_HRS_MNTH_STR*100)/25),0)*25)/100),2),0) as ACTL_HRS_MPZ from 
	(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from 
	ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20
	group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C
	group by C.wk_id order by c.wk_id) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</PaidHoursHistoryWeekData>
	/*
	<PaidHoursHistoryTotalWeekData>
	<![CDATA[select T.loc_nm,NVL(sum(ROUND(((ROUND((((U.ACTL_HRS_MNTH_STR)*100)/25),0)*25)/100),2)),0) as ACTL_HRS_TOT_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T
	LEFT OUTER JOIN (select C.loc_nm,c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
	from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.loc_nm,C.wk_id order by c.wk_id) U
	on T.loc_nm=U.loc_nm  group by T.loc_nm]]>
	</PaidHoursHistoryTotalWeekData>   */
</TCName>

<TCName name = "PaidHoursHistoryThirdMonth_WeekData">
	<PaidHoursHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(ROUND(((ROUND(((U.ACTL_HRS_MNTH_STR*100)/25),0)*25)/100),2),0) as ACTL_HRS_MPZ from 
	(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from 
	ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20
	group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C
	group by C.wk_id order by c.wk_id) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</PaidHoursHistoryWeekData>
	/*
	<PaidHoursHistoryTotalWeekData>
	<![CDATA[select T.loc_nm,NVL(sum(ROUND(((ROUND((((U.ACTL_HRS_MNTH_STR)*100)/25),0)*25)/100),2)),0) as ACTL_HRS_TOT_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T
	LEFT OUTER JOIN (select C.loc_nm,c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
	from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.loc_nm,C.wk_id order by c.wk_id) U
	on T.loc_nm=U.loc_nm  group by T.loc_nm]]>
	</PaidHoursHistoryTotalWeekData>   */
</TCName>

<TCName name = "PaidHoursHistoryFourthMonth_WeekData">
	<PaidHoursHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(ROUND(((ROUND(((U.ACTL_HRS_MNTH_STR*100)/25),0)*25)/100),2),0) as ACTL_HRS_MPZ from 
	(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from 
	ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20
	group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C
	group by C.wk_id order by c.wk_id) U on T.wk_id=U.wk_id order by T.wk_id]]>
	</PaidHoursHistoryWeekData>
	/*
	<PaidHoursHistoryTotalWeekData>
	<![CDATA[select T.loc_nm,NVL(sum(ROUND(((ROUND((((U.ACTL_HRS_MNTH_STR)*100)/25),0)*25)/100),2)),0) as ACTL_HRS_TOT_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T
	LEFT OUTER JOIN (select C.loc_nm,c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
	from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.loc_nm,C.wk_id order by c.wk_id) U
	on T.loc_nm=U.loc_nm  group by T.loc_nm]]>
	</PaidHoursHistoryTotalWeekData>   */
</TCName>

<TCName name = "ItemPriceHistoryFirsthMonth_WeekData">
<ItemPriceHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(ACTL_ITEM_PRICE,0) as ACTL_ITEM_PRICE_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select c.perd_desc,C.wk_id, 
	case when NVL(C.ACTL_SALES,0)=0 and NVL(C.ACTL_ITEMS,0)=0 then 0 
	when NVL(C.ACTL_SALES,0)=0 then 0 when NVL(C.ACTL_ITEMS,0)=0 then 0 
	else ROUND((C.ACTL_SALES / C.ACTL_ITEMS),2) end as ACTL_ITEM_PRICE from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as 
	ACTL_SALES, sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month')
	and loc_no  in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) group by b.perd_desc,b.wk_id order by b.wk_id) C order by c.wk_id) U
	on T.wk_id=U.wk_id order by T.wk_id]]>
	</ItemPriceHistoryWeekData>
	/*
	<ItemPriceHistoryTotalWeekData>
	<![CDATA[select  actl_sls_itm.loc_nm,
	case when NVL(actl_sls_itm.ACTL_SLS_TOT_MPZ,0)=0 and NVL(actl_sls_itm.ACTL_ITM_TOT_MPZ,0)=0 then 0 
	when NVL(actl_sls_itm.ACTL_SLS_TOT_MPZ,0)=0 then 0 when NVL(actl_sls_itm.ACTL_ITM_TOT_MPZ,0)=0 then 0 
	else ROUND(actl_sls_itm.ACTL_SLS_TOT_MPZ / actl_sls_itm.ACTL_ITM_TOT_MPZ,2) end as ACTL_ITM_PRICE_TOT_MPZ from 
	(select J.loc_nm,ROUND(sum(J.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ,ROUND(sum(J.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from (select T.loc_nm,
	NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN
	(select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_SALES,S.ACTL_ITEMS from (select lc.loc_nm,b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as 
	ACTL_SALES,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, loc lc where a.TXN_DTE between b.WK_STRT and b.WK_END
	and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) and a.loc_no=lc.loc_no
	group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm) actl_sls_itm]]>
	</ItemPriceHistoryTotalWeekData>   */
</TCName>

<TCName name = "ItemPriceHistorySecondMonth_WeekData">
<ItemPriceHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(ACTL_ITEM_PRICE,0) as ACTL_ITEM_PRICE_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select c.perd_desc,C.wk_id, 
	case when NVL(C.ACTL_SALES,0)=0 and NVL(C.ACTL_ITEMS,0)=0 then 0 
	when NVL(C.ACTL_SALES,0)=0 then 0 when NVL(C.ACTL_ITEMS,0)=0 then 0 
	else ROUND((C.ACTL_SALES / C.ACTL_ITEMS),2) end as ACTL_ITEM_PRICE from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as 
	ACTL_SALES, sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month')
	and loc_no  in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) group by b.perd_desc,b.wk_id order by b.wk_id) C order by c.wk_id) U
	on T.wk_id=U.wk_id order by T.wk_id]]>
	</ItemPriceHistoryWeekData>
	/*
	<ItemPriceHistoryTotalWeekData>
	<![CDATA[select  actl_sls_itm.loc_nm,
	case when NVL(actl_sls_itm.ACTL_SLS_TOT_MPZ,0)=0 and NVL(actl_sls_itm.ACTL_ITM_TOT_MPZ,0)=0 then 0 
	when NVL(actl_sls_itm.ACTL_SLS_TOT_MPZ,0)=0 then 0 when NVL(actl_sls_itm.ACTL_ITM_TOT_MPZ,0)=0 then 0 
	else ROUND(actl_sls_itm.ACTL_SLS_TOT_MPZ / actl_sls_itm.ACTL_ITM_TOT_MPZ,2) end as ACTL_ITM_PRICE_TOT_MPZ from 
	(select J.loc_nm,ROUND(sum(J.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ,ROUND(sum(J.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from (select T.loc_nm,
	NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN
	(select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_SALES,S.ACTL_ITEMS from (select lc.loc_nm,b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as 
	ACTL_SALES,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, loc lc where a.TXN_DTE between b.WK_STRT and b.WK_END
	and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) and a.loc_no=lc.loc_no
	group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm) actl_sls_itm]]>
	</ItemPriceHistoryTotalWeekData>   */
</TCName>

<TCName name = "ItemPriceHistoryThirdMonth_WeekData">
<ItemPriceHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(ACTL_ITEM_PRICE,0) as ACTL_ITEM_PRICE_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select c.perd_desc,C.wk_id, 
	case when NVL(C.ACTL_SALES,0)=0 and NVL(C.ACTL_ITEMS,0)=0 then 0 
	when NVL(C.ACTL_SALES,0)=0 then 0 when NVL(C.ACTL_ITEMS,0)=0 then 0 
	else ROUND((C.ACTL_SALES / C.ACTL_ITEMS),2) end as ACTL_ITEM_PRICE from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as 
	ACTL_SALES, sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month')
	and loc_no  in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) group by b.perd_desc,b.wk_id order by b.wk_id) C order by c.wk_id) U
	on T.wk_id=U.wk_id order by T.wk_id]]>
	</ItemPriceHistoryWeekData>
	/*
	<ItemPriceHistoryTotalWeekData>
	<![CDATA[select  actl_sls_itm.loc_nm,
	case when NVL(actl_sls_itm.ACTL_SLS_TOT_MPZ,0)=0 and NVL(actl_sls_itm.ACTL_ITM_TOT_MPZ,0)=0 then 0 
	when NVL(actl_sls_itm.ACTL_SLS_TOT_MPZ,0)=0 then 0 when NVL(actl_sls_itm.ACTL_ITM_TOT_MPZ,0)=0 then 0 
	else ROUND(actl_sls_itm.ACTL_SLS_TOT_MPZ / actl_sls_itm.ACTL_ITM_TOT_MPZ,2) end as ACTL_ITM_PRICE_TOT_MPZ from 
	(select J.loc_nm,ROUND(sum(J.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ,ROUND(sum(J.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from (select T.loc_nm,
	NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN
	(select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_SALES,S.ACTL_ITEMS from (select lc.loc_nm,b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as 
	ACTL_SALES,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, loc lc where a.TXN_DTE between b.WK_STRT and b.WK_END
	and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) and a.loc_no=lc.loc_no
	group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm) actl_sls_itm]]>
	</ItemPriceHistoryTotalWeekData>   */
</TCName>

<TCName name = "ItemPriceHistoryFourthMonth_WeekData">
	<ItemPriceHistoryWeekData>
	<![CDATA[select T.wk_id,NVL(ACTL_ITEM_PRICE,0) as ACTL_ITEM_PRICE_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select c.perd_desc,C.wk_id, 
	case when NVL(C.ACTL_SALES,0)=0 and NVL(C.ACTL_ITEMS,0)=0 then 0 
	when NVL(C.ACTL_SALES,0)=0 then 0 when NVL(C.ACTL_ITEMS,0)=0 then 0 
	else ROUND((C.ACTL_SALES / C.ACTL_ITEMS),2) end as ACTL_ITEM_PRICE from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as 
	ACTL_SALES, sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month')
	and loc_no  in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) group by b.perd_desc,b.wk_id order by b.wk_id) C order by c.wk_id) U
	on T.wk_id=U.wk_id order by T.wk_id]]>
	</ItemPriceHistoryWeekData>
	/*
	<ItemPriceHistoryTotalWeekData>
	<![CDATA[select  actl_sls_itm.loc_nm,
	case when NVL(actl_sls_itm.ACTL_SLS_TOT_MPZ,0)=0 and NVL(actl_sls_itm.ACTL_ITM_TOT_MPZ,0)=0 then 0 
	when NVL(actl_sls_itm.ACTL_SLS_TOT_MPZ,0)=0 then 0 when NVL(actl_sls_itm.ACTL_ITM_TOT_MPZ,0)=0 then 0 
	else ROUND(actl_sls_itm.ACTL_SLS_TOT_MPZ / actl_sls_itm.ACTL_ITM_TOT_MPZ,2) end as ACTL_ITM_PRICE_TOT_MPZ from 
	(select J.loc_nm,ROUND(sum(J.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ,ROUND(sum(J.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from (select T.loc_nm,
	NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN
	(select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_SALES,S.ACTL_ITEMS from (select lc.loc_nm,b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as 
	ACTL_SALES,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, loc lc where a.TXN_DTE between b.WK_STRT and b.WK_END
	and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) and a.loc_no=lc.loc_no
	group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm) actl_sls_itm]]>
	</ItemPriceHistoryTotalWeekData>   */
</TCName>

<TCName name = "WagePercentageHistoryFirsthMonth_WeekData">
	<WagePercentageHistoryWeekData>
	<![CDATA[select actl_wge.wk_id,
	case when NVL(actl_wge.ACTL_WAGE_MPZ,0)=0 and NVL(actl_sls.ACTL_SLS_MPZ,0)=0 then 0 
	when NVL(actl_wge.ACTL_WAGE_MPZ,0)=0 then 0 when NVL(actl_sls.ACTL_SLS_MPZ,0)=0 then 0 
	else NVL(ROUND(((actl_wge.ACTL_WAGE_MPZ / actl_sls.ACTL_SLS_MPZ)*100),2),0) end as ACTL_WAGE_PRCNT_MPZ from (select T.wk_id,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPZ from 
	(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T LEFT OUTER JOIN (select c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,
	sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as 
	ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,
	b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C group by C.wk_id order by c.wk_id) U on T.wk_id=U.wk_id order by T.wk_id) actl_wge,
	(select T.wk_id,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T LEFT OUTER JOIN
	(select S.perd_desc,S.wk_id,S.ACTL_SALES from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90)
	group by b.perd_desc,b.wk_id order by b.wk_id) S) U on T.wk_id=U.wk_id order by T.wk_id) actl_sls where actl_wge.wk_id=actl_sls.wk_id order by actl_wge.wk_id]]>
	</WagePercentageHistoryWeekData>
	/*
	<WagePercentageHistoryTotalWeekData>
	<![CDATA[select actl_wge.loc_nm,
	case when NVL(actl_wge.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(actl_sls.ACTL_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(actl_wge.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(actl_sls.ACTL_SLS_TOT_MPZ,0)=0 then 0 
	else NVL(ROUND(((actl_wge.ACTL_WAGE_TOT_MPZ / actl_sls.ACTL_SLS_TOT_MPZ)*100),2),0) end as ACTL_WAGE_PRCNT_TOT_MPZ from 
	(select T.loc_nm,ROUND(NVL(sum(U.ACTL_WAGE_MNTH_STR),0),0) as ACTL_WAGE_TOT_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T
	LEFT OUTER JOIN (select c.loc_nm,c.wk_id,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
	from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_nm,C.wk_id order by c.loc_nm,c.wk_id) U
	on T.loc_nm=U.loc_nm  group by T.loc_nm) actl_wge,(select J.loc_nm,ROUND(sum(J.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from (select T.loc_nm,
	NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_SALES 
	from (select lc.loc_nm,b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b,loc lc
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90)
	and a.loc_no=lc.loc_no group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm) 
	actl_sls where actl_wge.loc_nm=actl_sls.loc_nm]]>
	</WagePercentageHistoryTotalWeekData>   */
</TCName>

<TCName name = "WagePercentageHistorySecondMonth_WeekData">
	<WagePercentageHistoryWeekData>
	<![CDATA[select actl_wge.wk_id,
	case when NVL(actl_wge.ACTL_WAGE_MPZ,0)=0 and NVL(actl_sls.ACTL_SLS_MPZ,0)=0 then 0 
	when NVL(actl_wge.ACTL_WAGE_MPZ,0)=0 then 0 when NVL(actl_sls.ACTL_SLS_MPZ,0)=0 then 0 
	else NVL(ROUND(((actl_wge.ACTL_WAGE_MPZ / actl_sls.ACTL_SLS_MPZ)*100),2),0) end as ACTL_WAGE_PRCNT_MPZ from (select T.wk_id,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPZ from 
	(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T LEFT OUTER JOIN (select c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,
	sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as 
	ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,
	b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C group by C.wk_id order by c.wk_id) U on T.wk_id=U.wk_id order by T.wk_id) actl_wge,
	(select T.wk_id,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T LEFT OUTER JOIN
	(select S.perd_desc,S.wk_id,S.ACTL_SALES from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90)
	group by b.perd_desc,b.wk_id order by b.wk_id) S) U on T.wk_id=U.wk_id order by T.wk_id) actl_sls where actl_wge.wk_id=actl_sls.wk_id order by actl_wge.wk_id]]>
	</WagePercentageHistoryWeekData>
	/*
	<WagePercentageHistoryTotalWeekData>
	<![CDATA[select actl_wge.loc_nm,
	case when NVL(actl_wge.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(actl_sls.ACTL_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(actl_wge.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(actl_sls.ACTL_SLS_TOT_MPZ,0)=0 then 0 
	else NVL(ROUND(((actl_wge.ACTL_WAGE_TOT_MPZ / actl_sls.ACTL_SLS_TOT_MPZ)*100),2),0) end as ACTL_WAGE_PRCNT_TOT_MPZ from 
	(select T.loc_nm,ROUND(NVL(sum(U.ACTL_WAGE_MNTH_STR),0),0) as ACTL_WAGE_TOT_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T
	LEFT OUTER JOIN (select c.loc_nm,c.wk_id,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
	from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_nm,C.wk_id order by c.loc_nm,c.wk_id) U
	on T.loc_nm=U.loc_nm  group by T.loc_nm) actl_wge,(select J.loc_nm,ROUND(sum(J.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from (select T.loc_nm,
	NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_SALES 
	from (select lc.loc_nm,b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b,loc lc
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90)
	and a.loc_no=lc.loc_no group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm) 
	actl_sls where actl_wge.loc_nm=actl_sls.loc_nm]]>
	</WagePercentageHistoryTotalWeekData>   */
</TCName>

<TCName name = "WagePercentageHistoryThirdMonth_WeekData">
	<WagePercentageHistoryWeekData>
	<![CDATA[select actl_wge.wk_id,
	case when NVL(actl_wge.ACTL_WAGE_MPZ,0)=0 and NVL(actl_sls.ACTL_SLS_MPZ,0)=0 then 0 
	when NVL(actl_wge.ACTL_WAGE_MPZ,0)=0 then 0 when NVL(actl_sls.ACTL_SLS_MPZ,0)=0 then 0 
	else NVL(ROUND(((actl_wge.ACTL_WAGE_MPZ / actl_sls.ACTL_SLS_MPZ)*100),2),0) end as ACTL_WAGE_PRCNT_MPZ from (select T.wk_id,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPZ from 
	(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T LEFT OUTER JOIN (select c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,
	sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as 
	ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,
	b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C group by C.wk_id order by c.wk_id) U on T.wk_id=U.wk_id order by T.wk_id) actl_wge,
	(select T.wk_id,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T LEFT OUTER JOIN
	(select S.perd_desc,S.wk_id,S.ACTL_SALES from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90)
	group by b.perd_desc,b.wk_id order by b.wk_id) S) U on T.wk_id=U.wk_id order by T.wk_id) actl_sls where actl_wge.wk_id=actl_sls.wk_id order by actl_wge.wk_id]]>
	</WagePercentageHistoryWeekData>
	/*
	<WagePercentageHistoryTotalWeekData>
	<![CDATA[select actl_wge.loc_nm,
	case when NVL(actl_wge.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(actl_sls.ACTL_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(actl_wge.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(actl_sls.ACTL_SLS_TOT_MPZ,0)=0 then 0 
	else NVL(ROUND(((actl_wge.ACTL_WAGE_TOT_MPZ / actl_sls.ACTL_SLS_TOT_MPZ)*100),2),0) end as ACTL_WAGE_PRCNT_TOT_MPZ from 
	(select T.loc_nm,ROUND(NVL(sum(U.ACTL_WAGE_MNTH_STR),0),0) as ACTL_WAGE_TOT_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T
	LEFT OUTER JOIN (select c.loc_nm,c.wk_id,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
	from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_nm,C.wk_id order by c.loc_nm,c.wk_id) U
	on T.loc_nm=U.loc_nm  group by T.loc_nm) actl_wge,(select J.loc_nm,ROUND(sum(J.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from (select T.loc_nm,
	NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_SALES 
	from (select lc.loc_nm,b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b,loc lc
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90)
	and a.loc_no=lc.loc_no group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm) 
	actl_sls where actl_wge.loc_nm=actl_sls.loc_nm]]>
	</WagePercentageHistoryTotalWeekData>   */
</TCName>

<TCName name = "WagePercentageHistoryFourthMonth_WeekData">
	<WagePercentageHistoryWeekData>
	<![CDATA[select actl_wge.wk_id,
	case when NVL(actl_wge.ACTL_WAGE_MPZ,0)=0 and NVL(actl_sls.ACTL_SLS_MPZ,0)=0 then 0 
	when NVL(actl_wge.ACTL_WAGE_MPZ,0)=0 then 0 when NVL(actl_sls.ACTL_SLS_MPZ,0)=0 then 0 
	else NVL(ROUND(((actl_wge.ACTL_WAGE_MPZ / actl_sls.ACTL_SLS_MPZ)*100),2),0) end as ACTL_WAGE_PRCNT_MPZ from (select T.wk_id,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPZ from 
	(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T LEFT OUTER JOIN (select c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,
	sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as 
	ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,
	b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C group by C.wk_id order by c.wk_id) U on T.wk_id=U.wk_id order by T.wk_id) actl_wge,
	(select T.wk_id,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T LEFT OUTER JOIN
	(select S.perd_desc,S.wk_id,S.ACTL_SALES from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90)
	group by b.perd_desc,b.wk_id order by b.wk_id) S) U on T.wk_id=U.wk_id order by T.wk_id) actl_sls where actl_wge.wk_id=actl_sls.wk_id order by actl_wge.wk_id]]>
	</WagePercentageHistoryWeekData>
	/*
	<WagePercentageHistoryTotalWeekData>
	<![CDATA[select actl_wge.loc_nm,
	case when NVL(actl_wge.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(actl_sls.ACTL_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(actl_wge.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(actl_sls.ACTL_SLS_TOT_MPZ,0)=0 then 0 
	else NVL(ROUND(((actl_wge.ACTL_WAGE_TOT_MPZ / actl_sls.ACTL_SLS_TOT_MPZ)*100),2),0) end as ACTL_WAGE_PRCNT_TOT_MPZ from 
	(select T.loc_nm,ROUND(NVL(sum(U.ACTL_WAGE_MNTH_STR),0),0) as ACTL_WAGE_TOT_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T
	LEFT OUTER JOIN (select c.loc_nm,c.wk_id,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
	from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_nm,C.wk_id order by c.loc_nm,c.wk_id) U
	on T.loc_nm=U.loc_nm  group by T.loc_nm) actl_wge,(select J.loc_nm,ROUND(sum(J.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from (select T.loc_nm,
	NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_SALES 
	from (select lc.loc_nm,b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b,loc lc
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90)
	and a.loc_no=lc.loc_no group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm) 
	actl_sls where actl_wge.loc_nm=actl_sls.loc_nm]]>
	</WagePercentageHistoryTotalWeekData>   */
</TCName>

<TCName name = "CPHFirsthMonth_WeekData">
	<CPHHistoryWeekData>
	<![CDATA[select T.wk_id,
	NVL(ACTL_CPH_MPZ,0) as ACTL_CPH_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select c.wk_id,
	case when NVL(sum(ACTL_WAGE),0)=0 and NVL(sum(ACTL_HRS),0)=0 then 0 
	when NVL(sum(ACTL_WAGE),0)=0 then 0 when NVL(sum(ACTL_HRS),0)=0 then 0 
	else ROUND((ROUND(sum(ACTL_WAGE),0) / ROUND(sum(ACTL_HRS),2)),2) end as ACTL_CPH_MPZ from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
	d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk 
	where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 and a.div_no='Division' group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C group by C.wk_id order by c.wk_id) U
	on T.wk_id=U.wk_id order by T.wk_id]]>
	</CPHHistoryWeekData>
	/*
	<CPHHistoryTotalWeekData>
	<![CDATA[select actl_wge_hrs.loc_nm,
	case when NVL(actl_wge_hrs.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(actl_wge_hrs.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	when NVL(actl_wge_hrs.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(actl_wge_hrs.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	else ROUND(actl_wge_hrs.ACTL_WAGE_TOT_MPZ / actl_wge_hrs.ACTL_HRS_TOT_MPZ,2) end as ACTL_CPH_TOT_MPZ from 
	(select T.loc_nm,ROUND(NVL(sum(U.ACTL_WAGE_MNTH_STR),0),0) as ACTL_WAGE_TOT_MPZ,ROUND(NVL(sum(U.ACTL_HRS_MNTH_STR),0),0) as ACTL_HRS_TOT_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select c.loc_nm,c.wk_id,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as 
	ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) 
	as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 and a.div_no='Division' group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_nm,C.wk_id order by c.loc_nm,c.wk_id) U
	on T.loc_nm=U.loc_nm  group by T.loc_nm) actl_wge_hrs]]>
	</CPHHistoryTotalWeekData>   */
</TCName>

<TCName name = "CPHHistorySecondMonth_WeekData">
	<CPHHistoryWeekData>
	<![CDATA[select T.wk_id,
	NVL(ACTL_CPH_MPZ,0) as ACTL_CPH_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select c.wk_id,
	case when NVL(sum(ACTL_WAGE),0)=0 and NVL(sum(ACTL_HRS),0)=0 then 0 
	when NVL(sum(ACTL_WAGE),0)=0 then 0 when NVL(sum(ACTL_HRS),0)=0 then 0 
	else ROUND((ROUND(sum(ACTL_WAGE),0) / ROUND(sum(ACTL_HRS),2)),2) end as ACTL_CPH_MPZ from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
	d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk 
	where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 and a.div_no='Division' group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C group by C.wk_id order by c.wk_id) U
	on T.wk_id=U.wk_id order by T.wk_id]]>
	</CPHHistoryWeekData>
	/*
	<CPHHistoryTotalWeekData>
	<![CDATA[select actl_wge_hrs.loc_nm,
	case when NVL(actl_wge_hrs.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(actl_wge_hrs.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	when NVL(actl_wge_hrs.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(actl_wge_hrs.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	else ROUND(actl_wge_hrs.ACTL_WAGE_TOT_MPZ / actl_wge_hrs.ACTL_HRS_TOT_MPZ,2) end as ACTL_CPH_TOT_MPZ from 
	(select T.loc_nm,ROUND(NVL(sum(U.ACTL_WAGE_MNTH_STR),0),0) as ACTL_WAGE_TOT_MPZ,ROUND(NVL(sum(U.ACTL_HRS_MNTH_STR),0),0) as ACTL_HRS_TOT_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select c.loc_nm,c.wk_id,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as 
	ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) 
	as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 and a.div_no='Division' group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_nm,C.wk_id order by c.loc_nm,c.wk_id) U
	on T.loc_nm=U.loc_nm  group by T.loc_nm) actl_wge_hrs]]>
	</CPHHistoryTotalWeekData>   */
</TCName>

<TCName name = "CPHHistoryThirdMonth_WeekData">
	<CPHHistoryWeekData>
	<![CDATA[select T.wk_id,
	NVL(ACTL_CPH_MPZ,0) as ACTL_CPH_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select c.wk_id,
	case when NVL(sum(ACTL_WAGE),0)=0 and NVL(sum(ACTL_HRS),0)=0 then 0 
	when NVL(sum(ACTL_WAGE),0)=0 then 0 when NVL(sum(ACTL_HRS),0)=0 then 0 
	else ROUND((ROUND(sum(ACTL_WAGE),0) / ROUND(sum(ACTL_HRS),2)),2) end as ACTL_CPH_MPZ from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
	d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk 
	where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 and a.div_no='Division' group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C group by C.wk_id order by c.wk_id) U
	on T.wk_id=U.wk_id order by T.wk_id]]>
	</CPHHistoryWeekData>
	/*
	<CPHHistoryTotalWeekData>
	<![CDATA[select actl_wge_hrs.loc_nm,
	case when NVL(actl_wge_hrs.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(actl_wge_hrs.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	when NVL(actl_wge_hrs.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(actl_wge_hrs.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	else ROUND(actl_wge_hrs.ACTL_WAGE_TOT_MPZ / actl_wge_hrs.ACTL_HRS_TOT_MPZ,2) end as ACTL_CPH_TOT_MPZ from 
	(select T.loc_nm,ROUND(NVL(sum(U.ACTL_WAGE_MNTH_STR),0),0) as ACTL_WAGE_TOT_MPZ,ROUND(NVL(sum(U.ACTL_HRS_MNTH_STR),0),0) as ACTL_HRS_TOT_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select c.loc_nm,c.wk_id,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as 
	ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) 
	as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 and a.div_no='Division' group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_nm,C.wk_id order by c.loc_nm,c.wk_id) U
	on T.loc_nm=U.loc_nm  group by T.loc_nm) actl_wge_hrs]]>
	</CPHHistoryTotalWeekData>   */
</TCName>

<TCName name = "CPHHistoryFourthMonth_WeekData">
	<CPHHistoryWeekData>
	<![CDATA[select T.wk_id,
	NVL(ACTL_CPH_MPZ,0) as ACTL_CPH_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) T
	LEFT OUTER JOIN (select c.wk_id,
	case when NVL(sum(ACTL_WAGE),0)=0 and NVL(sum(ACTL_HRS),0)=0 then 0 
	when NVL(sum(ACTL_WAGE),0)=0 then 0 when NVL(sum(ACTL_HRS),0)=0 then 0 
	else ROUND((ROUND(sum(ACTL_WAGE),0) / ROUND(sum(ACTL_HRS),2)),2) end as ACTL_CPH_MPZ from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
	d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk 
	where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 and a.div_no='Division' group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C group by C.wk_id order by c.wk_id) U
	on T.wk_id=U.wk_id order by T.wk_id]]>
	</CPHHistoryWeekData>
	/*
	<CPHHistoryTotalWeekData>
	<![CDATA[select actl_wge_hrs.loc_nm,
	case when NVL(actl_wge_hrs.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(actl_wge_hrs.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	when NVL(actl_wge_hrs.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(actl_wge_hrs.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	else ROUND(actl_wge_hrs.ACTL_WAGE_TOT_MPZ / actl_wge_hrs.ACTL_HRS_TOT_MPZ,2) end as ACTL_CPH_TOT_MPZ from 
	(select T.loc_nm,ROUND(NVL(sum(U.ACTL_WAGE_MNTH_STR),0),0) as ACTL_WAGE_TOT_MPZ,ROUND(NVL(sum(U.ACTL_HRS_MNTH_STR),0),0) as ACTL_HRS_TOT_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select c.loc_nm,c.wk_id,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as 
	ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) 
	as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 and a.div_no='Division' group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_nm,C.wk_id order by c.loc_nm,c.wk_id) U
	on T.loc_nm=U.loc_nm  group by T.loc_nm) actl_wge_hrs]]>
	</CPHHistoryTotalWeekData>   */
</TCName>

<TCName name = "BudgetSales_CurrentMonth_WeekData">
	<BudgetSalesWeekData>
	<![CDATA[select f.wk_id,NVL(ROUND(sum(g.BDGT_SALES_MNTH_STR),0),0) as BDGT_SLS_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
		LEFT OUTER JOIN	(select C.loc_no,C.perd_desc,c.wk_id,ROUND(sum(BDGT_SALES),9) as BDGT_SALES_MNTH_STR from
		(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id,ROUND(sum(bdgt_sls),9) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
		from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
		and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) and a.div_no='Division' group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,
		a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C group by c.loc_no,c.perd_desc,C.wk_id order by c.loc_no,c.wk_id) g
		on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id group by f.wk_id order by f.wk_id]]>
	</BudgetSalesWeekData>
	/*
	<BudgetSalesTotalWeekData>
	<![CDATA[select C.loc_nm,ROUND(sum(BDGT_SLS_MPZ),0) as BDGT_SLS_TOT_MPZ from (select f.loc_nm,NVL(g.BDGT_SALES_MPZ,0) as BDGT_SLS_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN	(select C.loc_no,C.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(BDGT_SALES),0) as BDGT_SALES_MPZ 
	from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,ROUND(sum(bdgt_sls),0) as BDGT_SALES, sum(bdgt_wage_amt) as 
	BDGT_WAGE from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) and a.div_no='Division' group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,
	a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_no,c.loc_nm,c.perd_desc,C.wk_id order by 
	c.loc_no,c.wk_id) g on f.loc_nm=g.loc_nm order by f.loc_nm) C group by c.loc_nm]]>
	</BudgetSalesTotalWeekData>   */
	
	<ForecastSalesWeekData>
	<![CDATA[select f.wk_id,NVL(ROUND(sum(g.FCST_SALES_MPZ),0),0) as FCST_SLS_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
		LEFT OUTER JOIN (select C.loc_no,C.perd_desc,c.wk_id,ROUND(sum(FRCST_SLS),9) as FCST_SALES_MPZ from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
		d.perd_desc,a.wk_id,ROUND(sum(FRCST_SLS),9) as FRCST_SLS, sum(FRCST_WAGE_AMT) as FCST_WAGE from WW_WLP.MNTH_FCST a,loc b, wk d 
		where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT 
		IN (0,20,90) and a.div_no='Division' group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C
		group by c.loc_no,c.perd_desc,C.wk_id order by c.loc_no,c.wk_id) g on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id group by f.wk_id order by f.wk_id]]>
	</ForecastSalesWeekData>
	/*
	<ForecastSalesTotalWeekData>
	<![CDATA[select C.loc_nm,ROUND(sum(FCST_SLS_MPZ),0) as FCST_SLS_TOT_MPZ from (select f.loc_nm,NVL(g.FCST_SALES_MPZ,0) as FCST_SLS_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select C.loc_no,C.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(FCST_SALES),0) as FCST_SALES_MPZ 
	from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,ROUND(sum(frcst_sls),0) as FCST_SALES, sum(frcst_wage_amt) as 
	FCST_WAGE from WW_WLP.mnth_fcst a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) and a.div_no='Division' group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,
	a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_no,c.loc_nm,c.perd_desc,C.wk_id order by 
	c.loc_no,c.wk_id) g on f.loc_nm=g.loc_nm order by f.loc_nm) C group by c.loc_nm]]>
	</ForecastSalesTotalWeekData>
	*/
</TCName>

<TCName name = "GeneratedSales_CurrentMonth_WeekData">
	<GeneratedSalesWeekData>
	<![CDATA[select f.wk_id,NVL(sum(g.GEN_SALES_MNTH_STR),0) as GEN_SLS_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
		LEFT OUTER JOIN	(select a.loc_no,b.perd_desc,b.wk_id,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_MNTH_STR from WW_WLP.fcst a,WW_WLP.WK b
		where a.fcst_dte between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and loc_no  in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90)
		group by a.loc_no,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) g on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id group by f.wk_id order by f.wk_id]]>
	</GeneratedSalesWeekData>
	/*
	<GeneratedSalesTotalWeekData>
	<![CDATA[select h.loc_nm,ROUND(sum(h.GEN_SLS_MPZ),0) as GEN_SLS_TOT_MPZ from (select f.loc_nm,NVL(g.GEN_SALES_MNTH_STR,0) as GEN_SLS_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id,ROUND(sum(a.gnrt_sls),0) as 
	GEN_SALES_MNTH_STR from WW_WLP.fcst a,WW_WLP.WK b,ww_wlp.loc lc where a.fcst_dte between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month')
	and a.loc_no  in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) and a.loc_no=lc.loc_no group by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id order 
	by a.loc_no,b.wk_id) g on f.loc_nm=g.loc_nm order by f.loc_nm ) h group by h.loc_nm]]>
	</GeneratedSalesTotalWeekData>
	*/
	
</TCName>

<TCName name = "PlannedSales_CurrentMonth_WeekData">
	<PlannedSalesWeekData>
	<![CDATA[select f.wk_id,NVL(sum(e.PLAN_SALES),0) as PLN_SLS_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
		LEFT OUTER JOIN (select * from (select a.loc_no,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES from ww_wlp.mgr_wky_pln a,wk b 
		where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id group by a.loc_no,b.perd_desc,
		a.wk_id order by a.loc_no,b.perd_desc,a.wk_id) c 
		UNION 
		select * from (select loc_no,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES from ww_wlp.fcst a,wk b
		where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and dept_no NOT IN (0,20,90) and fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and (a.loc_no,b.wk_id) NOT IN
		(select distinct loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
		group by loc_no,b.perd_desc,b.wk_id order by loc_no,b.perd_desc,b.wk_id) d) e on f.perd_desc=e.perd_desc and f.wk_id=e.wk_id group by f.wk_id order by f.wk_id]]>
	</PlannedSalesWeekData>
	/*
	<PlannedSalesTotalWeekData>
	<![CDATA[select g.loc_nm,ROUND(sum(g.PLN_SLS_MNTH_STR),0) as PLN_SLS_MNTH_STR_TOT from (select f.loc_nm,NVL(e.PLAN_SALES,0) as PLN_SLS_MNTH_STR from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select * from (select a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) 
	as PLAN_SALES from ww_wlp.mgr_wky_pln a,wk b,loc lc where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id in (select wk_id from ww_wlp.wk where 
	perd_desc='Month') and a.wk_id=b.wk_id group by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id) c UNION
	select * from (select a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES from ww_wlp.fcst a,wk b,loc lc
	where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.dept_no NOT IN (0,20,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month'
	and (a.loc_no,b.wk_id) NOT IN (select distinct loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and wk_id in (select wk_id from ww_wlp.wk where perd_desc=
	'Month')) and a.loc_no=lc.loc_no group by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id) d) e
	on f.loc_nm=e.loc_nm order by f.loc_nm) g group by g.loc_nm]]>
	</PlannedSalesTotalWeekData>
	*/
</TCName>

<TCName name = "VarToBUDSales_CurrentMonth_WeekData">
	<VartoBUDWeekData>
	<![CDATA[select R.wk_id,NVL((sum(R.PLN_SLS_MNTH_STR) - sum(S.BDGT_SALES_MNTH_STR)),0) as VAR_TO_BDGT_SLS_MNTH_STR from (select f.perd_desc,f.wk_id,NVL(sum(e.PLAN_SALES),0) as
		PLN_SLS_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f LEFT OUTER JOIN (select * from (select a.loc_no,b.perd_desc,a.wk_id,
		round(sum(a.mgr_wky_sls),0) as PLAN_SALES from ww_wlp.mgr_wky_pln a,wk b where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id in (select wk_id from ww_wlp.wk where 
		perd_desc='Month') and a.wk_id=b.wk_id group by a.loc_no,b.perd_desc,a.wk_id order by a.loc_no,b.perd_desc,a.wk_id) c 
		UNION 
		select * from 
		(select loc_no,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES from ww_wlp.fcst a,wk b where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and dept_no NOT IN (0,20,90) 
		and fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and (a.loc_no,b.wk_id) NOT IN (select distinct loc_no,wk_id from ww_wlp.mgr_wky_pln  where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
		and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month')) group by loc_no,b.perd_desc,b.wk_id order by loc_no,b.perd_desc,b.wk_id) d) e
		on f.perd_desc=e.perd_desc and f.wk_id=e.wk_id group by f.perd_desc,f.wk_id order by f.wk_id) R,(select f.wk_id,NVL(ROUND(sum(g.BDGT_SALES_MNTH_STR),0),0) as BDGT_SALES_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
		LEFT OUTER JOIN	(select C.loc_no,C.perd_desc,c.wk_id,ROUND(sum(BDGT_SALES),9) as BDGT_SALES_MNTH_STR from
		(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id,ROUND(sum(bdgt_sls),9) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
		from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
		and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,
		a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C group by c.loc_no,c.perd_desc,C.wk_id order by c.loc_no,c.wk_id) g
		on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id group by f.perd_desc,f.wk_id order by f.wk_id) S where R.wk_id=S.wk_id group by r.wk_id order by R.wk_id]]>
	</VartoBUDWeekData>
	/*
	<VartoBUDTotalWeekData>
	<![CDATA[select R.loc_nm,NVL((R.PLN_SLS_MNTH_STR_TOT - S.BDGT_SLS_TOT_MPZ),0) as VAR_TO_BDGT_SLS_TOT_MPZ from (select g.loc_nm,ROUND(sum(g.PLN_SLS_MNTH_STR),0) 
	as PLN_SLS_MNTH_STR_TOT from (select f.loc_nm,NVL(e.PLAN_SALES,0) as PLN_SLS_MNTH_STR from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f
	LEFT OUTER JOIN (select * from (select a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES from ww_wlp.mgr_wky_pln a,wk b,
	loc lc where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id
	group by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id) c 
	UNION 
	select * from 
	(select a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES from ww_wlp.fcst a,wk b,loc lc where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.dept_no NOT IN (0,20,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and (a.loc_no,b.wk_id) NOT IN (select distinct loc_no,wk_id from 
	ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month')) and a.loc_no=lc.loc_no 
	group by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id) d) e on f.loc_nm=e.loc_nm order by f.loc_nm) g
	group by g.loc_nm) R,(select C.loc_nm,ROUND(sum(BDGT_SLS_MPZ),0) as BDGT_SLS_TOT_MPZ from (select f.loc_nm,NVL(g.BDGT_SALES_MPZ,0) as BDGT_SLS_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select C.loc_no,C.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(BDGT_SALES),0) as BDGT_SALES_MPZ 
	from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,ROUND(sum(bdgt_sls),0) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
	from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_no,c.loc_nm,c.perd_desc,C.wk_id order by c.loc_no,
	c.wk_id) g on f.loc_nm=g.loc_nm order by f.loc_nm) C group by c.loc_nm) S where R.loc_nm=S.loc_nm]]>
	</VartoBUDTotalWeekData>
	*/
	<VartoFCSTWeekData>
	<![CDATA[select R.wk_id,NVL((sum(R.PLN_SLS_MNTH_STR) - sum(S.FCST_SLS_MNTH_STR)),0) as VAR_TO_FCST_SLS_MPZ from (select f.perd_desc,f.wk_id,NVL(sum(e.PLAN_SALES),0) as 
		PLN_SLS_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f LEFT OUTER JOIN (select * from (select a.loc_no,b.perd_desc,a.wk_id,
		round(sum(a.mgr_wky_sls),0) as PLAN_SALES from ww_wlp.mgr_wky_pln a,wk b where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id in (select wk_id from ww_wlp.wk where 
		perd_desc='Month') and a.wk_id=b.wk_id group by a.loc_no,b.perd_desc,a.wk_id order by a.loc_no,b.perd_desc,a.wk_id) c 
		UNION 
		select * from 
		(select loc_no,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES from ww_wlp.fcst a,wk b where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and dept_no NOT IN (0,20,90) and 
		fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and (a.loc_no,b.wk_id) NOT IN (select distinct loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and wk_id 
		in (select wk_id from ww_wlp.wk where perd_desc='Month')) group by loc_no,b.perd_desc,b.wk_id order by loc_no,b.perd_desc,b.wk_id) d) e on f.perd_desc=e.perd_desc 
		and f.wk_id=e.wk_id group by f.perd_desc,f.wk_id order by f.wk_id) R,
		(select f.wk_id,NVL(ROUND(sum(g.FCST_SALES_MPZ),0),0) as FCST_SLS_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
		LEFT OUTER JOIN (select C.loc_no,C.perd_desc,c.wk_id,ROUND(sum(FRCST_SLS),9) as FCST_SALES_MPZ from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
		d.perd_desc,a.wk_id,ROUND(sum(FRCST_SLS),9) as FRCST_SLS, sum(FRCST_WAGE_AMT) as FCST_WAGE from WW_WLP.MNTH_FCST a,loc b, wk d 
		where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT 
		IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C
		group by c.loc_no,c.perd_desc,C.wk_id order by c.loc_no,c.wk_id) g on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id group by f.perd_desc,f.wk_id order by f.wk_id) S where R.wk_id=S.wk_id group by r.wk_id order 
		by R.wk_id]]>
	</VartoFCSTWeekData>
	/*
	<VartoFCSTTotalWeekData>
	<![CDATA[select R.loc_nm,NVL((R.PLN_SLS_MNTH_STR_TOT - S.FCST_SLS_TOT_MPZ),0) as VAR_TO_FCST_SLS_TOT_MPZ from (select g.loc_nm,ROUND(sum(g.PLN_SLS_MNTH_STR),0) 
	as PLN_SLS_MNTH_STR_TOT from (select f.loc_nm,NVL(e.PLAN_SALES,0) as PLN_SLS_MNTH_STR from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f
	LEFT OUTER JOIN (select * from (select a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES from ww_wlp.mgr_wky_pln a,wk b,
	loc lc where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id
	group by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id) c 
	UNION 
	select * from 
	(select a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES from ww_wlp.fcst a,wk b,loc lc where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.dept_no NOT IN (0,20,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and (a.loc_no,b.wk_id) NOT IN (select distinct loc_no,wk_id from 
	ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month')) and a.loc_no=lc.loc_no 
	group by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id) d) e on f.loc_nm=e.loc_nm order by f.loc_nm) g
	group by g.loc_nm) R,(select C.loc_nm,ROUND(sum(FCST_SLS_MPZ),0) as FCST_SLS_TOT_MPZ from (select f.loc_nm,NVL(g.FCST_SALES_MPZ,0) as FCST_SLS_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select C.loc_no,C.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(FCST_SALES),0) as FCST_SALES_MPZ 
	from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,ROUND(sum(frcst_sls),0) as FCST_SALES, sum(frcst_wage_amt) as 
	FCST_WAGE from WW_WLP.mnth_fcst a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_no,c.loc_nm,c.perd_desc,C.wk_id order by c.loc_no,
	c.wk_id) g on f.loc_nm=g.loc_nm order by f.loc_nm) C group by c.loc_nm) S where R.loc_nm=S.loc_nm]]>
	</VartoFCSTTotalWeekData>
	*/
</TCName>

<TCName name = "LYPercentageSales_CurrentMonth_WeekData">
	<LYPercentageSalesWeekData>
	<![CDATA[select T.wk_id,
	case when NVL(T.PLN_SLS_MNTH_STR,0)=0 and NVL(U.ACTL_SALES_LY,0)=0 then 0 
	when NVL(T.PLN_SLS_MNTH_STR,0)=0 then -100 when NVL(U.ACTL_SALES_LY,0)=0 then 0 
	else ROUND(((T.PLN_SLS_MNTH_STR / U.ACTL_SALES_LY)-1)*100,2) end as LY_SLS_PRCNT from 
  (select rownum x,TT.* from 
  (select f.perd_desc,f.wk_id,NVL(sum(e.PLAN_SALES),0)
		as PLN_SLS_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f LEFT OUTER JOIN (select * from (select a.loc_no,b.perd_desc,a.wk_id,
		round(sum(a.mgr_wky_sls),0) as PLAN_SALES from ww_wlp.mgr_wky_pln a,wk b where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id in (select wk_id from ww_wlp.wk where 
		perd_desc='Month') and a.wk_id=b.wk_id group by a.loc_no,b.perd_desc,a.wk_id order by a.loc_no,b.perd_desc,a.wk_id) c 
		UNION 
		select * from 
		(select loc_no,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES from ww_wlp.fcst a,wk b where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and dept_no NOT IN (0,20,90)
		and fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and (a.loc_no,b.wk_id) NOT IN (select distinct loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and wk_id 
		in (select wk_id from ww_wlp.wk where perd_desc='Month')) group by loc_no,b.perd_desc,b.wk_id order by loc_no,b.perd_desc,b.wk_id) d) e on f.perd_desc=e.perd_desc
		and f.wk_id=e.wk_id group by f.perd_desc,f.wk_id order by f.wk_id) TT order by x,TT.perd_desc,TT.wk_id) T,
    (select rownum x,UU.* from 
    (select f.perd_desc,f.wk_id,NVL(sum(e.ACTL_SALES_LY),0)
		as ACTL_SALES_LY from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='LYMonth') f LEFT OUTER JOIN (select S.perd_desc,S.wk_id,sum(S.ACTL_SALES_LY) as ACTL_SALES_LY from (select b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0)
		as ACTL_SALES_LY from WW_WLP.DLY_SLS a,WW_WLP.WK b where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('LYMonth') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division')
		and a.Dept_no NOT IN (0,20,90) group by b.perd_desc,b.wk_id order by b.wk_id) S group by S.perd_desc,S.wk_id order by S.perd_desc,S.wk_id) e on f.perd_desc=e.perd_desc
		and f.wk_id=e.wk_id group by f.perd_desc,f.wk_id order by f.wk_id) UU order by x,UU.perd_desc,UU.wk_id) U 
    where T.x=U.x order by T.wk_id]]>
	</LYPercentageSalesWeekData>
  
  
  /*
	<LYPercentageSalesTotalWeekData>
	<![CDATA[select T.loc_nm,
	case when NVL(T.PLN_SLS_MNTH_STR_TOT,0)=0 and NVL(U.ACTL_SALES_TOT_LY,0)=0 then 0 
	when NVL(T.PLN_SLS_MNTH_STR_TOT,0)=0 then -100 when NVL(U.ACTL_SALES_TOT_LY,0)=0 then 0 
	else ROUND(((T.PLN_SLS_MNTH_STR_TOT / U.ACTL_SALES_TOT_LY)-1)*100,2) end as LY_PRCNT_TOT_SLS_MPZ from (select g.loc_nm,
	ROUND(sum(g.PLN_SLS_MNTH_STR),0) as PLN_SLS_MNTH_STR_TOT from (select f.loc_nm,NVL(e.PLAN_SALES,0) as PLN_SLS_MNTH_STR from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select * from (select a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) 
	as PLAN_SALES from ww_wlp.mgr_wky_pln a,wk b,loc lc where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id in (select wk_id from ww_wlp.wk where 
	perd_desc='Month') and a.wk_id=b.wk_id group by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id) c 
	UNION
	select * from (select a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES from ww_wlp.fcst a,wk b,loc lc
	where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.dept_no NOT IN (0,20,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month'
	and (a.loc_no,b.wk_id) NOT IN (select distinct loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
	and a.loc_no=lc.loc_no group by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id) d) e on f.loc_nm=e.loc_nm order 
	by f.loc_nm) g group by g.loc_nm) T INNER JOIN (select J.loc_nm,ROUND(sum(J.ACTL_SLS_MPZ),0) as ACTL_SALES_TOT_LY from (select T.loc_nm,NVL(U.ACTL_SALES,0)
    as ACTL_SLS_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_SALES from 
	(select lc.loc_nm,b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b,loc lc where a.TXN_DTE between b.WK_STRT 
	and b.WK_END and b.PERD_DESC in ('LYMonth') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) and a.loc_no=lc.loc_no
	group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm) U 
	on T.loc_nm=U.loc_nm]]>
	</LYPercentageSalesTotalWeekData>  */
</TCName>

<TCName name = "BudgetPercentageSales_CurrentMonth_WeekData">
	<BUDPercentageSalesWeekData>
	<![CDATA[select T.wk_id,
	case when NVL(T.PLN_SLS_MNTH_STR,0)=0 and NVL(U.BDGT_SALES_MNTH_STR,0)=0 then 0 
	when NVL(T.PLN_SLS_MNTH_STR,0)=0 then -100 when NVL(U.BDGT_SALES_MNTH_STR,0)=0 then 0 
	else ROUND(((T.PLN_SLS_MNTH_STR / U.BDGT_SALES_MNTH_STR)-1)*100,2) end as BDGT_PRCNT_SLS_MPZ from 
  (select f.perd_desc,f.wk_id,NVL(sum(e.PLAN_SALES),0) as PLN_SLS_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f LEFT OUTER JOIN (select * from (select a.loc_no,
		b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES from ww_wlp.mgr_wky_pln a,wk b where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id in (select wk_id from 
		ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id group by a.loc_no,b.perd_desc,a.wk_id order by a.loc_no,b.perd_desc,a.wk_id) c 
		UNION 
		select * from 
		(select loc_no,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES from ww_wlp.fcst a,wk b where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and dept_no NOT IN (0,20,90) and 
		fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and (a.loc_no,b.wk_id) NOT IN (select distinct loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and wk_id in
		(select wk_id from ww_wlp.wk where perd_desc='Month')) group by loc_no,b.perd_desc,b.wk_id order by loc_no,b.perd_desc,b.wk_id) d) e on f.perd_desc=e.perd_desc 
		and f.wk_id=e.wk_id group by f.perd_desc,f.wk_id order by f.wk_id) T,
    (select f.perd_desc,f.wk_id,NVL(sum(g.BDGT_SALES_MNTH_STR),0) as BDGT_SALES_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
		LEFT OUTER JOIN	(select C.loc_no,C.perd_desc,c.wk_id,ROUND(sum(BDGT_SALES),0) as BDGT_SALES_MNTH_STR from
		(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id,ROUND(sum(bdgt_sls),0) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
		from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
		and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,
		a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C group by c.loc_no,c.perd_desc,C.wk_id order by c.loc_no,c.wk_id) g
		on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id group by f.perd_desc,f.wk_id order by f.wk_id) U where T.wk_id=U.wk_id order by T.wk_id]]>
	</BUDPercentageSalesWeekData>

/*	<BUDPercentageSalesTotalWeekData>
	<![CDATA[select T.loc_nm,
	case when NVL(T.PLN_SLS_TOT_MPZ,0)=0 and NVL(U.BDGT_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(T.PLN_SLS_TOT_MPZ,0)=0 then -100 when NVL(U.BDGT_SLS_TOT_MPZ,0)=0 then 0 
	else ROUND(((T.PLN_SLS_TOT_MPZ / U.BDGT_SLS_TOT_MPZ)-1)*100,2) end as BDGT_PRCNT_TOT_SLS_MPZ from 
	(select g.loc_nm,ROUND(sum(g.PLN_SLS_MNTH_STR),0) as PLN_SLS_TOT_MPZ from (select f.loc_nm,NVL(e.PLAN_SALES,0) as PLN_SLS_MNTH_STR from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select * from (select a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) 
	as PLAN_SALES from ww_wlp.mgr_wky_pln a,wk b,loc lc where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id
	group by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id) c 
	UNION 
	select * from 
	(select a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES from ww_wlp.fcst a,wk b,loc lc where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.dept_no NOT IN (0,20,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and (a.loc_no,b.wk_id) NOT IN (select distinct loc_no,wk_id from ww_wlp.mgr_wky_pln 
	where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month')) and a.loc_no=lc.loc_no 
	group by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id) d) e on f.loc_nm=e.loc_nm order by f.loc_nm) g
	group by g.loc_nm) T INNER JOIN (select C.loc_nm,ROUND(sum(BDGT_SLS_MPZ),0) as BDGT_SLS_TOT_MPZ from (select f.loc_nm,NVL(g.BDGT_SALES_MPZ,0) as BDGT_SLS_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select C.loc_no,C.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(BDGT_SALES),0) as BDGT_SALES_MPZ 
	from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,ROUND(sum(bdgt_sls),0) as BDGT_SALES, sum(bdgt_wage_amt) as 
	BDGT_WAGE from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_no,c.loc_nm,c.perd_desc,C.wk_id order by c.loc_no,
	c.wk_id) g on f.loc_nm=g.loc_nm order by f.loc_nm) C group by c.loc_nm) U on T.loc_nm=U.loc_nm]]>
	</BUDPercentageSalesTotalWeekData>  */
  
	<FCSTPercentageSalesWeekData>
	<![CDATA[select T.wk_id,
	case when NVL(T.PLN_SLS_MNTH_STR,0)=0 and NVL(U.FCST_SALES_MNTH_STR,0)=0 then 0 
	when NVL(T.PLN_SLS_MNTH_STR,0)=0 then -100 when NVL(U.FCST_SALES_MNTH_STR,0)=0 then 0 
	else ROUND(((T.PLN_SLS_MNTH_STR / U.FCST_SALES_MNTH_STR)-1)*100,2) end as FCST_PRCNT_SLS_MPZ from 
  (select f.perd_desc,f.wk_id,NVL(sum(e.PLAN_SALES),0) as PLN_SLS_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f LEFT OUTER JOIN (select * from (select a.loc_no,
		b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES from ww_wlp.mgr_wky_pln a,wk b where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id in (select wk_id from 
		ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id group by a.loc_no,b.perd_desc,a.wk_id order by a.loc_no,b.perd_desc,a.wk_id) c 
		UNION 
		select * from 
		(select loc_no,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES from ww_wlp.fcst a,wk b where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and dept_no NOT IN (0,20,90) and 
		fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and (a.loc_no,b.wk_id) NOT IN (select distinct loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and wk_id in
		(select wk_id from ww_wlp.wk where perd_desc='Month')) group by loc_no,b.perd_desc,b.wk_id order by loc_no,b.perd_desc,b.wk_id) d) e on f.perd_desc=e.perd_desc 
		and f.wk_id=e.wk_id group by f.perd_desc,f.wk_id order by f.wk_id) T,
    (select f.perd_desc,f.wk_id,NVL(ROUND(sum(g.FCST_SALES_MPZ),0),0) as FCST_SALES_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
		LEFT OUTER JOIN (select C.loc_no,C.perd_desc,c.wk_id,ROUND(sum(FRCST_SLS),9) as FCST_SALES_MPZ from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
		d.perd_desc,a.wk_id,ROUND(sum(FRCST_SLS),9) as FRCST_SLS, sum(FRCST_WAGE_AMT) as FCST_WAGE from WW_WLP.MNTH_FCST a,loc b, wk d 
		where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT 
		IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C
		group by c.loc_no,c.perd_desc,C.wk_id order by c.loc_no,c.wk_id) g on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id group by f.perd_desc,f.wk_id order by f.wk_id) U 
    where T.wk_id=U.wk_id order by T.wk_id]]>
	</FCSTPercentageSalesWeekData>
  /*
	<FCSTPercentageSalesTotalWeekData>
	<![CDATA[select T.loc_nm,
	case when NVL(T.PLN_SLS_TOT_MPZ,0)=0 and NVL(U.FCST_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(T.PLN_SLS_TOT_MPZ,0)=0 then -100 when NVL(U.FCST_SLS_TOT_MPZ,0)=0 then 0 
	else ROUND(((T.PLN_SLS_TOT_MPZ / U.FCST_SLS_TOT_MPZ)-1)*100,2) end as FCST_PRCNT_TOT_SLS_MPZ from (select g.loc_nm,
	ROUND(sum(g.PLN_SLS_MNTH_STR),0) as PLN_SLS_TOT_MPZ from (select f.loc_nm,NVL(e.PLAN_SALES,0) as PLN_SLS_MNTH_STR from (select loc_nm from loc where 
	loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select * from (select a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES from 
	ww_wlp.mgr_wky_pln a,wk b,loc lc where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and 
	a.wk_id=b.wk_id group by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id) c 
	UNION 
	select * from 
	(select a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES from ww_wlp.fcst a,wk b,loc lc where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.dept_no NOT IN (0,20,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and (a.loc_no,b.wk_id) NOT IN (select distinct loc_no,wk_id from 
	ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month')) and a.loc_no=lc.loc_no 
	group by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id) d) e on f.loc_nm=e.loc_nm order by f.loc_nm) g
	group by g.loc_nm) T INNER JOIN (select C.loc_nm,ROUND(sum(FCST_SLS_MPZ),0) as FCST_SLS_TOT_MPZ from (select f.loc_nm,NVL(g.FCST_SALES_MPZ,0) as 
	FCST_SLS_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select C.loc_no,C.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(FCST_SALES),0) 
	as FCST_SALES_MPZ from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,ROUND(sum(frcst_sls),0) as FCST_SALES, 
	sum(frcst_wage_amt) as FCST_WAGE from WW_WLP.mnth_fcst a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and 
	a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
	b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_no,c.loc_nm,c.perd_desc,
	C.wk_id order by c.loc_no,c.wk_id) g on f.loc_nm=g.loc_nm order by f.loc_nm) C group by c.loc_nm) U on T.loc_nm=U.loc_nm]]>
	</FCSTPercentageSalesTotalWeekData>  */
</TCName>

<TCName name = "BudgetWages_CurrentMonth_WeekData">
	<BudgetWagesWeekData>
	<![CDATA[select f.wk_id,NVL(ROUND(sum(g.BDGT_WAGES_MNTH_STR),0),0) as BDGT_WAGE_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
		LEFT OUTER JOIN (select C.loc_no,C.perd_desc,c.wk_id,ROUND(sum(BDGT_WAGE),9) as BDGT_WAGES_MNTH_STR from
		(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id,ROUND(sum(bdgt_sls),9) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
		from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
		and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (20) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,
		b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C group by c.loc_no,c.perd_desc,C.wk_id order by c.loc_no,c.wk_id) g
		on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id group by f.wk_id order by f.wk_id]]>
	</BudgetWagesWeekData>
  /*
	<BudgetWagesTotalWeekData>
	<![CDATA[select C.loc_nm,ROUND(sum(BDGT_WAGE_MPZ),0) as BDGT_WAGE_TOT_MPZ from (select f.loc_nm,NVL(g.BDGT_WAGES_MNTH_STR,0) as BDGT_WAGE_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(BDGT_WAGE),0) as 
	BDGT_WAGES_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,ROUND(sum(bdgt_sls),0) as BDGT_SALES, 
	sum(bdgt_wage_amt) as BDGT_WAGE from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and 
	a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (20) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,
	d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_no,c.loc_nm,c.perd_desc,
	C.wk_id order by c.loc_no,c.wk_id) g on f.loc_nm=g.loc_nm order by f.loc_nm) C group by c.loc_nm]]>
	</BudgetWagesTotalWeekData>  */
	
	<ForecastWagesWeekData>
	<![CDATA[select f.wk_id,NVL(sum(g.FCST_WAGE_MNTH_STR),0) as FCST_WAGE_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
		LEFT OUTER JOIN (select c.perd_desc,c.wk_id,ROUND(sum(FCST_WAGE),0) as FCST_WAGE_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,
		a.wk_id,sum(frcst_sls) as FCST_SALES, sum(frcst_wage_amt) as FCST_WAGE from WW_WLP.mnth_fcst a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where 
		perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (20) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,
		a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C
		group by c.perd_desc,C.wk_id order by c.perd_desc,c.wk_id) g
		on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id group by f.wk_id order by f.wk_id]]>
	</ForecastWagesWeekData>
  /*
	<ForecastWagesTotalWeekData>
	<![CDATA[select C.loc_nm,ROUND(sum(FCST_WAGE_MPZ),0) as FCST_WAGE_TOT_MPZ from (select f.loc_nm,NVL(g.FCST_WAGES_MNTH_STR,0) as FCST_WAGE_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(FCST_WAGE),0) as FCST_WAGES_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,ROUND(sum(frcst_sls),0) as FCST_SALES, sum(frcst_wage_amt) as FCST_WAGE 
	from WW_WLP.mnth_fcst a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (20) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_no,c.loc_nm,c.perd_desc,C.wk_id order by c.loc_no,c.wk_id) g
	on f.loc_nm=g.loc_nm order by f.loc_nm) C group by c.loc_nm]]>
	</ForecastWagesTotalWeekData> */
</TCName>

<TCName name = "BaseCostWages_CurrentMonth_WeekData">
	<BaseCostWagesWeekData>
	<![CDATA[select f.wk_id,NVL(sum(e.BASE_COST_MNTH_PLN_STR),0) as BASE_COST_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f
		LEFT OUTER JOIN (select d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from 
		(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, 
		ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')
		and DEPT_NO NOT IN (20)) d group by d.wk_id order by d.wk_id) e on e.wk_id=f.wk_id group by f.wk_id order by f.wk_id]]>
	</BaseCostWagesWeekData>
  /*
	<BaseCostWagesTotalWeekData>
	<![CDATA[select e.loc_nm,NVL(e.BASE_COST_TOT_MNTH_PLN_STR,0) as BASE_COST_TOT_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f
	LEFT OUTER JOIN (select d.loc_nm,d.perd_desc,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_TOT_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, 
	ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d
	group by d.loc_nm,d.perd_desc) e on e.loc_nm=f.loc_nm]]>
	</BaseCostWagesTotalWeekData> */
</TCName>

<TCName name = "PlannedWages_CurrentMonth_WeekData">
	<PlannedWagesWeekData>
	<![CDATA[select f.wk_id,NVL(sum(e.PLN_WAGE_MNTH_PLN_STR),0) as PLN_WAGE_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f
	LEFT OUTER JOIN (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and 
	b.perd_desc in ('Month')) d group by d.wk_id order by d.wk_id) 
	UNION 
	select * from (select d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as 
	BASE_COST_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')
	and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.wk_id order by d.wk_id)) e on e.wk_id=f.wk_id group by f.wk_id order by f.wk_id]]>
	</PlannedWagesWeekData>
  /*
	<PlannedWagesTotalWeekData>
	<![CDATA[select g.loc_nm,NVL(sum(g.PLN_WAGE_MPZ),0) as PLN_WAGE_TOT_MPZ from (select f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select * from (select d.loc_nm,d.perd_desc,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as 
	PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, 
	ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.loc_nm,d.perd_desc,
	d.wk_id order by d.loc_nm,d.perd_desc,d.wk_id) 
	UNION 
	select * from (select d.loc_nm,d.perd_desc,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + 
	sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,
	TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and 
	b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_nm,d.perd_desc,d.wk_id order by d.loc_nm,
	d.perd_desc,d.wk_id)) e on e.loc_nm=f.loc_nm order by f.loc_nm) g group by g.loc_nm]]>
	</PlannedWagesTotalWeekData>  */
</TCName>

<TCName name = "LYPercentageWages_CurrentMonth_WeekData">
	<LYPercentageWagesWeekData>
	<![CDATA[select T.wk_id,
	case when NVL(T.PLN_WAGE_MNTH_STR_CY,0)=0 and NVL(U.ACTL_WAGE_LY,0)=0 then 0 
	when NVL(T.PLN_WAGE_MNTH_STR_CY,0)=0 then -100 when NVL(U.ACTL_WAGE_LY,0)=0 then 0 
	else ROUND(((T.PLN_WAGE_MNTH_STR_CY / U.ACTL_WAGE_LY)-1)*100,2) end as LY_PRCNT_WAGE_MNTH_STR from 
	(select x,f.wk_id,NVL(sum(e.PLN_WAGE_MNTH_PLN_STR),0) as PLN_WAGE_MNTH_STR_CY from (select rownum x,perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) f
	LEFT OUTER JOIN (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and 
	b.perd_desc in ('Month')) d group by d.wk_id order by d.wk_id) 
	UNION 
	select * from (select d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as 
	BASE_COST_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')
	and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.wk_id order by d.wk_id)) e on e.wk_id=f.wk_id group by x,f.wk_id order by x,f.wk_id) T,
	(select UU.x,UU.wk_id,sum(ACTL_WAGE_LY) as ACTL_WAGE_LY from
  (select rownum x,T.perd_desc,T.wk_id,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_LY from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('LYMonth') order by wk_id) T
	LEFT OUTER JOIN (select c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from 
	ww_wlp.wk where perd_desc in ('LYMonth')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20
	group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C
	group by C.wk_id order by c.wk_id) U on T.wk_id=U.wk_id order by T.wk_id) UU group by UU.x,UU.wk_id order by UU.x,UU.wk_id) U 
  where T.x=U.x order by T.wk_id]]>
	</LYPercentageWagesWeekData>
  /*
	<LYPercentageWagesTotalWeekData>
	<![CDATA[select T.loc_nm,
	case when NVL(T.PLN_WAGE_TOT_CY_MPZ,0)=0 and NVL(U.ACTL_WAGE_TOT_LY_MPZ,0)=0 then 0 
	when NVL(T.PLN_WAGE_TOT_CY_MPZ,0)=0 then -100 when NVL(U.ACTL_WAGE_TOT_LY_MPZ,0)=0 then 0 
	else ROUND(((T.PLN_WAGE_TOT_CY_MPZ / U.ACTL_WAGE_TOT_LY_MPZ)-1)*100,2) end as LY_PRCNT_TOT_WAGE_MPZ from (select g.loc_nm,
	NVL(sum(g.PLN_WAGE_MPZ),0) as PLN_WAGE_TOT_CY_MPZ from (select f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select * from (select d.loc_nm,d.perd_desc,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) 
	as PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE
	from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d
	group by d.loc_nm,d.perd_desc,d.wk_id order by d.loc_nm,d.perd_desc,d.wk_id) 
	UNION 
	select * from (select d.loc_nm,d.perd_desc,d.wk_id,
	ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no=
	'store' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, 
	ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_nm,d.perd_desc,
	d.wk_id order by d.loc_nm,d.perd_desc,d.wk_id)) e on e.loc_nm=f.loc_nm order by f.loc_nm) g group by g.loc_nm) T,(select T.loc_nm,
	NVL(ROUND(sum(U.ACTL_WAGE_MNTH_STR),0),0) as ACTL_WAGE_TOT_LY_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN
	(select c.loc_nm,c.wk_id,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
	where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('LYMonth')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and 
	a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
	b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_nm,C.wk_id order by c.loc_nm,c.wk_id) U on T.loc_nm=U.loc_nm  group by T.loc_nm) U 
	where T.loc_nm=U.loc_nm]]>
	</LYPercentageWagesTotalWeekData>   */
</TCName>

<TCName name = "BudgetWagesPercentage_CurrentMonth_WeekData">
	<BudgetWagesPercentageWeekData>
	<![CDATA[select h.wk_id,
	case when NVL(h.BDGT_WAGE_MNTH_STR,0)=0 and NVL(i.BDGT_SLS_MNTH_STR,0)=0 then 0 
	when NVL(h.BDGT_WAGE_MNTH_STR,0)=0 then 0 when NVL(i.BDGT_SLS_MNTH_STR,0)=0 then 0 
	else ROUND((h.BDGT_WAGE_MNTH_STR / i.BDGT_SLS_MNTH_STR)*100,2) end as BDGT_WAGE_PRCNT_MNTH_STR from (select f.perd_desc,f.wk_id,
		NVL(sum(g.BDGT_WAGES_MNTH_STR),0) as BDGT_WAGE_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f LEFT OUTER JOIN
		(select C.loc_no,C.perd_desc,c.wk_id,ROUND(sum(BDGT_WAGE),0) as BDGT_WAGES_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
		d.perd_desc,a.wk_id,ROUND(sum(bdgt_sls),0) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE from WW_WLP.wky_bdgt a,loc b, wk d 
		where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and 
		a.dept_no NOT IN (20) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
		d.perd_desc,a.wk_id) C group by c.loc_no,c.perd_desc,C.wk_id order by c.loc_no,c.wk_id) g on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id 
    group by f.perd_desc,f.wk_id order by f.wk_id) h
		INNER JOIN (select f.perd_desc,f.wk_id,NVL(sum(g.BDGT_SALES_MNTH_STR),0) as BDGT_SLS_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where 
		perd_desc='Month') f LEFT OUTER JOIN (select C.loc_no,C.perd_desc,c.wk_id,ROUND(sum(BDGT_SALES),0) as BDGT_SALES_MNTH_STR from
		(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id,ROUND(sum(bdgt_sls),0) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE from 
		WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
		and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id 
		order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C group by c.loc_no,c.perd_desc,C.wk_id order by c.loc_no,c.wk_id) g
		on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id group by f.perd_desc,f.wk_id order by f.wk_id) i on h.perd_desc=i.perd_desc and h.wk_id=i.wk_id order by i.wk_id]]>
	</BudgetWagesPercentageWeekData>
  /*
	<BudgetWagesPercentageTotalWeekData>
	<![CDATA[select h.loc_nm,
	case when NVL(h.BDGT_WAGE_TOT_MPZ,0)=0 and NVL(i.BDGT_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(h.BDGT_WAGE_TOT_MPZ,0)=0 then 0 when NVL(i.BDGT_SLS_TOT_MPZ,0)=0 then 0 
	else ROUND((h.BDGT_WAGE_TOT_MPZ / i.BDGT_SLS_TOT_MPZ)*100,2) end as BDGT_WAGE_PRCNT_TOT_MPZ from (select C.loc_nm,
	ROUND(sum(BDGT_WAGE_MPZ),0) as BDGT_WAGE_TOT_MPZ from (select f.loc_nm,NVL(g.BDGT_WAGES_MNTH_STR,0) as BDGT_WAGE_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(BDGT_WAGE),0) as 
	BDGT_WAGES_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,ROUND(sum(bdgt_sls),0) as BDGT_SALES, 
	sum(bdgt_wage_amt) as BDGT_WAGE from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and 
	a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (20) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,
	d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_no,c.loc_nm,c.perd_desc,C.wk_id 
	order by c.loc_no,c.wk_id) g on f.loc_nm=g.loc_nm order by f.loc_nm) C group by c.loc_nm) h INNER JOIN (select C.loc_nm,ROUND(sum(BDGT_SLS_MPZ),0) as 
	BDGT_SLS_TOT_MPZ from (select f.loc_nm,NVL(g.BDGT_SALES_MPZ,0) as BDGT_SLS_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN
	(select C.loc_no,C.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(BDGT_SALES),0) as BDGT_SALES_MPZ from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
	b.loc_nm,d.perd_desc,a.wk_id,ROUND(sum(bdgt_sls),0) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE from WW_WLP.wky_bdgt a,loc b, wk d 
	where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and 
	a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_no,c.loc_nm,c.perd_desc,C.wk_id order by c.loc_no,c.wk_id) g
 	on f.loc_nm=g.loc_nm order by f.loc_nm) C group by c.loc_nm) i on h.loc_nm=i.loc_nm]]>
	</BudgetWagesPercentageTotalWeekData>  */
	<ForecastWagesPercentageWeekData>
	<![CDATA[select h.wk_id,
	case when NVL(h.FCST_WAGE_MNTH_STR,0)=0 and NVL(i.FCST_SLS_MNTH_STR,0)=0 then 0 
	when NVL(h.FCST_WAGE_MNTH_STR,0)=0 then 0 when NVL(i.FCST_SLS_MNTH_STR,0)=0 then 0 
	else ROUND((h.FCST_WAGE_MNTH_STR / i.FCST_SLS_MNTH_STR)*100,2) end as FCST_WAGE_PRCNT_MNTH_STR from 
  (select f.perd_desc,f.wk_id,NVL(ROUND(sum(g.FCST_WAGES_MNTH_STR),0),0) as FCST_WAGE_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f LEFT OUTER JOIN
		(select C.loc_no,C.perd_desc,c.wk_id,ROUND(sum(FCST_WAGE),9) as FCST_WAGES_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,
		a.wk_id,ROUND(sum(frcst_sls),9) as FCST_SALES, sum(frcst_wage_amt) as FCST_WAGE from WW_WLP.mnth_fcst a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk 
		where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (20) group by a.div_no,b.rgn_no,b.zone_no,
		b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C group by c.loc_no,c.perd_desc,C.wk_id order by 
		c.loc_no,c.wk_id) g on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id group by f.perd_desc,f.wk_id order by f.wk_id) h 
    INNER JOIN 
    (select f.perd_desc,f.wk_id,NVL(ROUND(sum(g.FCST_SALES_MNTH_STR),0),0) as 
		FCST_SLS_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f LEFT OUTER JOIN (select C.loc_no,C.perd_desc,c.wk_id,ROUND(sum(FCST_SALES)
		,9) as FCST_SALES_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id,ROUND(sum(frcst_sls),9) as FCST_SALES, sum(frcst_wage_amt) 
		as FCST_WAGE from WW_WLP.mnth_fcst a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
		and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by 
		a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C group by c.loc_no,c.perd_desc,C.wk_id order by c.loc_no,c.wk_id) g on f.perd_desc=g.perd_desc 
		and f.wk_id=g.wk_id group by f.perd_desc,f.wk_id order by f.wk_id) i on h.perd_desc=i.perd_desc and h.wk_id=i.wk_id order by i.wk_id]]>
	</ForecastWagesPercentageWeekData>
  
	<ForecastWagesPercentageTotalWeekData>
	<![CDATA[select h.loc_nm,
	case when NVL(h.FCST_WAGE_TOT_MPZ,0)=0 and NVL(i.FCST_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(h.FCST_WAGE_TOT_MPZ,0)=0 then 0 when NVL(i.FCST_SLS_TOT_MPZ,0)=0 then 0 
	else ROUND((h.FCST_WAGE_TOT_MPZ / i.FCST_SLS_TOT_MPZ)*100,2) end as FCST_WAGE_PRCNT_TOT_MPZ from (select C.loc_nm,
	ROUND(sum(FCST_WAGE_MPZ),0) as FCST_WAGE_TOT_MPZ from (select f.loc_nm,NVL(g.FCST_WAGES_MNTH_STR,0) as FCST_WAGE_MPZ from (select loc_nm from loc where 
	loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(FCST_WAGE),0) as FCST_WAGES_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,ROUND(sum(frcst_sls),0) as FCST_SALES, sum(frcst_wage_amt) as FCST_WAGE 
	from WW_WLP.mnth_fcst a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (20) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_no,c.loc_nm,c.perd_desc,C.wk_id order by c.loc_no,
	c.wk_id) g on f.loc_nm=g.loc_nm order by f.loc_nm) C group by c.loc_nm) h INNER JOIN (select C.loc_nm,ROUND(sum(FCST_SLS_MPZ),0) as FCST_SLS_TOT_MPZ from
	(select f.loc_nm,NVL(g.FCST_SALES_MPZ,0) as FCST_SLS_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select C.loc_no,C.loc_nm,
	C.perd_desc,c.wk_id,ROUND(sum(FCST_SALES),0) as FCST_SALES_MPZ from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,
	ROUND(sum(frcst_sls),0) as FCST_SALES, sum(frcst_wage_amt) as FCST_WAGE from WW_WLP.mnth_fcst a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk 
	where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,
	b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
	group by c.loc_no,c.loc_nm,c.perd_desc,C.wk_id order by c.loc_no,c.wk_id) g on f.loc_nm=g.loc_nm order by f.loc_nm) C
	group by c.loc_nm) i on h.loc_nm=i.loc_nm]]>
	</ForecastWagesPercentageTotalWeekData>  */
</TCName>

<TCName name = "PlannedWagesPercentage_CurrentMonth_WeekData">
	<PlannedWagesPercentageWeekData>
	<![CDATA[select j.wk_id,
	case when NVL(j.PLN_WAGE_MPZ,0)=0 and NVL(n.PLN_SLS_MPZ,0)=0 then 0 
	when NVL(j.PLN_WAGE_MPZ,0)=0 then 0 when NVL(n.PLN_SLS_MPZ,0)=0 then 0 
	else ROUND((j.PLN_WAGE_MPZ / n.PLN_SLS_MPZ)*100,2) end as PLN_WAGE_PRCNT_MPZ from (select f.perd_desc,f.wk_id,NVL(sum(e.PLN_WAGE_MNTH_PLN_STR),0) as PLN_WAGE_MPZ from
 		(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f LEFT OUTER JOIN (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as 
 		PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, 
 		ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.wk_id order by d.wk_id) 
		UNION
		select * from (select d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,
		a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
		where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id 
		from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
		group by d.wk_id order by d.wk_id)) e on e.wk_id=f.wk_id group by f.perd_desc,f.wk_id order by f.wk_id) j 
    INNER JOIN 
    (select f.perd_desc,f.wk_id,NVL(sum(e.PLAN_SALES),0) as PLN_SLS_MPZ from 
		(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f LEFT OUTER JOIN (select * from (select a.loc_no,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) 
		as PLAN_SALES from ww_wlp.mgr_wky_pln a,wk b where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=
		b.wk_id group by a.loc_no,b.perd_desc,a.wk_id order by a.loc_no,b.perd_desc,a.wk_id) c 
		UNION 
		select * from (select loc_no,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0)
		as GEN_SALES from ww_wlp.fcst a,wk b where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and dept_no NOT IN (0,20,90) and fcst_dte between b.wk_strt and b.wk_end and b.perd_desc=
		'Month' and (a.loc_no,b.wk_id) NOT IN (select distinct loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
		group by loc_no,b.perd_desc,b.wk_id order by loc_no,b.perd_desc,b.wk_id) d) e on f.perd_desc=e.perd_desc and f.wk_id=e.wk_id 
    group by f.perd_desc,f.wk_id order by f.wk_id) n
		on j.wk_id=n.wk_id order by j.wk_id]]>
	</PlannedWagesPercentageWeekData>
  /*
	<PlannedWagesPercentageTotalWeekData>
	<![CDATA[select j.loc_nm,
	case when NVL(j.PLN_WAGE_TOT_MPZ,0)=0 and NVL(n.PLN_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(j.PLN_WAGE_TOT_MPZ,0)=0 then 0 when NVL(n.PLN_SLS_TOT_MPZ,0)=0 then 0 
	else ROUND((j.PLN_WAGE_TOT_MPZ / n.PLN_SLS_TOT_MPZ)*100,2) end as PLN_WAGE_PRCNT_TOT_MPZ from (select g.loc_nm,NVL(sum(g.PLN_WAGE_MPZ),0) 
	as PLN_WAGE_TOT_MPZ from (select f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f
	LEFT OUTER JOIN (select * from (select d.loc_nm,d.perd_desc,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.loc_nm,d.perd_desc,d.wk_id order by d.loc_nm,d.perd_desc,d.wk_id)
	UNION 
	select * from (select d.loc_nm,d.perd_desc,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, 
	ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where 
	(d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id) from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
	group by d.loc_nm,d.perd_desc,d.wk_id order by d.loc_nm,d.perd_desc,d.wk_id)) e on e.loc_nm=f.loc_nm order by f.loc_nm) g group by g.loc_nm) j
	INNER JOIN (select g.loc_nm,ROUND(sum(g.PLN_SLS_MNTH_STR),0) as PLN_SLS_TOT_MPZ from (select f.loc_nm,NVL(e.PLAN_SALES,0) as PLN_SLS_MNTH_STR from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select * from (select a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) 
	as PLAN_SALES from ww_wlp.mgr_wky_pln a,wk b,loc lc where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id
	group by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id) c 
	UNION 
	select * from 
	(select a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES from ww_wlp.fcst a,wk b,loc lc
	where a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.dept_no NOT IN (0,20,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month'
	and (a.loc_no,b.wk_id) NOT IN (select distinct loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
	and a.loc_no=lc.loc_no group by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id) d) e
	on f.loc_nm=e.loc_nm order by f.loc_nm) g group by g.loc_nm) n on j.loc_nm=n.loc_nm]]>
	</PlannedWagesPercentageTotalWeekData> */
</TCName>

<TCName name = "LYWagesPercentage_CurrentMonth_WeekData">
	<LYWagesPercentageWeekData>
	<![CDATA[select x.wk_id,
	case when NVL(x.ACTL_WAGE_LY_MPZ,0)=0 and NVL(y.ACTL_SLS_LY_MPZ,0)=0 then 0 
	when NVL(x.ACTL_WAGE_LY_MPZ,0)=0 then 0 when NVL(y.ACTL_SLS_LY_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_WAGE_LY_MPZ / y.ACTL_SLS_LY_MPZ)*100,2) end as LY_WAGE_PRCNT_MPZ from 
  (select T.wk_id,NVL(sum(U.ACTL_WAGE_MNTH_STR),0) as ACTL_WAGE_LY_MPZ from 
  (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('LYMonth') order by wk_id) T 
  LEFT OUTER JOIN
		(select c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.
		loc_no,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
		where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('LYMonth')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and 
		a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.
		perd_desc,a.wk_id) C group by C.wk_id order by c.wk_id) U on T.wk_id=U.wk_id group by T.wk_id order by T.wk_id) x,
    (select T.wk_id,NVL(sum(U.ACTL_SALES),0) as ACTL_SLS_LY_MPZ from 
    (select perd_desc,wk_id from ww_wlp.wk where perd_desc='LYMonth' order by wk_id) T 
    LEFT OUTER JOIN 
    (select S.perd_desc,S.wk_id,S.ACTL_SALES from 
		(select b.perd_desc,b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b where a.TXN_DTE between b.WK_STRT and b.WK_END
		and b.PERD_DESC in ('LYMonth') and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) group by b.perd_desc,b.wk_id order by b.wk_id) S) U
		on T.wk_id=U.wk_id group by T.wk_id order by T.wk_id) y where x.wk_id=y.wk_id order by x.wk_id]]>
	</LYWagesPercentageWeekData>
  /*
	<LYWagesPercentageTotalWeekData>
	<![CDATA[select x.loc_nm,
		case when NVL(x.ACTL_WAGE_LY_TOT_MPZ,0)=0 and NVL(y.ACTL_SLS_LY_TOT_MPZ,0)=0 then 0 
		when NVL(x.ACTL_WAGE_LY_TOT_MPZ,0)=0 then 0 when NVL(y.ACTL_SLS_LY_TOT_MPZ,0)=0 then 0 
		else ROUND((x.ACTL_WAGE_LY_TOT_MPZ / y.ACTL_SLS_LY_TOT_MPZ)*100,2) end as LY_WAGE_PRCNT_TOT_MPZ from (select T.loc_nm,
		ROUND(NVL(sum(U.ACTL_WAGE_MNTH_STR),0),0) as ACTL_WAGE_LY_TOT_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T INNER JOIN
		(select c.loc_nm,c.wk_id,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,
		a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
		where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('LYMonth')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and 
		a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
		b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_nm,C.wk_id order by c.loc_nm,c.wk_id) U on T.loc_nm=U.loc_nm  group by T.loc_nm) x,
		(select J.loc_nm,ROUND(sum(J.ACTL_SLS_MPZ),0) as ACTL_SLS_LY_TOT_MPZ from (select T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from 
		(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select S.loc_nm,S.perd_desc,S.wk_id,S.ACTL_SALES from (select lc.loc_nm,b.perd_desc,
		b.wk_id, ROUND(sum(a.actl_sls),0) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b,loc lc where a.TXN_DTE between b.WK_STRT and b.WK_END
		and b.PERD_DESC in ('LYMonth') and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.div_no in ('Division') and a.Dept_no NOT IN (0,20,90) and a.loc_no=lc.loc_no
		group by lc.loc_nm,b.perd_desc,b.wk_id order by b.wk_id) S) U on T.loc_nm=U.loc_nm order by T.loc_nm) J  group by J.loc_nm) y
		where x.loc_nm=y.loc_nm]]>
	</LYWagesPercentageTotalWeekData>  */
</TCName>

<TCName name = "SMSHours_CurrentMonth_WeekData">
	<SMSHoursWeekData>
	<![CDATA[select x.wk_id,NVL(ROUND(((ROUND(((sum(y.SMS_HOURS_MPZ)*100)/25),0)*25)/100),2),0) as SMS_HRS_MPZ from (select wk_id from ww_wlp.wk where perd_desc='Month') x LEFT OUTER JOIN
	(select C.wk_id,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPZ from (select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,sum(fix_hrs) as 
	FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,
	a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d 
	where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no and d.dept_no!=20 and b.perd_desc in ('Month') and c.div_no='Division' and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) A
	group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C group by C.wk_id order by c.wk_id) y
	on x.wk_id=y.wk_id group by x.wk_id order by x.wk_id]]>
	</SMSHoursWeekData>
  /*
	<SMSHoursTotalWeekData>
	<![CDATA[select z.loc_nm,NVL(ROUND(((ROUND(((sum(Z.SMS_HRS_MPZ)*100)/25),0)*25)/100),2),0) as SMS_HRS_TOT_MPZ from (select x.loc_nm,NVL(y.SMS_HOURS_MPZ,0) as SMS_HRS_MPZ from 
	(select loc_nm from ww_wlp.loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) x LEFT OUTER JOIN (select C.loc_nm,C.perd_desc,C.wk_id,(sum(C.FIX_HRS_DEPT_TOT) + 
	sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPZ from (select A.loc_no,A.loc_nm,A.perd_desc,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) 
	as VOL_HRS_DEPT_TOT from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,
	NVL(a.vol_hrs,0) as vol_hrs from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d where a.task_no=d.task_no and a.wk_id=b.wk_id and 
	a.loc_no=c.loc_no and d.dept_no!=20 and b.perd_desc in ('Month') and c.div_no='Division' and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) A group by A.loc_no,A.loc_nm,A.perd_desc,A.wk_id,
	A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C group by C.loc_nm,C.perd_desc,C.wk_id order by C.loc_nm,C.perd_desc,c.wk_id) y
	on x.loc_nm=y.loc_nm order by x.loc_nm) z group by z.loc_nm]]>
	</SMSHoursTotalWeekData>  */
</TCName>

<TCName name = "BaseHours_CurrentMonth_WeekData">
	<BaseHoursWeekData>
	<![CDATA[select f.wk_id,NVL(sum(e.BASE_HOURS_MNTH_PLN_STR),0) as BASE_HRS_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f
		LEFT OUTER JOIN (select d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,
		c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
		where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d group by d.wk_id order by d.wk_id) 
		e on e.wk_id=f.wk_id group by f.wk_id order by f.wk_id]]>
	</BaseHoursWeekData>
  /*
	<BaseHoursTotalWeekData>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.BASE_HRS_MPZ),0),0) as BASE_HRS_TOT_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f
	LEFT OUTER JOIN (select d.loc_nm,d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HRS_MPZ from (select c.div_no,c.rgn_no,c.zone_no,
	c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,nvl(TA_PLN_HRS,0) as ta_pln_hrs,nvl(WAGE_ADJ_HRS,0) as WAGE_ADJ_HRS
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')
	and DEPT_NO NOT IN (20)) d group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id) e on e.loc_nm=f.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</BaseHoursTotalWeekData>  */
</TCName>

<TCName name = "PlannedHours_CurrentMonth_WeekData">
	<PlannedHoursWeekData>
	<![CDATA[select f.wk_id,NVL(sum(e.PLN_HOURS_MNTH_PLN_STR),0) as PLN_HRS_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f
		LEFT OUTER JOIN (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,
		a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and 
		a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.wk_id order by d.wk_id) 
		UNION 
		select * from (select d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum
		(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,
		TA_PLN_HRS,WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.
		perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
		where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
		group by d.wk_id order by d.wk_id)) e on e.wk_id=f.wk_id group by f.wk_id order by f.wk_id]]>
	</PlannedHoursWeekData>
  /*
	<PlannedHoursTotalWeekData>
	<![CDATA[select g.loc_nm,NVL(sum(g.PLN_HRS_MPZ),0) as PLN_HRS_TOT_MPZ from (select f.loc_nm,NVL(e.PLN_HOURS_MNTH_PLN_STR,0) as PLN_HRS_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select * from (select d.loc_nm,d.wk_id,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id)
	UNION 
	select * from (select d.loc_nm,d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,nvl(TA_PLN_HRS,0) as TA_PLN_HRS,nvl(WAGE_ADJ_HRS,0) as 
	WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in 
	('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
	group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id)) e on e.loc_nm=f.loc_nm order by f.loc_nm) g group by g.loc_nm]]>
	</PlannedHoursTotalWeekData>  */
</TCName>


<TCName name = "LYPercentageHours_CurrentMonth_WeekData">
	<LYHoursWeekData>
	<![CDATA[select pln_hrs_cy.wk_id,
	case when NVL(pln_hrs_cy.PLN_HRS_CY_MPZ,0)=0 and NVL(actl_hrs_ly.ACTL_HRS_LY_MPZ,0)=0 then 0 
	when NVL(pln_hrs_cy.PLN_HRS_CY_MPZ,0)=0 then -100 when NVL(actl_hrs_ly.ACTL_HRS_LY_MPZ,0)=0 then 0 
	else ROUND(((pln_hrs_cy.PLN_HRS_CY_MPZ / actl_hrs_ly.ACTL_HRS_LY_MPZ)-1)*100,2) end as LY_PRCNT_HRS_MPZ from 
(select x,f.wk_id,NVL(sum(e.PLN_HOURS_MNTH_PLN_STR),0) as PLN_HRS_CY_MPZ from 
(select rownum x,perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month') order by wk_id) f
LEFT OUTER JOIN
(select * from (select d.wk_id,sum(d.MGR_WKY_HRS) as PLN_HOURS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d
group by d.wk_id order by d.wk_id)
UNION
select * from (select d.wk_id,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as BASE_HOURS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')
and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
group by d.wk_id order by d.wk_id)) e on e.wk_id=f.wk_id group by x,f.wk_id order by f.wk_id) pln_hrs_cy,
(select src.x, src.wk_id,sum(ACTL_HRS_LY_MPZ) as ACTL_HRS_LY_MPZ from 
(select rownum x,T.wk_id,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_LY_MPZ from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('LYMonth') order by wk_id) T
LEFT OUTER JOIN
(select c.wk_id,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('LYMonth')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C
group by C.wk_id order by c.wk_id) U
on T.wk_id=U.wk_id order by T.wk_id) src 
group by src.x, src.wk_id order by src.x, src.wk_id) actl_hrs_ly 
where pln_hrs_cy.x=actl_hrs_ly.x  order by pln_hrs_cy.x]]>
	</LYHoursWeekData>
  /*
	<LYHoursTotalWeekData>
	<![CDATA[select pln_hrs_cy.loc_nm,
	case when NVL(pln_hrs_cy.PLN_HRS_CY_TOT_MPZ,0)=0 and NVL(actl_hrs_ly.ACTL_HRS_LY_TOT_MPZ,0)=0 then 0 
	when NVL(pln_hrs_cy.PLN_HRS_CY_TOT_MPZ,0)=0 then -100 when NVL(actl_hrs_ly.ACTL_HRS_LY_TOT_MPZ,0)=0 then 0 
	else ROUND(((pln_hrs_cy.PLN_HRS_CY_TOT_MPZ / actl_hrs_ly.ACTL_HRS_LY_TOT_MPZ)-1)*100,2) end as LY_PRCNT_TOT_HRS_MPZ from 
(select g.loc_nm,NVL(ROUND(sum(g.PLN_HRS_MPZ),0),0) as PLN_HRS_CY_TOT_MPZ from 
(select f.loc_nm,NVL(e.PLN_HOURS_MNTH_PLN_STR,0) as PLN_HRS_MPZ from 
(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f
LEFT OUTER JOIN
(select * from (select d.loc_nm,d.wk_id,ROUND(sum(d.MGR_WKY_HRS),2) as PLN_HOURS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d
group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id)
UNION
select * from (select d.loc_nm,d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),2) as BASE_HOURS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,nvl(TA_PLN_HRS,0) as TA_PLN_HRS,nvl(WAGE_ADJ_HRS,0) as WAGE_ADJ_HRS
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')
and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id)) e on e.loc_nm=f.loc_nm order by f.loc_nm) g group by g.loc_nm) pln_hrs_cy,
(select T.loc_nm,NVL(ROUND(sum(U.ACTL_HRS_MNTH_STR),0),0) as ACTL_HRS_LY_TOT_MPZ from 
(select loc_no,loc_nm from ww_wlp.loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T
LEFT OUTER JOIN
(select c.loc_nm,c.wk_id,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,ROUND(sum(ACTL_HRS),2) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('LYMonth')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by c.loc_nm,C.wk_id order by c.wk_id) U
on T.loc_nm=U.loc_nm  group by T.loc_nm) actl_hrs_ly 
where pln_hrs_cy.loc_nm=actl_hrs_ly.loc_nm  order by pln_hrs_cy.loc_nm]]>
	</LYHoursTotalWeekData>  */
</TCName>

<TCName name = "PlannedCPH_CurrentMonth_WeekData">
	<PlannedCPHWeekData>
	<![CDATA[select x.wk_id,
	case when NVL(x.PLN_WAGE_MPZ,0)=0 and NVL(y.PLN_HRS_MPZ,0)=0 then 0 
	when NVL(x.PLN_WAGE_MPZ,0)=0 then 0 when NVL(y.PLN_HRS_MPZ,0)=0 then 0 
	else ROUND((x.PLN_WAGE_MPZ / y.PLN_HRS_MPZ),2) end as PLN_CPH_MPZ from 
  (select f.wk_id,NVL(sum(e.PLN_WAGE_MNTH_PLN_STR),0) as PLN_WAGE_MPZ from 
		(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f LEFT OUTER JOIN (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as 
		PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, 
		ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.wk_id order by 
		d.wk_id) 
		UNION 
		select * from (select d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from (select c.div_no,
		c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.
		loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN 
		(select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in 
		('Month')) group by d.wk_id order by d.wk_id)) e on e.wk_id=f.wk_id group by f.wk_id order by f.wk_id) x,
    (select f.wk_id,NVL(sum(e.PLN_HOURS_MNTH_PLN_STR),0) as PLN_HRS_MPZ
		from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f 
    LEFT OUTER JOIN 
    (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_HRS) ,0)
		as PLN_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS from ww_wlp.mgr_wky_pln a, 
		ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.wk_id order by 
		d.wk_id) 
		UNION 
		select * from (select d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no
		,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
		where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d 
		where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
		group by d.wk_id order by d.wk_id)) e on e.wk_id=f.wk_id group by f.wk_id order by f.wk_id) y where x.wk_id=y.wk_id order by x.wk_id]]>
	</PlannedCPHWeekData>
  /*
	<PlannedCPHTotalWeekData>
	<![CDATA[select x.loc_nm,
	case when NVL(x.PLN_WAGE_TOT_MPZ,0)=0 and NVL(y.PLN_HRS_TOT_MPZ,0)=0 then 0 
	when NVL(x.PLN_WAGE_TOT_MPZ,0)=0 then 0 when NVL(y.PLN_HRS_TOT_MPZ,0)=0 then 0 
	else ROUND((x.PLN_WAGE_TOT_MPZ / y.PLN_HRS_TOT_MPZ),2) end as PLN_CPH_TOT_MPZ from (select g.loc_nm,NVL(sum(g.PLN_WAGE_MPZ),0) as PLN_WAGE_TOT_MPZ from 
	(select f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN
	(select * from (select d.loc_nm,d.perd_desc,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,
	a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d
	group by d.loc_nm,d.perd_desc,d.wk_id order by d.loc_nm,d.perd_desc,d.wk_id) 
	UNION 
	select * from (select d.loc_nm,d.perd_desc,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, 
	ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')
	and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and 
	c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_nm,d.perd_desc,d.wk_id order by d.loc_nm,d.perd_desc,d.wk_id)) e 
	on e.loc_nm=f.loc_nm order by f.loc_nm) g group by g.loc_nm) x,(select g.loc_nm,NVL(sum(g.PLN_HRS_MPZ),0) as PLN_HRS_TOT_MPZ from 
	(select f.loc_nm,NVL(e.PLN_HOURS_MNTH_PLN_STR,0) as PLN_HRS_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN
	(select * from (select d.loc_nm,d.wk_id,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
	from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d
	group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id) 
	UNION 
	select * from (select d.loc_nm,d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as 
	BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,nvl(TA_PLN_HRS,0) as TA_PLN_HRS,
	nvl(WAGE_ADJ_HRS,0) as WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id 
	and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id)) e 
	on e.loc_nm=f.loc_nm order by f.loc_nm) g group by g.loc_nm) y where x.loc_nm=y.loc_nm]]>
	</PlannedCPHTotalWeekData>   */
</TCName>

<TCName name = "GrowthLYCPH_CurrentMonth_WeekData">
	<GrowthLYCPHWeekData>
	<![CDATA[select pln_cph.wk_id,
	case when pln_cph.PLN_CPH_CY_MPZ=0 and actl_cph.ACTL_CPH_LY_MPZ=0 then 0 
	when pln_cph.PLN_CPH_CY_MPZ=0 then -100 when actl_cph.ACTL_CPH_LY_MPZ=0 then 0 
	else ROUND(((pln_cph.PLN_CPH_CY_MPZ / actl_cph.ACTL_CPH_LY_MPZ)-1)*100,2) end as GROWTH_LY_CPH_MPZ from 
	(select rownum x,x.wk_id,
		case when NVL(x.PLN_WAGE_MPZ,0)=0 and NVL(y.PLN_HRS_MPZ,0)=0 then 0 
		when NVL(x.PLN_WAGE_MPZ,0)=0 then 0 when NVL(y.PLN_HRS_MPZ,0)=0 then 0 
		else ROUND((x.PLN_WAGE_MPZ / y.PLN_HRS_MPZ),2) end as PLN_CPH_CY_MPZ from 
		(select f.wk_id,NVL(sum(e.PLN_WAGE_MNTH_PLN_STR),0) as PLN_WAGE_MPZ from (select perd_desc,
		wk_id from ww_wlp.wk where perd_desc in ('Month')) f LEFT OUTER JOIN (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR 
		from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c
		where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.wk_id order by d.wk_id) 
		UNION
		select * from (select d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no
		,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
		where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d 
		where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
		group by d.wk_id order by d.wk_id)) e on e.wk_id=f.wk_id group by f.wk_id order by f.wk_id) x,
		(select f.wk_id,NVL(sum(e.PLN_HOURS_MNTH_PLN_STR),0) as PLN_HRS_MPZ from 
		(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f LEFT OUTER JOIN (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_HRS) ,0) as 
		PLN_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS from ww_wlp.mgr_wky_pln a, 
		ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.wk_id order by 
		d.wk_id) 
		UNION 
		select * from (select d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.
		rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
		where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d 
		where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')
		) group by d.wk_id order by d.wk_id)) e on e.wk_id=f.wk_id group by f.wk_id order by f.wk_id) y 
		where x.wk_id=y.wk_id order by x.wk_id) pln_cph,
    (select rownum x,T.wk_id,NVL(ACTL_CPH_MNTH_STR,0) as ACTL_CPH_LY_MPZ from 
    (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('LYMonth') order by wk_id) T 
    LEFT OUTER JOIN
		(select c.wk_id,
		case when NVL(sum(ACTL_WAGE),0)=0 and NVL(sum(ACTL_HRS),0)=0 then 0 
		when NVL(sum(ACTL_WAGE),0)=0 then 0 when NVL(sum(ACTL_HRS),0)=0 then 0 
		else ROUND((ROUND(sum(ACTL_WAGE),0) / sum(ACTL_HRS)),2) end as ACTL_CPH_MNTH_STR from 
    (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id 
		from ww_wlp.wk where perd_desc in ('LYMonth')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,
		b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.perd_desc,a.wk_id) C
		group by C.wk_id order by c.wk_id) U on T.wk_id=U.wk_id order by T.wk_id) actl_cph where pln_cph.x=actl_cph.x order by pln_cph.wk_id]]>
	</GrowthLYCPHWeekData>
  /*
	<GrowthLYCPHTotalWeekData>
	<![CDATA[select pln_cph_cy.loc_nm,
	case when pln_cph_cy.PLN_CPH_TOT_CY_MPZ=0 and actl_cph_ly.ACTL_CPH_TOT_LY_MPZ=0 then 0 
	when pln_cph_cy.PLN_CPH_TOT_CY_MPZ=0 then -100  when actl_cph_ly.ACTL_CPH_TOT_LY_MPZ=0 then 0 
	else ROUND(((pln_cph_cy.PLN_CPH_TOT_CY_MPZ / actl_cph_ly.ACTL_CPH_TOT_LY_MPZ)-1)*100,2) end as GROWTH_LY_TOT_CPH_MPZ from 
	(select x.loc_nm,
	case when NVL(x.PLN_WAGE_TOT_MPZ,0)=0 and NVL(y.PLN_HRS_TOT_MPZ,0)=0 then 0 
	when NVL(x.PLN_WAGE_TOT_MPZ,0)=0 then 0 when NVL(y.PLN_HRS_TOT_MPZ,0)=0 then 0 
	else ROUND((x.PLN_WAGE_TOT_MPZ / y.PLN_HRS_TOT_MPZ),2) end as PLN_CPH_TOT_CY_MPZ from 
	(select g.loc_nm,NVL(sum(g.PLN_WAGE_MPZ),0) as PLN_WAGE_TOT_MPZ from 
	(select f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN
	(select * from (select d.loc_nm,d.perd_desc,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,
	a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.loc_nm,d.perd_desc,d.wk_id order by d.loc_nm,d.perd_desc,d.wk_id) 
	UNION
	select * from (select d.loc_nm,d.perd_desc,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, 
	ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where 
	(d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
	group by d.loc_nm,d.perd_desc,d.wk_id order by d.loc_nm,d.perd_desc,d.wk_id)) e on e.loc_nm=f.loc_nm order by f.loc_nm) g group by g.loc_nm) x,
	(select g.loc_nm,NVL(sum(g.PLN_HRS_MPZ),0) as PLN_HRS_TOT_MPZ from (select f.loc_nm,NVL(e.PLN_HOURS_MNTH_PLN_STR,0) as PLN_HRS_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN (select * from (select d.loc_nm,d.wk_id,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id)
	UNION 
	select * from (select d.loc_nm,d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,nvl(TA_PLN_HRS,0) as TA_PLN_HRS,nvl(WAGE_ADJ_HRS,0) as WAGE_ADJ_HRS
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')
	and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no=
	'store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id)) e on e.loc_nm=f.loc_nm order by f.loc_nm) g group by g.loc_nm) y 
	where x.loc_nm=y.loc_nm) pln_cph_cy,
	(select actl_wge_hrs.loc_nm,
	case when NVL(actl_wge_hrs.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(actl_wge_hrs.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	when NVL(actl_wge_hrs.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(actl_wge_hrs.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	else ROUND(actl_wge_hrs.ACTL_WAGE_TOT_MPZ / actl_wge_hrs.ACTL_HRS_TOT_MPZ,2) end as ACTL_CPH_TOT_LY_MPZ from 
	(select T.loc_nm,ROUND(NVL(sum(U.ACTL_WAGE_MNTH_STR),0),0) as ACTL_WAGE_TOT_MPZ,ROUND(NVL(sum(U.ACTL_HRS_MNTH_STR),0),0) as ACTL_HRS_TOT_MPZ from 
	(select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) T LEFT OUTER JOIN (select c.loc_nm,c.wk_id,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as 
	ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
	from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('LYMonth')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
	and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by c.loc_nm,C.wk_id order by c.loc_nm,c.wk_id) U
	on T.loc_nm=U.loc_nm  group by T.loc_nm) actl_wge_hrs) actl_cph_ly where pln_cph_cy.loc_nm=actl_cph_ly.loc_nm]]>
	</GrowthLYCPHTotalWeekData>  */
</TCName>

<TCName name = "PlannedOR_CurrentMonth_WeekData">

  	<PlannedORWeekData>
	<![CDATA[select sms_hrs.WK_ID,
	case when sms_hrs.SMS_HRS_MPZ=0 and pln_hrs.PLN_HRS_MPZ=0 then 0 
	when sms_hrs.SMS_HRS_MPZ=0 then 0 when pln_hrs.PLN_HRS_MPZ=0 then 0 
	else ROUND((sms_hrs.SMS_HRS_MPZ / pln_hrs.PLN_HRS_MPZ)*100,1) end as PLN_OR_MPZ from 
	(select x.wk_id,NVL(ROUND(((ROUND(((sum(y.SMS_HOURS_MPZ)*100)/25),0)*25)/100),2),0) as SMS_HRS_MPZ from (select wk_id from ww_wlp.wk where perd_desc='Month') x LEFT OUTER JOIN
	(select C.wk_id,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPZ from (select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,sum(fix_hrs) as 
	FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,
	a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d 
	where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no and d.dept_no!=20 and b.perd_desc in ('Month') and c.div_no='Division' and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) A
	group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C group by C.wk_id order by c.wk_id) y
	on x.wk_id=y.wk_id group by x.wk_id order by x.wk_id) sms_hrs,
	(select f.wk_id,NVL(ROUND(((ROUND(((sum(e.PLN_HOURS_MNTH_PLN_STR)*100)/25),0)*25)/100),2),0) as PLN_HRS_MPZ from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f
		LEFT OUTER JOIN (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,
		a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and 
		a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.wk_id order by d.wk_id) 
		UNION 
		select * from (select d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,
		TA_PLN_HRS,WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.
		perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
		where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
		group by d.wk_id order by d.wk_id)) e on e.wk_id=f.wk_id group by f.wk_id order by f.wk_id) pln_hrs 
	where sms_hrs.wk_id=pln_hrs.wk_id order by sms_hrs.wk_id]]>
	</PlannedORWeekData>
/*
	<PlannedORTotalWeekData>
	<![CDATA[select sms_hrs.loc_nm,
	case when sms_hrs.SMS_HRS_TOT_MPZ=0 and pln_hrs.PLN_HRS_TOT_MPZ=0 then 0 
	when sms_hrs.SMS_HRS_TOT_MPZ=0 then 0 when pln_hrs.PLN_HRS_TOT_MPZ=0 then 0 
	else ROUND((sms_hrs.SMS_HRS_TOT_MPZ / pln_hrs.PLN_HRS_TOT_MPZ)*100,1) end as PLN_OR_TOT_MPZ from 
	(select z.loc_nm,NVL(SUM(ROUND(((ROUND(((Z.SMS_HRS_MPZ*100)/25),0)*25)/100),2)),0) as SMS_HRS_TOT_MPZ from (select x.loc_nm,NVL(y.SMS_HOURS_MPZ,0) as SMS_HRS_MPZ from 
	(select loc_nm from ww_wlp.loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) x LEFT OUTER JOIN (select C.loc_nm,C.perd_desc,C.wk_id,(sum(C.FIX_HRS_DEPT_TOT) + 
	sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPZ from (select A.loc_no,A.loc_nm,A.perd_desc,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as 
	VOL_HRS_DEPT_TOT from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,
	NVL(a.vol_hrs,0) as vol_hrs from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d where a.task_no=d.task_no and a.wk_id=b.wk_id and 
	a.loc_no=c.loc_no and d.dept_no!=20 and b.perd_desc in ('Month') and c.div_no='Division' and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) A group by A.loc_no,A.loc_nm,A.perd_desc,A.wk_id,
	A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C group by C.loc_nm,C.perd_desc,C.wk_id order by C.loc_nm,C.perd_desc,c.wk_id) y
	on x.loc_nm=y.loc_nm order by x.loc_nm) z group by z.loc_nm) sms_hrs,
	(select g.loc_nm,NVL(SUM(ROUND(((ROUND(((g.PLN_HRS_MPZ*100)/25),0)*25)/100),2)),0) as PLN_HRS_TOT_MPZ from 
	(select f.loc_nm,NVL(e.PLN_HOURS_MNTH_PLN_STR,0) as PLN_HRS_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f LEFT OUTER JOIN
	(select * from (select d.loc_nm,d.wk_id,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d
	group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id) 
	UNION 
	select * from (select d.loc_nm,d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as 
	BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,nvl(TA_PLN_HRS,0) as TA_PLN_HRS,
	nvl(WAGE_ADJ_HRS,0) as WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')
	and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no=
	'store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id)) e on e.loc_nm=f.loc_nm order by f.loc_nm) g group by g.loc_nm) pln_hrs 
	where sms_hrs.loc_nm=pln_hrs.loc_nm]]>
	</PlannedORTotalWeekData>  */
</TCName>

<TCName name = "BGDT_FCST_OR_CurrentMonth_WeekData">
	<BudgetORWeekData>
	<![CDATA[select f.wk_id,
	case when NVL(sum(e.BDGT_SMS_MPZ),0)=0 and NVL(sum(e.BDGT_HRS_MPZ),0)=0 then 0 
	when NVL(sum(e.BDGT_SMS_MPZ),0)=0 then 0 when NVL(sum(e.BDGT_HRS_MPZ),0)=0 then 0 
	else NVL(ROUND((sum(e.BDGT_SMS_MPZ) / sum(e.BDGT_HRS_MPZ)) * 100,2),0) end as BDGT_OR_MPZ from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month' order by wk_id) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,b.perd_desc,b.wk_id,
NVL(a.bdgt_sms_hrs,0) as BDGT_SMS_MPZ,NVL(a.bdgt_hrs,0) as BDGT_HRS_MPZ
from ww_wlp.wky_bdgt a,wk b,loc c,dept d
where a.wk_id=b.wk_id and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month'))
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,b.perd_desc,b.wk_id) e
on f.wk_id=e.wk_id group by f.wk_id order by f.wk_id]]>
	</BudgetORWeekData>
	
	<BudgetORTotalWeekData>
	<![CDATA[select f.loc_nm,
	case when NVL(sum(e.BDGT_SMS_MPZ),0)=0 and NVL(sum(e.BDGT_HRS_MPZ),0)=0 then 0 
	when NVL(sum(e.BDGT_SMS_MPZ),0)=0 then 0 when NVL(sum(e.BDGT_HRS_MPZ),0)=0 then 0 
	else NVL(ROUND((sum(e.BDGT_SMS_MPZ) / sum(e.BDGT_HRS_MPZ)) * 100,2),0) end as BDGT_OR_TOT_MPZ from 
(select distinct loc_nm from ww_wlp.loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) order by loc_nm) f
LEFT OUTER JOIN
(select x.loc_nm,x.perd_desc,x.wk_id,sum(bdgt_sms_hrs) as BDGT_SMS_MPZ,sum(bdgt_hrs) as BDGT_HRS_MPZ from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,b.perd_desc,b.wk_id,
NVL(a.bdgt_sms_hrs,0) as bdgt_sms_hrs,NVL(a.bdgt_hrs,0) as bdgt_hrs
from ww_wlp.wky_bdgt a,wk b,loc c,dept d
where a.wk_id=b.wk_id and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month'))
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,b.perd_desc,b.wk_id) x
group by x.loc_nm,x.perd_desc,x.wk_id order by x.loc_nm,x.perd_desc,x.wk_id) e
on e.loc_nm=f.loc_nm group by f.loc_nm]]>
	</BudgetORTotalWeekData>
	
	<ForecastORWeekData>
	<![CDATA[select sms_hrs.WK_ID,
	case when sms_hrs.SMS_HRS_MPZ=0 and pln_hrs.PLN_HRS_MPZ=0 then 0 
	when sms_hrs.SMS_HRS_MPZ=0 then 0 when pln_hrs.PLN_HRS_MPZ=0 then 0 
	else ROUND((sms_hrs.SMS_HRS_MPZ / pln_hrs.PLN_HRS_MPZ)*100,2) end as PLN_OR_MPZ from 
	(select x.wk_id,NVL(ROUND(((ROUND(((y.SMS_HOURS_MPZ*100)/25),0)*25)/100),2),0) as SMS_HRS_MPZ from (select wk_id from ww_wlp.wk where perd_desc='Month') x LEFT OUTER JOIN
	(select C.wk_id,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPZ from (select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,sum(fix_hrs) as 
	FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,
	a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d 
	where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no and d.dept_no!=20 and b.perd_desc in ('Month') and c.div_no='Division' and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) A
	group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C group by C.wk_id order by c.wk_id) y
	on x.wk_id=y.wk_id order by x.wk_id) sms_hrs,
	(select f.wk_id,NVL(ROUND(((ROUND(((e.PLN_HOURS_MPZ*100)/25),0)*25)/100),2),0) as PLN_HRS_MPZ from 
	(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f
		LEFT OUTER JOIN 
		(select d.wk_id,ROUND(sum(d.plan_paid_hours),9) as PLN_HOURS_MPZ from 
		(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,nvl(a.plan_paid_hours,0) as plan_paid_hours 
		from ww_wlp.mnth_fcst a, ww_wlp.wk b, ww_wlp.loc c 
		where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.
		perd_desc in ('Month') and DEPT_NO NOT IN (20)) d 
		group by d.wk_id order by d.wk_id) e on e.wk_id=f.wk_id order by f.wk_id) pln_hrs 
	where sms_hrs.wk_id=pln_hrs.wk_id order by sms_hrs.wk_id]]>
	</ForecastORWeekData>
	/*
	<ForecastORTotalWeekData>
	<![CDATA[select sms_hrs.loc_nm,
	case when sms_hrs.SMS_HRS_TOT_MPZ=0 and pln_hrs.PLN_HRS_TOT_MPZ=0 then 0 
	when sms_hrs.SMS_HRS_TOT_MPZ=0 then 0 when pln_hrs.PLN_HRS_TOT_MPZ=0 then 0 
	else ROUND((sms_hrs.SMS_HRS_TOT_MPZ / pln_hrs.PLN_HRS_TOT_MPZ)*100,2) end as PLN_OR_TOT_MPZ from 
	(select z.loc_nm,NVL(SUM(ROUND(((ROUND(((Z.SMS_HRS_MPZ*100)/25),0)*25)/100),2)),0) as SMS_HRS_TOT_MPZ from 
	(select x.loc_nm,NVL(y.SMS_HOURS_MPZ,0) as SMS_HRS_MPZ from 
	(select loc_nm from ww_wlp.loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) x LEFT OUTER JOIN (select C.loc_nm,C.perd_desc,C.wk_id,(sum(C.FIX_HRS_DEPT_TOT) + 
	sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPZ from (select A.loc_no,A.loc_nm,A.perd_desc,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as 
	VOL_HRS_DEPT_TOT from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,
	NVL(a.vol_hrs,0) as vol_hrs from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d where a.task_no=d.task_no and a.wk_id=b.wk_id and 
	a.loc_no=c.loc_no and d.dept_no!=20 and b.perd_desc in ('Month') and c.div_no='Division' and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) A group by A.loc_no,A.loc_nm,A.perd_desc,A.wk_id,
	A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C group by C.loc_nm,C.perd_desc,C.wk_id order by C.loc_nm,C.perd_desc,c.wk_id) y
	on x.loc_nm=y.loc_nm order by x.loc_nm) z group by z.loc_nm) sms_hrs,
	(select g.loc_nm,NVL(SUM(ROUND(((ROUND(((g.PLN_HRS_MPZ*100)/25),0)*25)/100),2)),0) as PLN_HRS_TOT_MPZ from 
	(select f.loc_nm,NVL(e.PLN_HOURS_MPZ,0) as PLN_HRS_MPZ from (select loc_nm from loc where loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))) f 
	LEFT OUTER JOIN
	(select d.loc_nm,d.wk_id,ROUND(sum(d.plan_paid_hours),0) as PLN_HOURS_MPZ from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,nvl(a.plan_paid_hours,0) as plan_paid_hours 
	from ww_wlp.mnth_fcst a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')
	and DEPT_NO NOT IN (20)) d  group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id) e on e.loc_nm=f.loc_nm order by f.loc_nm) g group by g.loc_nm) pln_hrs 
	where sms_hrs.loc_nm=pln_hrs.loc_nm]]>
	</ForecastORTotalWeekData>   */
</TCName>

<TCName name = "PlannedBDGTRateandFCSTRateCurrentMonth_WeekData">
	<PlannedBudgetRateWeekData>
	<![CDATA[select rslt.wk_id,sum(rslt.OVERSPENT_BDGT_RATE_MPZ) as OVERSPENT_BDGT_RATE_MPZ from 
(select src.wk_id,
case 
when src.PLN_SLS_MPZ > src.BDGT_SLS_MPZ 
then NVL(ROUND((src.PLN_WGE_MPZ - ((((src.PST_FACTOR_MPZ * src.BDGT_WGE_PCT_MPZ) * (src.PLN_SLS_MPZ - src.BDGT_SLS_MPZ)) + src.BDGT_WGE_MPZ))),0),0)
When src.PLN_SLS_MPZ < src.BDGT_SLS_MPZ 
then NVL(ROUND((src.PLN_WGE_MPZ - ((((src.NGT_FACTOR_MPZ * src.BDGT_WGE_PCT_MPZ) * (src.PLN_SLS_MPZ - src.BDGT_SLS_MPZ)) + src.BDGT_WGE_MPZ))),0),0)
else NVL(ROUND((src.PLN_WGE_MPZ - src.BDGT_WGE_MPZ),0),0)
end as OVERSPENT_BDGT_RATE_MPZ from 

(select a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.wk_id, 
a.PLN_WGE_MPZ,b.pst_factor_MPZ,b.ngt_factor_MPZ,c.bdgt_wge_pct_MPZ,d.PLN_SLS_MPZ,c.BDGT_WGE_MPZ,C.BDGT_SLS_MPZ from

(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WGE_MPZ from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f
LEFT OUTER JOIN 
(select * from (select d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,	c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
group by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id 
order by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id) 
UNION 
select * from (select d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')
and DEPT_NO NOT IN (20)) d 
where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
group by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id 
order by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id)) e 
on e.wk_id=f.wk_id 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id) a,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_MPZ,NVL(src.ngt_factor,1) as NGT_FACTOR_MPZ from 
(select perd_desc,wk_id from wk where perd_desc in ('Month')) lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where perd_desc in ('Month')) and rgn_no in (99,'Region') group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) b,

(select h.div_no,h.rgn_no,h.zone_no,h.ar_no,h.loc_nm,h.wk_id,
NVL(ROUND(h.bdgt_wage_mnth_str,0),0) as BDGT_WGE_MPZ,NVL(ROUND(i.bdgt_sls_mnth_str,0),0) as BDGT_SLS_MPZ,
case when NVL(h.bdgt_wage_mnth_str,0)=0 and NVL(i.bdgt_sls_mnth_str,0)=0 then 0 
when NVL(h.bdgt_wage_mnth_str,0)=0 then 0 when NVL(i.bdgt_sls_mnth_str,0)=0 then 0 
else ROUND((h.bdgt_wage_mnth_str / i.bdgt_sls_mnth_str),2) end as BDGT_WGE_PCT_MPZ from 
(select g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.perd_desc,f.wk_id,NVL(g.bdgt_wages_mnth_str,0) as bdgt_wage_mnth_str from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f 
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(BDGT_WAGE),0) as BDGT_WAGES_MNTH_STR from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,
ROUND(sum(bdgt_sls),0) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no 
and a.wk_id=d.wk_id and a.dept_no NOT IN (20) 
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,d.perd_desc,a.wk_id) C 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_no,c.loc_nm,c.perd_desc,C.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,c.wk_id) g 
on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id 
order by g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.wk_id) h
INNER JOIN 
(select g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.perd_desc,f.wk_id,NVL(g.BDGT_SALES_MNTH_STR,0) as BDGT_SLS_MNTH_STR from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f 
LEFT OUTER JOIN 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(BDGT_SALES),0) as BDGT_SALES_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,
ROUND(sum(bdgt_sls),0) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) 
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,d.perd_desc,a.wk_id) C 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_no,c.loc_nm,c.perd_desc,C.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,c.wk_id) g
on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id 
order by g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.wk_id) i 
on h.div_no=i.div_no and h.rgn_no=i.rgn_no and h.zone_no=i.zone_no and h.ar_no=i.ar_no and h.loc_nm=i.loc_nm 
and h.perd_desc=i.perd_desc and h.wk_id=i.wk_id 
order by h.div_no,h.rgn_no,h.zone_no,h.ar_no,h.loc_nm,h.wk_id) c,

(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id,NVL(e.PLAN_SALES,0) as PLN_SLS_MPZ from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
LEFT OUTER JOIN 
(select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES 
from ww_wlp.mgr_wky_pln a,wk b, loc c 
where a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,b.perd_desc,a.wk_id) c 
UNION 
select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES 
from ww_wlp.fcst a,wk b, loc c 
where a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.dept_no NOT IN (0,20,90) 
and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
and (a.loc_no,b.wk_id) NOT IN (select distinct loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,b.perd_desc,b.wk_id) d) e 
on f.perd_desc=e.perd_desc and f.wk_id=e.wk_id 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id) d

where a.div_no=c.div_no and a.div_no=d.div_no and c.div_no=d.div_no
and a.rgn_no=c.rgn_no and a.rgn_no=d.rgn_no and c.rgn_no=d.rgn_no-- and a.rgn_no=b.rgn_no 
and a.zone_no=c.zone_no and a.zone_no=d.zone_no and c.zone_no=d.zone_no
and a.ar_no=c.ar_no and a.ar_no=d.ar_no and c.ar_no=d.ar_no
and a.loc_nm=c.loc_nm and a.loc_nm=d.loc_nm and c.loc_nm=d.loc_nm
and a.wk_id=c.wk_id and a.wk_id=d.wk_id and c.wk_id=d.wk_id and a.wk_id=b.wk_id
order by a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.wk_id) src) rslt
group by rslt.wk_id order by rslt.wk_id]]>
	</PlannedBudgetRateWeekData>
	/*
	<PlannedBudgetRateTotalWeekData>
	<![CDATA[select rslt.loc_nm,NVL(ROUND(sum(rslt.OVERSPENT_BDGT_RATE_MPZ),0),0) as OVERSPENT_BDGT_RATE_TOT_MPZ from 
(select src.div_no,src.rgn_no,src.zone_no,src.ar_no,src.loc_nm,src.wk_id,
case 
when src.PLN_SLS_MPZ > src.BDGT_SLS_MPZ 
then NVL(ROUND((src.PLN_WGE_MPZ - ((((src.PST_FACTOR_MPZ * src.BDGT_WGE_PCT_MPZ) * (src.PLN_SLS_MPZ - src.BDGT_SLS_MPZ)) + src.BDGT_WGE_MPZ))),0),0)
When src.PLN_SLS_MPZ < src.BDGT_SLS_MPZ 
then NVL(ROUND((src.PLN_WGE_MPZ - ((((src.NGT_FACTOR_MPZ * src.BDGT_WGE_PCT_MPZ) * (src.PLN_SLS_MPZ - src.BDGT_SLS_MPZ)) + src.BDGT_WGE_MPZ))),0),0)
else NVL(ROUND((src.PLN_WGE_MPZ - src.BDGT_WGE_MPZ),0),0)
end as OVERSPENT_BDGT_RATE_MPZ from 

(select a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.wk_id, 
a.PLN_WGE_MPZ,b.pst_factor_MPZ,b.ngt_factor_MPZ,c.bdgt_wge_pct_MPZ,d.PLN_SLS_MPZ,c.BDGT_WGE_MPZ,C.BDGT_SLS_MPZ from

(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WGE_MPZ from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f
LEFT OUTER JOIN 
(select * from (select d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,	c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
group by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id 
order by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id) 
UNION 
select * from (select d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')
and DEPT_NO NOT IN (20)) d 
where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
group by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id 
order by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id)) e 
on e.wk_id=f.wk_id 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id) a,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_MPZ,NVL(src.ngt_factor,1) as NGT_FACTOR_MPZ from 
(select perd_desc,wk_id from wk where perd_desc in ('Month')) lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where perd_desc in ('Month')) and rgn_no in (99,'Region') group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) b,

(select h.div_no,h.rgn_no,h.zone_no,h.ar_no,h.loc_nm,h.wk_id,
NVL(ROUND(h.bdgt_wage_mnth_str,0),0) as BDGT_WGE_MPZ,NVL(ROUND(i.bdgt_sls_mnth_str,0),0) as BDGT_SLS_MPZ,
case when NVL(h.bdgt_wage_mnth_str,0)=0 and NVL(i.bdgt_sls_mnth_str,0)=0 then 0 
when NVL(h.bdgt_wage_mnth_str,0)=0 then 0 when NVL(i.bdgt_sls_mnth_str,0)=0 then 0 
else ROUND((h.bdgt_wage_mnth_str / i.bdgt_sls_mnth_str)*100,2) end as BDGT_WGE_PCT_MPZ from 
(select g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.perd_desc,f.wk_id,NVL(g.bdgt_wages_mnth_str,0) as bdgt_wage_mnth_str from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f 
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(BDGT_WAGE),0) as BDGT_WAGES_MNTH_STR from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,
ROUND(sum(bdgt_sls),0) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no 
and a.wk_id=d.wk_id and a.dept_no NOT IN (20) 
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,d.perd_desc,a.wk_id) C 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_no,c.loc_nm,c.perd_desc,C.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,c.wk_id) g 
on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id 
order by g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.wk_id) h
INNER JOIN 
(select g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.perd_desc,f.wk_id,NVL(g.BDGT_SALES_MNTH_STR,0) as BDGT_SLS_MNTH_STR from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f 
LEFT OUTER JOIN 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(BDGT_SALES),0) as BDGT_SALES_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,
ROUND(sum(bdgt_sls),0) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) 
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,d.perd_desc,a.wk_id) C 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_no,c.loc_nm,c.perd_desc,C.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,c.wk_id) g
on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id 
order by g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.wk_id) i 
on h.div_no=i.div_no and h.rgn_no=i.rgn_no and h.zone_no=i.zone_no and h.ar_no=i.ar_no and h.loc_nm=i.loc_nm 
and h.perd_desc=i.perd_desc and h.wk_id=i.wk_id 
order by h.div_no,h.rgn_no,h.zone_no,h.ar_no,h.loc_nm,h.wk_id) c,

(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id,NVL(e.PLAN_SALES,0) as PLN_SLS_MPZ from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
LEFT OUTER JOIN 
(select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES 
from ww_wlp.mgr_wky_pln a,wk b, loc c 
where a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,b.perd_desc,a.wk_id) c 
UNION 
select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES 
from ww_wlp.fcst a,wk b, loc c 
where a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.dept_no NOT IN (0,20,90) 
and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
and (a.loc_no,b.wk_id) NOT IN (select distinct loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,b.perd_desc,b.wk_id) d) e 
on f.perd_desc=e.perd_desc and f.wk_id=e.wk_id 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id) d

where a.div_no=c.div_no and a.div_no=d.div_no and c.div_no=d.div_no
and a.rgn_no=c.rgn_no and a.rgn_no=d.rgn_no and c.rgn_no=d.rgn_no-- and a.rgn_no=b.rgn_no 
and a.zone_no=c.zone_no and a.zone_no=d.zone_no and c.zone_no=d.zone_no
and a.ar_no=c.ar_no and a.ar_no=d.ar_no and c.ar_no=d.ar_no
and a.loc_nm=c.loc_nm and a.loc_nm=d.loc_nm and c.loc_nm=d.loc_nm
and a.wk_id=c.wk_id and a.wk_id=d.wk_id and c.wk_id=d.wk_id and a.wk_id=b.wk_id
order by a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.wk_id) src
order by src.div_no,src.rgn_no,src.zone_no,src.ar_no,src.loc_nm,src.wk_id) rslt
group by rslt.loc_nm order by rslt.loc_nm]]>
	</PlannedBudgetRateTotalWeekData>   */
	
	<PlannedForecsatRateWeekData>
	<![CDATA[select rslt.wk_id,sum(rslt.OVERSPENT_FRCST_RATE_MPZ) as OVERSPENT_FRCST_RATE_MPZ from 
(select src.wk_id,
case 
when src.PLN_SLS_MPZ > src.FRCST_SLS_MPZ 
then NVL(ROUND((src.PLN_WGE_MPZ - ((((src.PST_FACTOR_MPZ * src.FRCST_WGE_PCT_MPZ) * (src.PLN_SLS_MPZ - src.FRCST_SLS_MPZ)) + src.FRCST_WGE_MPZ))),0),0)
When src.PLN_SLS_MPZ < src.FRCST_SLS_MPZ 
then NVL(ROUND((src.PLN_WGE_MPZ - ((((src.NGT_FACTOR_MPZ * src.FRCST_WGE_PCT_MPZ) * (src.PLN_SLS_MPZ - src.FRCST_SLS_MPZ)) + src.FRCST_WGE_MPZ))),0),0)
else NVL(ROUND((src.PLN_WGE_MPZ - src.FRCST_WGE_MPZ),0),0)
end as OVERSPENT_FRCST_RATE_MPZ from 

(select a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.wk_id, 
a.PLN_WGE_MPZ,b.pst_factor_MPZ,b.ngt_factor_MPZ,c.FRCST_wge_pct_MPZ,d.PLN_SLS_MPZ,c.FRCST_WGE_MPZ,C.FRCST_SLS_MPZ from

(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WGE_MPZ from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f
LEFT OUTER JOIN 
(select * from (select d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,	c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
group by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id 
order by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id) 
UNION 
select * from (select d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')
and DEPT_NO NOT IN (20)) d 
where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
group by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id 
order by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id)) e 
on e.wk_id=f.wk_id 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id) a,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_MPZ,NVL(src.ngt_factor,1) as NGT_FACTOR_MPZ from 
(select perd_desc,wk_id from wk where perd_desc in ('Month')) lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where perd_desc in ('Month')) and rgn_no in (99,'Region') group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) b,

(select h.div_no,h.rgn_no,h.zone_no,h.ar_no,h.loc_nm,h.wk_id,
NVL(ROUND(h.FRCST_wage_mnth_str,0),0) as FRCST_WGE_MPZ,NVL(ROUND(i.FRCST_sls_mnth_str,0),0) as FRCST_SLS_MPZ,
case when NVL(h.FRCST_wage_mnth_str,0)=0 and NVL(i.FRCST_sls_mnth_str,0)=0 then 0 
when NVL(h.FRCST_wage_mnth_str,0)=0 then 0 when NVL(i.FRCST_sls_mnth_str,0)=0 then 0 
else ROUND((h.FRCST_wage_mnth_str / i.FRCST_sls_mnth_str),2) end as FRCST_WGE_PCT_MPZ from 
(select g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.perd_desc,f.wk_id,NVL(g.FRCST_wages_mnth_str,0) as FRCST_wage_mnth_str from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f 
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(FRCST_WAGE),0) as FRCST_WAGES_MNTH_STR from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,
ROUND(sum(FRCST_sls),0) as FRCST_SALES, sum(FRCST_wage_amt) as FRCST_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no 
and a.wk_id=d.wk_id and a.dept_no NOT IN (20) 
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,d.perd_desc,a.wk_id) C 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_no,c.loc_nm,c.perd_desc,C.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,c.wk_id) g 
on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id 
order by g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.wk_id) h
INNER JOIN 
(select g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.perd_desc,f.wk_id,NVL(g.FRCST_SALES_MNTH_STR,0) as FRCST_SLS_MNTH_STR from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f 
LEFT OUTER JOIN 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(FRCST_SALES),0) as FRCST_SALES_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,
ROUND(sum(FRCST_sls),0) as FRCST_SALES, sum(FRCST_wage_amt) as FRCST_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) 
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,d.perd_desc,a.wk_id) C 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_no,c.loc_nm,c.perd_desc,C.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,c.wk_id) g
on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id 
order by g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.wk_id) i 
on h.div_no=i.div_no and h.rgn_no=i.rgn_no and h.zone_no=i.zone_no and h.ar_no=i.ar_no and h.loc_nm=i.loc_nm 
and h.perd_desc=i.perd_desc and h.wk_id=i.wk_id 
order by h.div_no,h.rgn_no,h.zone_no,h.ar_no,h.loc_nm,h.wk_id) c,

(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id,NVL(e.PLAN_SALES,0) as PLN_SLS_MPZ from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
LEFT OUTER JOIN 
(select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES 
from ww_wlp.mgr_wky_pln a,wk b, loc c 
where a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,b.perd_desc,a.wk_id) c 
UNION 
select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES 
from ww_wlp.fcst a,wk b, loc c 
where a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.dept_no NOT IN (0,20,90) 
and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
and (a.loc_no,b.wk_id) NOT IN (select distinct loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,b.perd_desc,b.wk_id) d) e 
on f.perd_desc=e.perd_desc and f.wk_id=e.wk_id 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id) d

where a.div_no=c.div_no and a.div_no=d.div_no and c.div_no=d.div_no
and a.rgn_no=c.rgn_no and a.rgn_no=d.rgn_no and c.rgn_no=d.rgn_no-- and a.rgn_no=b.rgn_no 
and a.zone_no=c.zone_no and a.zone_no=d.zone_no and c.zone_no=d.zone_no
and a.ar_no=c.ar_no and a.ar_no=d.ar_no and c.ar_no=d.ar_no
and a.loc_nm=c.loc_nm and a.loc_nm=d.loc_nm and c.loc_nm=d.loc_nm
and a.wk_id=c.wk_id and a.wk_id=d.wk_id and c.wk_id=d.wk_id and a.wk_id=b.wk_id
order by a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.wk_id) src) rslt
group by rslt.wk_id order by rslt.wk_id]]>
	</PlannedForecsatRateWeekData>
	/*
	<PlannedForecsatRateTotalWeekData>
	<![CDATA[select rslt.loc_nm,NVL(ROUND(sum(rslt.OVERSPENT_FRCST_RATE_MPZ),0),0) as OVERSPENT_FRCST_RATE_TOT_MPZ from 
(select src.div_no,src.rgn_no,src.zone_no,src.ar_no,src.loc_nm,src.wk_id,
case 
when src.PLN_SLS_MPZ > src.FRCST_SLS_MPZ 
then NVL(ROUND((src.PLN_WGE_MPZ - ((((src.PST_FACTOR_MPZ * src.FRCST_WGE_PCT_MPZ) * (src.PLN_SLS_MPZ - src.FRCST_SLS_MPZ)) + src.FRCST_WGE_MPZ))),0),0)
When src.PLN_SLS_MPZ < src.FRCST_SLS_MPZ 
then NVL(ROUND((src.PLN_WGE_MPZ - ((((src.NGT_FACTOR_MPZ * src.FRCST_WGE_PCT_MPZ) * (src.PLN_SLS_MPZ - src.FRCST_SLS_MPZ)) + src.FRCST_WGE_MPZ))),0),0)
else NVL(ROUND((src.PLN_WGE_MPZ - src.FRCST_WGE_MPZ),0),0)
end as OVERSPENT_FRCST_RATE_MPZ from 

(select a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.wk_id, 
a.PLN_WGE_MPZ,b.pst_factor_MPZ,b.ngt_factor_MPZ,c.FRCST_wge_pct_MPZ,d.PLN_SLS_MPZ,c.FRCST_WGE_MPZ,C.FRCST_SLS_MPZ from

(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WGE_MPZ from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f
LEFT OUTER JOIN 
(select * from (select d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,	c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
group by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id 
order by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id) 
UNION 
select * from (select d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.wk_id=b.wk_id and b.perd_desc in ('Month')
and DEPT_NO NOT IN (20)) d 
where (d.loc_no,d.wk_id) NOT IN (select distinct a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
group by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id 
order by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id)) e 
on e.wk_id=f.wk_id 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id) a,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_MPZ,NVL(src.ngt_factor,1) as NGT_FACTOR_MPZ from 
(select perd_desc,wk_id from wk where perd_desc in ('Month')) lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where perd_desc in ('Month')) and rgn_no in (99,'Region') group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) b,

(select h.div_no,h.rgn_no,h.zone_no,h.ar_no,h.loc_nm,h.wk_id,
NVL(ROUND(h.FRCST_wage_mnth_str,0),0) as FRCST_WGE_MPZ,NVL(ROUND(i.FRCST_sls_mnth_str,0),0) as FRCST_SLS_MPZ,
case when NVL(h.FRCST_wage_mnth_str,0)=0 and NVL(i.FRCST_sls_mnth_str,0)=0 then 0 
when NVL(h.FRCST_wage_mnth_str,0)=0 then 0 when NVL(i.FRCST_sls_mnth_str,0)=0 then 0 
else ROUND((h.FRCST_wage_mnth_str / i.FRCST_sls_mnth_str)*100,2) end as FRCST_WGE_PCT_MPZ from 
(select g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.perd_desc,f.wk_id,NVL(g.FRCST_wages_mnth_str,0) as FRCST_wage_mnth_str from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f 
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(FRCST_WAGE),0) as FRCST_WAGES_MNTH_STR from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,
ROUND(sum(FRCST_sls),0) as FRCST_SALES, sum(FRCST_wage_amt) as FRCST_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.loc_no=b.loc_no 
and a.wk_id=d.wk_id and a.dept_no NOT IN (20) 
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,d.perd_desc,a.wk_id) C 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_no,c.loc_nm,c.perd_desc,C.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,c.wk_id) g 
on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id 
order by g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.wk_id) h
INNER JOIN 
(select g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.perd_desc,f.wk_id,NVL(g.FRCST_SALES_MNTH_STR,0) as FRCST_SLS_MNTH_STR from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f 
LEFT OUTER JOIN 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(FRCST_SALES),0) as FRCST_SALES_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,
ROUND(sum(FRCST_sls),0) as FRCST_SALES, sum(FRCST_wage_amt) as FRCST_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) 
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,d.perd_desc,a.wk_id) C 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_no,c.loc_nm,c.perd_desc,C.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,c.wk_id) g
on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id 
order by g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.wk_id) i 
on h.div_no=i.div_no and h.rgn_no=i.rgn_no and h.zone_no=i.zone_no and h.ar_no=i.ar_no and h.loc_nm=i.loc_nm 
and h.perd_desc=i.perd_desc and h.wk_id=i.wk_id 
order by h.div_no,h.rgn_no,h.zone_no,h.ar_no,h.loc_nm,h.wk_id) c,

(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id,NVL(e.PLAN_SALES,0) as PLN_SLS_MPZ from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
LEFT OUTER JOIN 
(select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES 
from ww_wlp.mgr_wky_pln a,wk b, loc c 
where a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) 
and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,b.perd_desc,a.wk_id) c 
UNION 
select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES 
from ww_wlp.fcst a,wk b, loc c 
where a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N')) and a.dept_no NOT IN (0,20,90) 
and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
and (a.loc_no,b.wk_id) NOT IN (select distinct loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' 
and loc_no in (select distinct loc_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N'))
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,b.perd_desc,b.wk_id) d) e 
on f.perd_desc=e.perd_desc and f.wk_id=e.wk_id 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id) d

where a.div_no=c.div_no and a.div_no=d.div_no and c.div_no=d.div_no
and a.rgn_no=c.rgn_no and a.rgn_no=d.rgn_no and c.rgn_no=d.rgn_no-- and a.rgn_no=b.rgn_no 
and a.zone_no=c.zone_no and a.zone_no=d.zone_no and c.zone_no=d.zone_no
and a.ar_no=c.ar_no and a.ar_no=d.ar_no and c.ar_no=d.ar_no
and a.loc_nm=c.loc_nm and a.loc_nm=d.loc_nm and c.loc_nm=d.loc_nm
and a.wk_id=c.wk_id and a.wk_id=d.wk_id and c.wk_id=d.wk_id and a.wk_id=b.wk_id
order by a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.wk_id) src
order by src.div_no,src.rgn_no,src.zone_no,src.ar_no,src.loc_nm,src.wk_id) rslt
group by rslt.loc_nm order by rslt.loc_nm]]>
	</PlannedForecsatRateTotalWeekData>   */
</TCName>
<TCName name = "PlannedBDGTRateandFCSTRateCurrentMonth_WeektableData" >
	<PositiveFactor>
	<![CDATA[select PST_FACTOR_MPS from 
(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_MPS,NVL(src.ngt_factor,1) as NGT_FACTOR_MPS from 
(select perd_desc,wk_id from wk where perd_desc in ('Month')) lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where perd_desc in ('Month')) and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) order by wk_id]]>
	</PositiveFactor>
<NegativeFactor>
	<![CDATA[select NGT_FACTOR_MPS from 
(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_MPS,NVL(src.ngt_factor,1) as NGT_FACTOR_MPS from 
(select perd_desc,wk_id from wk where perd_desc in ('Month')) lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where perd_desc in ('Month')) and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) order by wk_id]]>
	</NegativeFactor>	
</TCName>
</configuration>