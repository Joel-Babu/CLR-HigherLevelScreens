<?xml version="1.0" encoding="UTF-8"?>

<configuration>

<TCName name = "SalesHistoryFirstWeek" >
	<SalesHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_SALES_WPS,0) as ACTL_SLS_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN 
	(20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d
	where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and 
	a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,
	a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</SalesHistory>
	<SalesHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_SALES_WPS),0),0) as ACTL_SLS_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,(sum(a.actl_sls)) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as 
	ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
	and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no 
	NOT IN (20,0,90) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	d.dply_seq) e on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</SalesHistoryTotal>
</TCName>

<TCName name = "SalesHistorySecondWeek" >
		<SalesHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_SALES_WPS,0) as ACTL_SLS_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN 
	(20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d
	where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and 
	a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,
	a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</SalesHistory>
	<SalesHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_SALES_WPS),0),0) as ACTL_SLS_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,(sum(a.actl_sls)) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as 
	ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
	and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no 
	NOT IN (20,0,90) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	d.dply_seq) e on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</SalesHistoryTotal>
</TCName>

<TCName name = "SalesHistoryThirdWeek" >
		<SalesHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_SALES_WPS,0) as ACTL_SLS_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN 
	(20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d
	where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and 
	a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,
	a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</SalesHistory>
	<SalesHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_SALES_WPS),0),0) as ACTL_SLS_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,(sum(a.actl_sls)) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as 
	ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
	and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no 
	NOT IN (20,0,90) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	d.dply_seq) e on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</SalesHistoryTotal>
</TCName>

<TCName name = "SalesHistoryFourthWeek" >
		<SalesHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_SALES_WPS,0) as ACTL_SLS_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN 
	(20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d
	where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and 
	a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,
	a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</SalesHistory>
	<SalesHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_SALES_WPS),0),0) as ACTL_SLS_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,(sum(a.actl_sls)) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as 
	ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
	and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no 
	NOT IN (20,0,90) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	d.dply_seq) e on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</SalesHistoryTotal>
</TCName>

<TCName name = "WagesHistoryFirstWeek" >
	<WagesHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_WAGE_WPS,0) as ACTL_WGE_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) 
	and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
	where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</WagesHistory>
	<WagesHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_WAGE_WPS),0),0) as ACTL_WGE_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) 
	as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and 
	a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</WagesHistoryTotal>
</TCName>

<TCName name = "WagesHistorySecondWeek" >
	<WagesHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_WAGE_WPS,0) as ACTL_WGE_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) 
	and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
	where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</WagesHistory>
	<WagesHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_WAGE_WPS),0),0) as ACTL_WGE_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) 
	as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and 
	a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</WagesHistoryTotal>
</TCName>

<TCName name = "WagesHistoryThirdWeek" >
	<WagesHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_WAGE_WPS,0) as ACTL_WGE_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) 
	and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
	where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</WagesHistory>
	<WagesHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_WAGE_WPS),0),0) as ACTL_WGE_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) 
	as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and 
	a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</WagesHistoryTotal>
</TCName>

<TCName name = "WagesHistoryFourthWeek" >
	<WagesHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_WAGE_WPS,0) as ACTL_WGE_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) 
	and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
	where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</WagesHistory>
	<WagesHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_WAGE_WPS),0),0) as ACTL_WGE_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) 
	as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and 
	a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</WagesHistoryTotal>
</TCName>

<TCName name = "ItemsHistoryFirsthWeek" >
	<ItemsHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_ITEM_WPS,0) as ACTL_ITM_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN 
	(20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt and 
	b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</ItemsHistory>
	<ItemsHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_ITEM_WPS),0),0) as ACTL_ITM_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) 
	as ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
	and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no 
	NOT IN (20,0,90) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	d.dply_seq) e on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</ItemsHistoryTotal>
</TCName>

<TCName name = "ItemsHistorySecondWeek" >
	<ItemsHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_ITEM_WPS,0) as ACTL_ITM_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN 
	(20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt and 
	b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</ItemsHistory>
	<ItemsHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_ITEM_WPS),0),0) as ACTL_ITM_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) 
	as ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
	and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no 
	NOT IN (20,0,90) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	d.dply_seq) e on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</ItemsHistoryTotal>
</TCName>

<TCName name = "ItemsHistoryThirdWeek" >
	<ItemsHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_ITEM_WPS,0) as ACTL_ITM_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN 
	(20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt and 
	b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</ItemsHistory>
	<ItemsHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_ITEM_WPS),0),0) as ACTL_ITM_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) 
	as ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
	and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no 
	NOT IN (20,0,90) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	d.dply_seq) e on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</ItemsHistoryTotal>
</TCName>

<TCName name = "ItemsHistoryFourthWeek" >
	<ItemsHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_ITEM_WPS,0) as ACTL_ITM_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN 
	(20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt and 
	b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</ItemsHistory>
	<ItemsHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_ITEM_WPS),0),0) as ACTL_ITM_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) 
	as ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
	and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no 
	NOT IN (20,0,90) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	d.dply_seq) e on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</ItemsHistoryTotal>
</TCName>

<TCName name = "CustomersHistoryFirsthWeek" >
	<CustomerHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_CUST_WPS,0) as ACTL_CUST_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN 
	(20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_cust_cnt),0) as ACTL_CUST_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt 
	and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</CustomerHistory>
	<CustomerHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_CUST_WPS),0),0) as ACTL_CUST_TOT_WPS from (select loc_nm from loc where loc_no='store') f
	LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,
	ROUND(sum(a.actl_cust_cnt),0) as ACTL_CUST_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and 
	b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not 
	null and a.dept_no IN (90,85) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,
	a.loc_no,d.dply_seq) e on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</CustomerHistoryTotal>
</TCName>

<TCName name = "CustomersHistorySecondWeek" >
	<CustomerHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_CUST_WPS,0) as ACTL_CUST_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN 
	(20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_cust_cnt),0) as ACTL_CUST_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt 
	and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</CustomerHistory>
	<CustomerHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_CUST_WPS),0),0) as ACTL_CUST_TOT_WPS from (select loc_nm from loc where loc_no='store') f
	LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,
	ROUND(sum(a.actl_cust_cnt),0) as ACTL_CUST_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and 
	b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not 
	null and a.dept_no IN (90,85) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,
	a.loc_no,d.dply_seq) e on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</CustomerHistoryTotal>
</TCName>

<TCName name = "CustomersHistoryThirdWeek" >
	<CustomerHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_CUST_WPS,0) as ACTL_CUST_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN 
	(20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_cust_cnt),0) as ACTL_CUST_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt 
	and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</CustomerHistory>
	<CustomerHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_CUST_WPS),0),0) as ACTL_CUST_TOT_WPS from (select loc_nm from loc where loc_no='store') f
	LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,
	ROUND(sum(a.actl_cust_cnt),0) as ACTL_CUST_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and 
	b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not 
	null and a.dept_no IN (90,85) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,
	a.loc_no,d.dply_seq) e on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</CustomerHistoryTotal>
</TCName>

<TCName name = "CustomersHistoryFourthWeek" >
	<CustomerHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_CUST_WPS,0) as ACTL_CUST_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN 
	(20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_cust_cnt),0) as ACTL_CUST_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt 
	and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</CustomerHistory>
	<CustomerHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_CUST_WPS),0),0) as ACTL_CUST_TOT_WPS from (select loc_nm from loc where loc_no='store') f
	LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,
	ROUND(sum(a.actl_cust_cnt),0) as ACTL_CUST_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and 
	b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not 
	null and a.dept_no IN (90,85) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,
	a.loc_no,d.dply_seq) e on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</CustomerHistoryTotal>
</TCName>

<TCName name = "PaidHoursHistoryFirsthWeek" >
	<PaidHoursHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_HOURS_WPS,0) as ACTL_HRS_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN 
	(20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),2) as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and 
	b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and 
	a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,
	d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</PaidHoursHistory>
	<PaidHoursHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_HOURS_WPS),2),0) as ACTL_HRS_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),2) 
	as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and 
	a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</PaidHoursHistoryTotal>
</TCName>

<TCName name = "PaidHoursHistorySecondWeek" >
	<PaidHoursHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_HOURS_WPS,0) as ACTL_HRS_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN 
	(20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),2) as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and 
	b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and 
	a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,
	d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</PaidHoursHistory>
	<PaidHoursHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_HOURS_WPS),2),0) as ACTL_HRS_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),2) 
	as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and 
	a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</PaidHoursHistoryTotal>
</TCName>

<TCName name = "PaidHoursHistoryThirdWeek" >
	<PaidHoursHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_HOURS_WPS,0) as ACTL_HRS_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN 
	(20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),2) as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and 
	b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and 
	a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,
	d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</PaidHoursHistory>
	<PaidHoursHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_HOURS_WPS),2),0) as ACTL_HRS_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),2) 
	as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and 
	a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</PaidHoursHistoryTotal>
</TCName>

<TCName name = "PaidHoursHistoryFourthWeek" >
	<PaidHoursHistory>
	<![CDATA[select f.dept_nm,NVL(e.ACTL_HOURS_WPS,0) as ACTL_HRS_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN 
	(20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),2) as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and 
	b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and 
	a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,
	d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</PaidHoursHistory>
	<PaidHoursHistoryTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.ACTL_HOURS_WPS),2),0) as ACTL_HRS_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),2) 
	as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and 
	a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</PaidHoursHistoryTotal>
</TCName>

<TCName name = "CPHHistoryFirsthWeek" >
	<CPHHistory>
	<![CDATA[select f.dept_nm,
	case when NVL(e.ACTL_WAGE_WPS,0)=0 and NVL(e.ACTL_HOURS_WPS,0)=0 then 0
	when NVL(e.ACTL_WAGE_WPS,0)=0 then 0 when NVL(e.ACTL_HOURS_WPS,0)=0 then 0
	else NVL(ROUND((e.ACTL_WAGE_WPS / e.ACTL_HOURS_WPS),2),0) end as ACTL_CPH_WPS from 
	(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where 
	div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	sum(a.actl_wage_amt) as ACTL_WAGE_WPS,sum(a.actl_hrs) as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' 
	and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is 
	not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,
	a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</CPHHistory>
	<CPHHistoryTotal>
	<![CDATA[select f.loc_nm,
	case when NVL(sum(e.ACTL_WAGE_WPS),0)=0 and NVL(sum(e.ACTL_HOURS_WPS),0)=0 then 0
	when NVL(sum(e.ACTL_WAGE_WPS),0)=0 then 0 when NVL(sum(e.ACTL_HOURS_WPS),0)=0 then 0
	else NVL(ROUND((sum(e.ACTL_WAGE_WPS) / sum(e.ACTL_HOURS_WPS)),2),0) end as ACTL_CPH_TOT_WPS from 
	(select loc_nm from loc where loc_no='store') f
	LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,sum(a.actl_wage_amt) as ACTL_WAGE_WPS,sum(a.actl_hrs) as 
	ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and 
	a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</CPHHistoryTotal>
</TCName>

<TCName name = "CPHHistorySecondWeek" >
	<CPHHistory>
	<![CDATA[select f.dept_nm,
	case when NVL(e.ACTL_WAGE_WPS,0)=0 and NVL(e.ACTL_HOURS_WPS,0)=0 then 0
	when NVL(e.ACTL_WAGE_WPS,0)=0 then 0 when NVL(e.ACTL_HOURS_WPS,0)=0 then 0
	else NVL(ROUND((e.ACTL_WAGE_WPS / e.ACTL_HOURS_WPS),2),0) end as ACTL_CPH_WPS from 
	(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where 
	div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	sum(a.actl_wage_amt) as ACTL_WAGE_WPS,sum(a.actl_hrs) as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' 
	and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is 
	not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,
	a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</CPHHistory>
	<CPHHistoryTotal>
	<![CDATA[select f.loc_nm,
	case when NVL(sum(e.ACTL_WAGE_WPS),0)=0 and NVL(sum(e.ACTL_HOURS_WPS),0)=0 then 0
	when NVL(sum(e.ACTL_WAGE_WPS),0)=0 then 0 when NVL(sum(e.ACTL_HOURS_WPS),0)=0 then 0
	else NVL(ROUND((sum(e.ACTL_WAGE_WPS) / sum(e.ACTL_HOURS_WPS)),2),0) end as ACTL_CPH_TOT_WPS from 
	(select loc_nm from loc where loc_no='store') f
	LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,sum(a.actl_wage_amt) as ACTL_WAGE_WPS,sum(a.actl_hrs) as 
	ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and 
	a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</CPHHistoryTotal>
</TCName>

<TCName name = "CPHHistoryThirdWeek" >
	<CPHHistory>
	<![CDATA[select f.dept_nm,
	case when NVL(e.ACTL_WAGE_WPS,0)=0 and NVL(e.ACTL_HOURS_WPS,0)=0 then 0
	when NVL(e.ACTL_WAGE_WPS,0)=0 then 0 when NVL(e.ACTL_HOURS_WPS,0)=0 then 0
	else NVL(ROUND((e.ACTL_WAGE_WPS / e.ACTL_HOURS_WPS),2),0) end as ACTL_CPH_WPS from 
	(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where 
	div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	sum(a.actl_wage_amt) as ACTL_WAGE_WPS,sum(a.actl_hrs) as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' 
	and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is 
	not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,
	a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</CPHHistory>
	<CPHHistoryTotal>
	<![CDATA[select f.loc_nm,
	case when NVL(sum(e.ACTL_WAGE_WPS),0)=0 and NVL(sum(e.ACTL_HOURS_WPS),0)=0 then 0
	when NVL(sum(e.ACTL_WAGE_WPS),0)=0 then 0 when NVL(sum(e.ACTL_HOURS_WPS),0)=0 then 0
	else NVL(ROUND((sum(e.ACTL_WAGE_WPS) / sum(e.ACTL_HOURS_WPS)),2),0) end as ACTL_CPH_TOT_WPS from 
	(select loc_nm from loc where loc_no='store') f
	LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,sum(a.actl_wage_amt) as ACTL_WAGE_WPS,sum(a.actl_hrs) as 
	ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and 
	a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</CPHHistoryTotal>
</TCName>

<TCName name = "CPHHistoryFourthWeek" >
	<CPHHistory>
	<![CDATA[select f.dept_nm,
	case when NVL(e.ACTL_WAGE_WPS,0)=0 and NVL(e.ACTL_HOURS_WPS,0)=0 then 0
	when NVL(e.ACTL_WAGE_WPS,0)=0 then 0 when NVL(e.ACTL_HOURS_WPS,0)=0 then 0
	else NVL(ROUND((e.ACTL_WAGE_WPS / e.ACTL_HOURS_WPS),2),0) end as ACTL_CPH_WPS from 
	(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where 
	div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	sum(a.actl_wage_amt) as ACTL_WAGE_WPS,sum(a.actl_hrs) as ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' 
	and b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is 
	not null and a.dept_no NOT IN (20) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,
	a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</CPHHistory>
	<CPHHistoryTotal>
	<![CDATA[select f.loc_nm,
	case when NVL(sum(e.ACTL_WAGE_WPS),0)=0 and NVL(sum(e.ACTL_HOURS_WPS),0)=0 then 0
	when NVL(sum(e.ACTL_WAGE_WPS),0)=0 then 0 when NVL(sum(e.ACTL_HOURS_WPS),0)=0 then 0
	else NVL(ROUND((sum(e.ACTL_WAGE_WPS) / sum(e.ACTL_HOURS_WPS)),2),0) end as ACTL_CPH_TOT_WPS from 
	(select loc_nm from loc where loc_no='store') f
	LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,sum(a.actl_wage_amt) as ACTL_WAGE_WPS,sum(a.actl_hrs) as 
	ACTL_HOURS_WPS from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear' and a.div_no=c.div_no and 
	a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store' and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm]]>
	</CPHHistoryTotal>
</TCName>

<TCName name = "WagePercentageHistoryFirsthWeek" >
	<WagePercentageHistory>
	<![CDATA[select actl_wge.dept_nm,
	case when NVL(actl_wge.ACTL_WGE_WPS,0)=0 and NVL(actl_sls.ACTL_SLS_WPS,0)=0 then 0
	when NVL(actl_wge.ACTL_WGE_WPS,0)=0 then 0 when NVL(actl_sls.ACTL_SLS_WPS,0)=0 then 0
	else NVL(ROUND((actl_wge.ACTL_WGE_WPS / actl_sls.ACTL_SLS_WPS)*100,2),0) end as ACTL_WGE_PCT_WPS from 
(select f.dept_nm,NVL(e.ACTL_WAGE_WPS,0) as ACTL_WGE_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) as ACTL_HOURS_WPS
from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_wge,
(select f.dept_nm,NVL(e.ACTL_SALES_WPS,0) as ACTL_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_sls
where actl_wge.dept_nm=actl_sls.dept_nm]]>
	</WagePercentageHistory>
	<WagePercentageHistoryTotal>
	<![CDATA[select actl_wge.loc_nm,
	case when NVL(actl_wge.ACTL_WGE_TOT_WPS,0)=0 and NVL(actl_sls.ACTL_SLS_TOT_WPS,0)=0 then 0
	when NVL(actl_wge.ACTL_WGE_TOT_WPS,0)=0 then 0 when NVL(actl_sls.ACTL_SLS_TOT_WPS,0)=0 then 0
	else NVL(ROUND((actl_wge.ACTL_WGE_TOT_WPS / actl_sls.ACTL_SLS_TOT_WPS)*100,2),0) end as ACTL_WGE_PCT_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.ACTL_WAGE_WPS),0),0) as ACTL_WGE_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) as ACTL_HOURS_WPS
from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_wge,
(select f.loc_nm,NVL(ROUND(sum(e.ACTL_SALES_WPS),0),0) as ACTL_SLS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_sls
where actl_wge.loc_nm=actl_sls.loc_nm
]]>
	</WagePercentageHistoryTotal>
</TCName>

<TCName name = "WagePercentageHistorySecondWeek" >
	<WagePercentageHistory>
	<![CDATA[select actl_wge.dept_nm,
	case when NVL(actl_wge.ACTL_WGE_WPS,0)=0 and NVL(actl_sls.ACTL_SLS_WPS,0)=0 then 0
	when NVL(actl_wge.ACTL_WGE_WPS,0)=0 then 0 when NVL(actl_sls.ACTL_SLS_WPS,0)=0 then 0
	else NVL(ROUND((actl_wge.ACTL_WGE_WPS / actl_sls.ACTL_SLS_WPS)*100,2),0) end as ACTL_WGE_PCT_WPS from 
(select f.dept_nm,NVL(e.ACTL_WAGE_WPS,0) as ACTL_WGE_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) as ACTL_HOURS_WPS
from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_wge,
(select f.dept_nm,NVL(e.ACTL_SALES_WPS,0) as ACTL_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_sls
where actl_wge.dept_nm=actl_sls.dept_nm]]>
	</WagePercentageHistory>
	<WagePercentageHistoryTotal>
	<![CDATA[select actl_wge.loc_nm,
	case when NVL(actl_wge.ACTL_WGE_TOT_WPS,0)=0 and NVL(actl_sls.ACTL_SLS_TOT_WPS,0)=0 then 0
	when NVL(actl_wge.ACTL_WGE_TOT_WPS,0)=0 then 0 when NVL(actl_sls.ACTL_SLS_TOT_WPS,0)=0 then 0
	else NVL(ROUND((actl_wge.ACTL_WGE_TOT_WPS / actl_sls.ACTL_SLS_TOT_WPS)*100,2),0) end as ACTL_WGE_PCT_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.ACTL_WAGE_WPS),0),0) as ACTL_WGE_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) as ACTL_HOURS_WPS
from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_wge,
(select f.loc_nm,NVL(ROUND(sum(e.ACTL_SALES_WPS),0),0) as ACTL_SLS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_sls
where actl_wge.loc_nm=actl_sls.loc_nm
]]>
	</WagePercentageHistoryTotal>
</TCName>

<TCName name = "WagePercentageHistoryThirdWeek" >
	<WagePercentageHistory>
	<![CDATA[select actl_wge.dept_nm,
	case when NVL(actl_wge.ACTL_WGE_WPS,0)=0 and NVL(actl_sls.ACTL_SLS_WPS,0)=0 then 0
	when NVL(actl_wge.ACTL_WGE_WPS,0)=0 then 0 when NVL(actl_sls.ACTL_SLS_WPS,0)=0 then 0
	else NVL(ROUND((actl_wge.ACTL_WGE_WPS / actl_sls.ACTL_SLS_WPS)*100,2),0) end as ACTL_WGE_PCT_WPS from 
(select f.dept_nm,NVL(e.ACTL_WAGE_WPS,0) as ACTL_WGE_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) as ACTL_HOURS_WPS
from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_wge,
(select f.dept_nm,NVL(e.ACTL_SALES_WPS,0) as ACTL_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_sls
where actl_wge.dept_nm=actl_sls.dept_nm]]>
	</WagePercentageHistory>
	<WagePercentageHistoryTotal>
	<![CDATA[select actl_wge.loc_nm,
	case when NVL(actl_wge.ACTL_WGE_TOT_WPS,0)=0 and NVL(actl_sls.ACTL_SLS_TOT_WPS,0)=0 then 0
	when NVL(actl_wge.ACTL_WGE_TOT_WPS,0)=0 then 0 when NVL(actl_sls.ACTL_SLS_TOT_WPS,0)=0 then 0
	else NVL(ROUND((actl_wge.ACTL_WGE_TOT_WPS / actl_sls.ACTL_SLS_TOT_WPS)*100,2),0) end as ACTL_WGE_PCT_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.ACTL_WAGE_WPS),0),0) as ACTL_WGE_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) as ACTL_HOURS_WPS
from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_wge,
(select f.loc_nm,NVL(ROUND(sum(e.ACTL_SALES_WPS),0),0) as ACTL_SLS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_sls
where actl_wge.loc_nm=actl_sls.loc_nm
]]>
	</WagePercentageHistoryTotal>
</TCName>

<TCName name = "WagePercentageHistoryFourthWeek" >
	<WagePercentageHistory>
	<![CDATA[select actl_wge.dept_nm,
	case when NVL(actl_wge.ACTL_WGE_WPS,0)=0 and NVL(actl_sls.ACTL_SLS_WPS,0)=0 then 0
	when NVL(actl_wge.ACTL_WGE_WPS,0)=0 then 0 when NVL(actl_sls.ACTL_SLS_WPS,0)=0 then 0
	else NVL(ROUND((actl_wge.ACTL_WGE_WPS / actl_sls.ACTL_SLS_WPS)*100,2),0) end as ACTL_WGE_PCT_WPS from 
(select f.dept_nm,NVL(e.ACTL_WAGE_WPS,0) as ACTL_WGE_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) as ACTL_HOURS_WPS
from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_wge,
(select f.dept_nm,NVL(e.ACTL_SALES_WPS,0) as ACTL_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_sls
where actl_wge.dept_nm=actl_sls.dept_nm]]>
	</WagePercentageHistory>
	<WagePercentageHistoryTotal>
	<![CDATA[select actl_wge.loc_nm,
	case when NVL(actl_wge.ACTL_WGE_TOT_WPS,0)=0 and NVL(actl_sls.ACTL_SLS_TOT_WPS,0)=0 then 0
	when NVL(actl_wge.ACTL_WGE_TOT_WPS,0)=0 then 0 when NVL(actl_sls.ACTL_SLS_TOT_WPS,0)=0 then 0
	else NVL(ROUND((actl_wge.ACTL_WGE_TOT_WPS / actl_sls.ACTL_SLS_TOT_WPS)*100,2),0) end as ACTL_WGE_PCT_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.ACTL_WAGE_WPS),0),0) as ACTL_WGE_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) as ACTL_HOURS_WPS
from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_wge,
(select f.loc_nm,NVL(ROUND(sum(e.ACTL_SALES_WPS),0),0) as ACTL_SLS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_sls
where actl_wge.loc_nm=actl_sls.loc_nm
]]>
	</WagePercentageHistoryTotal>
</TCName>

<TCName name = "ItemPriceHistoryFirsthWeek" >
	<ItemPriceHistory>
	<![CDATA[select actl_sls_itm.dept_nm,
	case when NVL(actl_sls_itm.actl_sls_wps,0)=0 and NVL(actl_sls_itm.actl_itm_wps,0)=0 then 0
	when NVL(actl_sls_itm.actl_sls_wps,0)=0 then 0 when NVL(actl_sls_itm.actl_itm_wps,0)=0 then 0
	else NVL(ROUND((actl_sls_itm.actl_sls_wps / actl_sls_itm.actl_itm_wps),2),0) end as ACTL_ITM_PRZ_WPS from 
(select f.dept_nm,NVL(e.ACTL_SALES_WPS,0) as ACTL_SLS_WPS,NVL(e.ACTL_ITEM_WPS,0) as ACTL_ITM_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_sls_itm ]]>
	</ItemPriceHistory>
	<ItemPriceHistoryTotal>
	<![CDATA[select actl_sls_itm.loc_nm,
	case when NVL(actl_sls_itm.actl_sls_tot_wps,0)=0 and NVL(actl_sls_itm.actl_itm_tot_wps,0)=0 then 0
	when NVL(actl_sls_itm.actl_sls_tot_wps,0)=0 then 0 when NVL(actl_sls_itm.actl_itm_tot_wps,0)=0 then 0
	else NVL(ROUND((actl_sls_itm.actl_sls_tot_wps / actl_sls_itm.actl_itm_tot_wps),2),0) end as ACTL_ITM_PRZ_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.ACTL_SALES_WPS),0),0) as ACTL_SLS_TOT_WPS,NVL(ROUND(sum(e.ACTL_ITEM_WPS),0),0) as ACTL_ITM_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_sls_itm]]>
	</ItemPriceHistoryTotal>
</TCName>

<TCName name = "ItemPriceHistorySecondWeek" >
	<ItemPriceHistory>
	<![CDATA[select actl_sls_itm.dept_nm,
	case when NVL(actl_sls_itm.actl_sls_wps,0)=0 and NVL(actl_sls_itm.actl_itm_wps,0)=0 then 0
	when NVL(actl_sls_itm.actl_sls_wps,0)=0 then 0 when NVL(actl_sls_itm.actl_itm_wps,0)=0 then 0
	else NVL(ROUND((actl_sls_itm.actl_sls_wps / actl_sls_itm.actl_itm_wps),2),0) end as ACTL_ITM_PRZ_WPS from 
(select f.dept_nm,NVL(e.ACTL_SALES_WPS,0) as ACTL_SLS_WPS,NVL(e.ACTL_ITEM_WPS,0) as ACTL_ITM_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_sls_itm ]]>
	</ItemPriceHistory>
	<ItemPriceHistoryTotal>
	<![CDATA[select actl_sls_itm.loc_nm,
	case when NVL(actl_sls_itm.actl_sls_tot_wps,0)=0 and NVL(actl_sls_itm.actl_itm_tot_wps,0)=0 then 0
	when NVL(actl_sls_itm.actl_sls_tot_wps,0)=0 then 0 when NVL(actl_sls_itm.actl_itm_tot_wps,0)=0 then 0
	else NVL(ROUND((actl_sls_itm.actl_sls_tot_wps / actl_sls_itm.actl_itm_tot_wps),2),0) end as ACTL_ITM_PRZ_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.ACTL_SALES_WPS),0),0) as ACTL_SLS_TOT_WPS,NVL(ROUND(sum(e.ACTL_ITEM_WPS),0),0) as ACTL_ITM_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_sls_itm]]>
	</ItemPriceHistoryTotal>
</TCName>

<TCName name = "ItemPriceHistoryThirdWeek" >
	<ItemPriceHistory>
	<![CDATA[select actl_sls_itm.dept_nm,
	case when NVL(actl_sls_itm.actl_sls_wps,0)=0 and NVL(actl_sls_itm.actl_itm_wps,0)=0 then 0
	when NVL(actl_sls_itm.actl_sls_wps,0)=0 then 0 when NVL(actl_sls_itm.actl_itm_wps,0)=0 then 0
	else NVL(ROUND((actl_sls_itm.actl_sls_wps / actl_sls_itm.actl_itm_wps),2),0) end as ACTL_ITM_PRZ_WPS from 
(select f.dept_nm,NVL(e.ACTL_SALES_WPS,0) as ACTL_SLS_WPS,NVL(e.ACTL_ITEM_WPS,0) as ACTL_ITM_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_sls_itm ]]>
	</ItemPriceHistory>
	<ItemPriceHistoryTotal>
	<![CDATA[select actl_sls_itm.loc_nm,
	case when NVL(actl_sls_itm.actl_sls_tot_wps,0)=0 and NVL(actl_sls_itm.actl_itm_tot_wps,0)=0 then 0
	when NVL(actl_sls_itm.actl_sls_tot_wps,0)=0 then 0 when NVL(actl_sls_itm.actl_itm_tot_wps,0)=0 then 0
	else NVL(ROUND((actl_sls_itm.actl_sls_tot_wps / actl_sls_itm.actl_itm_tot_wps),2),0) end as ACTL_ITM_PRZ_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.ACTL_SALES_WPS),0),0) as ACTL_SLS_TOT_WPS,NVL(ROUND(sum(e.ACTL_ITEM_WPS),0),0) as ACTL_ITM_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_sls_itm]]>
	</ItemPriceHistoryTotal>
</TCName>

<TCName name = "ItemPriceHistoryFourthWeek" >
	<ItemPriceHistory>
	<![CDATA[select actl_sls_itm.dept_nm,
	case when NVL(actl_sls_itm.actl_sls_wps,0)=0 and NVL(actl_sls_itm.actl_itm_wps,0)=0 then 0
	when NVL(actl_sls_itm.actl_sls_wps,0)=0 then 0 when NVL(actl_sls_itm.actl_itm_wps,0)=0 then 0
	else NVL(ROUND((actl_sls_itm.actl_sls_wps / actl_sls_itm.actl_itm_wps),2),0) end as ACTL_ITM_PRZ_WPS from 
(select f.dept_nm,NVL(e.ACTL_SALES_WPS,0) as ACTL_SLS_WPS,NVL(e.ACTL_ITEM_WPS,0) as ACTL_ITM_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_sls_itm ]]>
	</ItemPriceHistory>
	<ItemPriceHistoryTotal>
	<![CDATA[select actl_sls_itm.loc_nm,
	case when NVL(actl_sls_itm.actl_sls_tot_wps,0)=0 and NVL(actl_sls_itm.actl_itm_tot_wps,0)=0 then 0
	when NVL(actl_sls_itm.actl_sls_tot_wps,0)=0 then 0 when NVL(actl_sls_itm.actl_itm_tot_wps,0)=0 then 0
	else NVL(ROUND((actl_sls_itm.actl_sls_tot_wps / actl_sls_itm.actl_itm_tot_wps),2),0) end as ACTL_ITM_PRZ_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.ACTL_SALES_WPS),0),0) as ACTL_SLS_TOT_WPS,NVL(ROUND(sum(e.ACTL_ITEM_WPS),0),0) as ACTL_ITM_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_sls_itm]]>
	</ItemPriceHistoryTotal>
</TCName>

<TCName name = "ORHistoryFirstWeek" >
	<ORHistory>
	<![CDATA[select actl_sms.dept_nm,
case when NVL(actl_sms.ACTL_SMS_WTSS,0)=0 and NVL(actl_hrs.ACTL_HRS_WTSS,0)=0 then 0 
when NVL(actl_sms.ACTL_SMS_WTSS,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_WTSS,0)=0 then 0 
else NVL(ROUND((actl_sms.ACTL_SMS_WTSS / actl_hrs.ACTL_HRS_WTSS)*100,0),0) end as WTD from  
(select lc.dept_nm,NVL(xy.WK_TO_DT_TOT,0) as ACTL_SMS_WTSS from 
(select distinct dept_no,dply_seq,dept_nm from dept where div_no='Division' 
and dept_no IN (select dept_no from loc_dept where dept_no NOT IN (20) and loc_no='store') 
and dply_seq is not null order by dply_seq) lc
LEFT OUTER JOIN
(select  dept_nm,Sum(plan_sms_hrs) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
when dept_no not in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
NVL(ds.actl_itm_cnt,0) as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no NOT IN (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by dept_nm) xy
on lc.dept_nm=xy.dept_nm order by lc.dply_seq)actl_sms
LEFT OUTER JOIN
(select lc.dept_nm,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_WTSS from 
(select distinct dept_no,dply_seq,dept_nm from dept where div_no='Division' 
and dept_no IN (select dept_no from loc_dept where dept_no NOT IN (20) and loc_no='store') 
and dply_seq is not null order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq)actl_hrs
on actl_sms.dept_nm=actl_hrs.dept_nm]]>
	</ORHistory>
	<ORHistoryTotal>
	<![CDATA[select actl_sms.loc_nm,
	case when NVL(actl_sms.ACTL_SMS_TOT_WTSS,0)=0 and NVL(actl_hrs.ACTL_HRS_TOT_WTSS,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_TOT_WTSS,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_TOT_WTSS,0)=0 then 0 
	else NVL(ROUND((actl_sms.ACTL_SMS_TOT_WTSS / actl_hrs.ACTL_HRS_TOT_WTSS)*100,0),0) end as ACTL_OR_TOT_WTSS from
(select lc.loc_nm,NVL(xy.WK_TO_DT_TOT,0) as ACTL_SMS_TOT_WTSS from 
(select distinct loc_no,loc_nm from loc where div_no='Division' and loc_no='store') lc
LEFT OUTER JOIN
(select  loc_no,Sum(plan_sms_hrs) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
when dept_no not in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no) xy
on lc.loc_no=xy.loc_no)actl_sms,
(select lc.loc_nm,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no)actl_hrs
where actl_sms.loc_nm=actl_hrs.loc_nm order by actl_sms.loc_nm]]>
	</ORHistoryTotal>
</TCName>

<TCName name = "ORHistorySecondWeek" >
	<ORHistory>
	<![CDATA[select actl_sms.dept_nm,
case when NVL(actl_sms.ACTL_SMS_WTSS,0)=0 and NVL(actl_hrs.ACTL_HRS_WTSS,0)=0 then 0 
when NVL(actl_sms.ACTL_SMS_WTSS,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_WTSS,0)=0 then 0 
else NVL(ROUND((actl_sms.ACTL_SMS_WTSS / actl_hrs.ACTL_HRS_WTSS)*100,0),0) end as WTD from  
(select lc.dept_nm,NVL(xy.WK_TO_DT_TOT,0) as ACTL_SMS_WTSS from 
(select distinct dept_no,dply_seq,dept_nm from dept where div_no='Division' 
and dept_no IN (select dept_no from loc_dept where dept_no NOT IN (20) and loc_no='store') 
and dply_seq is not null order by dply_seq) lc
LEFT OUTER JOIN
(select  dept_nm,Sum(plan_sms_hrs) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
when dept_no not in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
NVL(ds.actl_itm_cnt,0) as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by dept_nm) xy
on lc.dept_nm=xy.dept_nm order by lc.dply_seq)actl_sms
LEFT OUTER JOIN
(select lc.dept_nm,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_WTSS from 
(select distinct dept_no,dply_seq,dept_nm from dept where div_no='Division' 
and dept_no IN (select dept_no from loc_dept where dept_no NOT IN (20) and loc_no='store') 
and dply_seq is not null order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq)actl_hrs
on actl_sms.dept_nm=actl_hrs.dept_nm]]>
	</ORHistory>
	<ORHistoryTotal>
	<![CDATA[select actl_sms.loc_nm,
	case when NVL(actl_sms.ACTL_SMS_TOT_WTSS,0)=0 and NVL(actl_hrs.ACTL_HRS_TOT_WTSS,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_TOT_WTSS,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_TOT_WTSS,0)=0 then 0 
	else NVL(ROUND((actl_sms.ACTL_SMS_TOT_WTSS / actl_hrs.ACTL_HRS_TOT_WTSS)*100,0),0) end as ACTL_OR_TOT_WTSS from
(select lc.loc_nm,NVL(xy.WK_TO_DT_TOT,0) as ACTL_SMS_TOT_WTSS from 
(select distinct loc_no,loc_nm from loc where div_no='Division' and loc_no='store') lc
LEFT OUTER JOIN
(select  loc_no,Sum(plan_sms_hrs) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
when dept_no not in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no) xy
on lc.loc_no=xy.loc_no)actl_sms,
(select lc.loc_nm,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no)actl_hrs
where actl_sms.loc_nm=actl_hrs.loc_nm order by actl_sms.loc_nm]]>
	</ORHistoryTotal>
</TCName>

<TCName name = "ORHistoryThirdWeek" >
	<ORHistory>
	<![CDATA[select actl_sms.dept_nm,
case when NVL(actl_sms.ACTL_SMS_WTSS,0)=0 and NVL(actl_hrs.ACTL_HRS_WTSS,0)=0 then 0 
when NVL(actl_sms.ACTL_SMS_WTSS,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_WTSS,0)=0 then 0 
else NVL(ROUND((actl_sms.ACTL_SMS_WTSS / actl_hrs.ACTL_HRS_WTSS)*100,0),0) end as WTD from  
(select lc.dept_nm,NVL(xy.WK_TO_DT_TOT,0) as ACTL_SMS_WTSS from 
(select distinct dept_no,dply_seq,dept_nm from dept where div_no='Division' 
and dept_no IN (select dept_no from loc_dept where dept_no NOT IN (20) and loc_no='store') 
and dply_seq is not null order by dply_seq) lc
LEFT OUTER JOIN
(select  dept_nm,Sum(plan_sms_hrs) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
when dept_no not in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
NVL(ds.actl_itm_cnt,0) as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by dept_nm) xy
on lc.dept_nm=xy.dept_nm order by lc.dply_seq)actl_sms
LEFT OUTER JOIN
(select lc.dept_nm,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_WTSS from 
(select distinct dept_no,dply_seq,dept_nm from dept where div_no='Division' 
and dept_no IN (select dept_no from loc_dept where dept_no NOT IN (20) and loc_no='store') 
and dply_seq is not null order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq)actl_hrs
on actl_sms.dept_nm=actl_hrs.dept_nm]]>
	</ORHistory>
	<ORHistoryTotal>
	<![CDATA[select actl_sms.loc_nm,
	case when NVL(actl_sms.ACTL_SMS_TOT_WTSS,0)=0 and NVL(actl_hrs.ACTL_HRS_TOT_WTSS,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_TOT_WTSS,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_TOT_WTSS,0)=0 then 0 
	else NVL(ROUND((actl_sms.ACTL_SMS_TOT_WTSS / actl_hrs.ACTL_HRS_TOT_WTSS)*100,0),0) end as ACTL_OR_TOT_WTSS from
(select lc.loc_nm,NVL(xy.WK_TO_DT_TOT,0) as ACTL_SMS_TOT_WTSS from 
(select distinct loc_no,loc_nm from loc where div_no='Division' and loc_no='store') lc
LEFT OUTER JOIN
(select  loc_no,Sum(plan_sms_hrs) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
when dept_no not in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no) xy
on lc.loc_no=xy.loc_no)actl_sms,
(select lc.loc_nm,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no)actl_hrs
where actl_sms.loc_nm=actl_hrs.loc_nm order by actl_sms.loc_nm]]>
	</ORHistoryTotal>
</TCName>

<TCName name = "ORHistoryFourthWeek" >
	<ORHistory>
	<![CDATA[select actl_sms.dept_nm,
case when NVL(actl_sms.ACTL_SMS_WTSS,0)=0 and NVL(actl_hrs.ACTL_HRS_WTSS,0)=0 then 0 
when NVL(actl_sms.ACTL_SMS_WTSS,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_WTSS,0)=0 then 0 
else NVL(ROUND((actl_sms.ACTL_SMS_WTSS / actl_hrs.ACTL_HRS_WTSS)*100,0),0) end as WTD from  
(select lc.dept_nm,NVL(xy.WK_TO_DT_TOT,0) as ACTL_SMS_WTSS from 
(select distinct dept_no,dply_seq,dept_nm from dept where div_no='Division' 
and dept_no IN (select dept_no from loc_dept where dept_no NOT IN (20) and loc_no='store') 
and dply_seq is not null order by dply_seq) lc
LEFT OUTER JOIN
(select  dept_nm,Sum(plan_sms_hrs) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
when dept_no not in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
NVL(ds.actl_itm_cnt,0) as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by dept_nm) xy
on lc.dept_nm=xy.dept_nm order by lc.dply_seq)actl_sms
LEFT OUTER JOIN
(select lc.dept_nm,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_WTSS from 
(select distinct dept_no,dply_seq,dept_nm from dept where div_no='Division' 
and dept_no IN (select dept_no from loc_dept where dept_no NOT IN (20) and loc_no='store') 
and dply_seq is not null order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq)actl_hrs
on actl_sms.dept_nm=actl_hrs.dept_nm]]>
	</ORHistory>
	<ORHistoryTotal>
	<![CDATA[select actl_sms.loc_nm,
	case when NVL(actl_sms.ACTL_SMS_TOT_WTSS,0)=0 and NVL(actl_hrs.ACTL_HRS_TOT_WTSS,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_TOT_WTSS,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_TOT_WTSS,0)=0 then 0 
	else NVL(ROUND((actl_sms.ACTL_SMS_TOT_WTSS / actl_hrs.ACTL_HRS_TOT_WTSS)*100,0),0) end as ACTL_OR_TOT_WTSS from
(select lc.loc_nm,NVL(xy.WK_TO_DT_TOT,0) as ACTL_SMS_TOT_WTSS from 
(select distinct loc_no,loc_nm from loc where div_no='Division' and loc_no='store') lc
LEFT OUTER JOIN
(select  loc_no,Sum(plan_sms_hrs) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
when dept_no not in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no) xy
on lc.loc_no=xy.loc_no)actl_sms,
(select lc.loc_nm,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no)actl_hrs
where actl_sms.loc_nm=actl_hrs.loc_nm order by actl_sms.loc_nm]]>
	</ORHistoryTotal>
</TCName>

<TCName name = "BudgetSales_CurrentMonth">
	<BudgetSales>
	<![CDATA[select f.dept_nm,NVL(e.BDGT_SALES_WPS,0) as BDGT_SLS_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no 
	NOT IN (20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,
	d.dply_seq,d.dept_nm,ROUND(sum(a.bdgt_sls),0) as BDGT_SALES_WPS,ROUND(sum(a.bdgt_wage_amt),0) as BDGT_WAGE_WPS
	from ww_wlp.wky_bdgt a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
	and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
	order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</BudgetSales>
	<BudgetSalesTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.BDGT_SALES_WPS),0),0) as BDGT_SLS_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.bdgt_sls),0) as BDGT_SALES_WPS,
	ROUND(sum(a.bdgt_wage_amt),0) as BDGT_WAGE_WPS from ww_wlp.wky_bdgt a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and 
	b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
	order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e on e.loc_nm=f.loc_nm group by f.loc_nm]]>
	</BudgetSalesTotal>
	<ForecastSales>
	<![CDATA[select f.dept_nm,NVL(e.FCST_SALES_WPS,0) as FCST_SLS_WPS from (select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no 
	NOT IN (20) and dply_seq is not null order by dply_seq) f LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,
	d.dply_seq,d.dept_nm,ROUND(sum(a.frcst_sls),0) as FCST_SALES_WPS,ROUND(sum(a.frcst_wage_amt),0) as FCST_WAGE_WPS
	from ww_wlp.mnth_fcst a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
	and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
	order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</ForecastSales>
	<ForecastSalesTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.FCST_SALES_WPS),0),0) as FCST_SLS_TOT_WPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.frcst_sls),0) as FCST_SALES_WPS,
	ROUND(sum(a.frcst_wage_amt),0) as FCST_WAGE_WPS from ww_wlp.MNTH_FCST a,wk b,loc c,dept d where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and 
	b.fin_yr='FinYear' and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
	order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e on e.loc_nm=f.loc_nm group by f.loc_nm]]>
	</ForecastSalesTotal>
</TCName>

<TCName name = "PlannedSales_CurrentMonth">
	<PlannedSales>
	<![CDATA[select f.dept_nm,NVL(sum(e.PLAN_SALES_WPS),0) as PLN_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no  group by f.dply_seq , f.dept_nm order by f.dply_seq ]]>
	</PlannedSales>
	<PlannedSalesTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES_WPS),0),0) as PLN_SLS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on e.loc_nm=f.loc_nm group by f.loc_nm]]>
	</PlannedSalesTotal>
</TCName>

<TCName name = "GeneratedSales_CurrentMonth">
	<GeneratedSales>
	<![CDATA[select f.dept_nm,NVL(e.GEN_SALES_WPS,0) as GEN_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS,ROUND(sum(a.gnrt_itm),0) as GEN_ITEM_WPS,ROUND(sum(a.gnrt_cust),0) as GEN_CUSTM_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</GeneratedSales>
	<GeneratedSalesTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.GEN_SALES_WPS),0),0) as GEN_SLS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS,ROUND(sum(a.gnrt_itm),0) as GEN_ITEM_WPS,ROUND(sum(a.gnrt_cust),0) as GEN_CUSTM_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm]]>
	</GeneratedSalesTotal>
</TCName>

<TCName name = "VarToBUDSales_CurrentMonth">
	<VartoBUD>
	<![CDATA[select pln_sls.dept_nm,(pln_sls.PLN_SLS_WPS - bdgt_sls.BDGT_SLS_WPS) as VAR_TO_BUD_SLS_WPS from 
(select f.dept_nm,NVL(sum(e.PLAN_SALES_WPS),0) as PLN_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no  group by f.dply_seq , f.dept_nm order by f.dply_seq ) pln_sls,
(select f.dept_nm,NVL(e.BDGT_SALES_WPS,0) as BDGT_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.bdgt_sls),0) as BDGT_SALES_WPS,ROUND(sum(a.bdgt_wage_amt),0) as BDGT_WAGE_WPS
from ww_wlp.wky_bdgt a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) bdgt_sls
where pln_sls.dept_nm=bdgt_sls.dept_nm ]]>
	</VartoBUD>
	<VartoBUDTotal>
	<![CDATA[select pln_sls.loc_nm,(pln_sls.PLN_SLS_TOT_WPS - bdgt_sls.BDGT_SLS_TOT_WPS) as VAR_TO_BUD_SLS_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES_WPS),0),0) as PLN_SLS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on e.loc_nm=f.loc_nm group by f.loc_nm) pln_sls,
(select f.loc_nm,NVL(ROUND(sum(e.BDGT_SALES_WPS),0),0) as BDGT_SLS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.bdgt_sls),0) as BDGT_SALES_WPS,ROUND(sum(a.bdgt_wage_amt),0) as BDGT_WAGE_WPS
from ww_wlp.wky_bdgt a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm) bdgt_sls
where pln_sls.loc_nm=bdgt_sls.loc_nm
]]>
	</VartoBUDTotal>
	<VartoFCST>
	<![CDATA[select pln_sls.dept_nm,(pln_sls.PLN_SLS_WPS - frcst_sls.frcst_sls_WPS) as VAR_TO_BUD_SLS_WPS from 
(select f.dept_nm,NVL(sum(e.PLAN_SALES_WPS),0) as PLN_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no  group by f.dply_seq , f.dept_nm order by f.dply_seq) pln_sls,
(select f.dept_nm,NVL(e.fcst_SALES_WPS,0) as frcst_sls_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.frcst_sls),0) as fcst_SALES_WPS,ROUND(sum(a.frcst_wage_amt),0) as fcst_WAGE_WPS
from ww_wlp.mnth_fcst a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) frcst_sls
where pln_sls.dept_nm=frcst_sls.dept_nm]]>
	</VartoFCST>
	<VartoFCSTTotal>
	<![CDATA[select pln_sls.loc_nm,(pln_sls.PLN_SLS_TOT_WPS - frcst_sls.frcst_sls_TOT_WPS) as VAR_TO_BUD_SLS_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES_WPS),0),0) as PLN_SLS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on e.loc_nm=f.loc_nm group by f.loc_nm) pln_sls,
(select f.loc_nm,NVL(ROUND(sum(e.fcst_SALES_WPS),0),0) as frcst_sls_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.frcst_sls),0) as fcst_SALES_WPS,ROUND(sum(a.frcst_wage_amt),0) as fcst_WAGE_WPS
from ww_wlp.mnth_fcst a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm) frcst_sls
where pln_sls.loc_nm=frcst_sls.loc_nm]]>
	</VartoFCSTTotal>
</TCName>

<TCName name = "PercentageLYsales_CurrentMonth">
	<PercentLYSales>
	<![CDATA[select pln_sls_cy.dept_nm,
	CASE When pln_sls_cy.PLN_SLS_CY_WPS=0 and actl_sls_ly.ACTL_SLS_LY_WPS=0 Then 0 
	When pln_sls_cy.PLN_SLS_CY_WPS=0 Then -100 When actl_sls_ly.ACTL_SLS_LY_WPS=0 Then 0 
	ELSE ROUND(((pln_sls_cy.PLN_SLS_CY_WPS / actl_sls_ly.ACTL_SLS_LY_WPS)-1)*100,2) END as LY_PCT_SLS_WPS from 
(select f.dept_nm,NVL(sum(e.PLAN_SALES_WPS),0) as PLN_SLS_CY_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no ,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no  group by f.dply_seq , f.dept_nm order by f.dply_seq ) pln_sls_cy,
(select f.dept_nm,NVL(e.ACTL_SALES_WPS,0) as ACTL_SLS_LY_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_sls_ly
where pln_sls_cy.dept_nm=actl_sls_ly.dept_nm]]>
	</PercentLYSales>
	<PercentLYSalesTotal>
	<![CDATA[select pln_sls_cy.loc_nm,
	CASE When pln_sls_cy.PLN_SLS_CY_TOT_WPS=0 and actl_sls_ly.ACTL_SLS_LY_TOT_WPS=0 Then 0 
	When pln_sls_cy.PLN_SLS_CY_TOT_WPS=0 Then -100 When actl_sls_ly.ACTL_SLS_LY_TOT_WPS=0 Then 0 
	ELSE ROUND(((pln_sls_cy.PLN_SLS_CY_TOT_WPS / actl_sls_ly.ACTL_SLS_LY_TOT_WPS)-1)*100,2) END as LY_PCT_SLS_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES_WPS),0),0) as PLN_SLS_CY_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no ,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm, a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on e.loc_nm=f.loc_nm group by f.loc_nm) pln_sls_cy,
(select f.loc_nm,NVL(ROUND(sum(e.ACTL_SALES_WPS),0),0) as ACTL_SLS_LY_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_sls_ly
where pln_sls_cy.loc_nm=actl_sls_ly.loc_nm
]]>
	</PercentLYSalesTotal>
</TCName>

<TCName name = "BudgetPercentageSales_CurrentMonth">
	<BudgetPercentage>
	<![CDATA[select pln_sls_cy.dept_nm,
case when pln_sls_cy.PLN_SLS_WPS=0 and bdgt_sls_cy.BDGT_SLS_CY_WPS=0 then 0 
when pln_sls_cy.PLN_SLS_WPS=0 then -100 when bdgt_sls_cy.BDGT_SLS_CY_WPS=0 then 0 
else ROUND(((pln_sls_cy.PLN_SLS_WPS / bdgt_sls_cy.BDGT_SLS_CY_WPS)-1)*100,2) end as BDGT_PCT_SLS_WPS from 
(select f.dept_nm,NVL(sum(e.PLAN_SALES_WPS),0) as PLN_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no  group by f.dply_seq , f.dept_nm order by f.dply_seq ) pln_sls_cy,
(select f.dept_nm,NVL(e.BDGT_SALES_WPS,0) as BDGT_SLS_CY_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.bdgt_sls),0) as BDGT_SALES_WPS,ROUND(sum(a.bdgt_wage_amt),0) as BDGT_WAGE_WPS
from ww_wlp.wky_bdgt a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) bdgt_sls_cy
where pln_sls_cy.dept_nm=bdgt_sls_cy.dept_nm]]>
	</BudgetPercentage>
	<BudgetPercentageTotal>
	<![CDATA[select pln_sls_cy.loc_nm,
	case when pln_sls_cy.PLN_SLS_TOT_WPS=0 and bdgt_sls_cy.BDGT_SLS_CY_TOT_WPS=0 then 0 
	when pln_sls_cy.PLN_SLS_TOT_WPS=0 then -100 when bdgt_sls_cy.BDGT_SLS_CY_TOT_WPS=0 then 0 
	else ROUND(((pln_sls_cy.PLN_SLS_TOT_WPS / bdgt_sls_cy.BDGT_SLS_CY_TOT_WPS)-1)*100,2) end as BDGT_PCT_SLS_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES_WPS),0),0) as PLN_SLS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on e.loc_nm=f.loc_nm group by f.loc_nm) pln_sls_cy,
(select f.loc_nm,NVL(ROUND(sum(e.BDGT_SALES_WPS),0),0) as BDGT_SLS_CY_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.bdgt_sls),0) as BDGT_SALES_WPS,ROUND(sum(a.bdgt_wage_amt),0) as BDGT_WAGE_WPS
from ww_wlp.wky_bdgt a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm) bdgt_sls_cy
where pln_sls_cy.loc_nm=bdgt_sls_cy.loc_nm]]>
	</BudgetPercentageTotal>
	<ForecastPercentage>
	<![CDATA[select pln_sls_cy.dept_nm,
	case when pln_sls_cy.PLN_SLS_CY_WPS=0 and frcst_sls_cy.frcst_sls_CY_WPS=0 then 0 
	when pln_sls_cy.PLN_SLS_CY_WPS=0 then -100 when frcst_sls_cy.frcst_sls_CY_WPS=0 then 0 
	else ROUND(((pln_sls_cy.PLN_SLS_CY_WPS / frcst_sls_cy.frcst_sls_CY_WPS)-1)*100,2) end as fcst_PCT_SLS_WPS from 
(select f.dept_nm,NVL(sum(e.PLAN_SALES_WPS),0) as PLN_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no  group by f.dply_seq , f.dept_nm order by f.dply_seq) pln_sls_cy,
(select f.dept_nm,NVL(e.fcst_SALES_WPS,0) as frcst_sls_CY_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.frcst_sls),0) as fcst_SALES_WPS,ROUND(sum(a.frcst_wage_amt),0) as fcst_WAGE_WPS
from ww_wlp.mnth_fcst a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) frcst_sls_cy
where pln_sls_cy.dept_nm=frcst_sls_cy.dept_nm]]>
	</ForecastPercentage>
	<ForecastPercentageTotal>
	<![CDATA[select pln_sls_cy.loc_nm,
	case when pln_sls_cy.PLN_SLS_CY_TOT_WPS=0 and frcst_sls_cy.frcst_sls_CY_TOT_WPS=0 then 0 
	when pln_sls_cy.PLN_SLS_CY_TOT_WPS=0 then -100 when frcst_sls_cy.frcst_sls_CY_TOT_WPS=0 then 0 
	else ROUND(((pln_sls_cy.PLN_SLS_CY_TOT_WPS / frcst_sls_cy.frcst_sls_CY_TOT_WPS)-1)*100,2) end as fcst_PCT_SLS_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES_WPS),0),0) as PLN_SLS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on e.loc_nm=f.loc_nm group by f.loc_nm) pln_sls_cy,
(select f.loc_nm,NVL(ROUND(sum(e.fcst_SALES_WPS),0),0) as frcst_sls_CY_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.frcst_sls),0) as fcst_SALES_WPS,ROUND(sum(a.frcst_wage_amt),0) as fcst_WAGE_WPS
from ww_wlp.mnth_fcst a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm) frcst_sls_cy
where pln_sls_cy.loc_nm=frcst_sls_cy.loc_nm]]>
	</ForecastPercentageTotal>
</TCName>

<TCName name = "BudgetWages_CurrentMonth">
	<BudgetWages>
	<![CDATA[select f.dept_nm,NVL(e.BDGT_WAGE_WPS,0) as BDGT_WGE_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.bdgt_sls),0) as BDGT_SALES_WPS,ROUND(sum(a.bdgt_wage_amt),0) as BDGT_WAGE_WPS
from ww_wlp.wky_bdgt a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</BudgetWages>
	<BudgetWagesTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.BDGT_WAGE_WPS),0),0) as BDGT_WGE_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.bdgt_sls),0) as BDGT_SALES_WPS,ROUND(sum(a.bdgt_wage_amt),0) as BDGT_WAGE_WPS
from ww_wlp.wky_bdgt a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm]]>
	</BudgetWagesTotal>
	<ForecastWages>
	<![CDATA[select f.dept_nm,NVL(e.fcst_WAGE_WPS,0) as fcst_WGE_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.frcst_sls),0) as fcst_SALES_WPS,ROUND(sum(a.frcst_wage_amt),0) as fcst_WAGE_WPS
from ww_wlp.mnth_fcst a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</ForecastWages>
	<ForecastWagesTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.fcst_WAGE_WPS),0),0) as fcst_WGE_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.frcst_sls),0) as fcst_SALES_WPS,ROUND(sum(a.frcst_wage_amt),0) as fcst_WAGE_WPS
from ww_wlp.mnth_fcst a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm]]>
	</ForecastWagesTotal>
</TCName>

<TCName name = "PlannedWages_CurrentMonth">
	<PlannedWages>
	<![CDATA[select f.dept_nm,NVL(e.PLN_WAGE_WPS,0) as PLN_WGE_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</PlannedWages>
	<PlannedWagesTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.PLN_WAGE_WPS),0),0) as PLN_WGE_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm]]>
	</PlannedWagesTotal>
</TCName>

<TCName name = "PlannedLYWages_CurrentMonth">
	<PlannedLYWages>
	<![CDATA[select pln_wge_cy.dept_nm,
	CASE When pln_wge_cy.PLN_WGE_CY_WPS=0 and actl_wge_ly.ACTL_WGE_LY_WPS=0 Then 0 
	When pln_wge_cy.PLN_WGE_CY_WPS=0 Then -100 When actl_wge_ly.ACTL_WGE_LY_WPS=0 Then 0 
	ELSE ROUND(((pln_wge_cy.PLN_WGE_CY_WPS / actl_wge_ly.ACTL_WGE_LY_WPS)-1)*100,2) END as PLN_PCT_ON_LY_SLS_WPS from 
(select f.dept_nm,NVL(e.PLN_WAGE_WPS,0) as PLN_WGE_CY_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) pln_wge_cy,
(select f.dept_nm,NVL(e.ACTL_WAGE_WPS,0) as ACTL_WGE_LY_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) as ACTL_HOURS_WPS
from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_wge_ly
where pln_wge_cy.dept_nm=actl_wge_ly.dept_nm]]>
	</PlannedLYWages>
	<PlannedLYWagesTotal>
	<![CDATA[select pln_wge_cy.loc_nm,
	CASE When pln_wge_cy.PLN_WGE_CY_TOT_WPS=0 and actl_wge_ly.ACTL_WGE_LY_TOT_WPS=0 Then 0 
	When pln_wge_cy.PLN_WGE_CY_TOT_WPS=0 Then -100 When actl_wge_ly.ACTL_WGE_LY_TOT_WPS=0 Then 0 
	ELSE ROUND(((pln_wge_cy.PLN_WGE_CY_TOT_WPS / actl_wge_ly.ACTL_WGE_LY_TOT_WPS)-1)*100,2) END as PLN_PCT_ON_LY_SLS_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.PLN_WAGE_WPS),0),0) as PLN_WGE_CY_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm) pln_wge_cy,
(select f.loc_nm,NVL(ROUND(sum(e.ACTL_WAGE_WPS),0),0) as ACTL_WGE_LY_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) as ACTL_HOURS_WPS
from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_wge_ly
where pln_wge_cy.loc_nm=actl_wge_ly.loc_nm]]>
	</PlannedLYWagesTotal>
</TCName>

<TCName name = "BudgetWagesPercentage_CurrentMonth">
	<BudgetWagesPercentage>
	<![CDATA[select wge_sls.dept_nm,
case when wge_sls.BDGT_WGE_WPS=0 and wge_sls.BDGT_SLS_WPS=0 then 0 
when wge_sls.BDGT_WGE_WPS=0 then 0 when wge_sls.BDGT_SLS_WPS=0 then 0 
else ROUND((wge_sls.BDGT_WGE_WPS / wge_sls.BDGT_SLS_WPS)*100,2) end as BDGT_WGE_PCT_WPS from 
(select f.dept_nm,NVL(e.BDGT_WAGE_WPS,0) as BDGT_WGE_WPS,NVL(e.BDGT_SALES_WPS,0) as BDGT_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
sum(a.bdgt_sls) as BDGT_SALES_WPS,sum(a.bdgt_wage_amt) as BDGT_WAGE_WPS
from ww_wlp.wky_bdgt a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) wge_sls]]>
	</BudgetWagesPercentage>
	<BudgetWagesPercentageTotal>
	<![CDATA[select wge.loc_nm,
	case when wge.BDGT_WGE_TOT_WPS=0 and sls.BDGT_SLS_TOT_WPS=0 then 0 
	when wge.BDGT_WGE_TOT_WPS=0 then 0 when sls.BDGT_SLS_TOT_WPS=0 then 0 
	else ROUND((wge.BDGT_WGE_TOT_WPS / sls.BDGT_SLS_TOT_WPS)*100,2) end as BDGT_WGE_PCT_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.BDGT_WAGE_WPS),0),0) as BDGT_WGE_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.bdgt_sls),0) as BDGT_SALES_WPS,ROUND(sum(a.bdgt_wage_amt),0) as BDGT_WAGE_WPS
from ww_wlp.wky_bdgt a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm) wge,
(select f.loc_nm,NVL(ROUND(sum(e.BDGT_SALES_WPS),0),0) as BDGT_SLS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.bdgt_sls),0) as BDGT_SALES_WPS,ROUND(sum(a.bdgt_wage_amt),0) as BDGT_WAGE_WPS
from ww_wlp.wky_bdgt a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm) sls
where wge.loc_nm=sls.loc_nm order by wge.loc_nm ]]>
	</BudgetWagesPercentageTotal>
	<ForecastWagesPercentage>
	<![CDATA[select wge_sls.dept_nm,
	case when wge_sls.fcst_WGE_WPS=0 and wge_sls.frcst_sls_WPS=0 then 0 
when wge_sls.fcst_WGE_WPS=0 then 0 when wge_sls.frcst_sls_WPS=0 then 0 
else ROUND((wge_sls.fcst_WGE_WPS / wge_sls.frcst_sls_WPS)*100,2) end as fcst_WGE_PCT_WPS from 
(select f.dept_nm,NVL(e.fcst_WAGE_WPS,0) as fcst_WGE_WPS,NVL(e.fcst_SALES_WPS,0) as frcst_sls_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
sum(a.frcst_sls) as fcst_SALES_WPS,sum(a.frcst_wage_amt) as fcst_WAGE_WPS
from ww_wlp.mnth_fcst a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) wge_sls]]>
	</ForecastWagesPercentage>
	<ForecastWagesPercentageTotal>
	<![CDATA[select wge.loc_nm,
		case when wge.fcst_WGE_TOT_WPS=0 and sls.frcst_sls_TOT_WPS=0 then 0 
	when wge.fcst_WGE_TOT_WPS=0 then 0 when sls.frcst_sls_TOT_WPS=0 then 0 
	else ROUND((wge.fcst_WGE_TOT_WPS / sls.frcst_sls_TOT_WPS)*100,2) end as fcst_WGE_PCT_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.fcst_WAGE_WPS),0),0) as fcst_WGE_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.frcst_sls),0) as fcst_SALES_WPS,ROUND(sum(a.frcst_wage_amt),0) as fcst_WAGE_WPS
from ww_wlp.mnth_fcst a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm) wge,
(select f.loc_nm,NVL(ROUND(sum(e.fcst_SALES_WPS),0),0) as frcst_sls_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.frcst_sls),0) as fcst_SALES_WPS,ROUND(sum(a.frcst_wage_amt),0) as fcst_WAGE_WPS
from ww_wlp.mnth_fcst a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm) sls
where wge.loc_nm=sls.loc_nm order by wge.loc_nm]]>
	</ForecastWagesPercentageTotal>
</TCName>

<TCName name = "PlannedWagesPercentage_CurrentMonth">
	<PlannedWagesPercentage>
	<![CDATA[select wge.dept_nm,
	case when NVL(wge.PLN_WGE_WPS,0)=0 and NVL(sls.PLN_SLS_WPS,0)=0 then 0
	when NVL(wge.PLN_WGE_WPS,0)=0 then 0 when NVL(sls.PLN_SLS_WPS,0)=0 then 0
	else NVL(ROUND((wge.PLN_WGE_WPS / sls.PLN_SLS_WPS)*100,2),0) end as PLN_WGE_PCT_WPS from 
(select f.dept_nm,NVL(e.PLN_WAGE_WPS,0) as PLN_WGE_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) wge,
(select f.dept_nm,NVL(sum(e.PLAN_SALES_WPS),0) as PLN_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no  group by f.dply_seq , f.dept_nm order by f.dply_seq) sls
where wge.dept_nm=sls.dept_nm]]>
	</PlannedWagesPercentage>
	<PlannedWagesPercentageTotal>
	<![CDATA[select wge.loc_nm,
	case when NVL(wge.PLN_WGE_TOT_WPS,0)=0 and NVL(sls.PLN_SLS_TOT_WPS,0)=0 then 0
	when NVL(wge.PLN_WGE_TOT_WPS,0)=0 then 0 when NVL(sls.PLN_SLS_TOT_WPS,0)=0 then 0
	else NVL(ROUND((wge.PLN_WGE_TOT_WPS / sls.PLN_SLS_TOT_WPS)*100,2),0) end as PLN_WGE_PCT_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.PLN_WAGE_WPS),0),0) as PLN_WGE_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm) wge,
(select f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES_WPS),0),0) as PLN_SLS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on e.loc_nm=f.loc_nm group by f.loc_nm) sls
where wge.loc_nm=sls.loc_nm]]>
	</PlannedWagesPercentageTotal>
</TCName>

<TCName name = "LYWagesPercentage_CurrentMonth">
	<LYWagesPercentage>
	<![CDATA[select actl_wge_ly.dept_nm,
	CASE When actl_wge_ly.ACTL_WGE_LY_WPS=0 and actl_sls_ly.ACTL_SLS_LY_WPS=0 Then 0 
	When actl_wge_ly.ACTL_WGE_LY_WPS=0 Then 0 When actl_sls_ly.ACTL_SLS_LY_WPS=0 Then 0 
	ELSE ROUND((actl_wge_ly.ACTL_WGE_LY_WPS / actl_sls_ly.ACTL_SLS_LY_WPS)*100,2) END as LY_WGE_PCT_WPS from 
(select f.dept_nm,NVL(e.ACTL_WAGE_WPS,0) as ACTL_WGE_LY_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) as ACTL_HOURS_WPS
from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_wge_ly,
(select f.dept_nm,NVL(e.ACTL_SALES_WPS,0) as ACTL_SLS_LY_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_sls_ly
where actl_wge_ly.dept_nm=actl_sls_ly.dept_nm]]>
	</LYWagesPercentage>
	<LYWagesPercentageTotal>
	<![CDATA[select actl_wge_ly.loc_nm,
	CASE When actl_wge_ly.ACTL_WGE_LY_TOT_WPS=0 and actl_sls_ly.ACTL_SLS_LY_TOT_WPS=0 Then 0 
	When actl_wge_ly.ACTL_WGE_LY_TOT_WPS=0 Then 0 When actl_sls_ly.ACTL_SLS_LY_TOT_WPS=0 Then 0 
	ELSE ROUND((actl_wge_ly.ACTL_WGE_LY_TOT_WPS / actl_sls_ly.ACTL_SLS_LY_TOT_WPS)*100,2) END as LY_WGE_PCT_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.ACTL_WAGE_WPS),0),0) as ACTL_WGE_LY_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),0) as ACTL_HOURS_WPS
from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_wge_ly,
(select f.loc_nm,NVL(ROUND(sum(e.ACTL_SALES_WPS),0),0) as ACTL_SLS_LY_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_sls),0) as ACTL_SALES_WPS,ROUND(sum(a.actl_itm_cnt),0) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_sls_ly
where actl_wge_ly.loc_nm=actl_sls_ly.loc_nm]]>
	</LYWagesPercentageTotal>
</TCName>

<TCName name = "SMSHours_CurrentMonth">
	<SMSHours>
	<![CDATA[select x.dept_nm,NVL(ROUND(((ROUND(((y.SMS_HOURS_MPS*100)/25),0)*25)/100),2),0) as SMS_HRS_MPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) x
LEFT OUTER JOIN
(select C.loc_nm,C.dept_nm,ROUND((C.FIX_HRS_DEPT_TOT + C.VOL_HRS_DEPT_TOT),2) as SMS_HOURS_MPS from 
(select A.loc_no,A.loc_nm,A.dept_nm,A.dply_seq,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,dpt.dply_seq,dpt.dept_nm,a.task_no,
nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
from ww_wlp.lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d, ww_wlp.dept dpt
where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
and d.dept_no NOT IN (20) and b.fin_wk_no in ('FinWeek') and b.fin_yr in ('FinYear') and c.div_no='Division' and c.loc_no='store'
and d.dept_no=dpt.dept_no and dpt.dply_seq is NOT NULL and dpt.div_no='Division') A
group by A.loc_no,A.loc_nm,A.dply_seq,A.dept_nm order by A.loc_no,A.dply_seq) C
order by c.dply_seq) y
on x.dept_nm=y.dept_nm order by x.dply_seq]]>
	</SMSHours>
	<SMSHoursTotal>
	<![CDATA[select x.loc_nm,ROUND(sum(y.SMS_HRS_MPS),2) as SMS_HRS_TOT_MPS from 
(select loc_no,loc_nm from loc where loc_no='store') x
LEFT OUTER JOIN
(select C.loc_nm,C.dept_nm,NVL(ROUND(((ROUND((((C.FIX_HRS_DEPT_TOT + C.VOL_HRS_DEPT_TOT)*100)/25),0)*25)/100),2),0) as SMS_HRS_MPS from 
(select A.loc_no,A.loc_nm,A.dept_nm,A.dply_seq,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,dpt.dply_seq,dpt.dept_nm,a.task_no,
nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
from ww_wlp.lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d, ww_wlp.dept dpt
where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
and d.dept_no NOT IN (20) and b.fin_wk_no in ('FinWeek') and b.fin_yr in ('FinYear') and c.div_no='Division' and c.loc_no='store'
and d.dept_no=dpt.dept_no and dpt.dply_seq is NOT NULL and dpt.div_no='Division') A
group by A.loc_no,A.loc_nm,A.dply_seq,A.dept_nm order by A.loc_no,A.dply_seq) C
order by c.dply_seq) y on x.loc_nm=y.loc_nm group by x.loc_nm]]>
	</SMSHoursTotal>
</TCName>

<TCName name = "PlannedHours_CurrentMonth">
	<PlannedHours>
	<![CDATA[select f.dept_nm,NVL(e.PLN_HOURS_WPS,0) as PLN_HRS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq]]>
	</PlannedHours>
	<PlannedHoursTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.PLN_HOURS_WPS),2),0) as PLN_HRS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm]]>
	</PlannedHoursTotal>
</TCName>

<TCName name = "HoursLY_CurrentMonth">
	<HoursLY>
	<![CDATA[select pln_hrs_cy.dept_nm,
	CASE When pln_hrs_cy.PLN_HRS_CY_WPS=0 and actl_hrs_ly.ACTL_HRS_LY_WPS=0 Then 0 
	When pln_hrs_cy.PLN_HRS_CY_WPS=0 Then -100 When actl_hrs_ly.ACTL_HRS_LY_WPS=0 Then 0 
	ELSE ROUND(((pln_hrs_cy.PLN_HRS_CY_WPS / actl_hrs_ly.ACTL_HRS_LY_WPS)-1)*100,0) END as LY_HRS_WPS from  
(select f.dept_nm,NVL(e.BASE_HOURS_MPS,0) as PLN_HRS_CY_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select d.dply_seq,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_MPS from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,dpt.dply_seq,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c, dept dpt
where a.loc_no=c.loc_no and c.div_no='Division' and a.loc_no='store' and a.wk_id=b.wk_id and b.fin_wk_no in ('FinWeek') and b.fin_yr in ('FinYear')
and a.dept_no NOT IN (20)
and a.dept_no=dpt.dept_no and dpt.dply_seq is not null and dpt.div_no='Division' ) d
group by d.dply_seq order by d.dply_seq) e
on f.dply_seq=e.dply_seq order by f.dply_seq) pln_hrs_cy,
(select f.dept_nm,NVL(e.ACTL_HOURS_WPS,0) as ACTL_HRS_LY_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),2) as ACTL_HOURS_WPS
from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_hrs_ly
where pln_hrs_cy.dept_nm=actl_hrs_ly.dept_nm]]>
	</HoursLY>
	<HoursLYTotal>
	<![CDATA[select pln_hrs_cy.loc_nm,
	CASE When pln_hrs_cy.PLN_HRS_CY_TOT_WPS=0 and actl_hrs_ly.ACTL_HRS_LY_TOT_WPS=0 Then 0 
	When pln_hrs_cy.PLN_HRS_CY_TOT_WPS=0 Then -100 When actl_hrs_ly.ACTL_HRS_LY_TOT_WPS=0 Then 0 
	ELSE ROUND(((pln_hrs_cy.PLN_HRS_CY_TOT_WPS / actl_hrs_ly.ACTL_HRS_LY_TOT_WPS)-1)*100,0) END as LY_HRS_WPS from 
(select f.loc_nm,NVL(e.BASE_HOURS_TOT_MPS,0) as PLN_HRS_CY_TOT_WPS from 
(select loc_no,loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select d.loc_no,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_TOT_MPS from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,dpt.dply_seq,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c, dept dpt
where a.loc_no=c.loc_no and c.div_no='Division' and a.loc_no='store' and a.wk_id=b.wk_id and b.fin_wk_no in ('FinWeek') and b.fin_yr in ('FinYear')
and a.dept_no NOT IN (20)
and a.dept_no=dpt.dept_no and dpt.dply_seq is not null and dpt.div_no='Division' ) d
group by d.loc_no order by d.loc_no) e
on f.loc_no=e.loc_no order by f.loc_no) pln_hrs_cy,
(select f.loc_nm,NVL(ROUND(sum(e.ACTL_HOURS_WPS),2),0) as ACTL_HRS_LY_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.actl_wage_amt),0) as ACTL_WAGE_WPS,ROUND(sum(a.actl_hrs),2) as ACTL_HOURS_WPS
from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_hrs_ly
where pln_hrs_cy.loc_nm=actl_hrs_ly.loc_nm]]>
	</HoursLYTotal>
</TCName>

<TCName name = "PlannedOR_CurrentMonth">
	<plannedOR>
	<![CDATA[select sms_hrs.dept_nm,
	CASE When sms_hrs.SMS_HRS_WPS=0 and pln_hrs.PLN_HRS_WPS=0 Then 0 
	When sms_hrs.SMS_HRS_WPS=0 Then 0 When pln_hrs.PLN_HRS_WPS=0 Then 0 
	ELSE ROUND((sms_hrs.SMS_HRS_WPS / pln_hrs.PLN_HRS_WPS)*100,2) END as PLN_OR_WPS from 
(select x.dept_nm,NVL(((ROUND(((y.SMS_HOURS_WPS*100)/25),0)*25)/100),0) as SMS_HRS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) x
LEFT OUTER JOIN
(select C.loc_nm,C.dept_nm,ROUND((C.FIX_HRS_DEPT_TOT + C.VOL_HRS_DEPT_TOT),2) as SMS_HOURS_WPS from 
(select A.loc_no,A.loc_nm,A.dept_nm,A.dply_seq,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,dpt.dply_seq,dpt.dept_nm,a.task_no,
nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
from ww_wlp.lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d, ww_wlp.dept dpt
where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
and d.dept_no NOT IN (20) and b.fin_wk_no in ('FinWeek') and b.fin_yr in ('FinYear') and c.div_no='Division' and c.loc_no='store'
and d.dept_no=dpt.dept_no and dpt.dply_seq is NOT NULL and dpt.div_no='Division' ) A
group by A.loc_no,A.loc_nm,A.dply_seq,A.dept_nm order by A.loc_no,A.dply_seq) C
order by c.dply_seq) y
on x.dept_nm=y.dept_nm order by x.dply_seq) sms_hrs, 
(select f.dept_nm,NVL(ROUND(e.PLN_HOURS_WPS,0),0) as PLN_HRS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),2) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no=FinWeek and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) pln_hrs 
where sms_hrs.dept_nm=pln_hrs.dept_nm]]>
	</plannedOR>
	<plannedORTotal>
	<![CDATA[select sms_hrs.loc_nm,
	CASE When sms_hrs.SMS_HRS_TOT_WPS=0 and pln_hrs.PLN_HRS_TOT_WPS=0 Then 0 
	When sms_hrs.SMS_HRS_TOT_WPS=0 Then 0 When pln_hrs.PLN_HRS_TOT_WPS=0 Then 0 
	ELSE ROUND((sms_hrs.SMS_HRS_TOT_WPS / pln_hrs.PLN_HRS_TOT_WPS)*100,2) END as PLN_OR_TOT_WPS from 
(select x.loc_nm,NVL(y.SMS_HOURS_TOT_WPS,0) as SMS_HRS_TOT_WPS from 
(select loc_no,loc_nm from loc where loc_no='store') x
LEFT OUTER JOIN
(select z.loc_no,sum(SMS_HOURS_WPS) as SMS_HOURS_TOT_WPS from 
(select C.loc_no,C.dept_nm,NVL(((ROUND((((C.FIX_HRS_DEPT_TOT + C.VOL_HRS_DEPT_TOT)*100)/25),0)*25)/100),0) as SMS_HOURS_WPS from 
(select A.loc_no,A.loc_nm,A.dept_nm,A.dply_seq,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,dpt.dply_seq,dpt.dept_nm,a.task_no,
nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
from ww_wlp.lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d, ww_wlp.dept dpt
where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
and d.dept_no NOT IN (20) and b.fin_wk_no in ('FinWeek') and b.fin_yr in ('FinYear') and c.div_no='Division' and c.loc_no='store'
and d.dept_no=dpt.dept_no and dpt.dply_seq is NOT NULL and dpt.div_no='Division') A
group by A.loc_no,A.loc_nm,A.dply_seq,A.dept_nm order by A.loc_no,A.dply_seq) C
order by c.dply_seq) z
group by z.loc_no order by z.loc_no) y
on x.loc_no=y.loc_no order by x.loc_no) sms_hrs, 
(select f.loc_nm,NVL(ROUND(sum(e.PLN_HOURS_WPS),0),0) as PLN_HRS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm) pln_hrs 
where sms_hrs.loc_nm=pln_hrs.loc_nm]]>
	</plannedORTotal>
</TCName>

<TCName name = "PlannedCPH_CurrentMonth">
	<PlannedCPH>
	<![CDATA[select pln_wge.dept_nm,
	CASE When pln_wge.PLN_WGE_WPS=0 and pln_hrs.PLN_HRS_WPS=0 Then 0 
	When pln_wge.PLN_WGE_WPS=0 Then 0 When pln_hrs.PLN_HRS_WPS=0 Then 0 
	ELSE ROUND((pln_wge.PLN_WGE_WPS / pln_hrs.PLN_HRS_WPS),2) END as PLN_CPH_WPS from 
(select f.dept_nm,NVL(ROUND(e.PLN_WAGE_WPS,0),0) as PLN_WGE_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) pln_wge, 
(select f.dept_nm,NVL(ROUND(e.PLN_HOURS_WPS,0),0) as PLN_HRS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),2) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) pln_hrs 
where pln_wge.dept_nm=pln_hrs.dept_nm]]>
	</PlannedCPH>
	<PlannedCPHTotal>
	<![CDATA[select pln_wge.loc_nm,
	CASE When pln_wge.PLN_WGE_TOT_WPS=0 and pln_hrs.PLN_HRS_TOT_WPS=0 Then 0 
	When pln_wge.PLN_WGE_TOT_WPS=0 Then 0 When pln_hrs.PLN_HRS_TOT_WPS=0 Then 0 
	ELSE ROUND((pln_wge.PLN_WGE_TOT_WPS / pln_hrs.PLN_HRS_TOT_WPS),2) END as PLN_CPH_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.PLN_WAGE_WPS),0),0) as PLN_WGE_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm) pln_wge, 
(select f.loc_nm,NVL(ROUND(sum(e.PLN_HOURS_WPS),2),0) as PLN_HRS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm) pln_hrs 
where pln_wge.loc_nm=pln_hrs.loc_nm]]>
	</PlannedCPHTotal>
</TCName>

<TCName name = "GrowthLYCPH_CurrentMonth">
	<GrowthLYCPH>
	<![CDATA[select pln_cph_cy.dept_nm,
	CASE When pln_cph_cy.PLN_CPH_CY_WPS=0 and actl_cph_ly.ACTL_CPH_LY_WPS=0 Then 0 
	When pln_cph_cy.PLN_CPH_CY_WPS=0 Then -100 When actl_cph_ly.ACTL_CPH_LY_WPS=0 Then 0 
	ELSE ROUND(((pln_cph_cy.PLN_CPH_CY_WPS / actl_cph_ly.ACTL_CPH_LY_WPS)-1)*100,2) END as GROWTH_LY_CPH_WPS from 
(select pln_wge.dept_nm,
CASE When pln_wge.PLN_WGE_WPS=0 and pln_hrs.PLN_HRS_WPS=0 Then 0 
When pln_wge.PLN_WGE_WPS=0 Then 0 When pln_hrs.PLN_HRS_WPS=0 Then 0 
ELSE NVL(ROUND((pln_wge.PLN_WGE_WPS / pln_hrs.PLN_HRS_WPS),2),0) END as PLN_CPH_CY_WPS from 
(select f.dept_nm,NVL(e.PLN_WAGE_WPS,0) as PLN_WGE_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) pln_wge, 
(select f.dept_nm,NVL(e.PLN_HOURS_WPS,0) as PLN_HRS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) pln_hrs 
where pln_wge.dept_nm=pln_hrs.dept_nm) pln_cph_cy,
(select f.dept_nm,
CASE When e.ACTL_WAGE_WPS=0 and e.ACTL_HOURS_WPS=0 Then 0 
When e.ACTL_WAGE_WPS=0 Then 0 When e.ACTL_HOURS_WPS=0 Then 0 
ELSE NVL(ROUND((e.ACTL_WAGE_WPS / e.ACTL_HOURS_WPS),2),0) END as ACTL_CPH_LY_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
sum(a.actl_wage_amt) as ACTL_WAGE_WPS,sum(a.actl_hrs) as ACTL_HOURS_WPS
from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_cph_ly
where pln_cph_cy.dept_nm=actl_cph_ly.dept_nm]]>
	</GrowthLYCPH>
	<GrowthLYCPHTotal>
	<![CDATA[select pln_cph_cy.loc_nm,
	CASE When pln_cph_cy.PLN_CPH_CY_TOT_WPS=0 and actl_cph_ly.ACTL_CPH_LY_TOT_WPS=0 Then 0 
	When pln_cph_cy.PLN_CPH_CY_TOT_WPS=0 Then -100 When actl_cph_ly.ACTL_CPH_LY_TOT_WPS=0 Then 0 
	ELSE ROUND(((pln_cph_cy.PLN_CPH_CY_TOT_WPS / actl_cph_ly.ACTL_CPH_LY_TOT_WPS)-1)*100,2) END as GROWTH_LY_CPH_WPS from 
(select pln_wge.loc_nm,
CASE When pln_wge.PLN_WGE_TOT_WPS=0 and pln_hrs.PLN_HRS_TOT_WPS=0 Then 0 
When pln_wge.PLN_WGE_TOT_WPS=0 Then 0 When pln_hrs.PLN_HRS_TOT_WPS=0 Then 0 
ELSE NVL(ROUND((pln_wge.PLN_WGE_TOT_WPS / pln_hrs.PLN_HRS_TOT_WPS),2),0) END as PLN_CPH_CY_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.PLN_WAGE_WPS),0),0) as PLN_WGE_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm) pln_wge, 
(select f.loc_nm,NVL(ROUND(sum(e.PLN_HOURS_WPS),2),0) as PLN_HRS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm) pln_hrs 
where pln_wge.loc_nm=pln_hrs.loc_nm) pln_cph_cy,
(select f.loc_nm,
CASE When e.ACTL_WAGE_WPS=0 and e.ACTL_HOURS_WPS=0 Then 0 
When e.ACTL_WAGE_WPS=0 Then 0 When e.ACTL_HOURS_WPS=0 Then 0 
ELSE NVL(ROUND((e.ACTL_WAGE_WPS / e.ACTL_HOURS_WPS),2),0) END as ACTL_CPH_LY_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select src.loc_nm,sum(src.ACTL_WAGE_WPS) as ACTL_WAGE_WPS, sum(src.ACTL_HOURS_WPS) as ACTL_HOURS_WPS from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
sum(a.actl_wage_amt) as ACTL_WAGE_WPS,sum(a.actl_hrs) as ACTL_HOURS_WPS
from ww_wlp.ACTL_WKY_WAGE a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) src 
group by src.loc_nm) e
on f.loc_nm=e.loc_nm order by f.loc_nm) actl_cph_ly
where pln_cph_cy.loc_nm=actl_cph_ly.loc_nm]]>
	</GrowthLYCPHTotal>
</TCName>

<TCName name = "PlannedItems_CurrentMonth" >
	<PlannedItems>
	<![CDATA[select f.dept_nm,NVL(sum(e.PLAN_ITEM_WPS),0) as PLN_ITM_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_itm_cnt),0) as PLAN_ITEM_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_itm),0) as GEN_ITEM_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_itm_cnt),0) as PLAN_ITEM_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no group by f.dply_seq , f.dept_nm order by f.dply_seq]]>
	</PlannedItems>
	<PlannedItemsTotal>
	<![CDATA[select f.loc_nm,NVL(ROUND(sum(e.PLAN_ITEM_WPS),0),0) as PLN_ITM_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_itm_cnt),0) as PLAN_ITEM_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_itm),0) as GEN_ITEM_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte, ROUND(sum(a.mgr_pln_itm_cnt),0) as PLAN_ITEM_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on e.loc_nm=f.loc_nm group by f.loc_nm
]]>
	</PlannedItemsTotal>
</TCName>

<TCName name = "PlannedItemPrice_CurrentMonth" >
	<PlannedItemPrice>
	<![CDATA[select pln_sls_itm.dept_nm,
	case when NVL(pln_sls_itm.PLN_SLS_WPS,0)=0 and NVL(pln_sls_itm.PLN_ITM_WPS,0)=0 then 0
	when NVL(pln_sls_itm.PLN_SLS_WPS,0)=0 then 0 when NVL(pln_sls_itm.PLN_ITM_WPS,0)=0 then 0
	else NVL(ROUND((pln_sls_itm.PLN_SLS_WPS / pln_sls_itm.PLN_ITM_WPS),2),0) end as PLN_ITM_PRZ_WPS from 
(select f.dept_nm,NVL(sum(e.PLAN_SALES_WPS),0) as PLN_SLS_WPS,NVL(sum(e.PLAN_ITEM_WPS),0) as PLN_ITM_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS,ROUND(sum(a.mgr_pln_itm_cnt),0) as PLAN_ITEM_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS,ROUND(sum(a.gnrt_itm),0) as GEN_ITEM_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,
ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS,ROUND(sum(a.mgr_pln_itm_cnt),0) as PLAN_ITEM_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no group by f.dply_seq , f.dept_nm order by f.dply_seq) pln_sls_itm]]>
	</PlannedItemPrice>
	<PlannedItemPriceTotal>
	<![CDATA[select pln_sls_itm.loc_nm,
	case when NVL(pln_sls_itm.PLN_SLS_TOT_WPS,0)=0 and NVL(pln_sls_itm.PLN_ITM_TOT_WPS,0)=0 then 0
	when NVL(pln_sls_itm.PLN_SLS_TOT_WPS,0)=0 then 0 when NVL(pln_sls_itm.PLN_ITM_TOT_WPS,0)=0 then 0
	else NVL(ROUND((pln_sls_itm.PLN_SLS_TOT_WPS / pln_sls_itm.PLN_ITM_TOT_WPS),2),0) end as PLN_ITM_PRZ_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES_WPS),0),0) as PLN_SLS_TOT_WPS,NVL(ROUND(sum(e.PLAN_ITEM_WPS),0),0) as PLN_ITM_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS,ROUND(sum(a.mgr_pln_itm_cnt),0) as PLAN_ITEM_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,
ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS,ROUND(sum(a.gnrt_itm),0) as GEN_ITEM_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,
ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS,ROUND(sum(a.mgr_pln_itm_cnt),0) as PLAN_ITEM_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on e.loc_nm=f.loc_nm group by f.loc_nm) pln_sls_itm]]>
	</PlannedItemPriceTotal>
</TCName>

<TCName name = "PlannedIPLHitems_CurrentMonth" >
	<PlannedIPLHitems>
	<![CDATA[select pln_itm.dept_nm,
	CASE When pln_itm.PLN_ITM_WPS=0 and pln_hrs.PLN_HRS_WPS=0 Then 0 
	When pln_itm.PLN_ITM_WPS=0 Then 0 When pln_hrs.PLN_HRS_WPS=0 Then 0 
	ELSE ROUND((pln_itm.PLN_ITM_WPS / pln_hrs.PLN_HRS_WPS),0) END as PLN_IPLH_ITM_WPS from 
(select f.dept_nm,NVL(sum(e.PLAN_ITEM_WPS),0) as PLN_ITM_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_itm_cnt),0) as PLAN_ITEM_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_itm),0) as GEN_ITEM_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_itm_cnt),0) as PLAN_ITEM_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no group by f.dply_seq , f.dept_nm order by f.dply_seq) pln_itm,
(select f.dept_nm,NVL(e.PLN_HOURS_WPS,0) as PLN_HRS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) pln_hrs
where pln_itm.dept_nm=pln_hrs.dept_nm ]]>
	</PlannedIPLHitems>
	<PlannedIPLHitemsTotal>
	<![CDATA[select pln_itm.loc_nm,
	CASE When pln_itm.PLN_ITM_TOT_WPS=0 and pln_hrs.PLN_HRS_TOT_WPS=0 Then 0 
	When pln_itm.PLN_ITM_TOT_WPS=0 Then 0 When pln_hrs.PLN_HRS_TOT_WPS=0 Then 0 
	ELSE ROUND((pln_itm.PLN_ITM_TOT_WPS / pln_hrs.PLN_HRS_TOT_WPS),0) END as PLN_IPLH_ITM_TOT_WPS from 
(select f.loc_nm,NVL(ROUND(sum(e.PLAN_ITEM_WPS),0),0) as PLN_ITM_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_itm_cnt),0) as PLAN_ITEM_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_itm),0) as GEN_ITEM_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_itm_cnt),0) as PLAN_ITEM_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on e.loc_nm=f.loc_nm group by f.loc_nm) pln_itm,
(select f.loc_nm,NVL(ROUND(sum(e.PLN_HOURS_WPS),0),0) as PLN_HRS_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on e.loc_nm=f.loc_nm group by f.loc_nm) pln_hrs
where pln_itm.loc_nm=pln_hrs.loc_nm]]>
	</PlannedIPLHitemsTotal>
</TCName>

<TCName name = "PlannedPercentOnLY_CurrentMonth" >
	<PlannedpercentonLY>
	<![CDATA[select pln_itm_prz_cy.dept_nm,
	CASE When pln_itm_prz_cy.PLN_ITM_PRZ_CY_WPS=0 and actl_itm_prz_ly.ACTL_ITM_PRZ_LY_WPS=0 Then 0 
	When pln_itm_prz_cy.PLN_ITM_PRZ_CY_WPS=0 Then -100 When actl_itm_prz_ly.ACTL_ITM_PRZ_LY_WPS=0 Then 0 
	ELSE NVl(ROUND(((pln_itm_prz_cy.PLN_ITM_PRZ_CY_WPS / actl_itm_prz_ly.ACTL_ITM_PRZ_LY_WPS)-1)*100,2),0) END as PLN_PRCNT_LY_ITM_PRZ_WPS from 
(select pln_sls_itm.dept_nm,
CASE When pln_sls_itm.PLN_SLS_WPS=0 and pln_sls_itm.PLN_ITM_WPS=0 Then 0 
When pln_sls_itm.PLN_SLS_WPS=0 Then 0 When pln_sls_itm.PLN_ITM_WPS=0 Then 0 
ELSE NVL((pln_sls_itm.PLN_SLS_WPS / pln_sls_itm.PLN_ITM_WPS),0) END as PLN_ITM_PRZ_CY_WPS from 
(select f.dept_nm,NVL(sum(e.PLAN_SALES_WPS),0) as PLN_SLS_WPS,NVL(sum(e.PLAN_ITEM_WPS),0) as PLN_ITM_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
sum(a.mgr_pln_sls) as PLAN_SALES_WPS,sum(a.mgr_pln_itm_cnt) as PLAN_ITEM_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,
sum(a.gnrt_sls) as GEN_SALES_WPS,sum(a.gnrt_itm) as GEN_ITEM_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,
sum(a.mgr_pln_sls) as PLAN_SALES_WPS,sum(a.mgr_pln_itm_cnt) as PLAN_ITEM_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no group by f.dply_seq , f.dept_nm order by f.dply_seq) pln_sls_itm) pln_itm_prz_cy,
(select actl_sls_itm.dept_nm,
CASE When actl_sls_itm.actl_sls_wps=0 and actl_sls_itm.actl_itm_wps=0 Then 0 
When actl_sls_itm.actl_sls_wps=0 Then 0 When actl_sls_itm.actl_itm_wps=0 Then 0 
ELSE NVL((actl_sls_itm.actl_sls_wps / actl_sls_itm.actl_itm_wps),0) END as ACTL_ITM_PRZ_LY_WPS from 
(select f.dept_nm,NVL(e.ACTL_SALES_WPS,0) as ACTL_SLS_WPS,NVL(e.ACTL_ITEM_WPS,0) as ACTL_ITM_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
sum(a.actl_sls) as ACTL_SALES_WPS,sum(a.actl_itm_cnt) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) actl_sls_itm) actl_itm_prz_ly
where pln_itm_prz_cy.dept_nm=actl_itm_prz_ly.dept_nm]]>
	</PlannedpercentonLY>
	<PlannedpercentonLYTotal>
	<![CDATA[select pln_itm_prz_cy.loc_nm,
	CASE When pln_itm_prz_cy.PLN_ITM_PRZ_CY_TOT_WPS=0 and actl_itm_prz_ly.ACTL_ITM_PRZ_LY_TOT_WPS=0 Then 0 
	When pln_itm_prz_cy.PLN_ITM_PRZ_CY_TOT_WPS=0 Then -100 When actl_itm_prz_ly.ACTL_ITM_PRZ_LY_TOT_WPS=0 Then 0 
	ELSE ROUND(((pln_itm_prz_cy.PLN_ITM_PRZ_CY_TOT_WPS / actl_itm_prz_ly.ACTL_ITM_PRZ_LY_TOT_WPS)-1)*100,2) END as PLN_PRCNT_LY_ITM_PRZ_TOT_WPS from 
(select pln_sls_itm.loc_nm,
CASE When pln_sls_itm.PLN_SLS_TOT_WPS=0 and pln_sls_itm.PLN_ITM_TOT_WPS=0 Then 0 
When pln_sls_itm.PLN_SLS_TOT_WPS=0 Then 0 When pln_sls_itm.PLN_ITM_TOT_WPS=0 Then 0 
ELSE NVL((pln_sls_itm.PLN_SLS_TOT_WPS / pln_sls_itm.PLN_ITM_TOT_WPS),0) END as PLN_ITM_PRZ_CY_TOT_WPS from 
(select f.loc_nm,NVL(sum(e.PLAN_SALES_WPS),0) as PLN_SLS_TOT_WPS,NVL(sum(e.PLAN_ITEM_WPS),0) as PLN_ITM_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
sum(a.mgr_pln_sls) as PLAN_SALES_WPS,sum(a.mgr_pln_itm_cnt) as PLAN_ITEM_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,
sum(a.gnrt_sls) as GEN_SALES_WPS,sum(a.gnrt_itm) as GEN_ITEM_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from

(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,
sum(a.mgr_pln_sls) as PLAN_SALES_WPS,sum(a.mgr_pln_itm_cnt) as PLAN_ITEM_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on e.loc_nm=f.loc_nm group by f.loc_nm) pln_sls_itm) pln_itm_prz_cy,
(select actl_sls_itm.loc_nm,
CASE When actl_sls_itm.actl_sls_tot_wps=0 and actl_sls_itm.actl_itm_tot_wps=0 Then 0 
When actl_sls_itm.actl_sls_tot_wps=0 Then 0 When actl_sls_itm.actl_itm_tot_wps=0 Then 0 
ELSE NVL((actl_sls_itm.actl_sls_tot_wps / actl_sls_itm.actl_itm_tot_wps),0) END as ACTL_ITM_PRZ_LY_TOT_WPS from 
(select f.loc_nm,NVL(sum(e.ACTL_SALES_WPS),0) as ACTL_SLS_TOT_WPS,NVL(sum(e.ACTL_ITEM_WPS),0) as ACTL_ITM_TOT_WPS from 
(select loc_nm from loc where loc_no='store') f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
sum(a.actl_sls) as ACTL_SALES_WPS,sum(a.actl_itm_cnt) as ACTL_ITEM_WPS
from ww_wlp.DLY_SLS a,wk b,loc c,dept d
where a.txn_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='LYFinYr'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.loc_nm=e.loc_nm group by f.loc_nm order by f.loc_nm) actl_sls_itm) actl_itm_prz_ly
where pln_itm_prz_cy.loc_nm=actl_itm_prz_ly.loc_nm]]>
	</PlannedpercentonLYTotal>
</TCName>

<TCName name = "BGDT_FCST_OR_CurrentMonth" >
		<BudgetOR>
	<![CDATA[select src.dept_nm,
case when (select datavalue from ADT_TRL_TOGGLE_BDGT_HOUR_OR where updtime in (select max(updtime) from ADT_TRL_TOGGLE_BDGT_HOUR_OR)) 
in ('Hide Budget Hour and OR%','Show Budget Hour Hide Budget OR%') then 0
else src.BDGT_OR_WPS end as BDGT_OR_WPS from 
(select f.dply_seq,f.dept_nm,
case when NVL(e.BDGT_SMS_WPS,0)=0 and NVL(e.BDGT_HRS_WPS,0)=0 then 0 
when NVL(e.BDGT_SMS_WPS,0)=0 then 0 when NVL(e.BDGT_HRS_WPS,0)=0 then 0 
else NVL(ROUND((e.BDGT_SMS_WPS / e.BDGT_HRS_WPS) * 100,2),0) end as BDGT_OR_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
NVL(sum(a.bdgt_sms_hrs),0) as BDGT_SMS_WPS,NVL(sum(a.bdgt_hrs),0) as BDGT_HRS_WPS
from ww_wlp.wky_bdgt a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) src
order by src.dply_seq]]>
	</BudgetOR>
	
	<BudgetORTotal>
	<![CDATA[select src.loc_nm,
case when (select datavalue from ADT_TRL_TOGGLE_BDGT_HOUR_OR where updtime in (select max(updtime) from ADT_TRL_TOGGLE_BDGT_HOUR_OR)) 
in ('Hide Budget Hour and OR%','Show Budget Hour Hide Budget OR%') then 0
else src.BDGT_OR_TOT_WPS end as BDGT_OR_TOT_WPS from 
(select f.loc_nm,
	case when NVL(sum(e.BDGT_SMS_WPS),0)=0 and NVL(sum(e.BDGT_HRS_WPS),0)=0 then 0 
	when NVL(sum(e.BDGT_SMS_WPS),0)=0 then 0 when NVL(sum(e.BDGT_HRS_WPS),0)=0 then 0 
	else NVL(ROUND((sum(e.BDGT_SMS_WPS) / sum(e.BDGT_HRS_WPS)) * 100,2),0) end as BDGT_OR_TOT_WPS from 
	(select loc_nm from loc where loc_no='store') f
	LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	NVL(sum(a.bdgt_sms_hrs),0) as BDGT_SMS_WPS,NVL(sum(a.bdgt_hrs),0) as BDGT_HRS_WPS
	from ww_wlp.wky_bdgt a,wk b,loc c,dept d
	where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
	and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
	order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on e.loc_nm=f.loc_nm group by f.loc_nm) src
	order by src.loc_nm]]>
	</BudgetORTotal>
	
	<ForecastOR>
	<![CDATA[select f.dept_nm,NVL((ROUND(e.or_prcnt,2)),0) as FCST_OR_WPS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select dept_no,or_prcnt from mnth_fcst where div_no='Division' and loc_no='store '
and wk_id in (select wk_id from wk where fin_wk_no='FinWeek' and fin_yr='FinYear') and dept_no NOT IN (20)
order by dept_no) e
on f.dept_no=e.dept_no order by f.dply_seq]]>
	</ForecastOR>
	<ForecastORTotal>
	<![CDATA[select sms_hrs.loc_nm,
	CASE When sms_hrs.SMS_HRS_TOT_WPS=0 and pln_hrs.PLN_HRS_TOT_WPS=0 Then 0 
	When sms_hrs.SMS_HRS_TOT_WPS=0 Then 0 When pln_hrs.PLN_HRS_TOT_WPS=0 Then 0 
	ELSE ROUND((sms_hrs.SMS_HRS_TOT_WPS / pln_hrs.PLN_HRS_TOT_WPS)*100,0) END as FCST_OR_TOT_WPS from 
	(select x.loc_nm,NVL(((ROUND((((y.SMS_HOURS_TOT_WPS)*100)/25),9)*25)/100),0) as SMS_HRS_TOT_WPS from 
	(select loc_no,loc_nm from loc where loc_no='store') x
	LEFT OUTER JOIN
	(select z.loc_no,sum(SMS_HOURS_WPS) as SMS_HOURS_TOT_WPS from 
	(select C.loc_no,C.dept_nm,(C.FIX_HRS_DEPT_TOT + C.VOL_HRS_DEPT_TOT) as SMS_HOURS_WPS from 
	(select A.loc_no,A.loc_nm,A.dept_nm,A.dply_seq,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,dpt.dply_seq,dpt.dept_nm,a.task_no,
	nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
	from ww_wlp.lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d, ww_wlp.dept dpt
	where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
	and d.dept_no NOT IN (20) and b.fin_wk_no in ('FinWeek') and b.fin_yr in ('FinYear') and c.div_no='Division' and c.loc_no='store'
	and d.dept_no=dpt.dept_no and dpt.dply_seq is NOT NULL and dpt.div_no='Division') A
	group by A.loc_no,A.loc_nm,A.dply_seq,A.dept_nm order by A.loc_no,A.dply_seq) C
	order by c.dply_seq) z
	group by z.loc_no order by z.loc_no) y
	on x.loc_no=y.loc_no order by x.loc_no) sms_hrs, 
	(select f.loc_nm,NVL(ROUND(sum(e.PLN_HOURS_WPS),9),0) as PLN_HRS_TOT_WPS from 
	(select loc_nm from loc where loc_no='store') f
	LEFT OUTER JOIN
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
	ROUND((sum(nvl(a.PLAN_PAID_HOURS,0))),9) as PLN_HOURS_WPS
	from ww_wlp.mnth_fcst a,wk b,loc c,dept d
	where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='FinYear'
	and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
	and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
	order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
	on e.loc_nm=f.loc_nm group by f.loc_nm) pln_hrs 
	where sms_hrs.loc_nm=pln_hrs.loc_nm]]>
	</ForecastORTotal>
</TCName>


<TCName name="MonthlyViewMetricsValidation">  
<Sales>
<![CDATA[select f.wk_id,NVL(e.PLAN_SALES,0) as PLN_SLS_MNTH_STR from (select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
		LEFT OUTER JOIN (select * from (select a.loc_no,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES from ww_wlp.mgr_wky_pln a,wk b 
		where a.div_no='Division' and a.loc_no='store' and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id group by a.loc_no,b.perd_desc,
		a.wk_id order by a.loc_no,b.perd_desc,a.wk_id) c UNION select * from (select loc_no,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES from ww_wlp.fcst a,wk b
		where div_no='Division' and loc_no='store' and dept_no NOT IN (0,20,90) and fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and wk_id NOT IN
		(select wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no='store' and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
		group by loc_no,b.perd_desc,b.wk_id order by loc_no,b.perd_desc,b.wk_id) d) e on f.perd_desc=e.perd_desc and f.wk_id=e.wk_id order by f.wk_id]]>
</Sales>
<SalesTotal>
<![CDATA[select g.loc_nm,ROUND(sum(g.PLN_SLS_MNTH_STR),0) as PLN_SLS_MNTH_STR_TOT from (select f.loc_nm,NVL(e.PLAN_SALES,0) as PLN_SLS_MNTH_STR from 
	(select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN (select * from (select a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) 
	as PLAN_SALES from ww_wlp.mgr_wky_pln a,wk b,loc lc where a.div_no='Division' and a.loc_no='store' and a.wk_id in (select wk_id from ww_wlp.wk where 
	perd_desc='Month') and a.wk_id=b.wk_id group by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id) c UNION
	select * from (select a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES from ww_wlp.fcst a,wk b,loc lc
	where a.div_no='Division' and a.loc_no='store' and a.dept_no NOT IN (0,20,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month'
	and b.wk_id NOT IN (select wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no='store' and wk_id in (select wk_id from ww_wlp.wk where perd_desc=
	'Month')) and a.loc_no=lc.loc_no group by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id) d) e
	on f.loc_nm=e.loc_nm order by f.loc_nm) g group by g.loc_nm]]>
</SalesTotal>

<Wages>
<![CDATA[select f.wk_id,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPS from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f
	LEFT OUTER JOIN (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and 
	b.perd_desc in ('Month')) d group by d.wk_id order by d.wk_id) UNION select * from (select d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as 
	BASE_COST_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')
	and DEPT_NO NOT IN (20)) d where d.wk_id NOT IN (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.wk_id order by d.wk_id)) e on e.wk_id=f.wk_id order by f.wk_id]]>
</Wages>
<WagesTotal>
<![CDATA[select g.loc_nm,NVL(sum(g.PLN_WAGE_MPS),0) as PLN_WAGE_TOT_MPS from (select f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPS from 
	(select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN (select * from (select d.loc_nm,d.perd_desc,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as 
	PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, 
	ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.loc_nm,d.perd_desc,
	d.wk_id order by d.loc_nm,d.perd_desc,d.wk_id) UNION select * from (select d.loc_nm,d.perd_desc,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + 
	sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,
	TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and 
	b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where d.wk_id NOT IN (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_nm,d.perd_desc,d.wk_id order by d.loc_nm,
	d.perd_desc,d.wk_id)) e on e.loc_nm=f.loc_nm order by f.loc_nm) g group by g.loc_nm]]>
</WagesTotal>

<WagePercentage>
<![CDATA[select j.wk_id,
	case when NVL(j.PLN_WAGE_MPS,0)=0 and NVL(n.PLN_SLS_MPS,0)=0 then 0 
	when NVL(j.PLN_WAGE_MPS,0)=0 then 0 when NVL(n.PLN_SLS_MPS,0)=0 then 0 
	else ROUND((j.PLN_WAGE_MPS / n.PLN_SLS_MPS)*100,2) end as PLN_WAGE_PRCNT_MPS from (select f.wk_id,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPS from
 		(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f LEFT OUTER JOIN (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as 
 		PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, 
 		ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.wk_id order by d.wk_id) UNION
		select * from (select d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,
		a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
		where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where d.wk_id NOT IN (select a.wk_id 
		from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
		group by d.wk_id order by d.wk_id)) e on e.wk_id=f.wk_id order by f.wk_id) j INNER JOIN (select f.perd_desc,f.wk_id,NVL(e.PLAN_SALES,0) as PLN_SLS_MPS from 
		(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f LEFT OUTER JOIN (select * from (select a.loc_no,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) 
		as PLAN_SALES from ww_wlp.mgr_wky_pln a,wk b where a.div_no='Division' and a.loc_no='store' and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=
		b.wk_id group by a.loc_no,b.perd_desc,a.wk_id order by a.loc_no,b.perd_desc,a.wk_id) c UNION select * from (select loc_no,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0)
		as GEN_SALES from ww_wlp.fcst a,wk b where div_no='Division' and loc_no='store' and dept_no NOT IN (0,20,90) and fcst_dte between b.wk_strt and b.wk_end and b.perd_desc=
		'Month' and wk_id NOT IN (select wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no='store' and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
		group by loc_no,b.perd_desc,b.wk_id order by loc_no,b.perd_desc,b.wk_id) d) e on f.perd_desc=e.perd_desc and f.wk_id=e.wk_id order by f.wk_id) n
		on j.wk_id=n.wk_id order by j.wk_id]]>
</WagePercentage>
<WagePercentageTotal>
<![CDATA[select j.loc_nm,
	case when NVL(j.PLN_WAGE_TOT_MPS,0)=0 and NVL(n.PLN_SLS_TOT_MPS,0)=0 then 0 
	when NVL(j.PLN_WAGE_TOT_MPS,0)=0 then 0 when NVL(n.PLN_SLS_TOT_MPS,0)=0 then 0 
	else ROUND((j.PLN_WAGE_TOT_MPS / n.PLN_SLS_TOT_MPS)*100,2) end as PLN_WAGE_PRCNT_TOT_MPS from (select g.loc_nm,NVL(sum(g.PLN_WAGE_MPS),0) 
	as PLN_WAGE_TOT_MPS from (select f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPS from (select loc_nm from loc where loc_no='store') f
	LEFT OUTER JOIN (select * from (select d.loc_nm,d.perd_desc,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.loc_nm,d.perd_desc,d.wk_id order by d.loc_nm,d.perd_desc,d.wk_id)
	UNION select * from (select d.loc_nm,d.perd_desc,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, 
	ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where 
	d.wk_id NOT IN (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
	group by d.loc_nm,d.perd_desc,d.wk_id order by d.loc_nm,d.perd_desc,d.wk_id)) e on e.loc_nm=f.loc_nm order by f.loc_nm) g group by g.loc_nm) j
	INNER JOIN (select g.loc_nm,ROUND(sum(g.PLN_SLS_MNTH_STR),0) as PLN_SLS_TOT_MPS from (select f.loc_nm,NVL(e.PLAN_SALES,0) as PLN_SLS_MNTH_STR from 
	(select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN (select * from (select a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) 
	as PLAN_SALES from ww_wlp.mgr_wky_pln a,wk b,loc lc where a.div_no='Division' and a.loc_no='store' and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id
	group by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,a.wk_id) c UNION select * from 
	(select a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES from ww_wlp.fcst a,wk b,loc lc
	where a.div_no='Division' and a.loc_no='store' and a.dept_no NOT IN (0,20,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month'
	and b.wk_id NOT IN (select wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no='store' and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
	and a.loc_no=lc.loc_no group by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,lc.loc_nm,b.perd_desc,b.wk_id) d) e
	on f.loc_nm=e.loc_nm order by f.loc_nm) g group by g.loc_nm) n on j.loc_nm=n.loc_nm]]>
</WagePercentageTotal>

<CPHValue>
<![CDATA[select x.wk_id,
	case when NVL(x.PLN_WAGE_MPS,0)=0 and NVL(y.PLN_HRS_MPS,0)=0 then 0 
	when NVL(x.PLN_WAGE_MPS,0)=0 then 0 when NVL(y.PLN_HRS_MPS,0)=0 then 0 
	else ROUND((x.PLN_WAGE_MPS / y.PLN_HRS_MPS),2) end as PLN_CPH_MPS from (select f.wk_id,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPS from 
		(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f LEFT OUTER JOIN (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as 
		PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, 
		ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.wk_id order by 
		d.wk_id) UNION select * from (select d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from (select c.div_no,
		c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.
		loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where d.wk_id NOT IN 
		(select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in 
		('Month')) group by d.wk_id order by d.wk_id)) e on e.wk_id=f.wk_id order by f.wk_id) x,(select f.wk_id,NVL(e.PLN_HOURS_MNTH_PLN_STR,0) as PLN_HRS_MPS
		from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f LEFT OUTER JOIN (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_HRS) ,0)
		as PLN_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS from ww_wlp.mgr_wky_pln a, 
		ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.wk_id order by 
		d.wk_id) UNION select * from (select d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no
		,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
		where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where d.wk_id NOT IN (select a.
		wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
		group by d.wk_id order by d.wk_id)) e on e.wk_id=f.wk_id order by f.wk_id) y where x.wk_id=y.wk_id order by x.wk_id]]>
</CPHValue>
<CPHTotal>
<![CDATA[select x.loc_nm,
	case when NVL(x.PLN_WAGE_TOT_MPS,0)=0 and NVL(y.PLN_HRS_TOT_MPS,0)=0 then 0 
	when NVL(x.PLN_WAGE_TOT_MPS,0)=0 then 0 when NVL(y.PLN_HRS_TOT_MPS,0)=0 then 0 
	else ROUND((x.PLN_WAGE_TOT_MPS / y.PLN_HRS_TOT_MPS),2) end as PLN_CPH_TOT_MPS from (select g.loc_nm,NVL(sum(g.PLN_WAGE_MPS),0) as PLN_WAGE_TOT_MPS from 
	(select f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select * from (select d.loc_nm,d.perd_desc,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,
	a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d
	group by d.loc_nm,d.perd_desc,d.wk_id order by d.loc_nm,d.perd_desc,d.wk_id) UNION select * from (select d.loc_nm,d.perd_desc,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, 
	ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')
	and DEPT_NO NOT IN (20)) d where d.wk_id NOT IN (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and 
	c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_nm,d.perd_desc,d.wk_id order by d.loc_nm,d.perd_desc,d.wk_id)) e 
	on e.loc_nm=f.loc_nm order by f.loc_nm) g group by g.loc_nm) x,(select g.loc_nm,NVL(sum(g.PLN_HRS_MPS),0) as PLN_HRS_TOT_MPS from 
	(select f.loc_nm,NVL(e.PLN_HOURS_MNTH_PLN_STR,0) as PLN_HRS_MPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select * from (select d.loc_nm,d.wk_id,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
	from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d
	group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id) UNION select * from (select d.loc_nm,d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as 
	BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,nvl(TA_PLN_HRS,0) as TA_PLN_HRS,
	nvl(WAGE_ADJ_HRS,0) as WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id 
	and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where d.wk_id NOT IN (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id)) e 
	on e.loc_nm=f.loc_nm order by f.loc_nm) g group by g.loc_nm) y where x.loc_nm=y.loc_nm]]>
</CPHTotal>

<PlanPaidHours>
<![CDATA[select f.wk_id,NVL(e.PLN_HOURS_MNTH_PLN_STR,0) as PLN_HRS_MPS from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f
		LEFT OUTER JOIN (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,
		a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and 
		a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.wk_id order by d.wk_id) UNION select * from (select d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum
		(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,
		TA_PLN_HRS,WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.
		perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where d.wk_id NOT IN (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
		where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
		group by d.wk_id order by d.wk_id)) e on e.wk_id=f.wk_id order by f.wk_id]]>
</PlanPaidHours>
<PlanPaidHoursTotal>
<![CDATA[select g.loc_nm,NVL(sum(g.PLN_HRS_MPS),0) as PLN_HRS_TOT_MPS from (select f.loc_nm,NVL(e.PLN_HOURS_MNTH_PLN_STR,0) as PLN_HRS_MPS from 
	(select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN (select * from (select d.loc_nm,d.wk_id,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id)
	UNION select * from (select d.loc_nm,d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,nvl(TA_PLN_HRS,0) as TA_PLN_HRS,nvl(WAGE_ADJ_HRS,0) as 
	WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in 
	('Month') and DEPT_NO NOT IN (20)) d where d.wk_id NOT IN (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
	group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id)) e on e.loc_nm=f.loc_nm order by f.loc_nm) g group by g.loc_nm]]>
</PlanPaidHoursTotal>

<ORPercentage>
<![CDATA[select sms_hrs.WK_ID,
	case when sms_hrs.SMS_HRS_MPS=0 and pln_hrs.PLN_HRS_MPS=0 then 0 
	when sms_hrs.SMS_HRS_MPS=0 then 0 when pln_hrs.PLN_HRS_MPS=0 then 0 
	else ROUND((sms_hrs.SMS_HRS_MPS / pln_hrs.PLN_HRS_MPS)*100,1) end as PLN_OR_MPS from 
	(select x.wk_id,NVL(ROUND(((ROUND(((y.SMS_HOURS_MPS*100)/25),0)*25)/100),2),0) as SMS_HRS_MPS from (select wk_id from ww_wlp.wk where perd_desc='Month') x LEFT OUTER JOIN
	(select C.wk_id,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPS from (select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,sum(fix_hrs) as 
	FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,
	a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d 
	where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no and d.dept_no!=20 and b.perd_desc in ('Month') and c.div_no='Division' and c.loc_no='store') A
	group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C group by C.wk_id order by c.wk_id) y
	on x.wk_id=y.wk_id order by x.wk_id) sms_hrs,
	(select f.wk_id,NVL(ROUND(((ROUND(((e.PLN_HOURS_MNTH_PLN_STR*100)/25),0)*25)/100),2),0) as PLN_HRS_MPS from (select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f
		LEFT OUTER JOIN (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,
		a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and 
		a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.wk_id order by d.wk_id) UNION select * from (select d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum
		(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,
		TA_PLN_HRS,WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.
		perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where d.wk_id NOT IN (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
		where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
		group by d.wk_id order by d.wk_id)) e on e.wk_id=f.wk_id order by f.wk_id) pln_hrs 
	where sms_hrs.wk_id=pln_hrs.wk_id order by sms_hrs.wk_id]]>
</ORPercentage>
<ORPercentageTotal>
<![CDATA[select sms_hrs.loc_nm,
	case when sms_hrs.SMS_HRS_TOT_MPS=0 and pln_hrs.PLN_HRS_TOT_MPS=0 then 0 
	when sms_hrs.SMS_HRS_TOT_MPS=0 then 0 when pln_hrs.PLN_HRS_TOT_MPS=0 then 0 
	else ROUND((sms_hrs.SMS_HRS_TOT_MPS / pln_hrs.PLN_HRS_TOT_MPS)*100,1) end as PLN_OR_TOT_MPS from 
	(select z.loc_nm,NVL(SUM(ROUND(((ROUND(((Z.SMS_HRS_MPS*100)/25),0)*25)/100),2)),0) as SMS_HRS_TOT_MPS from (select x.loc_nm,NVL(y.SMS_HOURS_MPS,0) as SMS_HRS_MPS from 
	(select loc_nm from ww_wlp.loc where loc_no='store') x LEFT OUTER JOIN (select C.loc_nm,C.perd_desc,C.wk_id,(sum(C.FIX_HRS_DEPT_TOT) + 
	sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPS from (select A.loc_no,A.loc_nm,A.perd_desc,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as 
	VOL_HRS_DEPT_TOT from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,
	NVL(a.vol_hrs,0) as vol_hrs from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d where a.task_no=d.task_no and a.wk_id=b.wk_id and 
	a.loc_no=c.loc_no and d.dept_no!=20 and b.perd_desc in ('Month') and c.div_no='Division' and c.loc_no='store') A group by A.loc_no,A.loc_nm,A.perd_desc,A.wk_id,
	A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C group by C.loc_nm,C.perd_desc,C.wk_id order by C.loc_nm,C.perd_desc,c.wk_id) y
	on x.loc_nm=y.loc_nm order by x.loc_nm) z group by z.loc_nm) sms_hrs,
	(select g.loc_nm,NVL(SUM(ROUND(((ROUND(((g.PLN_HRS_MPS*100)/25),0)*25)/100),2)),0) as PLN_HRS_TOT_MPS from 
	(select f.loc_nm,NVL(e.PLN_HOURS_MNTH_PLN_STR,0) as PLN_HRS_MPS from (select loc_nm from loc where loc_no='store') f LEFT OUTER JOIN
	(select * from (select d.loc_nm,d.wk_id,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d
	group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id) UNION select * from (select d.loc_nm,d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as 
	BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,nvl(TA_PLN_HRS,0) as TA_PLN_HRS,
	nvl(WAGE_ADJ_HRS,0) as WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')
	and DEPT_NO NOT IN (20)) d where d.wk_id NOT IN (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no=
	'store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_nm,d.wk_id order by d.loc_nm,d.wk_id)) e on e.loc_nm=f.loc_nm order by f.loc_nm) g group by g.loc_nm) pln_hrs 
	where sms_hrs.loc_nm=pln_hrs.loc_nm]]></ORPercentageTotal>
</TCName>
/*
<TCName name = "PlannedBudgetAndForecastRate" >
	<PlannedBudgetRate>
	<![CDATA[select src.dept_nm,
case 
when src.PLN_SLS_WPS > src.BDGT_SLS_WPS 
then NVL(ROUND((src.PLN_WGE_WPS - ((((src.PST_FACTOR_WPS * src.BDGT_WGE_PCT_WPS) * (src.PLN_SLS_WPS - src.BDGT_SLS_WPS)) + src.BDGT_WGE_WPS))),0),0)
When src.PLN_SLS_WPS < src.BDGT_SLS_WPS 
then NVL(ROUND((src.PLN_WGE_WPS - ((((src.NGT_FACTOR_WPS * src.BDGT_WGE_PCT_WPS) * (src.PLN_SLS_WPS - src.BDGT_SLS_WPS)) + src.BDGT_WGE_WPS))),0),0)
else NVL(ROUND((src.PLN_WGE_WPS - src.BDGT_WGE_WPS),0),0)
end as OVERSPENT_BDGT_RATE_WPS from 

(select a.dept_nm,b.wk_id,a.PLN_WGE_WPS,b.pst_factor_wps,b.ngt_factor_wps,c.bdgt_wge_pct_wps,d.PLN_SLS_WPS,c.BDGT_WGE_WPS,C.BDGT_SLS_WPS from

(select f.dept_nm,NVL(e.PLN_WAGE_WPS,0) as PLN_WGE_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm, b.wk_id,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,b.wk_id) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) a,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_WPS,NVL(src.ngt_factor,1) as NGT_FACTOR_WPS from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99,Region) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) b,

(select wge_sls.dept_nm,NVL(ROUND(wge_sls.BDGT_WGE_WPS,0),0) as BDGT_WGE_WPS, NVL(ROUND(wge_sls.BDGT_SLS_WPS,0),0) as BDGT_SLS_WPS,
case when wge_sls.BDGT_WGE_WPS=0 and wge_sls.BDGT_SLS_WPS=0 then 0 
when wge_sls.BDGT_WGE_WPS=0 then 0 when wge_sls.BDGT_SLS_WPS=0 then 0 
else ROUND((wge_sls.BDGT_WGE_WPS / wge_sls.BDGT_SLS_WPS)*100,2) end as BDGT_WGE_PCT_WPS from 
(select f.dept_nm,NVL(e.BDGT_WAGE_WPS,0) as BDGT_WGE_WPS,NVL(e.BDGT_SALES_WPS,0) as BDGT_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
sum(a.bdgt_sls) as BDGT_SALES_WPS,sum(a.bdgt_wage_amt) as BDGT_WAGE_WPS
from ww_wlp.wky_bdgt a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) wge_sls) c,

(select f.dept_nm,NVL(sum(e.PLAN_SALES_WPS),0) as PLN_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select loc_no,dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no group by f.dept_nm order by f.dept_nm) d

where a.dept_nm=c.dept_nm and a.dept_nm=d.dept_nm and c.dept_nm=d.dept_nm) src]]>
	</PlannedBudgetRate>
	<PlannedBudgetRateTotal>
	<![CDATA[select 'Store Total' as Total, sum(OVERSPENT_BDGT_RATE_WPS) as OVERSPENT_BDGT_RATE_TOT_WPS from 
(select src.dept_nm,
case 
when src.PLN_SLS_WPS > src.BDGT_SLS_WPS 
then NVL(ROUND((src.PLN_WGE_WPS - ((((src.PST_FACTOR_WPS * src.BDGT_WGE_PCT_WPS) * (src.PLN_SLS_WPS - src.BDGT_SLS_WPS)) + src.BDGT_WGE_WPS))),0),0)
When src.PLN_SLS_WPS < src.BDGT_SLS_WPS 
then NVL(ROUND((src.PLN_WGE_WPS - ((((src.NGT_FACTOR_WPS * src.BDGT_WGE_PCT_WPS) * (src.PLN_SLS_WPS - src.BDGT_SLS_WPS)) + src.BDGT_WGE_WPS))),0),0)
else NVL(ROUND((src.PLN_WGE_WPS - src.BDGT_WGE_WPS),0),0)
end as OVERSPENT_BDGT_RATE_WPS from 

(select a.dept_nm,b.wk_id,a.PLN_WGE_WPS,b.pst_factor_wps,b.ngt_factor_wps,c.bdgt_wge_pct_wps,d.PLN_SLS_WPS,c.BDGT_WGE_WPS,C.BDGT_SLS_WPS from

(select f.dept_nm,NVL(e.PLN_WAGE_WPS,0) as PLN_WGE_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm, b.wk_id,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,b.wk_id) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) a,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_WPS,NVL(src.ngt_factor,1) as NGT_FACTOR_WPS from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99,Region) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) b,

(select wge_sls.dept_nm,NVL(ROUND(wge_sls.BDGT_WGE_WPS,0),0) as BDGT_WGE_WPS, NVL(ROUND(wge_sls.BDGT_SLS_WPS,0),0) as BDGT_SLS_WPS,
case when wge_sls.BDGT_WGE_WPS=0 and wge_sls.BDGT_SLS_WPS=0 then 0 
when wge_sls.BDGT_WGE_WPS=0 then 0 when wge_sls.BDGT_SLS_WPS=0 then 0 
else ROUND((wge_sls.BDGT_WGE_WPS / wge_sls.BDGT_SLS_WPS)*100,2) end as BDGT_WGE_PCT_WPS from 
(select f.dept_nm,NVL(e.BDGT_WAGE_WPS,0) as BDGT_WGE_WPS,NVL(e.BDGT_SALES_WPS,0) as BDGT_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
sum(a.bdgt_sls) as BDGT_SALES_WPS,sum(a.bdgt_wage_amt) as BDGT_WAGE_WPS
from ww_wlp.wky_bdgt a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) wge_sls) c,

(select f.dept_nm,NVL(sum(e.PLAN_SALES_WPS),0) as PLN_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select loc_no,dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no group by f.dept_nm order by f.dept_nm) d

where a.dept_nm=c.dept_nm and a.dept_nm=d.dept_nm and c.dept_nm=d.dept_nm) src)]]>
	</PlannedBudgetRateTotal>
	<PlannedForecsatRate>
	<![CDATA[select src.dept_nm,
case 
when src.PLN_SLS_WPS > src.FRCST_SLS_WPS 
then NVL(ROUND((src.PLN_WGE_WPS - ((((src.PST_FACTOR_WPS * src.FRCST_WGE_PCT_WPS) * (src.PLN_SLS_WPS - src.FRCST_SLS_WPS)) + src.FRCST_WGE_WPS))),0),0)
When src.PLN_SLS_WPS < src.FRCST_SLS_WPS 
then NVL(ROUND((src.PLN_WGE_WPS - ((((src.NGT_FACTOR_WPS * src.FRCST_WGE_PCT_WPS) * (src.PLN_SLS_WPS - src.FRCST_SLS_WPS)) + src.FRCST_WGE_WPS))),0),0)
else NVL(ROUND((src.PLN_WGE_WPS - src.FRCST_WGE_WPS),0),0)
end as OVERSPENT_FRCST_RATE_WPS from 

(select a.dept_nm,b.wk_id,a.PLN_WGE_WPS,b.pst_factor_wps,b.ngt_factor_wps,c.FRCST_wge_pct_wps,d.PLN_SLS_WPS,c.FRCST_WGE_WPS,C.FRCST_SLS_WPS from

(select f.dept_nm,NVL(e.PLN_WAGE_WPS,0) as PLN_WGE_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm, b.wk_id,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,b.wk_id) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) a,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_WPS,NVL(src.ngt_factor,1) as NGT_FACTOR_WPS from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99,Region) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) b,

(select wge_sls.dept_nm,NVL(ROUND(wge_sls.FRCST_WGE_WPS,0),0) as FRCST_WGE_WPS, NVL(ROUND(wge_sls.FRCST_SLS_WPS,0),0) as FRCST_SLS_WPS,
case when wge_sls.FRCST_WGE_WPS=0 and wge_sls.FRCST_SLS_WPS=0 then 0 
when wge_sls.FRCST_WGE_WPS=0 then 0 when wge_sls.FRCST_SLS_WPS=0 then 0 
else ROUND((wge_sls.FRCST_WGE_WPS / wge_sls.FRCST_SLS_WPS)*100,2) end as FRCST_WGE_PCT_WPS from 
(select f.dept_nm,NVL(e.FRCST_WAGE_WPS,0) as FRCST_WGE_WPS,NVL(e.FRCST_SALES_WPS,0) as FRCST_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
sum(a.FRCST_sls) as FRCST_SALES_WPS,sum(a.FRCST_wage_amt) as FRCST_WAGE_WPS
from ww_wlp.mnth_fcst a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) wge_sls) c,

(select f.dept_nm,NVL(sum(e.PLAN_SALES_WPS),0) as PLN_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select loc_no,dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no group by f.dept_nm order by f.dept_nm) d

where a.dept_nm=c.dept_nm and a.dept_nm=d.dept_nm and c.dept_nm=d.dept_nm) src]]>
	</PlannedForecsatRate>
	<PlannedForecsatRateTotal>
	<![CDATA[select 'Store Total' as Total, sum(OVERSPENT_FRCST_RATE_WPS) as OVERSPENT_FRCST_RATE_TOT_WPS from 
(select src.dept_nm,
case 
when src.PLN_SLS_WPS > src.FRCST_SLS_WPS 
then NVL(ROUND((src.PLN_WGE_WPS - ((((src.PST_FACTOR_WPS * src.FRCST_WGE_PCT_WPS) * (src.PLN_SLS_WPS - src.FRCST_SLS_WPS)) + src.FRCST_WGE_WPS))),0),0)
When src.PLN_SLS_WPS < src.FRCST_SLS_WPS 
then NVL(ROUND((src.PLN_WGE_WPS - ((((src.NGT_FACTOR_WPS * src.FRCST_WGE_PCT_WPS) * (src.PLN_SLS_WPS - src.FRCST_SLS_WPS)) + src.FRCST_WGE_WPS))),0),0)
else NVL(ROUND((src.PLN_WGE_WPS - src.FRCST_WGE_WPS),0),0)
end as OVERSPENT_FRCST_RATE_WPS from 
(select a.dept_nm,b.wk_id,a.PLN_WGE_WPS,b.pst_factor_wps,b.ngt_factor_wps,c.FRCST_wge_pct_wps,d.PLN_SLS_WPS,c.FRCST_WGE_WPS,C.FRCST_SLS_WPS from
(select f.dept_nm,NVL(e.PLN_WAGE_WPS,0) as PLN_WGE_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm, b.wk_id,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,b.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,b.wk_id) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) a,
(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_WPS,NVL(src.ngt_factor,1) as NGT_FACTOR_WPS from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99,Region) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) b,
(select wge_sls.dept_nm,NVL(ROUND(wge_sls.FRCST_WGE_WPS,0),0) as FRCST_WGE_WPS, NVL(ROUND(wge_sls.FRCST_SLS_WPS,0),0) as FRCST_SLS_WPS,
case when wge_sls.FRCST_WGE_WPS=0 and wge_sls.FRCST_SLS_WPS=0 then 0 
when wge_sls.FRCST_WGE_WPS=0 then 0 when wge_sls.FRCST_SLS_WPS=0 then 0 
else ROUND((wge_sls.FRCST_WGE_WPS / wge_sls.FRCST_SLS_WPS)*100,2) end as FRCST_WGE_PCT_WPS from 
(select f.dept_nm,NVL(e.FRCST_WAGE_WPS,0) as FRCST_WGE_WPS,NVL(e.FRCST_SALES_WPS,0) as FRCST_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,
sum(a.FRCST_sls) as FRCST_SALES_WPS,sum(a.FRCST_wage_amt) as FRCST_WAGE_WPS
from ww_wlp.mnth_fcst a,wk b,loc c,dept d
where a.wk_id=b.wk_id and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no order by f.dply_seq) wge_sls) c,
(select f.dept_nm,NVL(sum(e.PLAN_SALES_WPS),0) as PLN_SLS_WPS from 
(select div_no,dept_no,dept_nm,dply_seq from ww_wlp.dept where div_no='Division' and dept_no NOT IN (20) and dply_seq is not null order by dply_seq) f
LEFT OUTER JOIN
(select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS 
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) c
UNION
select * from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_WPS
from ww_wlp.fcst a,wk b,loc c,dept d
where a.fcst_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and a.dept_no NOT IN (20)
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select loc_no,dept_no,mgr_pln_sls_dte from
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte,ROUND(sum(a.mgr_pln_sls),0) as PLAN_SALES_WPS
from ww_wlp.mgr_dly_pln a,wk b,loc c,dept d
where a.mgr_pln_sls_dte between b.wk_strt and b.wk_end and b.fin_wk_no='FinWeek' and b.fin_yr='Year'
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20)
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,a.dept_no,d.dply_seq,d.dept_nm,a.mgr_pln_sls_dte
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq,a.mgr_pln_sls_dte))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,d.dply_seq) d) e
on f.dept_nm=e.dept_nm and f.dept_no=e.dept_no group by f.dept_nm order by f.dept_nm) d
where a.dept_nm=c.dept_nm and a.dept_nm=d.dept_nm and c.dept_nm=d.dept_nm) src)]]>
	</PlannedForecsatRateTotal>	
</TCName>
*/

<TCName name = "PlannedBDGTRate_CurrentMonth" >
	<PositiveFactor>
	<![CDATA[select PST_FACTOR_WPS from 
(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_WPS,NVL(src.ngt_factor,1) as NGT_FACTOR_WPS from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) order by wk_id]]>
	</PositiveFactor>
	<NegativeFactor>
	<![CDATA[select NGT_FACTOR_WPS from 
(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_WPS,NVL(src.ngt_factor,1) as NGT_FACTOR_WPS from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) order by wk_id]]>
	</NegativeFactor>
</TCName>


</configuration>