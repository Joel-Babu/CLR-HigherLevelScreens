<?xml version="1.0" encoding="UTF-8"?>

<configuration>

<TCName name = "SalesView" >
	<SalesColumn>
	<![CDATA[select z.dept_nm,NVL(y.mon,0) as Mon,NVL(y.Tue,0) as Tue,NVL(y.Wed,0) as Wed,
	NVL(y.Thu,0) as Thu,NVL(y.Fri,0) as Fri,NVL(y.Sat,0) as Sat,NVL(y.sun,0) as Sun from 
	(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
	LEFT OUTER JOIN
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.dply_seq,b.dept_nm,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTS)),0) Sun from 
	(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.PLN_SLS_DTS from 
	(select * from 
	(select e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.mgr_pln_sls),0) as PLN_SLS_DTS,ROUND(sum(e.mgr_pln_itm_cnt),0) as PLN_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
	nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
	from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
	and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
	group by e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) f
	UNION
	select * from 
	(select e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.gnrt_sls),0) as GEN_SLS_DTS,ROUND(sum(e.gnrt_itm),0) as GEN_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
	nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
	and a.fcst_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and (a.dept_no,a.fcst_dte) NOT in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
	where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end  and c.wk_id='Week' and a.loc_no='store')
	and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
	group by e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) g) h ) b
	group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x ) y
	on z.dept_nm=y.dept_nm order by z.dply_seq]]>
	</SalesColumn>
	<SalesTotal>
	<![CDATA[select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
	NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
	(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
	LEFT OUTER JOIN
	(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.loc_nm,'Store Total' as STR_TOT,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTS)),0) Sun from 
	(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DTS from 
	(select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
	nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
	from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept')
	and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.loc_nm,e.dply_seq,e.day_of_wk) f
	UNION
	select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
	nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept')
	and a.fcst_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and (a.dept_no,fcst_dte) NOT in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
	where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end  and c.wk_id='Week' and a.loc_no='store')
	and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
	group by b.loc_nm order by b.loc_nm) x ) z) sls
	on lc.loc_nm=sls.loc_nm]]>
	</SalesTotal>	
	<SalesWkToDt>
	<![CDATA[select z.dept_nm,NVL(y.wtd,0) as WTD from 
	(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
	LEFT OUTER JOIN
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.dply_seq,b.dept_nm,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTS)),0) Sun from 
	(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.PLN_SLS_DTS from 
	(select * from 
	(select e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.mgr_pln_sls),0) as PLN_SLS_DTS,ROUND(sum(e.mgr_pln_itm_cnt),0) as PLN_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
	nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
	from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
	and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
	group by e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) f
	UNION
	select * from 
	(select e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.gnrt_sls),0) as GEN_SLS_DTS,ROUND(sum(e.gnrt_itm),0) as GEN_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
	nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
	and a.fcst_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and (a.dept_no,a.fcst_dte) NOT in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
	where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1  and c.wk_id='Week' and a.loc_no='store')
	and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
	group by e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) g) h ) b
	group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x ) y
	on z.dept_nm=y.dept_nm order by z.dply_seq]]>
	</SalesWkToDt>
	<SalesWkToDtTotal>
	<![CDATA[select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
	(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
	LEFT OUTER JOIN
	(select z.loc_nm,z.wtd from 
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.loc_nm,'Store Total' as STR_TOT,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTS)),0) Sun from 
	(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),2) as PLN_SLS_DTS from 
	(select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.mgr_pln_sls),2) as PLN_SLS_DTS,ROUND(sum(e.mgr_pln_itm_cnt),0) as PLN_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
	nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
	from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
	and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.loc_nm,e.dply_seq,e.day_of_wk) f
	UNION
	select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.gnrt_sls),0) as GEN_SLS_DTS,ROUND(sum(e.gnrt_itm),0) as GEN_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
	nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
	and a.fcst_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and (a.dept_no,a.fcst_dte) NOT in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
	where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1  and c.wk_id='Week' and a.loc_no='store')
	and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
	group by b.loc_nm order by b.loc_nm) x ) z) sls
	on lc.loc_nm=sls.loc_nm]]>
	</SalesWkToDtTotal>
	
	<VarianceSalesColumn>
<![CDATA[]]>
</VarianceSalesColumn>
<VarianceSalesTotal>
<![CDATA[]]>
</VarianceSalesTotal>	
<VarianceSalesWkToDt>
<![CDATA[]]>
</VarianceSalesWkToDt>
<VarianceSalesWkToDtTotal>
<![CDATA[]]>
</VarianceSalesWkToDtTotal>
</TCName>

<TCName name = "ScheduledHoursView" >
	<HoursColumn>
	<![CDATA[select z.dept_nm,NVL(y.mon,0) as Mon,NVL(y.Tue,0) as Tue,NVL(y.Wed,0) as Wed,
	NVL(y.Thu,0) as Thu,NVL(y.Fri,0) as Fri,NVL(y.Sat,0) as Sat,NVL(y.sun,0) as Sun from 
	(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
	LEFT OUTER JOIN
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.dply_seq,b.dept_nm,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DTS)),0) Sun from 
	(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.PLN_HRS_DTS from 
	(select e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.ta_pln_wage_amt),0) as PLN_WGE_DTS,ROUND(sum(e.ta_pln_hrs),2) as PLN_HRS_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
	nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
	from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
	and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
	group by e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) h ) b
	group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x ) y
	on z.dept_nm=y.dept_nm order by z.dply_seq]]>
	</HoursColumn>
	<HoursTotal>
	<![CDATA[select lc.loc_nm,NVL(ROUND(wge.mon,0),0) as Mon,NVL(ROUND(wge.tue,0),0) as Tue,NVL(ROUND(wge.wed,0),0) as Wed,NVL(ROUND(wge.thu,0),0) as Thu,
	NVL(ROUND(wge.fri,0),0) as Fri,NVL(ROUND(wge.sat,0),0) as Sat,NVL(ROUND(wge.sun,0),0) as Sun from 
	(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
	LEFT OUTER JOIN
	(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.loc_nm,'Store Total' as STR_TOT,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DTS)),0) Sun from 
	(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_HRS_DTS),2) as PLN_HRS_TOT_DTS from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
	nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
	from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
	and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
	group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
	group by b.loc_nm order by b.loc_nm) x ) z) wge
	on wge.loc_nm=lc.loc_nm]]>
	</HoursTotal>
	<HoursWkToDt>
	<![CDATA[select z.dept_nm,NVL(y.PLN_HOURS_DTS,0) as PLN_HRS_DTS from 
	(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
	LEFT OUTER JOIN
	(select e.dply_seq,e.dept_nm,ROUND((sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)),0) as PLN_WAGE_DTS,
	ROUND((sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)),2) as PLN_HOURS_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
	nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
	from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
	and a.wk_id=c.wk_id  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
	group by e.dply_seq,e.dept_nm 
	order by e.dply_seq) y
	on z.dept_nm=y.dept_nm order by z.dply_seq]]>
	</HoursWkToDt>
	<HoursWkToDtTotal>
	<![CDATA[select lc.loc_nm,NVL(ROUND(sum(wge.PLN_HOURS_DTS),0),1) as PLN_HRS_TOT_DTS from 
	(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
	LEFT OUTER JOIN
	(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
	(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
	nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
	from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
	and a.wk_id=c.wk_id  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
	group by e.loc_nm,e.dply_seq,e.dept_nm 
	order by e.loc_nm,e.dply_seq) wge
	on wge.loc_nm=lc.loc_nm group by lc.loc_nm]]>
	</HoursWkToDtTotal>
	
	<VarianceHoursColumn>
<![CDATA[]]>
</VarianceHoursColumn>
<VarianceHoursTotal>
<![CDATA[]]>
</VarianceHoursTotal>	
<VarianceHoursWkToDt>
<![CDATA[]]>
</VarianceHoursWkToDt>
<VarianceHoursWkToDtTotal>
<![CDATA[]]>
</VarianceHoursWkToDtTotal>
</TCName>

<TCName name = "WagesView" >
	<WagesColumn>
	<![CDATA[select z.dept_nm,NVL(y.mon,0) as Mon,NVL(y.Tue,0) as Tue,NVL(y.Wed,0) as Wed,
NVL(y.Thu,0) as Thu,NVL(y.Fri,0) as Fri,NVL(y.Sat,0) as Sat,NVL(y.sun,0) as Sun from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,b.dept_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DTS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DTS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DTS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DTS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DTS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DTS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DTS)),0) Sun from 
(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.PLN_WGE_DTS from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.ta_pln_wage_amt),0) as PLN_WGE_DTS,ROUND(sum(e.ta_pln_hrs),0) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h ) b
group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x ) y
on z.dept_nm=y.dept_nm order by z.dply_seq]]>
	</WagesColumn>
	<WagesWkToDt>
	<![CDATA[select z.dept_nm,NVL(y.PLN_WAGE_DTS,0) as PLN_WGE_DTS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
LEFT OUTER JOIN
(select e.dply_seq,e.dept_nm,ROUND((sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)),0) as PLN_WAGE_DTS,
ROUND((sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)),0) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq,e.dept_nm 
order by e.dply_seq) y
on z.dept_nm=y.dept_nm order by z.dply_seq]]>
	</WagesWkToDt>
	
	<WagesTotal>
	<![CDATA[select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DTS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DTS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DTS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DTS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DTS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DTS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DTS)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_TOT_DTS from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.ta_pln_wage_amt),0) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) wge
on wge.loc_nm=lc.loc_nm]]>
	</WagesTotal>
	<WagesWkToDtTotal>
	<![CDATA[select lc.loc_nm,NVL(ROUND(sum(wge.PLN_WAGE_DTS),0),0) as PLN_WGE_TOT_DTS from 
(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,ROUND((sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)),0) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm]]>
	</WagesWkToDtTotal>
	
	<VarianceWagesColumn>
<![CDATA[]]>
</VarianceWagesColumn>
<VarianceWagesTotal>
<![CDATA[]]>
</VarianceWagesTotal>	
<VarianceWagesWkToDt>
<![CDATA[]]>
</VarianceWagesWkToDt>
<VarianceWagesWkToDtTotal>
<![CDATA[]]>
</VarianceWagesWkToDtTotal>
</TCName>

<TCName name = "WagesPercentageView" >
	<WagesPrcntColumn>
	<![CDATA[select wge.dept_nm,ROUND((wge.mon / sls.mon)*100,2) as Mon,ROUND((wge.tue / sls.tue)*100,2) as Tue,ROUND((wge.wed / sls.wed)*100,2) as Wed,
ROUND((wge.thu / sls.thu)*100,2) as Thu,ROUND((wge.fri / sls.fri)*100,2) as Fri,ROUND((wge.sat / sls.sat)*100,2) as Sat,ROUND((wge.sun / sls.sun)*100,2) as Sun from
(select z.dept_nm,NVL(y.mon,0) as Mon,NVL(y.Tue,0) as Tue,NVL(y.Wed,0) as Wed,
NVL(y.Thu,0) as Thu,NVL(y.Fri,0) as Fri,NVL(y.Sat,0) as Sat,NVL(y.sun,0) as Sun from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,b.dept_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DTS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DTS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DTS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DTS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DTS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DTS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DTS)),0) Sun from 
(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.PLN_WGE_DTS from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h ) b
group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x ) y
on z.dept_nm=y.dept_nm order by z.dply_seq) wge,
(select z.dept_nm,NVL(y.mon,0) as Mon,NVL(y.Tue,0) as Tue,NVL(y.Wed,0) as Wed,
NVL(y.Thu,0) as Thu,NVL(y.Fri,0) as Fri,NVL(y.Sat,0) as Sat,NVL(y.sun,0) as Sun from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,b.dept_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTS)),0) Sun from 
(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.PLN_SLS_DTS from 
(select * from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) not in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) g) h ) b
group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x ) y
on z.dept_nm=y.dept_nm order by z.dply_seq) sls
where wge.dept_nm=sls.dept_nm]]>
	</WagesPrcntColumn>
	<WagesPrcntWkToDt>
	<![CDATA[select wge.dept_nm,ROUND((wge.PLN_WGE_DTS / sls.PLN_SLS_DTS)*100,2) as PLN_WGE_PRCNT_DTS from
(select z.dept_nm,NVL(y.PLN_WAGE_DTS,0) as PLN_WGE_DTS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
LEFT OUTER JOIN
(select e.dply_seq,e.dept_nm,ROUND((sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)),0) as PLN_WAGE_DTS,
ROUND((sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)),0) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq,e.dept_nm 
order by e.dply_seq) y
on z.dept_nm=y.dept_nm order by z.dply_seq) wge,
(select z.dept_nm,NVL(y.wtd,0) as PLN_SLS_DTS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,b.dept_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTS)),0) Sun from 
(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.PLN_SLS_DTS from 
(select * from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) not in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) g) h ) b
group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x ) y
on z.dept_nm=y.dept_nm order by z.dply_seq) sls
where wge.dept_nm=sls.dept_nm]]>
	</WagesPrcntWkToDt>	
	<WagesPrcntTotal>
	<![CDATA[select wge.loc_nm,ROUND((wge.mon / sls.mon)*100,2) as Mon,ROUND((wge.tue / sls.tue)*100,2) as Tue,ROUND((wge.wed / sls.wed)*100,2) as Wed,
ROUND((wge.thu / sls.thu)*100,2) as Thu,ROUND((wge.fri / sls.fri)*100,2) as Fri,ROUND((wge.sat / sls.sat)*100,2) as Sat,ROUND((wge.sun / sls.sun)*100,2) as Sun from
(select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DTS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DTS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DTS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DTS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DTS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DTS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DTS)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_WGE_DTS) as PLN_WGE_TOT_DTS from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) wge
on wge.loc_nm=lc.loc_nm) wge,
(select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTS)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DTS from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,fcst_dte) not in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) sls
on lc.loc_nm=sls.loc_nm) sls
where wge.loc_nm=sls.loc_nm]]>
	</WagesPrcntTotal>
	<WagesPrcntWkToDtTotal>
	<![CDATA[select wge.loc_nm,ROUND((wge.PLN_WGE_TOT_DTS / sls.PLN_SLS_TOT_DTS)*100,2) as PLN_WGE_PRCNT_TOT_DTS from
(select lc.loc_nm,NVL(sum(wge.PLN_WAGE_DTS),0) as PLN_WGE_TOT_DTS from 
(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as PLN_SLS_TOT_DTS from 
(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_nm,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTS)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DTS from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) not in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) sls
on lc.loc_nm=sls.loc_nm) sls
where wge.loc_nm=sls.loc_nm]]>
	</WagesPrcntWkToDtTotal>
	
	<VarianceWagesPrcntColumn>
<![CDATA[]]>
</VarianceWagesPrcntColumn>
<VarianceWagesPrcntTotal>
<![CDATA[]]>
</VarianceWagesPrcntTotal>	
<VarianceWagesPrcntWkToDt>
<![CDATA[]]>
</VarianceWagesPrcntWkToDt>
<VarianceWagesPrcntWkToDtTotal>
<![CDATA[]]>
</VarianceWagesPrcntWkToDtTotal>
</TCName>

<TCName name = "ORPercentageView" >
	<ORPrcntColumn>
	<![CDATA[select sms_hrs.dept_nm,NVL(ROUND((sms_hrs.mon / pln_hrs.mon)*100,1),0) as Mon,NVL(ROUND((sms_hrs.tue / pln_hrs.tue)*100,1),0) as Tue,
NVL(ROUND((sms_hrs.wed / pln_hrs.wed)*100,1),0) as Wed,NVL(ROUND((sms_hrs.Thu / pln_hrs.Thu)*100,1),0) as Thu,
NVL(ROUND((sms_hrs.fri / pln_hrs.fri)*100,1),0) as Fri,NVL(ROUND((sms_hrs.sat / pln_hrs.sat)*100,1),0) as Sat,
NVL(ROUND((sms_hrs.sun / pln_hrs.sun)*100,1),0) as Sun from  
(select z.dept_nm,y.mon,y.tue,y.wed,y.thu,y.fri,y.sat,y.sun,y.wtd from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,b.dept_nm,
sum(DECODE(b.dte_of_wk,00,b.SMS_HRS_DPS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.SMS_HRS_DPS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.SMS_HRS_DPS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.SMS_HRS_DPS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.SMS_HRS_DPS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.SMS_HRS_DPS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.SMS_HRS_DPS)) Sun from 
(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.SMS_HRS_DPS from 
(select C.loc_nm,C.dply_seq,C.dept_nm,C.day_of_wk,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HRS_DPS from 
(select A.loc_nm,A.dply_seq,A.dept_nm,A.day_of_wk,sum(a.fix_hrs) as FIX_HRS_DEPT_TOT,Sum(a.vol_hrs) as VOL_HRS_DEPT_TOT from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,dpt.dept_nm,dpt.dply_seq,B.perd_desc,a.wk_id,a.day_of_wk,
 nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
from lbr_std a, wk b, loc c, task d, day dy, dept dpt 
where a.task_no=d.task_no and d.dept_no in ('Dept') 
and a.wk_id=b.wk_id and b.wk_id='Week'
and a.loc_no=c.loc_no and c.div_no=3 and a.loc_no='store'
and d.dept_no=dpt.dept_no and dpt.dply_seq is not null
and a.day_of_wk=dy.day_of_wk and a.wk_id=dy.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,dpt.dply_seq,a.wk_id,a.day_of_wk) A
group by A.loc_nm,A.dply_seq,A.dept_nm,A.day_of_wk order by A.loc_nm,A.dply_seq,A.day_of_wk) C
group by C.loc_nm,C.dply_seq,C.dept_nm,C.day_of_wk order by C.loc_nm,C.dply_seq,C.day_of_wk) h ) b
group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x ) y
on z.dept_nm=y.dept_nm order by z.dply_seq) sms_hrs,
(select z.dept_nm,y.mon,y.tue,y.wed,y.thu,y.fri,y.sat,y.sun,y.wtd from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,b.dept_nm,
sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DTS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DTS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DTS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DTS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DTS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DTS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DTS)) Sun from 
(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.PLN_HRS_DTS from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
a.ta_pln_wage_amt as ta_pln_wage_amt,a.ta_pln_hrs as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h ) b
group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x ) y
on z.dept_nm=y.dept_nm order by z.dply_seq) pln_hrs 
where sms_hrs.dept_nm=pln_hrs.dept_nm]]>
	</ORPrcntColumn>
	<ORPrcntWkToDt>
	<![CDATA[select sms_hrs.dept_nm,NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) as WTD from  
(select z.dept_nm,y.mon,y.tue,y.wed,y.thu,y.fri,y.sat,y.sun,y.wtd from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,b.dept_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.SMS_HRS_DPS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.SMS_HRS_DPS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.SMS_HRS_DPS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.SMS_HRS_DPS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.SMS_HRS_DPS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.SMS_HRS_DPS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.SMS_HRS_DPS)),0) Sun from 
(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.SMS_HRS_DPS from 
(select C.loc_nm,C.dply_seq,C.dept_nm,C.day_of_wk,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HRS_DPS from 
(select A.loc_nm,A.dply_seq,A.dept_nm,A.day_of_wk,sum(a.fix_hrs) as FIX_HRS_DEPT_TOT,Sum(a.vol_hrs) as VOL_HRS_DEPT_TOT from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,dpt.dept_nm,dpt.dply_seq,B.perd_desc,a.wk_id,a.day_of_wk,
 nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
from lbr_std a, wk b, loc c, task d, day dy, dept dpt 
where a.task_no=d.task_no and d.dept_no in ('Dept') 
and a.wk_id=b.wk_id and b.wk_id='Week'
and a.loc_no=c.loc_no and c.div_no=3 and a.loc_no='store'
and d.dept_no=dpt.dept_no and dpt.dply_seq is not null
and a.day_of_wk=dy.day_of_wk and a.wk_id=dy.wk_id
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,dpt.dply_seq,a.wk_id,a.day_of_wk) A
group by A.loc_nm,A.dply_seq,A.dept_nm,A.day_of_wk order by A.loc_nm,A.dply_seq,A.day_of_wk) C
group by C.loc_nm,C.dply_seq,C.dept_nm,C.day_of_wk order by C.loc_nm,C.dply_seq,C.day_of_wk) h ) b
group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x ) y
on z.dept_nm=y.dept_nm order by z.dply_seq) sms_hrs,
(select z.dept_nm,y.PLN_HOURS_DTS as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
LEFT OUTER JOIN
(select e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
a.ta_pln_wage_amt as ta_pln_wage_amt,a.wage_adj_amt as wage_adj_amt,a.ta_pln_hrs as ta_pln_hrs,a.wage_adj_hrs as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq,e.dept_nm 
order by e.dply_seq) y
on z.dept_nm=y.dept_nm order by z.dply_seq) pln_hrs 
where sms_hrs.dept_nm=pln_hrs.dept_nm]]>
	</ORPrcntWkToDt>	
	<ORPrcntTotal>
	<![CDATA[select sms_hrs.loc_nm,NVL(ROUND((sms_hrs.mon / pln_hrs.mon)*100,1),0) as Mon,NVL(ROUND((sms_hrs.tue / pln_hrs.tue)*100,1),0) as Tue,
NVL(ROUND((sms_hrs.wed / pln_hrs.wed)*100,1),0) as Wed,NVL(ROUND((sms_hrs.Thu / pln_hrs.Thu)*100,1),0) as Thu,
NVL(ROUND((sms_hrs.fri / pln_hrs.fri)*100,1),0) as Fri,NVL(ROUND((sms_hrs.sat / pln_hrs.sat)*100,1),0) as Sat,
NVL(ROUND((sms_hrs.sun / pln_hrs.sun)*100,1),0) as Sun from  
(select lc.loc_nm,sms.mon,sms.tue,sms.wed,sms.thu,sms.fri,sms.sat,sms.sun from 
(select loc_nm,'store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DTS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DTS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DTS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DTS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DTS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DTS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DTS)) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_TOT_DTS from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and a.loc_no='store' and tsk.dept_no in ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z ) sms
on sms.loc_nm=lc.loc_nm) sms_hrs,
(select lc.loc_nm,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select loc_nm,'store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DTS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DTS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DTS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DTS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DTS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DTS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DTS)) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_HRS_DTS) as PLN_HRS_TOT_DTS from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
a.ta_pln_wage_amt as ta_pln_wage_amt,a.ta_pln_hrs as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) wge
on wge.loc_nm=lc.loc_nm) pln_hrs 
where sms_hrs.loc_nm=pln_hrs.loc_nm]]>
	</ORPrcntTotal>
	<ORPrcntWkToDtTotal>
	<![CDATA[select sms_hrs.loc_nm,NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,2),0) as WTD from  
(select lc.loc_nm,sms.wtd from 
(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_nm,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DTS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DTS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DTS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DTS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DTS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DTS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DTS)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_TOT_DTS from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and a.loc_no='store' and tsk.dept_no in ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and sysdate-1
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z ) sms
on sms.loc_nm=lc.loc_nm) sms_hrs,
(select lc.loc_nm,NVL(sum(wge.PLN_HOURS_DTS),0) as WTD from 
(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
a.ta_pln_wage_amt as ta_pln_wage_amt,a.wage_adj_amt as wage_adj_amt,a.ta_pln_hrs as ta_pln_hrs,a.wage_adj_hrs as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm) pln_hrs 
where sms_hrs.loc_nm=pln_hrs.loc_nm]]>
	</ORPrcntWkToDtTotal>
	
	<VarianceORPrcntColumn>
<![CDATA[]]>
</VarianceORPrcntColumn>
<VarianceORPrcntTotal>
<![CDATA[]]>
</VarianceORPrcntTotal>	
<VarianceORPrcntWkToDt>
<![CDATA[]]>
</VarianceORPrcntWkToDt>
<VarianceORPrcntWkToDtTotal>
<![CDATA[]]>
</VarianceORPrcntWkToDtTotal>
</TCName>

<TCName name = "ItemsView" >
	<ItemsColumn>
	<![CDATA[select z.dept_nm,NVL(y.mon,0) as Mon,NVL(y.Tue,0) as Tue,NVL(y.Wed,0) as Wed,
	NVL(y.Thu,0) as Thu,NVL(y.Fri,0) as Fri,NVL(y.Sat,0) as Sat,NVL(y.sun,0) as Sun from 
	(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
	LEFT OUTER JOIN
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.dply_seq,b.dept_nm,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DTS)),0) Sun from 
	(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.PLN_ITM_DTS from 
	(select * from 
	(select e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.mgr_pln_sls),0) as PLN_SLS_DTS,ROUND(sum(e.mgr_pln_itm_cnt),0) as PLN_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
	nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
	from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
	and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
	group by e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) f
	UNION
	select * from 
	(select e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.gnrt_sls),0) as GEN_SLS_DTS,ROUND(sum(e.gnrt_itm),0) as GEN_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
	nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
	and a.fcst_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and (a.dept_no,a.fcst_dte) not in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
	where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end  and c.wk_id='Week' and a.loc_no='store')
	and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
	group by e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) g) h ) b
	group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x ) y
	on z.dept_nm=y.dept_nm order by z.dply_seq]]>
	</ItemsColumn>
	<ItemsTotal>
	<![CDATA[select lc.loc_nm,NVL(itm.mon,0) as Mon,NVL(itm.tue,0) as Tue,NVL(itm.wed,0) as Wed,NVL(itm.thu,0) as Thu,
	NVL(itm.fri,0) as Fri,NVL(itm.sat,0) as Sat,NVL(itm.sun,0) as Sun from 
	(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
	LEFT OUTER JOIN
	(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.loc_nm,'Store Total' as STR_TOT,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DTS)),0) Sun from 
	(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DTS from 
	(select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
	nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
	from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept')
	and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.loc_nm,e.dply_seq,e.day_of_wk) f
	UNION
	select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
	nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept')
	and a.fcst_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and (a.dept_no,fcst_dte) not in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
	where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end  and c.wk_id='Week' and a.loc_no='store')
	and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
	group by b.loc_nm order by b.loc_nm) x ) z) itm
	on itm.loc_nm=lc.loc_nm]]>
	</ItemsTotal>	
	<ItemsWkToDt>
	<![CDATA[select z.dept_nm,NVL(y.wtd,0) as WTD from 
	(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
	LEFT OUTER JOIN
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.dply_seq,b.dept_nm,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DTS)),0) Sun from 
	(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.PLN_ITM_DTS from 
	(select * from 
	(select e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.mgr_pln_sls),0) as PLN_SLS_DTS,ROUND(sum(e.mgr_pln_itm_cnt),0) as PLN_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
	nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
	from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
	and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
	group by e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) f
	UNION
	select * from 
	(select e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.gnrt_sls),0) as GEN_SLS_DTS,ROUND(sum(e.gnrt_itm),0) as GEN_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
	nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
	and a.fcst_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and (a.dept_no,a.fcst_dte) not in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
	where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1  and c.wk_id='Week' and a.loc_no='store')
	and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
	group by e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) g) h ) b
	group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x ) y
	on z.dept_nm=y.dept_nm order by z.dply_seq]]>
	</ItemsWkToDt>
	<ItemsWkToDtTotal>
	<![CDATA[select lc.loc_nm,NVL(itm.wtd,0) as WTD from 
	(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
	LEFT OUTER JOIN
	(select z.loc_nm,z.wtd from 
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.loc_nm,'Store Total' as STR_TOT,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DTS)),0) Sun from 
	(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DTS from 
	(select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
	nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
	from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
	and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.loc_nm,e.dply_seq,e.day_of_wk) f
	UNION
	select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm)as GEN_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
	nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
	and a.fcst_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and (a.dept_no,a.fcst_dte) not in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
	where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1  and c.wk_id='Week' and a.loc_no='store')
	and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
	group by b.loc_nm order by b.loc_nm) x ) z) itm
	on itm.loc_nm=lc.loc_nm]]>
	</ItemsWkToDtTotal>
	
	<VarianceItemsColumn>
<![CDATA[]]>
</VarianceItemsColumn>
<VarianceItemsTotal>
<![CDATA[]]>
</VarianceItemsTotal>	
<VarianceItemsWkToDt>
<![CDATA[]]>
</VarianceItemsWkToDt>
<VarianceItemsWkToDtTotal>
<![CDATA[]]>
</VarianceItemsWkToDtTotal>
</TCName>

<TCName name = "ItemsPriceView" >
	<ItemsPriceColumn>
	<![CDATA[select sls_itm.dept_nm,ROUND((sls_itm.mon_sls / sls_itm.mon_itm),2) as Mon,ROUND((sls_itm.tue_sls / sls_itm.tue_itm),2) as Tue,
ROUND((sls_itm.wed_sls / sls_itm.wed_itm),2) as Wed,ROUND((sls_itm.thu_sls / sls_itm.thu_itm),2) as Thu,ROUND((sls_itm.fri_sls / sls_itm.fri_itm),2) as Fri,
ROUND((sls_itm.sat_sls / sls_itm.sat_itm),2) as Sat,ROUND((sls_itm.sun_sls / sls_itm.sun_itm),2) as Sun from
(select z.dept_nm,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.dply_seq,b.dept_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DTS)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DTS)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DTS)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DTS)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DTS)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DTS)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DTS)),0) Sun_itm from 
(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.PLN_SLS_DTS,h.PLN_ITM_DTS from 
(select * from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) not in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) g) h ) b
group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x ) y
on z.dept_nm=y.dept_nm order by z.dply_seq) sls_itm]]>
	</ItemsPriceColumn>
	<ItemsPriceWkToDt>
	<![CDATA[select sls_itm.dept_nm,ROUND((sls_itm.wtd_sls / sls_itm.wtd_itm),2) as WTD from
(select z.dept_nm,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,y.Wtd_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm,y.Wtd_itm from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.dply_seq,b.dept_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DTS)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DTS)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DTS)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DTS)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DTS)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DTS)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DTS)),0) Sun_itm from 
(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.PLN_SLS_DTS,h.PLN_ITM_DTS from 
(select * from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) not in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) g) h ) b
group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x ) y
on z.dept_nm=y.dept_nm order by z.dply_seq) sls_itm]]>
	</ItemsPriceWkToDt>
	
	<ItemsPriceTotal>
	<![CDATA[select sls_itm.loc_nm,ROUND((sls_itm.mon_sls / sls_itm.mon_itm),2) as Mon,ROUND((sls_itm.tue_sls / sls_itm.tue_itm),2) as Tue,
ROUND((sls_itm.wed_sls / sls_itm.wed_itm),2) as Wed,ROUND((sls_itm.thu_sls / sls_itm.thu_itm),2) as Thu,ROUND((sls_itm.fri_sls / sls_itm.fri_itm),2) as Fri,
ROUND((sls_itm.sat_sls / sls_itm.sat_itm),2) as Sat,ROUND((sls_itm.sun_sls / sls_itm.sun_itm),2) as Sun from
(select z.loc_nm,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm from 
(select loc_no,loc_nm from ww_wlp.loc where loc_no='store') z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.loc_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTS)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTS)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTS)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTS)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTS)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTS)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTS)),0) Sun_itm from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DTS,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_DTS from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) not in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) y
on z.loc_nm=y.loc_nm order by z.loc_no) sls_itm]]>
	</ItemsPriceTotal>
	<ItemsPriceWkToDtTotal>
	<![CDATA[select sls_itm.loc_nm,ROUND((sls_itm.wtd_sls / sls_itm.wtd_itm),2) as WTD from
(select z.loc_nm,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,y.wtd_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm,y.wtd_itm from 
(select loc_no,loc_nm from ww_wlp.loc where loc_no='store') z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.loc_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTS)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTS)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTS)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTS)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTS)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTS)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTS)),0) Sun_itm from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DTS,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_DTS from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) not in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) y
on z.loc_nm=y.loc_nm order by z.loc_no) sls_itm]]>
	</ItemsPriceWkToDtTotal>
	
	<VarianceItemsPriceColumn>
<![CDATA[]]>
</VarianceItemsPriceColumn>
<VarianceItemsPriceTotal>
<![CDATA[]]>
</VarianceItemsPriceTotal>	
<VarianceItemsPriceWkToDt>
<![CDATA[]]>
</VarianceItemsPriceWkToDt>
<VarianceItemsPriceWkToDtTotal>
<![CDATA[]]>
</VarianceItemsPriceWkToDtTotal>
</TCName>

<TCName name = "CustomersView" >
	<CustomersColumn>
	<![CDATA[select z.dept_nm,NVL(y.mon,0) as Mon,NVL(y.Tue,0) as Tue,NVL(y.Wed,0) as Wed,
	NVL(y.Thu,0) as Thu,NVL(y.Fri,0) as Fri,NVL(y.Sat,0) as Sat,NVL(y.sun,0) as Sun from 
	(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no not IN ('Dept')) z
	LEFT OUTER JOIN
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.dply_seq,b.dept_nm,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DTS)),0) Sun from 
	(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.PLN_CUST_DTS from 
	(select * from 
	(select e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.mgr_pln_cust_cnt),0) as PLN_CUST_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
	nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
	from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no not IN ('Dept') 
	and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
	group by e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) f
	UNION
	select * from 
	(select e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.gnrt_cust),0) as GEN_CUST_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
	nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no not IN ('Dept') 
	and a.fcst_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and (a.dept_no,a.fcst_dte) not in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
	where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end  and c.wk_id='Week' and a.loc_no='store')
	and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
	group by e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) g) h ) b
	group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x ) y
	on z.dept_nm=y.dept_nm order by z.dply_seq]]>
	</CustomersColumn>
	<CustomersTotal>
	<![CDATA[select lc.loc_nm,NVL(cust.mon,0) as Mon,NVL(cust.tue,0) as Tue,NVL(cust.wed,0) as Wed,NVL(cust.thu,0) as Thu,
	NVL(cust.fri,0) as Fri,NVL(cust.sat,0) as Sat,NVL(cust.sun,0) as Sun from 
	(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
	LEFT OUTER JOIN
	(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.loc_nm,'Store Total' as STR_TOT,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DTS)),0) Sun from 
	(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_DTS from 
	(select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
	nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
	from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN ('Dept')
	and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.loc_nm,e.dply_seq,e.day_of_wk) f
	UNION
	select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_cust) as GEN_CUST_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
	nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN ('Dept')
	and a.fcst_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and (a.dept_no,fcst_dte) not in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
	where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end  and c.wk_id='Week' and a.loc_no='store')
	and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
	group by b.loc_nm order by b.loc_nm) x ) z ) cust
	on cust.loc_nm=lc.loc_nm]]>
	</CustomersTotal>
	<CustomersWkToDt>
	<![CDATA[select z.dept_nm,NVL(y.wtd,0) as WTD from 
	(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no not IN ('Dept')) z
	LEFT OUTER JOIN
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.dply_seq,b.dept_nm,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DTS)),0) Sun from 
	(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.PLN_CUST_DTS from 
	(select * from 
	(select e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.mgr_pln_cust_cnt),0) as PLN_CUST_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
	nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
	from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no not IN ('Dept') 
	and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
	group by e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) f
	UNION
	select * from 
	(select e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.gnrt_cust),0) as GEN_CUST_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
	nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no not IN ('Dept')
	and a.fcst_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and (a.dept_no,a.fcst_dte) not in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
	where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1  and c.wk_id='Week' and a.loc_no='store')
	and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
	group by e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) g) h ) b
	group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x ) y
	on z.dept_nm=y.dept_nm order by z.dply_seq]]>
	</CustomersWkToDt>
	<CustomersWkToDtTotal>
	<![CDATA[select lc.loc_nm,NVL(cust.wtd,0) as WTD from 
	(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
	LEFT OUTER JOIN
	(select z.loc_nm,z.wtd from 
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.loc_nm,'Store Total' as STR_TOT,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DTS)),0) Sun from 
	(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_DTS from 
	(select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.mgr_pln_cust_cnt),0) as PLN_CUST_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
	nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
	from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN ('Dept') 
	and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.loc_nm,e.dply_seq,e.day_of_wk) f
	UNION
	select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.gnrt_cust),0) as GEN_CUST_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
	nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN ('Dept') 
	and a.fcst_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and (a.dept_no,a.fcst_dte) not in (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
	where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1  and c.wk_id='Week' and a.loc_no='store')
	and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
	group by b.loc_nm order by b.loc_nm) x ) z ) cust
	on cust.loc_nm=lc.loc_nm]]>
	</CustomersWkToDtTotal>
	
	<VarianceCustomersColumn>
<![CDATA[]]>
</VarianceCustomersColumn>
<VarianceCustomersTotal>
<![CDATA[]]>
</VarianceCustomersTotal>	
<VarianceCustomersWkToDt>
<![CDATA[]]>
</VarianceCustomersWkToDt>
<VarianceCustomersWkToDtTotal>
<![CDATA[]]>
</VarianceCustomersWkToDtTotal>
</TCName>

<TCName name = "CPHView" >
	<CPHColumn>
	<![CDATA[select wge_hrs.dept_nm,NVL(ROUND((wge_hrs.mon_wge / wge_hrs.mon_hrs),2),0) as Mon,NVL(ROUND((wge_hrs.tue_wge / wge_hrs.tue_hrs),2),0) as Tue,
NVL(ROUND((wge_hrs.wed_wge / wge_hrs.wed_hrs),2),0) as Wed,NVL(ROUND((wge_hrs.thu_wge / wge_hrs.thu_hrs),2),0) as Thu,
NVL(ROUND((wge_hrs.fri_wge / wge_hrs.fri_hrs),2),0) as Fri,NVL(ROUND((wge_hrs.sat_wge / wge_hrs.sat_hrs),2),0) as Sat,
NVL(ROUND((wge_hrs.sun_wge / wge_hrs.sun_hrs),2),0) as Sun from
(select z.dept_nm,y.Mon_wge,y.Tue_wge,y.Wed_wge,y.Thu_wge,y.Fri_wge,y.Sat_wge,y.Sun_wge,y.wtd_wge,
y.Mon_hrs,y.Tue_hrs,y.Wed_hrs,y.Thu_hrs,y.Fri_hrs,y.Sat_hrs,y.Sun_hrs,y.wtd_hrs from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
LEFT OUTER JOIN
(select x.*,(x.Mon_wge + x.Tue_wge + x.Wed_wge + x.Thu_wge + x.Fri_wge + x.Sat_wge + x.Sun_wge) as WTD_wge,
(x.Mon_hrs + x.Tue_hrs + x.Wed_hrs + x.Thu_hrs + x.Fri_hrs + x.Sat_hrs + x.Sun_hrs) as WTD_hrs from 
(select b.dply_seq,b.dept_nm,
sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DTS)) Mon_wge,
sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DTS)) Tue_wge,
sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DTS)) Wed_wge,
sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DTS)) Thu_wge,
sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DTS)) Fri_wge,
sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DTS)) Sat_wge,
sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DTS)) Sun_wge,
sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DTS)) Mon_hrs,
sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DTS)) Tue_hrs,
sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DTS)) Wed_hrs,
sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DTS)) Thu_hrs,
sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DTS)) Fri_hrs,
sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DTS)) Sat_hrs,
sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DTS)) Sun_hrs from 
(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.PLN_WGE_DTS,h.PLN_HRS_DTS from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.ta_pln_wage_amt),2) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h ) b
group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x ) y
on z.dept_nm=y.dept_nm order by z.dply_seq) wge_hrs]]>
	</CPHColumn>
	<CPHWkToDt>
	<![CDATA[select wge_hrs.dept_nm,NVL(ROUND((wge_hrs.PLN_WGE_DTS / wge_hrs.PLN_HRS_DTS),2),0) as WTD from
(select z.dept_nm,y.PLN_WAGE_DTS as PLN_WGE_DTS,y.PLN_HOURS_DTS as PLN_HRS_DTS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and dept_no in ('Dept')) z
LEFT OUTER JOIN
(select e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq,e.dept_nm 
order by e.dply_seq) y
on z.dept_nm=y.dept_nm order by z.dply_seq) wge_hrs ]]>
	</CPHWkToDt>
	<CPHTotal>
	<![CDATA[select wge_hrs.loc_nm,ROUND((wge_hrs.mon_wge / wge_hrs.mon_hrs),2) as Mon,ROUND((wge_hrs.tue_wge / wge_hrs.tue_hrs),2) as Tue,
ROUND((wge_hrs.wed_wge / wge_hrs.wed_hrs),2) as Wed,ROUND((wge_hrs.thu_wge / wge_hrs.thu_hrs),2) as Thu,ROUND((wge_hrs.fri_wge / wge_hrs.fri_hrs),2) as Fri,
ROUND((wge_hrs.sat_wge / wge_hrs.sat_hrs),2) as Sat,ROUND((wge_hrs.sun_wge / wge_hrs.sun_hrs),2) as Sun from
(select z.loc_nm,y.Mon_wge,y.Tue_wge,y.Wed_wge,y.Thu_wge,y.Fri_wge,y.Sat_wge,y.Sun_wge,y.wtd_wge,
y.Mon_hrs,y.Tue_hrs,y.Wed_hrs,y.Thu_hrs,y.Fri_hrs,y.Sat_hrs,y.Sun_hrs,y.wtd_hrs from 
(select loc_no,loc_nm from loc where loc_no='store') z
LEFT OUTER JOIN
(select x.*,(x.Mon_wge + x.Tue_wge + x.Wed_wge + x.Thu_wge + x.Fri_wge + x.Sat_wge + x.Sun_wge) as WTD_wge,
(x.Mon_hrs + x.Tue_hrs + x.Wed_hrs + x.Thu_hrs + x.Fri_hrs + x.Sat_hrs + x.Sun_hrs) as WTD_hrs from 
(select b.loc_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DTS)),0) Mon_wge,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DTS)),0) Tue_wge,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DTS)),0) Wed_wge,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DTS)),0) Thu_wge,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DTS)),0) Fri_wge,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DTS)),0) Sat_wge,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DTS)),0) Sun_wge,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DTS)),0) Mon_hrs,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DTS)),0) Tue_hrs,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DTS)),0) Wed_hrs,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DTS)),0) Thu_hrs,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DTS)),0) Fri_hrs,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DTS)),0) Sat_hrs,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DTS)),0) Sun_hrs from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_TOT_DTS,sum(h.PLN_HRS_DTS) as PLN_HRS_TOT_DTS from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) y
on z.loc_nm=y.loc_nm order by z.loc_no) wge_hrs]]>
	</CPHTotal>
	<CPHWkToDtTotal>
	<![CDATA[select wge_hrs.loc_nm,ROUND((wge_hrs.PLN_WGE_TOT_DTS / wge_hrs.PLN_HRS_TOT_DTS),2) as WTD from
(select lc.loc_nm,NVL(sum(wge.PLN_WAGE_DTS),0) as PLN_WGE_TOT_DTS,NVL(sum(wge.PLN_HOURS_DTS),0) as PLN_HRS_TOT_DTS from 
(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no in ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm) wge_hrs]]>
	</CPHWkToDtTotal>
	
	<VarianceCPHColumn>
<![CDATA[]]>
</VarianceCPHColumn>
<VarianceCPHTotal>
<![CDATA[]]>
</VarianceCPHTotal>	
<VarianceCPHWkToDt>
<![CDATA[]]>
</VarianceCPHWkToDt>
<VarianceCPHWkToDtTotal>
<![CDATA[]]>
</VarianceCPHWkToDtTotal>
</TCName>


</configuration>