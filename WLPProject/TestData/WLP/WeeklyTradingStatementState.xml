<?xml version="1.0" encoding="UTF-8" ?> 
<configuration>

<TCName name="SalesColumnValidation">
<PlannedSales>
<![CDATA[select lc.zone_no,NVL(ROUND(sls.PLN_SLS_WTSR,0),0) as PLN_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSR from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk
order by e.zone_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk
order by e.zone_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.zone_no order by h.zone_no) sls
on lc.zone_no=sls.zone_no order by lc.zone_no]]> 
  </PlannedSales>
  
  <PlannedSalesTotal>
<![CDATA[select lc.rgn_no,NVL(ROUND(sls.PLN_SLS_TOT_WTSR,0),0) as PLN_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSR from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]> 
  </PlannedSalesTotal>
  
  <ActualSales>
<![CDATA[select lc.zone_no,NVL(ROUND(sls.ACTL_SLS_WTSR,0),0) as ACTL_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR from 
(select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk order by e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) sls
on lc.zone_no=sls.zone_no order by lc.zone_no]]> 
  </ActualSales>
  
  <ActualSalesTotal>
<![CDATA[select lc.rgn_no,NVL(ROUND(sls.ACTL_SLS_TOT_WTSR,0),0) as ACTL_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region'  and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]> 
  </ActualSalesTotal>
  
  <VarSales>
<![CDATA[select pln.zone_no,ROUND((actl.ACTL_SLS_WTSR - pln.PLN_SLS_WTSR),0) as VAR_SLS_WTD_WTSR from 
(select lc.zone_no,NVL(sls.PLN_SLS_WTSR,0) as PLN_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSR from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.dply_seq,e.loc_no,e.day_of_wk 
order by e.dply_seq,e.loc_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk 
order by e.zone_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk 
order by e.zone_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.zone_no order by h.zone_no) sls
on lc.zone_no=sls.zone_no) pln,
(select lc.zone_no,NVL(sls.ACTL_SLS_WTSR,0) as ACTL_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' 
order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR from 
(select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk order by e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) sls
on lc.zone_no=sls.zone_no order by lc.zone_no) actl
where pln.zone_no=actl.zone_no order by pln.zone_no]]> 
  </VarSales>
  
  <VarSalesTotal>
<![CDATA[select pln.rgn_no,ROUND((actl.ACTL_SLS_TOT_WTSR - pln.PLN_SLS_TOT_WTSR),0) as VAR_SLS_WTD_WTSR from 
(select lc.rgn_no,NVL(sls.PLN_SLS_TOT_WTSR,0) as PLN_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSR from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no) pln,
(select lc.rgn_no,NVL(sls.ACTL_SLS_TOT_WTSR,0) as ACTL_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]> 
  </VarSalesTotal>
  
  <LYSales>
<![CDATA[select lc.zone_no,NVL(ROUND(sls.ACTL_SLS_WTSR,0),0) as ACTL_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' 
order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR from 
(select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk order by e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) sls
on lc.zone_no=sls.zone_no order by lc.zone_no]]> 
  </LYSales>
  
  <LYSalesTotal>
<![CDATA[select lc.rgn_no,NVL(ROUND(sls.ACTL_SLS_TOT_WTSR,0),0) as ACTL_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]> 
  </LYSalesTotal>
  
  <LYSalesPct>
<![CDATA[select lc.zone_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' 
order by b.zone_no) lc
LEFT OUTER JOIN
(select cy_val.zone_no,sum(cy_val.ACTL_SLS_WTSR) as cy_wtd,sum(ly_val.ACTL_SLS_WTSR) as ly_wtd from 
(select lc.zone_no,NVL(sls.ACTL_SLS_WTSR,0) as ACTL_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' 
order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR from 
(select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk order by e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) sls
on lc.zone_no=sls.zone_no order by lc.zone_no) cy_val
LEFT OUTER JOIN
(select lc.zone_no,NVL(sls.ACTL_SLS_WTSR,0) as ACTL_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' 
order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR from 
(select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk order by e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) sls
on lc.zone_no=sls.zone_no order by lc.zone_no) ly_val
on cy_val.zone_no=ly_val.zone_no group by cy_val.zone_no) cyly_wtd
on cyly_wtd.zone_no=lc.zone_no order by lc.zone_no]]> 
  </LYSalesPct>
  
  <LYSalesPctTotal>
<![CDATA[select lc.rgn_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select cy_val.rgn_no,sum(cy_val.ACTL_SLS_TOT_WTSR) as cy_wtd,sum(ly_val.ACTL_SLS_TOT_WTSR) as ly_wtd from 
(select lc.rgn_no,NVL(sls.ACTL_SLS_TOT_WTSR,0) as ACTL_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) cy_val
LEFT OUTER JOIN
(select lc.rgn_no,NVL(sls.ACTL_SLS_TOT_WTSR,0) as ACTL_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) ly_val
on cy_val.rgn_no=ly_val.rgn_no group by cy_val.rgn_no) cyly_wtd
on cyly_wtd.rgn_no=lc.rgn_no order by lc.rgn_no]]> 
  </LYSalesPctTotal>
  
  <BudgetSales>
<![CDATA[select lc.zone_no,NVL(bdgt.BDGT_SALES_WTSR,0) as BDGT_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' 
order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.zone_no order by e.zone_no) bdgt
on lc.zone_no=bdgt.zone_no order by lc.zone_no]]> 
  </BudgetSales>
  
  <BudgetSalesTotal>
<![CDATA[select lc.rgn_no,NVL(bdgt.BDGT_SALES_TOT_WTSR,0) as BDGT_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_TOT_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no]]> 
  </BudgetSalesTotal>
  
  <ForecastSales>
<![CDATA[select lc.zone_no,NVL(fcst.FCST_SALES_WTSR,0) as FCST_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' 
order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,ROUND(sum(e.frcst_sls),0) as FCST_SALES_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.zone_no order by e.zone_no) fcst
on lc.zone_no=fcst.zone_no order by lc.zone_no]]> 
  </ForecastSales>
  
<ForecastSalesTotal>
<![CDATA[select lc.rgn_no,NVL(bdgt.FCST_SALES_TOT_WTSR,0) as FCST_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,ROUND(sum(e.frcst_sls),0) as FCST_SALES_TOT_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no]]> 
  </ForecastSalesTotal>
  
  <VarBudgetSales>
<![CDATA[select actl.zone_no,ROUND((actl.ACTL_SLS_WTSR - bdgt.BDGT_SLS_WTSR),0) as VAR_BDGT_SLS_WTSR from 
(select lc.zone_no,NVL(sls.ACTL_SLS_WTSR,0) as ACTL_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR from 
(select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk order by e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) sls
on lc.zone_no=sls.zone_no order by lc.zone_no) actl,
(select lc.zone_no,NVL(bdgt.BDGT_SALES_WTSR,0) as BDGT_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' 
order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,sum(e.bdgt_sls) as BDGT_SALES_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.zone_no order by e.zone_no) bdgt
on lc.zone_no=bdgt.zone_no order by lc.zone_no) bdgt
where bdgt.zone_no=actl.zone_no order by bdgt.zone_no]]> 
  </VarBudgetSales>
  
  <VarBudgetSalesTotal>
<![CDATA[select actl.rgn_no,ROUND((actl.ACTL_SLS_TOT_WTSR - bdgt.BDGT_SLS_TOT_WTSR),0) as VAR_BDGT_SLS_TOT_WTSR from 
(select lc.rgn_no,NVL(sls.ACTL_SLS_TOT_WTSR,0) as ACTL_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl,
(select lc.rgn_no,NVL(bdgt.BDGT_SALES_TOT_WTSR,0) as BDGT_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.bdgt_sls) as BDGT_SALES_TOT_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no) bdgt
where bdgt.rgn_no=actl.rgn_no order by bdgt.zone_no]]> 
  </VarBudgetSalesTotal>
  
  <VarFcstSales>
<![CDATA[select actl.zone_no,ROUND((actl.ACTL_SLS_WTSR - fcst.FCST_SLS_WTSR),0) as VAR_FCST_SLS_WTSR from 
(select lc.zone_no,NVL(sls.ACTL_SLS_WTSR,0) as ACTL_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' 
order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR from 
(select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk order by e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) sls
on lc.zone_no=sls.zone_no order by lc.zone_no) actl,
(select lc.zone_no,NVL(fcst.FCST_SALES_WTSR,0) as FCST_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' 
order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,sum(e.frcst_sls) as FCST_SALES_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.zone_no order by e.zone_no) fcst
on lc.zone_no=fcst.zone_no order by lc.zone_no) fcst
where fcst.zone_no=actl.zone_no order by fcst.zone_no]]> 
  </VarFcstSales>
  
  <VarFcstSalesTotal>
<![CDATA[select actl.rgn_no,ROUND((actl.ACTL_SLS_TOT_WTSR - fcst.FCST_SLS_TOT_WTSR),0) as VAR_FCST_SLS_TOT_WTSR from 
(select lc.rgn_no,NVL(sls.ACTL_SLS_TOT_WTSR,0) as ACTL_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl,
(select lc.rgn_no,NVL(bdgt.FCST_SALES_TOT_WTSR,0) as FCST_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.frcst_sls) as FCST_SALES_TOT_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no) fcst
where fcst.rgn_no=actl.rgn_no order by fcst.rgn_no]]> 
  </VarFcstSalesTotal>
  
  <AvgBasketSales>
<![CDATA[select lc.zone_no,
CASE WHEN nvl(nume_den.ACTL_SLS_WTSR,0) = 0 and nvl(nume_den.ACTL_CUST_WTSR,0) = 0 THEN 0
WHEN nvl(nume_den.ACTL_SLS_WTSR,0) = 0 THEN 0 WHEN nvl(nume_den.ACTL_CUST_WTSR,0) = 0 THEN 0
ELSE NVL(ROUND((nume_den.ACTL_SLS_WTSR / nume_den.ACTL_CUST_WTSR),2),0) END as AVG_BASKET_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' 
order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSR from 
(select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no IN (85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk order by e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) nume_den
on nume_den.zone_no=lc.zone_no order by lc.zone_no]]> 
  </AvgBasketSales>
  
  <AvgBasketSalesTotal>
<![CDATA[select lc.rgn_no,
CASE WHEN nume_den.ACTL_SLS_TOT_WTSR = 0 AND nume_den.ACTL_CUST_TOT_WTSR = 0 THEN 0
WHEN nume_den.ACTL_SLS_TOT_WTSR = 0 THEN 0 WHEN nume_den.ACTL_CUST_TOT_WTSR = 0 THEN 0
ELSE NVL(ROUND((nume_den.ACTL_SLS_TOT_WTSR / nume_den.ACTL_CUST_TOT_WTSR),2),0) END as AVG_BASKET_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSR,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no IN (85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) nume_den
on nume_den.rgn_no=lc.rgn_no order by lc.rgn_no]]> 
  </AvgBasketSalesTotal>
  
  <WkyMixSales>
<![CDATA[select lc.zone_no,
CASE WHEN NVL(nume_den.ACTL_SLS_WTSR,0) = 0 AND NVL(nume_den.ACTL_SLS_TOT_WTSR,0) = 0 THEN 0
WHEN nume_den.ACTL_SLS_WTSR = 0 THEN 0 WHEN NVL(nume_den.ACTL_SLS_TOT_WTSR,0) = 0 THEN 0
ELSE ROUND((nume_den.ACTL_SLS_WTSR / nume_den.ACTL_SLS_TOT_WTSR)*100,2) END as WKY_MIX_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' 
order by b.zone_no) lc
LEFT OUTER JOIN
(select nume.zone_no,nume.ACTL_SLS_WTSR,den.ACTL_SLS_TOT_WTSR from 
(select lc.zone_no,NVL(sls.ACTL_SLS_WTSR,0) as ACTL_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' 
order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR from 
(select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk order by e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) sls
on lc.zone_no=sls.zone_no order by lc.zone_no) nume,
(select lc.rgn_no,NVL(sls.ACTL_SLS_TOT_WTSR,0) as ACTL_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no)den) nume_den
on nume_den.zone_no=lc.zone_no order by lc.zone_no]]> 
  </WkyMixSales>
  
  <WkyMixSalesTotal>
<![CDATA[select nume_den.rgn_no,
CASE WHEN nume_den.ACTL_SLS_TOT_WTSR = 0 THEN 0 
ELSE ROUND((nume_den.ACTL_SLS_TOT_WTSR / nume_den.ACTL_SLS_TOT_WTSR)*100,2) END as WKY_MIX_SLS_TOT_WTSR from 
(select lc.rgn_no,NVL(sls.ACTL_SLS_TOT_WTSR,0) as ACTL_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) nume_den order by nume_den.rgn_no]]> 
  </WkyMixSalesTotal>
  
</TCName>
  
<TCName name="ItemsColumnValidation">  
  
  <PlannedItems>
<![CDATA[select lc.zone_no,NVL(ROUND(itm.PLN_ITM_WTSR,0),0) as PLN_ITM_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.PLN_ITM_DTS) as PLN_ITM_WTSR from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.dply_seq,e.loc_no,e.day_of_wk 
order by e.dply_seq,e.loc_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk 
order by e.zone_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk 
order by e.zone_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.zone_no order by h.zone_no) itm
on lc.zone_no=itm.zone_no order by lc.zone_no]]> 
  </PlannedItems>
  
  <PlannedItemsTotal>
<![CDATA[select lc.rgn_no,NVL(ROUND(itm.PLN_ITM_TOT_WTSR,0),0) as PLN_ITM_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_WTSR from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.rgn_no order by h.rgn_no) itm
on lc.rgn_no=itm.rgn_no order by lc.rgn_no]]> 
  </PlannedItemsTotal>
  
  <ActualItems>
<![CDATA[select lc.zone_no,NVL(ROUND(itm.ACTL_ITM_WTSR,0),0) as ACTL_ITM_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_ITM_DTS) as ACTL_ITM_WTSR from 
(select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk order by e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) itm
on lc.zone_no=itm.zone_no order by lc.zone_no]]> 
  </ActualItems>
  
  <ActualItemsTotal>
<![CDATA[select lc.rgn_no,NVL(ROUND(itm.ACTL_ITM_TOT_WTSR,0),0) as ACTL_ITM_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) itm
on lc.rgn_no=itm.rgn_no order by lc.rgn_no]]> 
  </ActualItemsTotal>

    <PlannedItemPrice>
<![CDATA[select lc.zone_no,
case when NVL(sls_itm.PLN_SLS_WTSR,0)=0 and NVL(sls_itm.PLN_ITM_WTSR,0)=0 then 0
when NVL(sls_itm.PLN_SLS_WTSR,0)=0 then 0 when NVL(sls_itm.PLN_ITM_WTSR,0)=0 then 0 
else NVL(ROUND((sls_itm.PLN_SLS_WTSR / sls_itm.PLN_ITM_WTSR),2),0) END as PLN_ITMPRZ_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSR,sum(h.PLN_ITM_DTS) as PLN_ITM_WTSR from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.dply_seq,e.loc_no,e.day_of_wk 
order by e.dply_seq,e.loc_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk 
order by e.zone_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk 
order by e.zone_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.zone_no order by h.zone_no) sls_itm
on lc.zone_no=sls_itm.zone_no order by lc.zone_no]]> 
  </PlannedItemPrice>
  
  <PlannedItemPriceTotal>
<![CDATA[select lc.rgn_no,
case when NVL(sls_itm.PLN_SLS_TOT_WTSR,0)=0 and NVL(sls_itm.PLN_ITM_TOT_WTSR,0)=0 then 0
when NVL(sls_itm.PLN_SLS_TOT_WTSR,0)=0 then 0 when NVL(sls_itm.PLN_ITM_TOT_WTSR,0)=0 then 100 
else NVL(ROUND((sls_itm.PLN_SLS_TOT_WTSR / sls_itm.PLN_ITM_TOT_WTSR),2),0) END as PLN_ITMPRZ_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSR,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_WTSR from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.rgn_no order by h.rgn_no) sls_itm
on lc.rgn_no=sls_itm.rgn_no order by lc.rgn_no]]> 
  </PlannedItemPriceTotal>
  
  <ActualItemPrice>
<![CDATA[select lc.zone_no,
CASE WHEN NVL(sls_itm.ACTL_SLS_WTSR,0)=0 AND NVL(sls_itm.ACTL_ITM_WTSR,0)=0 THEN 0 
WHEN NVL(sls_itm.ACTL_SLS_WTSR,0)=0 THEN 0 WHEN NVL(sls_itm.ACTL_ITM_WTSR,0)=0 THEN 0 
ELSE NVL(ROUND((sls_itm.ACTL_SLS_WTSR / sls_itm.ACTL_ITM_WTSR),2),0) END as ACTL_ITMPRZ_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR,sum(h.ACTL_ITM_DTS) as ACTL_ITM_WTSR from 
(select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk order by e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) sls_itm
on lc.zone_no=sls_itm.zone_no order by lc.zone_no]]> 
  </ActualItemPrice>
  
  <ActualItemPriceTotal>
<![CDATA[select lc.rgn_no,
CASE WHEN NVL(sls_itm.ACTL_SLS_TOT_WTSR,0)=0 AND NVL(sls_itm.ACTL_ITM_TOT_WTSR,0)=0 THEN 0 
WHEN NVL(sls_itm.ACTL_SLS_TOT_WTSR,0)=0 THEN 0 WHEN NVL(sls_itm.ACTL_ITM_TOT_WTSR,0)=0 THEN 0 
ELSE NVL(ROUND((sls_itm.ACTL_SLS_TOT_WTSR / sls_itm.ACTL_ITM_TOT_WTSR),2),0) END as ACTL_ITMPRZ_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSR,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) sls_itm
on lc.rgn_no=sls_itm.rgn_no order by lc.rgn_no]]> 
  </ActualItemPriceTotal>
  
</TCName>  
  
<TCName name="CustomersColumnValidation">  
  
  <ThisYrActlCustomers>
<![CDATA[select lc.zone_no,NVL(ROUND(itm.ACTL_CUST_WTSR,0),0) as ACTL_CUST_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSR from 
(select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no IN (85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk order by e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) itm
on lc.zone_no=itm.zone_no order by lc.zone_no]]> 
  </ThisYrActlCustomers>
  
  <ThisYrActlCustomersTotal>
<![CDATA[select lc.rgn_no,NVL(ROUND(itm.ACTL_CUST_TOT_WTSR,0),0) as ACTL_CUST_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no IN (85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) itm
on lc.rgn_no=itm.rgn_no order by lc.rgn_no]]> 
  </ThisYrActlCustomersTotal>
  
  <PctLastYrCustomers>
<![CDATA[select lc.zone_no,
CASE  WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN 0 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0   
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select cy_val.zone_no,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.zone_no,NVL(sls.ACTL_CUST_WTSR,0) as WTD from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSR from 
(select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no IN (85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk order by e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) sls
on lc.zone_no=sls.zone_no order by lc.zone_no) cy_val
LEFT OUTER JOIN
(select lc.zone_no,NVL(sls.ACTL_CUST_WTSR,0) as WTD from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSR from 
(select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no IN (85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk order by e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) sls
on lc.zone_no=sls.zone_no order by lc.zone_no) ly_val
on cy_val.zone_no=ly_val.zone_no  
group by cy_val.zone_no) cyly_wtd
on cyly_wtd.zone_no=lc.zone_no order by lc.zone_no]]> 
  </PctLastYrCustomers>
  
  <PctLastYrCustomersTotal>
<![CDATA[select lc.rgn_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select cy_val.rgn_no,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.rgn_no,NVL(sls.ACTL_CUST_WTSR,0) as WTD from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSR from 
(select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no IN (85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) cy_val
LEFT OUTER JOIN
(select lc.rgn_no,NVL(sls.ACTL_CUST_WTSR,0) as WTD from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSR from 
(select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no IN (85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) ly_val
on cy_val.rgn_no=ly_val.rgn_no 
group by cy_val.rgn_no ) cyly_wtd
on cyly_wtd.rgn_no=lc.rgn_no order by lc.rgn_no]]> 
  </PctLastYrCustomersTotal>
  
  <DataPenetrationCustomers>
<![CDATA[select nume_den.zone_no,
CASE When nume_den.ACTL_CUST_WTSR=0 and nume_den.ACTL_CUST_TOT_WTSR=0 Then 0
When nume_den.ACTL_CUST_WTSR=0 Then 0 when nume_den.ACTL_CUST_TOT_WTSR=0 Then 0
ELSE ROUND((nume_den.ACTL_CUST_WTSR / nume_den.ACTL_CUST_TOT_WTSR)*100,2) END as DATA_PEN_CUST_WTSR from
(select nume.zone_no,NVL(nume.ACTL_CUST_WTSR,0) as ACTL_CUST_WTSR,NVL(den.ACTL_CUST_TOT_WTSR,0) as ACTL_CUST_TOT_WTSR from 
(select lc.zone_no,itm.ACTL_CUST_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSR from 
(select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no IN (85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk order by e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) itm
on lc.zone_no=itm.zone_no order by lc.zone_no) nume,
(select lc.rgn_no,itm.ACTL_CUST_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no IN (85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) itm
on lc.rgn_no=itm.rgn_no order by lc.rgn_no) den order by nume.zone_no) nume_den order by nume_den.zone_no]]> 
  </DataPenetrationCustomers>
  
  <DataPenetrationCustomersTotal>
<![CDATA[select nume_den.rgn_no,
CASE When nume_den.ACTL_CUST_TOT_WTSR=0 Then 0 
ELSE ROUND((nume_den.ACTL_CUST_TOT_WTSR / nume_den.ACTL_CUST_TOT_WTSR)*100,2) END as DATA_PEN_CUST_TOT_WTSR from 
(select lc.rgn_no,NVL(itm.ACTL_CUST_TOT_WTSR,0) as ACTL_CUST_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no IN (85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) itm
on lc.rgn_no=itm.rgn_no order by lc.rgn_no) nume_den order by nume_den.rgn_no]]> 
  </DataPenetrationCustomersTotal>
  
</TCName>  
  
<TCName name="HoursColumnValidation">  
  
  <ActualHours>
<![CDATA[select lc.zone_no,NVL(ROUND(hrs.ACTL_HRS_DTS,2),0) as ACTL_HRS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) hrs
on hrs.zone_no=lc.zone_no order by lc.zone_no]]> 
  </ActualHours>
  
  <ActualHoursTotal>
<![CDATA[select lc.rgn_no,NVL(ROUND(hrs.ACTL_HRS_DTS,2),0) as ACTL_HRS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) hrs
on hrs.rgn_no=lc.rgn_no order by lc.rgn_no]]> 
  </ActualHoursTotal>
  
  <CurrentActualHours>
<![CDATA[select z.loc_nm,NVL(ROUND(y.ACTL_HOURS_WTSR,2),0) as ACTL_HRS_WTSR from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) z
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_WTSR,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on z.loc_no=y.loc_no order by z.loc_no]]> 
  </CurrentActualHours>
  
  <CurrentActualHoursTotal>
<![CDATA[select lc.ar_no,NVL(ROUND(y.ACTL_HOURS_TOT_WTSR,2),0) as ACTL_HRS_TOT_WTSR from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_WTSR,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no order by e.ar_no) y
on lc.ar_no=y.ar_no order by lc.ar_no]]> 
  </CurrentActualHoursTotal>
  
    <PlannedHours>
<![CDATA[select z.zone_no,NVL(ROUND(y.PLN_HOURS_WTSR,2),0) as PLN_HRS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) z
LEFT OUTER JOIN
(select e.zone_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) y
on z.zone_no=y.zone_no order by z.zone_no]]> 
  </PlannedHours>
  
  <PlannedHoursTotal>
<![CDATA[select lc.rgn_no,NVL(ROUND(hrs.PLN_HOURS_TOT_WTSR,2),0) as PLN_HRS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) hrs
on hrs.rgn_no=lc.rgn_no order by lc.rgn_no]]> 
  </PlannedHoursTotal>
  
  <CurrentPlannedHours>
<![CDATA[select z.loc_nm,NVL(ROUND(y.PLN_HOURS_WTSR,2),0) as PLN_HRS_WTSR from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) z
LEFT OUTER JOIN
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) y
on z.loc_no=y.loc_no order by z.loc_no]]> 
  </CurrentPlannedHours>
  
  <CurrentPlannedHoursTotal>
<![CDATA[select lc.ar_no,NVL(ROUND(sum(hrs.PLN_HOURS_TOT_WTSR),2),0) as PLN_HRS_TOT_WTSR from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) hrs
on hrs.ar_no=lc.ar_no group by lc.ar_no]]> 
  </CurrentPlannedHoursTotal>
  
  <VarHours>
<![CDATA[select pln.zone_no,ROUND((actl.ACTL_HRS_WTSR - pln.PLN_HRS_WTSR),2) as VAR_HRS_WTSR from 
(select z.zone_no,NVL(y.PLN_HOURS_WTSR,0) as PLN_HRS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) z
LEFT OUTER JOIN
(select e.zone_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) y
on z.zone_no=y.zone_no order by z.zone_no) pln,
(select lc.zone_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) hrs
on hrs.zone_no=lc.zone_no order by lc.zone_no) actl
where pln.zone_no=actl.zone_no order by pln.zone_no]]> 
  </VarHours>
  
  <VarHoursTotal>
<![CDATA[select pln.rgn_no,ROUND((actl.ACTL_HRS_TOT_WTSR - pln.PLN_HRS_TOT_WTSR),2) as VAR_HRS_TOT_WTSR from 
(select lc.rgn_no,NVL(hrs.PLN_HOURS_TOT_WTSR,0) as PLN_HRS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) hrs
on hrs.rgn_no=lc.rgn_no order by lc.rgn_no) pln,
(select lc.rgn_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) hrs
on hrs.rgn_no=lc.rgn_no order by lc.rgn_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]> 
  </VarHoursTotal>
  
  <CurrentVarHours>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_HRS_WTSR - pln.PLN_HRS_WTSR),2) as VAR_HRS_WTSR from 
(select z.loc_nm,NVL(y.PLN_HOURS_WTSR,0) as PLN_HRS_WTSR from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) z
LEFT OUTER JOIN
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) y
on z.loc_no=y.loc_no order by z.loc_no) pln,
(select z.loc_nm,NVL(y.ACTL_HOURS_WTSR,0) as ACTL_HRS_WTSR from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) z
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_WTSR,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on z.loc_no=y.loc_no order by z.loc_no) actl
where pln.loc_nm=actl.loc_nm order by pln.loc_nm]]> 
  </CurrentVarHours>
  
  <CurrentVarHoursTotal>
<![CDATA[select pln.ar_no,ROUND((actl.ACTL_HRS_TOT_WTSR - pln.PLN_HRS_TOT_WTSR),2) as VAR_HRS_TOT_WTSR from 
(select lc.ar_no,NVL(sum(hrs.PLN_HOURS_TOT_WTSR),0) as PLN_HRS_TOT_WTSR from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) hrs
on hrs.ar_no=lc.ar_no group by lc.ar_no) pln,
(select lc.ar_no,NVL(sum(hrs.PLN_HOURS_TOT_WTSR),0) as PLN_HRS_TOT_WTSR from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) hrs
on hrs.ar_no=lc.ar_no group by lc.ar_no) actl
where pln.ar_no=actl.ar_no order by pln.ar_no]]> 
  </CurrentVarHoursTotal>
  
  <ActualSMS>
	<![CDATA[select lc.zone_no,NVL(ROUND(sum(xy.ACTL_SMS_DTSG),2),0) as ACTL_SMS_WTSR from 
(select distinct zone_no from loc where div_no='Division' and rgn_no='Region' order by zone_no) lc
LEFT OUTER JOIN
(select  zone_no,ar_no,Sum(ACTL_SMS_DTSG) as ACTL_SMS_DTSG from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as ACTL_SMS_DTSG
from
(select LL.task_no,LL.task_nm,LL.div_no,LL.rgn_no,LL.zone_no,LL.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select 
Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, 
dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' and rgn_no='Region' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by zone_no,ar_no order by zone_no,ar_no) xy
on lc.zone_no=xy.zone_no group by lc.zone_no order by lc.zone_no]]> 
</ActualSMS>
  
<ActualSMSTotal>
	<![CDATA[select lc.rgn_no,NVL(ROUND(sum(xy.ACTL_SMS_DTSG),2),0) as ACTL_SMS_TOT_WTSR from 
(select distinct rgn_no from loc where div_no='Division' and rgn_no='Region' order by rgn_no) lc
LEFT OUTER JOIN
(select  rgn_no,Sum(ACTL_SMS_DTSG) as ACTL_SMS_DTSG from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as ACTL_SMS_DTSG
from
(select LL.task_no,LL.task_nm,LL.div_no,LL.rgn_no,LL.zone_no,LL.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select 
Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, 
dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' and rgn_no='Region' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
on lc.rgn_no=xy.rgn_no group by lc.rgn_no order by lc.rgn_no]]> 
</ActualSMSTotal>
  
<ORPercentage>
	<![CDATA[select actl_sms.zone_no,
	case when NVL(actl_sms.ACTL_SMS_WTSR,0)=0 and NVL(actl_hrs.ACTL_HRS_WTSR,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_WTSR,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_WTSR,0)=0 then 0 
	else NVL(ROUND((actl_sms.ACTL_SMS_WTSR / actl_hrs.ACTL_HRS_WTSR)*100,2),0) end as ACTL_OR_WTSR from
(select lc.zone_no,NVL(sum(xy.ACTL_SMS_DTSG),0) as ACTL_SMS_WTSR from 
(select distinct zone_no from loc where div_no='Division' and rgn_no='Region' order by zone_no) lc
LEFT OUTER JOIN
(select  zone_no,ar_no,Sum(ACTL_SMS_DTSG) as ACTL_SMS_DTSG from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as ACTL_SMS_DTSG
from
(select LL.task_no,LL.task_nm,LL.div_no,LL.rgn_no,LL.zone_no,LL.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select 
Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, 
dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' and rgn_no='Region' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by zone_no,ar_no order by zone_no,ar_no) xy
on lc.zone_no=xy.zone_no group by lc.zone_no order by lc.zone_no) actl_sms,
(select lc.zone_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) hrs
on hrs.zone_no=lc.zone_no order by lc.zone_no) actl_hrs
where actl_hrs.zone_no=actl_sms.zone_no order by actl_sms.zone_no]]> 
</ORPercentage>
  
<ORPercentageTotal>
	<![CDATA[select actl_sms.rgn_no,
	case when NVL(actl_sms.ACTL_SMS_TOT_WTSR,0)=0 and NVL(actl_hrs.ACTL_HRS_TOT_WTSR,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_TOT_WTSR,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_TOT_WTSR,0)=0 then 0 
	else NVL(ROUND((actl_sms.ACTL_SMS_TOT_WTSR / actl_hrs.ACTL_HRS_TOT_WTSR)*100,2),0) end as ACTL_OR_TOT_WTSR from
(select lc.rgn_no,NVL(sum(xy.ACTL_SMS_DTSG),0) as ACTL_SMS_TOT_WTSR from 
(select distinct rgn_no from loc where div_no='Division' and rgn_no='Region' order by rgn_no) lc
LEFT OUTER JOIN
(select  rgn_no,Sum(ACTL_SMS_DTSG) as ACTL_SMS_DTSG from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as ACTL_SMS_DTSG
from
(select LL.task_no,LL.task_nm,LL.div_no,LL.rgn_no,LL.zone_no,LL.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select 
Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, 
dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' and rgn_no='Region' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
on lc.rgn_no=xy.rgn_no group by lc.rgn_no order by lc.rgn_no)actl_sms,
(select lc.rgn_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) hrs
on hrs.rgn_no=lc.rgn_no order by lc.rgn_no)actl_hrs
where actl_hrs.rgn_no=actl_sms.rgn_no order by actl_sms.rgn_no]]> 
</ORPercentageTotal>

<VarianceSMS>
	<![CDATA[select actl_hrs.zone_no,NVL(ROUND((actl_hrs.ACTL_HRS_WTSR - actl_sms.ACTL_SMS_WTSR),2),0) as VAR_SMS_WTSR from 
(select lc.zone_no,NVL(ROUND(sum(xy.ACTL_SMS_DTSG),2),0) as ACTL_SMS_WTSR from 
(select distinct zone_no from loc where div_no='Division' and rgn_no='Region' order by zone_no) lc
LEFT OUTER JOIN
(select  zone_no,ar_no,Sum(ACTL_SMS_DTSG) as ACTL_SMS_DTSG from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as ACTL_SMS_DTSG
from
(select LL.task_no,LL.task_nm,LL.div_no,LL.rgn_no,LL.zone_no,LL.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select 
Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, 
dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' and rgn_no='Region' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by zone_no,ar_no order by zone_no,ar_no) xy
on lc.zone_no=xy.zone_no group by lc.zone_no order by lc.zone_no) actl_sms,
(select lc.zone_no,NVL(ROUND(hrs.ACTL_HRS_DTS,2),0) as ACTL_HRS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) hrs
on hrs.zone_no=lc.zone_no order by lc.zone_no) actl_hrs
where actl_hrs.zone_no=actl_sms.zone_no order by actl_sms.zone_no]]> 
</VarianceSMS>
  
<VarianceSMSTotal>
	<![CDATA[select actl_hrs.rgn_no,NVL(ROUND((actl_hrs.ACTL_HRS_TOT_WTSR - actl_sms.ACTL_SMS_TOT_WTSR),2),0) as VAR_SMS_TOT_WTSR from 
(select lc.rgn_no,NVL(ROUND(sum(xy.ACTL_SMS_DTSG),2),0) as ACTL_SMS_TOT_WTSR from 
(select distinct rgn_no from loc where div_no='Division' and rgn_no='Region' order by rgn_no) lc
LEFT OUTER JOIN
(select  rgn_no,Sum(ACTL_SMS_DTSG) as ACTL_SMS_DTSG from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as ACTL_SMS_DTSG
from
(select LL.task_no,LL.task_nm,LL.div_no,LL.rgn_no,LL.zone_no,LL.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select 
Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, 
dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' and rgn_no='Region' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
on lc.rgn_no=xy.rgn_no group by lc.rgn_no order by lc.rgn_no)actl_sms,
(select lc.rgn_no,NVL(ROUND(hrs.ACTL_HRS_DTS,2),0) as ACTL_HRS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) hrs
on hrs.rgn_no=lc.rgn_no order by lc.rgn_no)actl_hrs
where actl_hrs.rgn_no=actl_sms.rgn_no order by actl_sms.rgn_no]]> 
</VarianceSMSTotal>
  
</TCName>


<TCName name = "WagesColumnValidation" >

  <ActualWages>
<![CDATA[select lc.zone_no,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) hrs
on hrs.zone_no=lc.zone_no order by lc.zone_no]]> 
  </ActualWages>
  
  <ActualWagesTotal>
<![CDATA[select lc.rgn_no,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) hrs
on hrs.rgn_no=lc.rgn_no order by lc.rgn_no]]> 
  </ActualWagesTotal>
  
  <ActualWagePercentage>
<![CDATA[select nume_den.zone_no,
CASE When nume_den.ACTL_WGE_WTSR=0 and nume_den.ACTL_SLS_WTSR=0 Then 0
When nume_den.ACTL_WGE_WTSR=0 Then 0 when nume_den.ACTL_SLS_WTSR=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_WTSR / nume_den.ACTL_SLS_WTSR)*100,2) END as ACTL_WGE_PCT_WTSR from 
(select nume.zone_no,NVL(nume.ACTL_WGE_WTSR,0) as ACTL_WGE_WTSR,NVL(den.ACTL_SLS_WTSR,0) as ACTL_SLS_WTSR from 
(select lc.zone_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) hrs
on hrs.zone_no=lc.zone_no order by lc.zone_no) nume,
(select lc.zone_no,NVL(sls.ACTL_SLS_WTSR,0) as ACTL_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR from 
(select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk order by e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) sls
on lc.zone_no=sls.zone_no order by lc.zone_no) den 
where nume.zone_no=den.zone_no) nume_den order by nume_den.zone_no]]> 
  </ActualWagePercentage>
  
  <ActualWagePercentageTotal>
<![CDATA[select nume_den.rgn_no,
CASE When nume_den.ACTL_WGE_TOT_WTSR=0 and nume_den.ACTL_SLS_TOT_WTSR=0 Then 0
When nume_den.ACTL_WGE_TOT_WTSR=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSR=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_TOT_WTSR / nume_den.ACTL_SLS_TOT_WTSR)*100,2) END as ACTL_WGE_PCT_TOT_WTSR from 
(select nume.rgn_no,NVL(nume.ACTL_WGE_TOT_WTSR,0) as ACTL_WGE_TOT_WTSR,NVL(den.ACTL_SLS_TOT_WTSR,0) as ACTL_SLS_TOT_WTSR from 
(select lc.rgn_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) hrs
on hrs.rgn_no=lc.rgn_no order by lc.rgn_no) nume,
(select lc.rgn_no,NVL(sls.ACTL_SLS_TOT_WTSR,0) as ACTL_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) den 
where nume.rgn_no=den.rgn_no) nume_den order by nume_den.rgn_no]]> 
  </ActualWagePercentageTotal>
 
  <BudgetWages>
<![CDATA[select lc.zone_no,NVL(ROUND(bdgt.BDGT_WAGE_WTSR,0),0) as BDGT_WGE_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,sum(e.bdgt_wage_amt) as BDGT_WAGE_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.zone_no order by e.zone_no) bdgt
on lc.zone_no=bdgt.zone_no order by lc.zone_no]]> 
  </BudgetWages>
  
  <BudgetWagesTotal>
<![CDATA[select lc.rgn_no,NVL(ROUND(bdgt.BDGT_WAGE_TOT_WTSR,0),0) as BDGT_WGE_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.bdgt_wage_amt) as BDGT_WAGE_TOT_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no]]> 
  </BudgetWagesTotal>
  
  <ForecastWages>
<![CDATA[select lc.zone_no,NVL(ROUND(fcst.FCST_WAGE_WTSR,0),0) as FCST_WGE_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,sum(e.frcst_wage_amt) as FCST_WAGE_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.zone_no order by e.zone_no) fcst
on lc.zone_no=fcst.zone_no order by lc.zone_no]]> 
  </ForecastWages>
  
  <ForecastWagesTotal>
<![CDATA[select lc.rgn_no,NVL(ROUND(fcst.FCST_WAGE_TOT_WTSR,0),0) as FCST_WGE_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.frcst_wage_amt) as FCST_WAGE_TOT_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) fcst
on lc.rgn_no=fcst.rgn_no order by lc.rgn_no]]> 
  </ForecastWagesTotal>
  
  <BudgetWagePercentage>
<![CDATA[select wge.zone_no,
CASE When wge.BDGT_WGE_WTSR=0 and sls.BDGT_SLS_WTSR=0 Then 0
When wge.BDGT_WGE_WTSR=0 Then 0 When sls.BDGT_SLS_WTSR=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_WTSR / sls.BDGT_SLS_WTSR)*100,2),0) END as BDGT_WGE_PCT_WTSR from 
(select lc.zone_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.zone_no=bdgt.zone_no
group by lc.zone_no order by lc.zone_no) wge,
(select lc.zone_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.zone_no=bdgt.zone_no
group by lc.zone_no order by lc.zone_no) sls
where wge.zone_no=sls.zone_no order by wge.zone_no]]> 
  </BudgetWagePercentage>
  
  <BudgetWagePercentageTotal>
<![CDATA[select wge.rgn_no,
CASE When wge.BDGT_WGE_TOT_WTSR=0 and sls.BDGT_SLS_TOT_WTSR=0 Then 0
When wge.BDGT_WGE_TOT_WTSR=0 Then 0 When sls.BDGT_SLS_TOT_WTSR=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_WTSR / sls.BDGT_SLS_TOT_WTSR)*100,2),0) END as BDGT_WGE_PCT_TOT_WTSR from 
(select lc.rgn_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no]]> 
  </BudgetWagePercentageTotal>
  
  <ForecastWagePercentage>
<![CDATA[select wge.zone_no,
CASE When wge.FCST_WGE_WTSR=0 and sls.FCST_SLS_WTSR=0 Then 0
When wge.FCST_WGE_WTSR=0 Then 0 When sls.FCST_SLS_WTSR=0 Then 0
ELSE NVL(ROUND((wge.FCST_WGE_WTSR / sls.FCST_SLS_WTSR)*100,2),0) END as FCST_WGE_PCT_WTSR from 
(select lc.zone_no,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.zone_no=fcst.zone_no
group by lc.zone_no order by lc.zone_no) wge,
(select lc.zone_no,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.zone_no=fcst.zone_no
group by lc.zone_no order by lc.zone_no) sls
where wge.zone_no=sls.zone_no order by wge.zone_no]]> 
  </ForecastWagePercentage>
  
  <ForecastWagePercentageTotal>
<![CDATA[select wge.rgn_no,
CASE When wge.FCST_WGE_TOT_WTSR=0 and sls.FCST_SLS_TOT_WTSR=0 Then 0
When wge.FCST_WGE_TOT_WTSR=0 Then 0 When sls.FCST_SLS_TOT_WTSR=0 Then 0
ELSE NVL(ROUND((wge.FCST_WGE_TOT_WTSR / sls.FCST_SLS_TOT_WTSR)*100,2),0) END as FCST_WGE_PCT_TOT_WTSR from 
(select lc.rgn_no,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.rgn_no=fcst.rgn_no
group by lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.rgn_no=fcst.rgn_no
group by lc.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no]]> 
  </ForecastWagePercentageTotal>
  
  <PlannedWages>
<![CDATA[select z.zone_no,NVL(ROUND(y.PLN_WAGE_WTSR,0),0) as PLN_WGE_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) z
LEFT OUTER JOIN
(select e.zone_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) y
on z.zone_no=y.zone_no order by z.zone_no]]> 
  </PlannedWages>
  
  <PlannedWagesTotal>
<![CDATA[select lc.rgn_no,NVL(ROUND(wge.PLN_WAGE_WTSR,0),0) as PLN_WGE_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no]]> 
  </PlannedWagesTotal>
  
  <PlannedWagesPercentage>
<![CDATA[select wge.zone_no,
CASE When wge.PLN_WGE_WTSR=0 and sls.PLN_SLS_WTSR=0 Then 0 
When wge.PLN_WGE_WTSR=0 Then 0 When sls.PLN_SLS_WTSR=0 Then 0 
ELSE NVL(ROUND((wge.PLN_WGE_WTSR / sls.PLN_SLS_WTSR)*100,2),0) END as PLN_WGE_PRCNT_WTSR from
(select z.zone_no,NVL(y.PLN_WAGE_WTSR,0) as PLN_WGE_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) z
LEFT OUTER JOIN
(select e.zone_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) y
on z.zone_no=y.zone_no order by z.zone_no) wge,
(select z.zone_no,NVL(y.PLN_SLS_WTSR,0) as PLN_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) z
LEFT OUTER JOIN
(select h.zone_no,sum(h.PLN_SLS_WTSR) as PLN_SLS_WTSR from 
(/*select * from 
(select e.zone_no,e.ar_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_WTSR,sum(e.refcst_itm_cnt) as PLN_ITM_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.zone_no,e.ar_no,e.day_of_wk 
order by e.zone_no,e.ar_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.zone_no,e.ar_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_WTSR,sum(e.mgr_pln_itm_cnt) as PLN_ITM_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and b.rgn_no='Region')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.zone_no,e.ar_no,e.day_of_wk 
order by e.zone_no,e.ar_no,e.day_of_wk) f
/*UNION
select * from 
(select e.zone_no,e.ar_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_WTSR,sum(e.gnrt_itm) as GEN_ITM_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and b.rgn_no='Region')
/*and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and b.rgn_no='Region')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.zone_no,e.ar_no,e.day_of_wk 
order by e.zone_no,e.ar_no,e.day_of_wk) g*/) sec_prty) h 
group by h.zone_no order by h.zone_no) y
on z.zone_no=y.zone_no order by z.zone_no) sls
where wge.zone_no=sls.zone_no order by wge.zone_no]]> 
  </PlannedWagesPercentage>
  
  <PlannedWagesPercentageTotal>
<![CDATA[select wge.rgn_no,
CASE When wge.PLN_WGE_TOT_WTSR=0 and sls.PLN_SLS_TOT_WTSR=0 Then 0 
When wge.PLN_WGE_TOT_WTSR=0 Then 0 When sls.PLN_SLS_TOT_WTSR=0 Then 0 
ELSE NVL(ROUND((wge.PLN_WGE_TOT_WTSR / sls.PLN_SLS_TOT_WTSR)*100,2),0) END as PLN_WGE_PRCNT_TOT_WTSR from
(select lc.rgn_no,sum(wge.PLN_WAGE_WTSR) as PLN_WGE_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,e.dply_seq,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no,e.zone_no,e.dply_seq 
order by e.rgn_no,e.zone_no,e.dply_seq) wge
on wge.rgn_no=lc.rgn_no 
group by lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,NVL(sls.PLN_SLS_WTSR,0) as PLN_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.PLN_SLS_WTSR) as PLN_SLS_WTSR from 
(/*select * from 
(select e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_WTSR,sum(e.refcst_itm_cnt) as PLN_ITM_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_WTSR,sum(e.mgr_pln_itm_cnt) as PLN_ITM_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and b.rgn_no='Region')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_WTSR,sum(e.gnrt_itm) as GEN_ITM_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and b.rgn_no='Region')
/*and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and b.rgn_no='Region')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no]]> 
  </PlannedWagesPercentageTotal>

  <AllowedWages>
<![CDATA[select src.zone_no,
case 
when src.ACTL_SLS_WTSR > src.BDGT_SLS_WTSR 
	then NVL(ROUND((((BDGT_WGE_PCT_WTSR * BDGT_SLS_WTSR) + ((ACTL_SLS_WTSR - BDGT_SLS_WTSR) * (PST_FACTOR_WTSR * BDGT_WGE_PCT_WTSR)))/100),0),0)
When src.ACTL_SLS_WTSR < src.BDGT_SLS_WTSR 
	then NVL(ROUND((((BDGT_WGE_PCT_WTSR * BDGT_SLS_WTSR) + ((ACTL_SLS_WTSR - BDGT_SLS_WTSR) * (NGT_FACTOR_WTSR * BDGT_WGE_PCT_WTSR)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_WTSR * ACTL_SLS_WTSR)/100),0),0) end as ALWD_WGE_WTSR from 

(select actl_sls.zone_no,rte_fct.wk_id,actl_sls.ACTL_SLS_WTSR,rte_fct.PST_FACTOR_WTSR,rte_fct.NGT_FACTOR_WTSR,
bdgt_wge_pct.BDGT_WGE_PCT_WTSR,bdgt_wge_pct.BDGT_WGE_WTSR,bdgt_wge_pct.BDGT_SLS_WTSR from

(select lc.zone_no,NVL(ROUND(sls.ACTL_SLS_WTSR,0),0) as ACTL_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR from 
(select * from 
(select e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.dply_seq,e.day_of_wk order by e.zone_no,e.dply_seq,e.day_of_wk) f) h 
group by h.zone_no order by h.zone_no) sls
on lc.zone_no=sls.zone_no order by lc.zone_no) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_WTSR,NVL(src.ngt_factor,1) as NGT_FACTOR_WTSR from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select wge.zone_no,NVL(ROUND(wge.BDGT_WGE_WTSR,0),0) as BDGT_WGE_WTSR, NVL(ROUND(sls.BDGT_SLS_WTSR,0),0) as BDGT_SLS_WTSR,
CASE When NVL(wge.BDGT_WGE_WTSR,0)=0 and NVL(sls.BDGT_SLS_WTSR,0)=0 Then 0
When NVL(wge.BDGT_WGE_WTSR,0)=0 Then 0 When NVL(sls.BDGT_SLS_WTSR,0)=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_WTSR / sls.BDGT_SLS_WTSR)*100,5),0) END as BDGT_WGE_PCT_WTSR from 
(select lc.zone_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.zone_no=bdgt.zone_no
group by lc.zone_no order by lc.zone_no) wge,
(select lc.zone_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.zone_no=bdgt.zone_no
group by lc.zone_no order by lc.zone_no) sls
where wge.zone_no=sls.zone_no) bdgt_wge_pct

where actl_sls.zone_no=bdgt_wge_pct.zone_no order by actl_sls.zone_no,rte_fct.wk_id) src order by src.zone_no ]]> 
  </AllowedWages>
  
  <AllowedWagesTotal>
<![CDATA[select src.rgn_no,
case 
when src.ACTL_SLS_TOT_WTSR > src.BDGT_SLS_TOT_WTSR 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_WTSR * BDGT_SLS_TOT_WTSR) + ((ACTL_SLS_TOT_WTSR - BDGT_SLS_TOT_WTSR) * (PST_FACTOR_TOT_WTSR * BDGT_WGE_PCT_TOT_WTSR)))/100),0),0)
When src.ACTL_SLS_TOT_WTSR < src.BDGT_SLS_TOT_WTSR 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_WTSR * BDGT_SLS_TOT_WTSR) + ((ACTL_SLS_TOT_WTSR - BDGT_SLS_TOT_WTSR) * (NGT_FACTOR_TOT_WTSR * BDGT_WGE_PCT_TOT_WTSR)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_TOT_WTSR * ACTL_SLS_TOT_WTSR)/100),0),0) end as ALWD_WGE_TOT_WTSR from 

(select actl_sls.rgn_no,rte_fct.wk_id,actl_sls.ACTL_SLS_TOT_WTSR,rte_fct.PST_FACTOR_TOT_WTSR,rte_fct.NGT_FACTOR_TOT_WTSR,
bdgt_wge_pct.BDGT_WGE_PCT_TOT_WTSR,bdgt_wge_pct.BDGT_WGE_TOT_WTSR,bdgt_wge_pct.BDGT_SLS_TOT_WTSR from

(select lc.rgn_no,NVL(ROUND(sls.ACTL_SLS_TOT_WTSR,0),0) as ACTL_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region'  and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk) f) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_TOT_WTSR,NVL(src.ngt_factor,1) as NGT_FACTOR_TOT_WTSR from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select wge.rgn_no,NVL(ROUND(wge.BDGT_WGE_TOT_WTSR,0),0) as BDGT_WGE_TOT_WTSR, NVL(ROUND(sls.BDGT_SLS_TOT_WTSR,0),0) as BDGT_SLS_TOT_WTSR,
CASE When NVL(wge.BDGT_WGE_TOT_WTSR,0)=0 and NVL(sls.BDGT_SLS_TOT_WTSR,0)=0 Then 0 
When NVL(wge.BDGT_WGE_TOT_WTSR,0)=0 Then 0 When NVL(sls.BDGT_SLS_TOT_WTSR,0)=0 Then 0 
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_WTSR / sls.BDGT_SLS_TOT_WTSR)*100,5),0) END as BDGT_WGE_PCT_TOT_WTSR from 
(select lc.rgn_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no) bdgt_wge_pct

where actl_sls.rgn_no=bdgt_wge_pct.rgn_no order by actl_sls.rgn_no,rte_fct.wk_id) src order by src.rgn_no ]]> 
  </AllowedWagesTotal>
  
  <PlannedCPH>
<![CDATA[select lc.zone_no,
CASE When NVL(wge.PLN_WAGE_WTSR,0)=0 and NVL(wge.PLN_HOURS_WTSR,0)=0 Then 0 
When NVL(wge.PLN_WAGE_WTSR,0)=0 Then 0 When NVL(wge.PLN_HOURS_WTSR,0)=0 Then 0 
ELSE NVL(ROUND((wge.PLN_WAGE_WTSR / wge.PLN_HOURS_WTSR),2),0) END as PLN_CPH_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) wge
on lc.zone_no=wge.zone_no order by lc.zone_no]]> 
  </PlannedCPH>
  
  <PlannedCPHTotal>
<![CDATA[select lc.rgn_no,
CASE When NVL(wge.PLN_WAGE_TOT_WTSR,0)=0 and NVL(wge.PLN_HOURS_TOT_WTSR,0)=0 Then 0 
When NVL(wge.PLN_WAGE_TOT_WTSR,0)=0 Then 0 When NVL(wge.PLN_HOURS_TOT_WTSR,0)=0 Then 0 
ELSE NVL(ROUND((wge.PLN_WAGE_TOT_WTSR / wge.PLN_HOURS_TOT_WTSR),2),0) END as PLN_CPH_TOT_WTSR from
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no]]> 
  </PlannedCPHTotal>
  
  <ActualCPH>
<![CDATA[select lc.zone_no,
CASE When NVL(wge.ACTL_WAGE_WTSR,0)=0 and NVL(wge.ACTL_HOURS_WTSR,0)=0 Then 0 
When NVL(wge.ACTL_WAGE_WTSR,0)=0 Then 0 When NVL(wge.ACTL_HOURS_WTSR,0)=0 Then 0 
ELSE NVL(ROUND((wge.ACTL_WAGE_WTSR / wge.ACTL_HOURS_WTSR),2),0) END as ACTL_CPH_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,sum(e.actl_wage_amt) as ACTL_WAGE_WTSR,sum(e.actl_hrs) as ACTL_HOURS_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) wge
on wge.zone_no=lc.zone_no order by lc.zone_no]]> 
  </ActualCPH>
  
  <ActualCPHTotal>
<![CDATA[select lc.rgn_no,
CASE When NVL(wge.ACTL_WAGE_TOT_WTSR,0)=0 and NVL(wge.ACTL_HOURS_TOT_WTSR,0)=0 Then 0 
When NVL(wge.ACTL_WAGE_TOT_WTSR,0)=0 Then 0 When NVL(wge.ACTL_HOURS_TOT_WTSR,0)=0 Then 0 
ELSE NVL(ROUND((wge.ACTL_WAGE_TOT_WTSR / wge.ACTL_HOURS_TOT_WTSR),2),0) END as ACTL_CPH_TOT_WTSR from
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WAGE_TOT_WTSR,sum(e.actl_hrs) as ACTL_HOURS_TOT_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no]]> 
  </ActualCPHTotal>
  
  <VarWages>
<![CDATA[select pln.zone_no,ROUND((actl.ACTL_WGE_PCT_WTSR - pln.BDGT_WGE_PCT_WTSR),2) as VAR_WGE_PCT_WTSR from 
(select nume_den.zone_no,
CASE When nume_den.ACTL_WGE_WTSR=0 and nume_den.ACTL_SLS_WTSR=0 Then 0
When nume_den.ACTL_WGE_WTSR=0 Then 0 when nume_den.ACTL_SLS_WTSR=0 Then 0
ELSE ((nume_den.ACTL_WGE_WTSR / nume_den.ACTL_SLS_WTSR)*100) END as ACTL_WGE_PCT_WTSR from 
(select nume.zone_no,NVL(nume.ACTL_WGE_WTSR,0) as ACTL_WGE_WTSR,NVL(den.ACTL_SLS_WTSR,0) as ACTL_SLS_WTSR from 
(select lc.zone_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) hrs
on hrs.zone_no=lc.zone_no order by lc.zone_no) nume,
(select lc.zone_no,NVL(sls.ACTL_SLS_WTSR,0) as ACTL_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR from 
(select * from 
(select e.zone_no,e.ar_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.ar_no,e.day_of_wk order by e.zone_no,e.ar_no,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) sls
on lc.zone_no=sls.zone_no order by lc.zone_no) den 
where nume.zone_no=den.zone_no) nume_den) actl,
(select wge.zone_no,
CASE When wge.BDGT_WGE_WTSR=0 and sls.BDGT_SLS_WTSR=0 Then 0
When wge.BDGT_WGE_WTSR=0 Then 0 When sls.BDGT_SLS_WTSR=0 Then 0
ELSE NVL((wge.BDGT_WGE_WTSR / sls.BDGT_SLS_WTSR)*100,0) END as BDGT_WGE_PCT_WTSR from 
(select lc.zone_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.zone_no=bdgt.zone_no
group by lc.zone_no order by lc.zone_no) wge,
(select lc.zone_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.zone_no=bdgt.zone_no
group by lc.zone_no order by lc.zone_no) sls
where wge.zone_no=sls.zone_no) pln
where pln.zone_no=actl.zone_no order by pln.zone_no]]> 
  </VarWages>
  
  <VarWagesTotal>
<![CDATA[select pln.rgn_no,ROUND((actl.ACTL_WGE_PCT_TOT_WTSR - pln.BDGT_WGE_PCT_TOT_WTSR),2) as VAR_WGE_TOT_WTSR from 
(select nume_den.rgn_no,
CASE When nume_den.ACTL_WGE_TOT_WTSR=0 and nume_den.ACTL_SLS_TOT_WTSR=0 Then 0
When nume_den.ACTL_WGE_TOT_WTSR=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSR=0 Then 0
ELSE ((nume_den.ACTL_WGE_TOT_WTSR / nume_den.ACTL_SLS_TOT_WTSR)*100) END as ACTL_WGE_PCT_TOT_WTSR from 
(select nume.rgn_no,NVL(nume.ACTL_WGE_TOT_WTSR,0) as ACTL_WGE_TOT_WTSR,NVL(den.ACTL_SLS_TOT_WTSR,0) as ACTL_SLS_TOT_WTSR from 
(select lc.rgn_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) hrs
on hrs.rgn_no=lc.rgn_no order by lc.rgn_no) nume,
(select lc.rgn_no,NVL(sls.ACTL_SLS_TOT_WTSR,0) as ACTL_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) den 
where nume.rgn_no=den.rgn_no) nume_den) actl,
(select wge.rgn_no,
CASE When wge.BDGT_WGE_TOT_WTSR=0 and sls.BDGT_SLS_TOT_WTSR=0 Then 0
When wge.BDGT_WGE_TOT_WTSR=0 Then 0 When sls.BDGT_SLS_TOT_WTSR=0 Then 0
ELSE NVL((wge.BDGT_WGE_TOT_WTSR / sls.BDGT_SLS_TOT_WTSR)*100,0) END as BDGT_WGE_PCT_TOT_WTSR from 
(select lc.rgn_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no) pln
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]> 
  </VarWagesTotal>
  
    <VarFcstWages>
<![CDATA[select pln.zone_no,ROUND((actl.ACTL_WGE_PCT_WTSR - pln.FCST_WGE_PCT_WTSR),2) as VAR_FCST_WGE_WTSR from 
(select nume_den.zone_no,
CASE When nume_den.ACTL_WGE_WTSR=0 and nume_den.ACTL_SLS_WTSR=0 Then 0
When nume_den.ACTL_WGE_WTSR=0 Then 0 when nume_den.ACTL_SLS_WTSR=0 Then 0
ELSE ((nume_den.ACTL_WGE_WTSR / nume_den.ACTL_SLS_WTSR)*100) END as ACTL_WGE_PCT_WTSR from 
(select nume.zone_no,NVL(nume.ACTL_WGE_WTSR,0) as ACTL_WGE_WTSR,NVL(den.ACTL_SLS_WTSR,0) as ACTL_SLS_WTSR from 
(select lc.zone_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select e.zone_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.zone_no order by e.zone_no) hrs
on hrs.zone_no=lc.zone_no order by lc.zone_no) nume,
(select lc.zone_no,NVL(sls.ACTL_SLS_WTSR,0) as ACTL_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select h.zone_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR from 
(select * from 
(select e.zone_no,e.ar_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.ar_no,e.day_of_wk order by e.zone_no,e.ar_no,e.day_of_wk) f ) h 
group by h.zone_no order by h.zone_no) sls
on lc.zone_no=sls.zone_no order by lc.zone_no) den 
where nume.zone_no=den.zone_no) nume_den) actl,
(select wge.zone_no,
CASE When wge.FCST_WGE_WTSR=0 and sls.FCST_SLS_WTSR=0 Then 0
When wge.FCST_WGE_WTSR=0 Then 0 When sls.FCST_SLS_WTSR=0 Then 0
ELSE NVL((wge.FCST_WGE_WTSR / sls.FCST_SLS_WTSR)*100,0) END as FCST_WGE_PCT_WTSR from 
(select lc.zone_no,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.zone_no=fcst.zone_no
group by lc.zone_no order by lc.zone_no) wge,
(select lc.zone_no,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_WTSR from 
(select distinct b.zone_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.zone_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.zone_no=fcst.zone_no
group by lc.zone_no order by lc.zone_no) sls
where wge.zone_no=sls.zone_no) pln
where pln.zone_no=actl.zone_no order by pln.zone_no]]> 
  </VarFcstWages>
  
  <VarFcstWagesTotal>
<![CDATA[select pln.rgn_no,ROUND((actl.ACTL_WGE_PCT_TOT_WTSR - pln.FCST_WGE_PCT_TOT_WTSR),2) as VAR_FCST_WGE_TOT_WTSR from 
(select nume_den.rgn_no,
CASE When nume_den.ACTL_WGE_TOT_WTSR=0 and nume_den.ACTL_SLS_TOT_WTSR=0 Then 0
When nume_den.ACTL_WGE_TOT_WTSR=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSR=0 Then 0
ELSE ((nume_den.ACTL_WGE_TOT_WTSR / nume_den.ACTL_SLS_TOT_WTSR)*100) END as ACTL_WGE_PCT_TOT_WTSR from 
(select nume.rgn_no,NVL(nume.ACTL_WGE_TOT_WTSR,0) as ACTL_WGE_TOT_WTSR,NVL(den.ACTL_SLS_TOT_WTSR,0) as ACTL_SLS_TOT_WTSR from 
(select lc.rgn_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) hrs
on hrs.rgn_no=lc.rgn_no order by lc.rgn_no) nume,
(select lc.rgn_no,NVL(sls.ACTL_SLS_TOT_WTSR,0) as ACTL_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSR from 
(select * from 
(select e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) den 
where nume.rgn_no=den.rgn_no) nume_den) actl,
(select wge.rgn_no,
CASE When wge.FCST_WGE_TOT_WTSR=0 and sls.FCST_SLS_TOT_WTSR=0 Then 0
When wge.FCST_WGE_TOT_WTSR=0 Then 0 When sls.FCST_SLS_TOT_WTSR=0 Then 0
ELSE NVL(((wge.FCST_WGE_TOT_WTSR / sls.FCST_SLS_TOT_WTSR)*100),0) END as FCST_WGE_PCT_TOT_WTSR from 
(select lc.rgn_no,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.rgn_no=fcst.rgn_no
group by lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_TOT_WTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.rgn_no='Region' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.rgn_no=fcst.rgn_no
group by lc.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no) pln
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]> 
  </VarFcstWagesTotal>
</TCName>

<TCName name = "SalesColumnValidationNewTable" >
	  <BudgetSales>
<![CDATA[select lc.fin_wk_no,NVL(bdgt.BDGT_SALES_TOT_WTSR,0) as BDGT_SLS_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_TOT_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
 /*and d.dept_no=ld.dept_no and a.loc_no=ld.loc_no*/
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.wk_id order by e.wk_id) bdgt
on lc.wk_id=bdgt.wk_id order by lc.wk_id]]> 
  </BudgetSales>
  
  <BudgetSalesTotal>
<![CDATA[select 'Total' as Tot,NVL(bdgt.BDGT_SALES_TOT_WTSR,0) as BDGT_SLS_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_TOT_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
 /*and d.dept_no=ld.dept_no and a.loc_no=ld.loc_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.perd_desc order by e.perd_desc) bdgt
on lc.perd_desc=bdgt.perd_desc]]> 
  </BudgetSalesTotal>
  
  <ForecastSales>
<![CDATA[select lc.fin_wk_no,NVL(bdgt.FCST_SALES_TOT_WTSR,0) as FCST_SLS_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,ROUND(sum(e.frcst_sls),0) as FCST_SALES_TOT_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
/*and d.dept_no=ld.dept_no and a.loc_no=ld.loc_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.wk_id order by e.wk_id) bdgt
on lc.wk_id=bdgt.wk_id order by lc.wk_id]]> 
  </ForecastSales>
  
  <ForecastSalesTotal>
<![CDATA[select 'Total' as Tot,NVL(bdgt.FCST_SALES_TOT_WTSR,0) as FCST_SLS_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,ROUND(sum(e.frcst_sls),0) as FCST_SALES_TOT_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
/*and d.dept_no=ld.dept_no and a.loc_no=ld.loc_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.perd_desc order by e.perd_desc) bdgt
on lc.perd_desc=bdgt.perd_desc]]> 
  </ForecastSalesTotal>
  
   	<MonthlyPlannedSales> 
	<![CDATA[select f.fin_wk_no,NVL(ROUND(e.PLAN_SALES,0),0) as PLN_SLS_WTSR from 
	(select distinct wk_id,fin_wk_no from ww_wlp.wk where perd_desc='Month' order by wk_id) f
	LEFT OUTER JOIN 
    (select z.wk_id,sum(PLAN_SALES) as PLAN_SALES from 
    (select * from 
    (select b.wk_id,c.zone_no,ROUND(sum(a.mgr_wky_sls),9) as PLAN_SALES 
    from ww_wlp.mgr_wky_pln a,wk b,loc c
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
  and a.div_no=c.div_no and a.loc_no=c.loc_no 
  group by b.wk_id,c.zone_no order by b.wk_id,c.zone_no) c 
    UNION 
    select * from 
    (select b.wk_id,c.zone_no,ROUND(sum(gnrt_sls),9) as GEN_SALES 
    from ww_wlp.fcst a,wk b,loc c
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.dept_no NOT IN (0,20,85,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
  and (a.loc_no,b.wk_id) NOT IN
	(select a.loc_no,b.wk_id from ww_wlp.mgr_wky_pln a,wk b,loc c
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
  and a.div_no=c.div_no and a.loc_no=c.loc_no)
  and a.div_no=c.div_no and a.loc_no=c.loc_no 
	group by b.wk_id,c.zone_no order by b.wk_id,c.zone_no) d) z 
    group by z.wk_id order by z.wk_id) e 
    on f.wk_id=e.wk_id order by f.wk_id]]>
	</MonthlyPlannedSales>
  
	<MonthlyPlannedSalesTotal>
	<![CDATA[select 'Total' as Tot,NVL(sum(e.PLAN_SALES),0) as PLN_SLS_TOT_WTSR from 
	(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
    (select z.perd_desc,z.wk_id,ROUND(sum(PLAN_SALES),0) as PLAN_SALES from 
    (select * from 
    (select b.perd_desc,b.wk_id,c.zone_no,ROUND(sum(a.mgr_wky_sls),9) as PLAN_SALES 
    from ww_wlp.mgr_wky_pln a,wk b,loc c
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
  and a.div_no=c.div_no and a.loc_no=c.loc_no 
  group by b.perd_desc,b.wk_id,c.zone_no order by b.perd_desc,b.wk_id,c.zone_no) c 
    UNION 
    select * from 
    (select b.perd_desc,b.wk_id,c.zone_no,ROUND(sum(gnrt_sls),9) as GEN_SALES 
    from ww_wlp.fcst a,wk b,loc c
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.dept_no NOT IN (0,20,85,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
  and (a.loc_no,b.wk_id) NOT IN
	(select a.loc_no,b.wk_id from ww_wlp.mgr_wky_pln a,wk b,loc c
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
  and a.div_no=c.div_no and a.loc_no=c.loc_no)
  and a.div_no=c.div_no and a.loc_no=c.loc_no 
	group by b.perd_desc,b.wk_id,c.zone_no order by b.perd_desc,b.wk_id,c.zone_no) d) z 
    group by z.perd_desc,z.wk_id order by z.perd_desc,z.wk_id) e 
    on lc.perd_desc=e.perd_desc]]>
	</MonthlyPlannedSalesTotal>
	
	<WeeklyPlannedSales>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(sls.PLN_SLS_WTSR,0),0) as PLN_SLS_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select h.wk_id,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSR from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy--, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
--and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region'))*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust 
from ww_wlp.fcst a, loc b, wk c , dept d, day dy/*, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and (b.zone_no,a.fcst_dte) NOT IN (select b.zone_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region'))
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region'))
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) g*/) sec_prty) h 
group by h.wk_id order by h.wk_id) sls
on lc.wk_id=sls.wk_id order by lc.wk_id]]> 
  </WeeklyPlannedSales>
  
  <WeeklyPlannedSalesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(sls.PLN_SLS_WTSR,0),0) as PLN_SLS_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select h.perd_desc,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSR from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy--, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
--and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region'))*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust 
from ww_wlp.fcst a, loc b, wk c , dept d, day dy/*, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and (b.zone_no,a.fcst_dte) NOT IN (select b.zone_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region'))
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region'))
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) g*/) sec_prty) h 
group by h.perd_desc order by h.perd_desc) sls
on lc.perd_desc=sls.perd_desc]]> 
  </WeeklyPlannedSalesTotal>
 
 
   <ActualSales>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(sls.ACTL_SLS_WTSR,0),0) as ACTL_SLS_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select h.wk_id,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) f ) h 
group by h.wk_id order by h.wk_id) sls
on lc.wk_id=sls.wk_id order by lc.wk_id]]> 
  </ActualSales>
  
  <ActualSalesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(sls.ACTL_SLS_WTSR,0),0) as ACTL_SLS_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select h.perd_desc,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) f ) h 
group by h.perd_desc order by h.perd_desc) sls
on lc.perd_desc=sls.perd_desc]]> 
  </ActualSalesTotal>
</TCName>

<TCName name = "WagesColumnValidationNewTable" >
 <BudgetWages>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(bdgt.BDGT_WAGE_TOT_WTSR,0),0) as BDGT_WGE_TOT_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.bdgt_wage_amt) as BDGT_WAGE_TOT_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.wk_id order by e.wk_id) bdgt
on lc.wk_id=bdgt.wk_id order by lc.wk_id]]> 
  </BudgetWages>
  
  <BudgetWagesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(bdgt.BDGT_WAGE_TOT_WTSR,0),0) as BDGT_WGE_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.bdgt_wage_amt) as BDGT_WAGE_TOT_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.perd_desc order by e.perd_desc) bdgt
on lc.perd_desc=bdgt.perd_desc]]> 
  </BudgetWagesTotal>
  
    <ForecastWages>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(fcst.FCST_WAGE_WTSR,0),0) as FCST_WGE_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.frcst_wage_amt) as FCST_WAGE_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.wk_id order by e.wk_id) fcst
on lc.wk_id=fcst.wk_id order by lc.wk_id]]> 
  </ForecastWages>
  
    <ForecastWagesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(fcst.FCST_WAGE_TOT_WTSR,0),0) as FCST_WGE_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.frcst_wage_amt) as FCST_WAGE_TOT_WTSR from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.perd_desc order by e.perd_desc) fcst
on lc.perd_desc=fcst.perd_desc]]> 
  </ForecastWagesTotal>
  
  	<MonthlyPlannedWages> --not able to verify
	<![CDATA[select lc.fin_wk_no,NVL(e.PLN_WAGE_WTSR,0) as PLN_WGE_WTSR from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
	LEFT OUTER JOIN 
  (select z.wk_id,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSR from 
  (select * from (select d.wk_id,d.zone_no,ROUND(sum(d.MGR_WKY_WGE),0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id,d.zone_no order by d.wk_id,d.zone_no) 
  UNION 
  select * from (select d.wk_id,d.zone_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id,d.zone_no order by d.wk_id,d.zone_no)) z
  group by z.wk_id order by z.wk_id) e 
  on e.wk_id=lc.wk_id order by lc.wk_id]]>
	</MonthlyPlannedWages>
	
  <MonthlyPlannedWagesTotal>
	<![CDATA[select lc.perd_desc,NVL(e.PLN_WAGE_WTSR,0) as PLN_WGE_TOT_WTSR from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSR from 
  (select * from (select d.perd_desc,d.zone_no,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.zone_no order by d.perd_desc,d.zone_no) 
  UNION 
  select * from (select d.perd_desc,d.zone_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c/* , loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.zone_no order by d.perd_desc,d.zone_no)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc]]>
	</MonthlyPlannedWagesTotal>
	
	  <WeeklyPlannedWages>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(wge.PLN_WAGE_WTSR,0),0) as PLN_WGE_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) wge
on wge.wk_id=lc.wk_id order by lc.wk_id]]> 
  </WeeklyPlannedWages>
  
    <WeeklyPlannedWagesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(wge.PLN_WAGE_WTSR,0),0) as PLN_WGE_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) wge
on wge.perd_desc=lc.perd_desc]]> 
  </WeeklyPlannedWagesTotal>
  
    <ActualWages>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) hrs
on hrs.wk_id=lc.wk_id order by lc.wk_id]]> 
  </ActualWages>
  
    <ActualWagesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) hrs
on hrs.perd_desc=lc.perd_desc]]> 
  </ActualWagesTotal>	
</TCName>

<TCName name = "WagePercentageColumnValidationNewTable" >
	<BudgetWagePercentage>
<![CDATA[select wge.fin_wk_no,
CASE When NVL(wge.BDGT_WGE_WTSR,0)=0 and NVL(sls.BDGT_SLS_WTSR,0)=0 Then 0
When NVL(wge.BDGT_WGE_WTSR,0)=0 Then 0 When NVL(sls.BDGT_SLS_WTSR,0)=0 Then 0
ELSE ROUND((wge.BDGT_WGE_WTSR / sls.BDGT_SLS_WTSR)*100,2) END as BDGT_WGE_PCT_WTSR from 
(select lc.fin_wk_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.wk_id=bdgt.wk_id 
group by lc.fin_wk_no order by lc.fin_wk_no) wge,
(select lc.fin_wk_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.wk_id=bdgt.wk_id 
group by lc.fin_wk_no order by lc.fin_wk_no) sls
where wge.fin_wk_no=sls.fin_wk_no order by wge.fin_wk_no]]> 
  </BudgetWagePercentage>
  
  <BudgetWagePercentageTotal>
<![CDATA[select 'Total' as Tot,
CASE When NVL(wge.BDGT_WGE_TOT_WTSR,0)=0 and NVL(sls.BDGT_SLS_TOT_WTSR,0)=0 Then 0
When NVL(wge.BDGT_WGE_TOT_WTSR,0)=0 Then 0 When NVL(sls.BDGT_SLS_TOT_WTSR,0)=0 Then 0
ELSE ROUND((wge.BDGT_WGE_TOT_WTSR / sls.BDGT_SLS_TOT_WTSR)*100,2) END as BDGT_WGE_PCT_TOT_WTSR from 
(select lc.perd_desc,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.perd_desc=bdgt.perd_desc 
group by lc.perd_desc order by lc.perd_desc) wge,
(select lc.perd_desc,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.perd_desc=bdgt.perd_desc 
group by lc.perd_desc order by lc.perd_desc) sls
where wge.perd_desc=sls.perd_desc]]> 
  </BudgetWagePercentageTotal>
  
    <ForecastWagePercentage>
<![CDATA[select wge.fin_wk_no,
CASE When NVL(wge.FCST_WGE_WTSR,0)=0 and NVL(sls.FCST_SLS_WTSR,0)=0 Then 0
When NVL(wge.FCST_WGE_WTSR,0)=0 Then 0 When NVL(sls.FCST_SLS_WTSR,0)=0 Then 0
ELSE ROUND((wge.FCST_WGE_WTSR / sls.FCST_SLS_WTSR)*100,2) END as FCST_WGE_PCT_WTSR from 
(select lc.fin_wk_no,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.wk_id=fcst.wk_id 
group by lc.fin_wk_no order by lc.fin_wk_no) wge,
(select lc.fin_wk_no,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.wk_id=fcst.wk_id 
group by lc.fin_wk_no order by lc.fin_wk_no) sls
where wge.fin_wk_no=sls.fin_wk_no order by wge.fin_wk_no]]> 
  </ForecastWagePercentage>
  
  <ForecastWagePercentageTotal>
<![CDATA[select 'Total' as Tot,
CASE When NVL(wge.FCST_WGE_TOT_WTSR,0)=0 and NVL(sls.FCST_SLS_TOT_WTSR,0)=0 Then 0
When NVL(wge.FCST_WGE_TOT_WTSR,0)=0 Then 0 When NVL(sls.FCST_SLS_TOT_WTSR,0)=0 Then 0
ELSE ROUND((wge.FCST_WGE_TOT_WTSR / sls.FCST_SLS_TOT_WTSR)*100,2) END as FCST_WGE_PCT_TOT_WTSR from 
(select lc.perd_desc,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.perd_desc=fcst.perd_desc 
group by lc.perd_desc order by lc.perd_desc) wge,
(select lc.perd_desc,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.perd_desc=fcst.perd_desc 
group by lc.perd_desc order by lc.perd_desc) sls
where wge.perd_desc=sls.perd_desc]]> 
  </ForecastWagePercentageTotal>
  
    <MonthlyPlannedWagePercentage>
	<![CDATA[select pln_wge.fin_wk_no,
	case when NVL(pln_wge.PLN_WGE_WTSR,0)=0 and NVL(pln_sls.PLN_SLS_WTSR,0)=0 then 0 
	when NVL(pln_wge.PLN_WGE_WTSR,0)=0 then 0 when NVL(pln_sls.PLN_SLS_WTSR,0)=0 then 0 
	else ROUND((pln_wge.PLN_WGE_WTSR / pln_sls.PLN_SLS_WTSR)*100,2) end as PLN_WGE_PCT_WTSR from 
  (select lc.fin_wk_no,NVL(e.PLN_WAGE_WTSR,0) as PLN_WGE_WTSR from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
	LEFT OUTER JOIN 
  (select z.wk_id,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSR from 
  (select * from (select d.wk_id,d.zone_no,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id,d.zone_no order by d.wk_id,d.zone_no) 
  UNION 
  select * from (select d.wk_id,d.zone_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id,d.zone_no order by d.wk_id,d.zone_no)) z
  group by z.wk_id order by z.wk_id) e 
  on e.wk_id=lc.wk_id order by lc.wk_id) pln_wge,
  (select f.fin_wk_no,NVL(e.PLAN_SALES,0) as PLN_SLS_WTSR from 
	(select distinct wk_id,fin_wk_no from ww_wlp.wk where perd_desc='Month' order by wk_id) f
	LEFT OUTER JOIN 
    (select z.wk_id,sum(PLAN_SALES) as PLAN_SALES from 
    (select * from 
    (select b.wk_id,a.loc_no,ROUND(sum(a.mgr_wky_sls),0) as PLAN_SALES 
    from ww_wlp.mgr_wky_pln a,wk b 
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
    group by b.wk_id,a.loc_no order by b.wk_id,a.loc_no) c 
    UNION 
    select * from 
    (select b.wk_id,a.loc_no,Round(sum(gnrt_sls),0) as GEN_SALES 
    from ww_wlp.fcst a,wk b
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.dept_no NOT IN (0,20,85,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
  and (a.loc_no,b.wk_id) NOT IN
	(select loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
	group by b.wk_id,a.loc_no order by b.wk_id,a.loc_no) d) z 
    group by z.wk_id order by z.wk_id) e 
    on f.wk_id=e.wk_id order by f.wk_id) pln_sls 
  where pln_wge.fin_wk_no=pln_sls.fin_wk_no order by pln_wge.fin_wk_no]]>
	</MonthlyPlannedWagePercentage>

  <MonthlyPlannedWagePercentageTotal>
	<![CDATA[select 'Total' as Tot,
	case when NVL(pln_wge.PLN_WGE_TOT_WTSR,0)=0 and NVL(pln_sls.PLN_SLS_TOT_WTSR,0)=0 then 0 
	when NVL(pln_wge.PLN_WGE_TOT_WTSR,0)=0 then 0 when NVL(pln_sls.PLN_SLS_TOT_WTSR,0)=0 then 0 
	else ROUND((pln_wge.PLN_WGE_TOT_WTSR / pln_sls.PLN_SLS_TOT_WTSR)*100,2) end as PLN_WGE_PCT_TOT_WTSR from 
  (select lc.perd_desc,NVL(e.PLN_WAGE_WTSR,0) as PLN_WGE_TOT_WTSR from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSR from 
  (select * from (select d.perd_desc,d.zone_no,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.zone_no order by d.perd_desc,d.zone_no) 
  UNION 
  select * from (select d.perd_desc,d.zone_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.zone_no order by d.perd_desc,d.zone_no)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc) pln_wge,
	(select lc.perd_desc,NVL(ROUND(e.PLAN_SALES,0),0) as PLN_SLS_TOT_WTSR from 
	(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
    (select z.perd_desc,sum(PLAN_SALES) as PLAN_SALES from 
    (select * from 
    (select b.perd_desc,a.loc_no,ROUND(sum(a.mgr_wky_sls),0) as PLAN_SALES 
    from ww_wlp.mgr_wky_pln a,wk b 
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
    group by b.perd_desc,a.loc_no order by b.perd_desc,a.loc_no) c 
    UNION 
    select * from 
    (select b.perd_desc,a.loc_no,ROUND(sum(gnrt_sls),0) as GEN_SALES 
    from ww_wlp.fcst a,wk b
	where a.div_no='Division' and a.loc_no in (select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.dept_no NOT IN (0,20,85,90) and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
  and (a.loc_no,b.wk_id) NOT IN
	(select loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
	group by b.perd_desc,a.loc_no order by b.perd_desc,a.loc_no) d) z 
    group by z.perd_desc order by z.perd_desc) e 
    on lc.perd_desc=e.perd_desc order by lc.perd_desc) pln_sls 
  where pln_wge.perd_desc=pln_sls.perd_desc]]>
	</MonthlyPlannedWagePercentageTotal>
	
	  <WeeklyPlannedWagePercentage>
<![CDATA[select wge.fin_wk_no,
case when NVL(wge.PLN_WGE_WTSR,0)=0 and NVL(sls.PLN_SLS_WTSR,0)=0 then 0 
when NVL(wge.PLN_WGE_WTSR,0)=0 then 0 when NVL(sls.PLN_SLS_WTSR,0)=0 then 0 
else ROUND((wge.PLN_WGE_WTSR / sls.PLN_SLS_WTSR)*100,2) end as PLN_WGE_PRCNT_WTSR from
(select lc.fin_wk_no,NVL(wge.PLN_WAGE_WTSR,0) as PLN_WGE_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) wge
on wge.wk_id=lc.wk_id order by lc.wk_id) wge,
(select lc.fin_wk_no,NVL(sls.PLN_SLS_WTSR,0) as PLN_SLS_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select h.wk_id,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSR from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy--, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
--and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region'))*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust 
from ww_wlp.fcst a, loc b, wk c , dept d, day dy/*, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region'))
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region'))
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) g*/) sec_prty) h 
group by h.wk_id order by h.wk_id) sls
on lc.wk_id=sls.wk_id) sls
where wge.fin_wk_no=sls.fin_wk_no order by wge.fin_wk_no]]> 
  </WeeklyPlannedWagePercentage>
  
  <WeeklyPlannedWagePercentageTotal>
<![CDATA[select 'Total' as Tot,
case when NVL(wge.PLN_WGE_TOT_WTSR,0)=0 and NVL(sls.PLN_SLS_TOT_WTSR,0)=0 then 0 
when NVL(wge.PLN_WGE_TOT_WTSR,0)=0 then 0 when NVL(sls.PLN_SLS_TOT_WTSR,0)=0 then 0 
else ROUND((wge.PLN_WGE_TOT_WTSR / sls.PLN_SLS_TOT_WTSR)*100,2) end as PLN_WGE_PRCNT_TOT_WTSR from
(select lc.perd_desc,NVL(wge.PLN_WAGE_WTSR,0) as PLN_WGE_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) wge
on wge.perd_desc=lc.perd_desc order by lc.perd_desc) wge,
(select lc.perd_desc,NVL(sls.PLN_SLS_WTSR,0) as PLN_SLS_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select h.perd_desc,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSR from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy--, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
--and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region'))*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust 
from ww_wlp.fcst a, loc b, wk c , dept d, day dy/*, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region'))
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region'))
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) g*/) sec_prty) h 
group by h.perd_desc order by h.perd_desc) sls
on lc.perd_desc=sls.perd_desc) sls
where wge.perd_desc=sls.perd_desc]]> 
  </WeeklyPlannedWagePercentageTotal>
  
    <ActualWagePercentage>
<![CDATA[select wge.fin_wk_no,
case when NVL(wge.ACTL_WGE_WTSR,0)=0 and NVL(sls.ACTL_SLS_WTSR,0)=0 then 0 
when NVL(wge.ACTL_WGE_WTSR,0)=0 then 0 when NVL(sls.ACTL_SLS_WTSR,0)=0 then 0 
else ROUND((wge.ACTL_WGE_WTSR / sls.ACTL_SLS_WTSR)*100,2) end as ACTL_WGE_PRCNT_WTSR from
(select lc.fin_wk_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) hrs
on hrs.wk_id=lc.wk_id order by lc.wk_id) wge,
(select lc.fin_wk_no,NVL(sls.ACTL_SLS_WTSR,0) as ACTL_SLS_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select h.wk_id,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) f ) h 
group by h.wk_id order by h.wk_id) sls
on lc.wk_id=sls.wk_id order by lc.wk_id) sls
where wge.fin_wk_no=sls.fin_wk_no order by wge.fin_wk_no]]> 
  </ActualWagePercentage>
  
  <ActualWagePercentageTotal>
<![CDATA[select 'Total' as Tot,
case when NVL(wge.ACTL_WGE_TOT_WTSR,0)=0 and NVL(sls.ACTL_SLS_TOT_WTSR,0)=0 then 0 
when NVL(wge.ACTL_WGE_TOT_WTSR,0)=0 then 0 when NVL(sls.ACTL_SLS_TOT_WTSR,0)=0 then 0 
else ROUND((wge.ACTL_WGE_TOT_WTSR / sls.ACTL_SLS_TOT_WTSR)*100,2) end as ACTL_WGE_PRCNT_TOT_WTSR from
(select lc.perd_desc,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
/*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) hrs
on hrs.perd_desc=lc.perd_desc order by lc.perd_desc) wge,
(select lc.perd_desc,NVL(sls.ACTL_SLS_WTSR,0) as ACTL_SLS_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select h.perd_desc,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSR from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) f ) h 
group by h.perd_desc order by h.perd_desc) sls
on lc.perd_desc=sls.perd_desc order by lc.perd_desc) sls
where wge.perd_desc=sls.perd_desc]]> 
  </ActualWagePercentageTotal>
</TCName>

<TCName name = "ORColumnValidationNewTable" >
	<MonthlyPlannedOR>
	<![CDATA[select sms_hrs.fin_wk_no,
	case when NVL(sms_hrs.SMS_HRS_WTSR,0)=0 and NVL(pln_hrs.PLN_HRS_WTSR,0)=0 then 0 
	when NVL(sms_hrs.SMS_HRS_WTSR,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_WTSR,0)=0 then 0 
	else ROUND((sms_hrs.SMS_HRS_WTSR / pln_hrs.PLN_HRS_WTSR)*100,1) end as PLN_OR_WTSR from 
	(select lc.fin_wk_no,NVL(y.SMS_HOURS_WTSR,0) as SMS_HRS_WTSR from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
  LEFT OUTER JOIN
	(select C.wk_id,sum(C.SMS_HOURS_WTSR) as SMS_HOURS_WTSR from 
  (select a.wk_id,a.zone_no,NVL(ROUND(((ROUND((((sum(fix_hrs) + Sum(vol_hrs))*100)/25),0)*25)/100),2),0) as SMS_HOURS_WTSR from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,
	a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
  from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d /*,loc_dept ld */
	where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no and d.dept_no NOT IN (20,27,28) 
  and b.perd_desc in ('Month') and c.div_no='Division' and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region')
  /*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no*/ ) A
	group by a.wk_id,a.zone_no order by a.wk_id,a.zone_no) C 
  group by C.wk_id order by c.wk_id) y
	on lc.wk_id=y.wk_id order by lc.wk_id)sms_hrs,
	(select lc.fin_wk_no,NVL(e.PLN_HOURS_WTSR,0) as PLN_HRS_WTSR from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
	LEFT OUTER JOIN 
  (select z.wk_id,sum(PLN_HOURS_WTSR) as PLN_HOURS_WTSR from 
  (select * from (select d.wk_id,d.zone_no,ROUND(sum(d.MGR_WKY_HRS),0) as PLN_HOURS_WTSR from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id,d.zone_no order by d.wk_id,d.zone_no) 
  UNION 
  select * from (select d.wk_id,d.zone_no,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_WTSR from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id,d.zone_no order by d.wk_id,d.zone_no)) z
  group by z.wk_id order by z.wk_id) e 
  on e.wk_id=lc.wk_id order by lc.wk_id) pln_hrs 
	where sms_hrs.fin_wk_no=pln_hrs.fin_wk_no order by sms_hrs.fin_wk_no]]>
	</MonthlyPlannedOR>
  
  <MonthlyPlannedORTotal>
	<![CDATA[select 'Total' as Tot,
	case when NVL(sms_hrs.SMS_HRS_TOT_WTSR,0)=0 and NVL(pln_hrs.PLN_HRS_TOT_WTSR,0)=0 then 0 
	when NVL(sms_hrs.SMS_HRS_TOT_WTSR,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_TOT_WTSR,0)=0 then 0 
	else ROUND((sms_hrs.SMS_HRS_TOT_WTSR / pln_hrs.PLN_HRS_TOT_WTSR)*100,1) end as PLN_OR_TOT_WTSR from 
	(select lc.perd_desc,NVL(y.SMS_HOURS_TOT_WTSR,0) as SMS_HRS_TOT_WTSR from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
  LEFT OUTER JOIN
	(select C.perd_desc,sum(C.SMS_HOURS_WTSR) as SMS_HOURS_TOT_WTSR from 
  (select a.perd_desc,a.zone_no,NVL(ROUND(((ROUND((((sum(fix_hrs) + Sum(vol_hrs))*100)/25),0)*25)/100),2),0) as SMS_HOURS_WTSR from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,
	a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
  from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d /*,loc_dept ld */
	where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no and d.dept_no NOT IN (20,27,28) 
  and b.perd_desc in ('Month') and c.div_no='Division' and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region')
  /*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no*/ ) A
	group by a.perd_desc,a.zone_no order by a.perd_desc,a.zone_no) C 
  group by C.perd_desc order by c.perd_desc) y
	on lc.perd_desc=y.perd_desc order by lc.perd_desc)sms_hrs,
	(select lc.perd_desc,NVL(e.PLN_HOURS_WTSR,0) as PLN_HRS_TOT_WTSR from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_HOURS_WTSR) as PLN_HOURS_WTSR from 
  (select * from (select d.perd_desc,d.zone_no,ROUND(sum(d.MGR_WKY_HRS),0) as PLN_HOURS_WTSR from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.zone_no order by d.perd_desc,d.zone_no) 
  UNION 
  select * from (select d.perd_desc,d.zone_no,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_WTSR from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.zone_no order by d.perd_desc,d.zone_no)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc) pln_hrs 
	where sms_hrs.perd_desc=pln_hrs.perd_desc]]>
	</MonthlyPlannedORTotal>
	
		<WeeklyPlannedOR>
	<![CDATA[select sms_hrs.fin_wk_no,
	CASE When NVL(sms_hrs.SMS_HRS_WTSR,0)=0 and NVL(pln_hrs.PLN_HRS_WTSR,0)=0 Then 0 
	When NVL(sms_hrs.SMS_HRS_WTSR,0)=0 Then 0 When NVL(pln_hrs.PLN_HRS_WTSR,0)=0 Then 0 
	ELSE ROUND((sms_hrs.SMS_HRS_WTSR / pln_hrs.PLN_HRS_WTSR)*100,1) END as PLN_OR_WTSR from 
(select lc.fin_wk_no,NVL(sum(SMS_HOURS_MPS),0) as SMS_HRS_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc 
LEFT OUTER JOIN
(select c.wk_id,C.zone_no,NVL(ROUND(((ROUND((((sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT))*100)/25),0)*25)/100),2),0) as SMS_HOURS_MPS from 
(select A.zone_no,A.rgn_no,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
from ww_wlp.lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d /*, loc_dept ld */
where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
and d.dept_no NOT IN (20,27,28) and b.perd_desc='Month' and c.div_no='Division' and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region')
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no*/) A 
group by A.zone_no,A.rgn_no,A.wk_id,A.dept_no order by A.zone_no,A.rgn_no,A.wk_id,A.dept_no) C 
group by c.wk_id,C.zone_no order by c.wk_id,c.zone_no) y
on lc.wk_id=y.wk_id group by lc.fin_wk_no order by lc.fin_wk_no) sms_hrs, 
(select lc.fin_wk_no,NVL(sum(e.PLN_HOURS_WPS),0) as PLN_HRS_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select z.wk_id,z.zone_no,NVL(ROUND(sum(PLN_HOURS_WPS),0),0) as PLN_HOURS_WPS from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm,
(sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))) as PLN_WAGE_WPS,
(sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d /*,loc_dept ld */
where a.wk_id=b.wk_id and b.perd_desc='Month' 
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region')
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28)
/*and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no*/
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,b.perd_desc,b.wk_id,d.dply_seq) z
group by z.wk_id,z.zone_no order by z.wk_id,z.zone_no) e
on e.wk_id=lc.wk_id group by lc.fin_wk_no order by lc.fin_wk_no) pln_hrs 
where sms_hrs.fin_wk_no=pln_hrs.fin_wk_no order by sms_hrs.fin_wk_no]]>
	</WeeklyPlannedOR>
  
  <WeeklyPlannedORTotal>
	<![CDATA[select 'Total' as Tot,
	CASE When NVL(sms_hrs.SMS_HRS_TOT_WTSR,0)=0 and NVL(pln_hrs.PLN_HRS_TOT_WTSR,0)=0 Then 0 
	When NVL(sms_hrs.SMS_HRS_TOT_WTSR,0)=0 Then 0 When NVL(pln_hrs.PLN_HRS_TOT_WTSR,0)=0 Then 0 
	ELSE ROUND((sms_hrs.SMS_HRS_TOT_WTSR / pln_hrs.PLN_HRS_TOT_WTSR)*100,1) END as PLN_OR_TOT_WTSR from 
(select lc.perd_desc,NVL(sum(y.SMS_HOURS_WTSR),0) as SMS_HRS_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select c.perd_desc,c.wk_id,C.zone_no,NVL(ROUND(((ROUND((((sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT))*100)/25),0)*25)/100),2),0) as SMS_HOURS_WTSR from 
(select A.zone_no,A.perd_desc,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
from ww_wlp.lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d /*, loc_dept ld */
where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
and d.dept_no NOT IN (20,27,28) and b.perd_desc='Month' and c.div_no='Division' and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region')
/*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no*/) A 
group by A.zone_no,A.perd_desc,A.wk_id,A.dept_no order by A.zone_no,A.perd_desc,A.wk_id,A.dept_no) C 
group by c.perd_desc,c.wk_id,C.zone_no order by c.perd_desc,c.wk_id,C.zone_no) y
on lc.perd_desc=y.perd_desc group by lc.perd_desc order by lc.perd_desc) sms_hrs, 
(select lc.perd_desc,NVL(sum(e.PLN_HOURS_WTSR),0) as PLN_HRS_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select z.perd_desc,z.wk_id,z.zone_no,NVL(ROUND(sum(PLN_HOURS_WPS),0),0) as PLN_HOURS_WTSR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm,
(sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))) as PLN_WAGE_WPS,
(sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d /*,loc_dept ld */
where a.wk_id=b.wk_id and b.perd_desc='Month' 
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region')
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28)
/*and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no*/
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,b.perd_desc,b.wk_id,d.dply_seq) z
group by z.perd_desc,z.wk_id,z.zone_no order by z.perd_desc,z.wk_id,z.zone_no) e
on e.perd_desc=lc.perd_desc group by lc.perd_desc order by lc.perd_desc) pln_hrs 
where sms_hrs.perd_desc=pln_hrs.perd_desc]]>
	</WeeklyPlannedORTotal>
	
	<ActualOR>
	<![CDATA[select actl_sms.fin_wk_no,
	case when NVL(actl_sms.ACTL_SMS_WTSR,0)=0 and NVL(actl_hrs.ACTL_HRS_WTSR,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_WTSR,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_WTSR,0)=0 then 0 
	else NVL(ROUND((actl_sms.ACTL_SMS_WTSR / actl_hrs.ACTL_HRS_WTSR)*100,1),0) end as ACTL_OR_WTSR from
(select lc.fin_wk_no,NVL(xy.WK_TO_DT_TOT,0) as ACTL_SMS_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select  wk_id,Sum(ACTL_SMS_DTSG) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as ACTL_SMS_DTSG
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no='Division'
where w.perd_desc='Month' and A.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by wk_id) xy
on lc.wk_id=xy.wk_id order by lc.wk_id)actl_sms,
(select lc.fin_wk_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
/*and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) hrs
on hrs.wk_id=lc.wk_id order by lc.wk_id)actl_hrs
where actl_sms.fin_wk_no=actl_hrs.fin_wk_no order by actl_sms.fin_wk_no]]> 
</ActualOR>

<ActualORTotal>
	<![CDATA[select 'Total' as Tot,
	case when NVL(actl_sms.ACTL_SMS_TOT_WTSR,0)=0 and NVL(actl_hrs.ACTL_HRS_TOT_WTSR,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_TOT_WTSR,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_TOT_WTSR,0)=0 then 0 
	else NVL(ROUND((actl_sms.ACTL_SMS_TOT_WTSR / actl_hrs.ACTL_HRS_TOT_WTSR)*100,1),0) end as ACTL_OR_TOT_WTSR from
(select lc.perd_desc,NVL(xy.WK_TO_DT_TOT,2) as ACTL_SMS_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select perd_desc,Sum(ACTL_SMS_DTSG) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as ACTL_SMS_DTSG
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.perd_desc,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.perd_desc,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,W.perd_desc,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no='Division'
where w.perd_desc='Month' and A.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region')
and A.day_of_wk in (0,1,2,3,4,5,6)
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.perd_desc,LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by perd_desc) xy
on lc.perd_desc=xy.perd_desc order by lc.perd_desc)actl_sms,
(select lc.perd_desc,NVL(hrs.ACTL_HRS_DTS,2) as ACTL_HRS_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c /*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
/*and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) hrs
on hrs.perd_desc=lc.perd_desc order by lc.perd_desc)actl_hrs
where actl_sms.perd_desc=actl_hrs.perd_desc order by actl_sms.perd_desc]]> 
</ActualORTotal>
</TCName>

<TCName name = "CPHColumnValidationNewTable" >
	<MonthlyPlannedCPH>
	<![CDATA[select pln_wge.fin_wk_no,
	case when NVL(pln_wge.PLN_WGE_WTSR,0)=0 and NVL(pln_hrs.PLN_HRS_WTSR,0)=0 then 0 
	when NVL(pln_wge.PLN_WGE_WTSR,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_WTSR,0)=0 then 0 
	else ROUND((pln_wge.PLN_WGE_WTSR / pln_hrs.PLN_HRS_WTSR),2) end as PLN_CPH_WTSR from 
  (select lc.fin_wk_no,NVL(e.PLN_WAGE_WTSR,0) as PLN_WGE_WTSR from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
	LEFT OUTER JOIN 
  (select z.wk_id,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSR from 
  (select * from (select d.wk_id,d.zone_no,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id,d.zone_no order by d.wk_id,d.zone_no) 
  UNION 
  select * from (select d.wk_id,d.zone_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id,d.zone_no order by d.wk_id,d.zone_no)) z
  group by z.wk_id order by z.wk_id) e 
  on e.wk_id=lc.wk_id order by lc.wk_id) pln_wge,
  (select lc.fin_wk_no,NVL(e.PLN_HOURS_WTSR,0) as PLN_HRS_WTSR from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
	LEFT OUTER JOIN 
  (select z.wk_id,sum(PLN_HOURS_WTSR) as PLN_HOURS_WTSR from 
  (select * from (select d.wk_id,d.zone_no,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_WTSR from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id,d.zone_no order by d.wk_id,d.zone_no) 
  UNION 
  select * from (select d.wk_id,d.zone_no,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_WTSR from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id,d.zone_no order by d.wk_id,d.zone_no)) z
  group by z.wk_id order by z.wk_id) e 
  on e.wk_id=lc.wk_id order by lc.wk_id) pln_hrs 
  where pln_wge.fin_wk_no=pln_hrs.fin_wk_no order by pln_wge.fin_wk_no]]>
	</MonthlyPlannedCPH>
  
	<MonthlyPlannedCPHTotal>
	<![CDATA[select 'Total' as Tot,
	case when NVL(pln_wge.PLN_WGE_TOT_WTSR,0)=0 and NVL(pln_hrs.PLN_HRS_TOT_WTSR,0)=0 then 0 
	when NVL(pln_wge.PLN_WGE_TOT_WTSR,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_TOT_WTSR,0)=0 then 0 
	else ROUND((pln_wge.PLN_WGE_TOT_WTSR / pln_hrs.PLN_HRS_TOT_WTSR),2) end as PLN_CPH_TOT_WTSR from 
  (select lc.perd_desc,NVL(e.PLN_WAGE_WTSR,0) as PLN_WGE_TOT_WTSR from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSR from 
  (select * from (select d.perd_desc,d.zone_no,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.zone_no order by d.perd_desc,d.zone_no) 
  UNION 
  select * from (select d.perd_desc,d.zone_no,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.zone_no order by d.perd_desc,d.zone_no)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc) pln_wge,
  (select lc.perd_desc,NVL(e.PLN_HOURS_WTSR,0) as PLN_HRS_TOT_WTSR from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_HOURS_WTSR) as PLN_HOURS_WTSR from 
  (select * from (select d.perd_desc,d.zone_no,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_WTSR from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.zone_no order by d.perd_desc,d.zone_no) 
  UNION 
  select * from (select d.perd_desc,d.zone_no,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_WTSR from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c /*, loc_dept ld */
  where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') 
and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  /*and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no*/) d 
  where (d.loc_no,d.wk_id) NOT IN 
  (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.zone_no order by d.perd_desc,d.zone_no)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc) pln_hrs 
  where pln_wge.perd_desc=pln_hrs.perd_desc order by pln_wge.perd_desc]]>
	</MonthlyPlannedCPHTotal>
	
	  <WeeklyPlannedCPH>
<![CDATA[select wge_hrs.fin_wk_no,
CASE When NVL(wge_hrs.PLN_WGE_WTSR,0)=0 and NVL(wge_hrs.PLN_HRS_WTSR,0)=0 Then 0 
When NVL(wge_hrs.PLN_WGE_WTSR,0)=0 Then 0 When NVL(wge_hrs.PLN_HRS_WTSR,0)=0 Then 0 
ELSE ROUND((wge_hrs.PLN_WGE_WTSR / wge_hrs.PLN_HRS_WTSR),2) END as PLN_CPH_WTSR from
(select lc.fin_wk_no,NVL(sum(e.PLN_WAGE_WPS),0) as PLN_WGE_WTSR,NVL(sum(e.PLN_HOURS_WPS),0) as PLN_HRS_WTSR from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select z.wk_id,z.zone_no,NVL(ROUND(sum(PLN_WAGE_WPS),9),0) as PLN_WAGE_WPS,NVL(ROUND(sum(PLN_HOURS_WPS),9),0) as PLN_HOURS_WPS from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm,
(sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))) as PLN_WAGE_WPS,
(sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d/*,loc_dept ld */
where a.wk_id=b.wk_id and b.perd_desc='Month' 
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region')
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28)
/*and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no*/
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,b.perd_desc,b.wk_id,d.dply_seq) z
group by z.wk_id,z.zone_no order by z.wk_id,z.zone_no) e
on e.wk_id=lc.wk_id group by lc.fin_wk_no order by lc.fin_wk_no) wge_hrs
order by wge_hrs.fin_wk_no]]> 
  </WeeklyPlannedCPH>
  
  <WeeklyPlannedCPHTotal>
<![CDATA[select 'Total' as Tot,
CASE When NVL(wge_hrs.PLN_WGE_TOT_WTSR,0)=0 and NVL(wge_hrs.PLN_HRS_TOT_WTSR,0)=0 Then 0 
When NVL(wge_hrs.PLN_WGE_TOT_WTSR,0)=0 Then 0 When NVL(wge_hrs.PLN_HRS_TOT_WTSR,0)=0 Then 0 
ELSE ROUND((wge_hrs.PLN_WGE_TOT_WTSR / wge_hrs.PLN_HRS_TOT_WTSR),2) END as PLN_CPH_TOT_WTSR from
(select lc.perd_desc,NVL(sum(e.PLN_WAGE_WPS),0) as PLN_WGE_TOT_WTSR,NVL(sum(e.PLN_HOURS_WPS),0) as PLN_HRS_TOT_WTSR from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select z.perd_desc,z.wk_id,z.zone_no,NVL(ROUND(sum(PLN_WAGE_WPS),9),0) as PLN_WAGE_WPS,NVL(ROUND(sum(PLN_HOURS_WPS),9),0) as PLN_HOURS_WPS from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm,
(sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))) as PLN_WAGE_WPS,
(sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d/*,loc_dept ld */
where a.wk_id=b.wk_id and b.perd_desc='Month' 
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region')
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28)
/*and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no*/
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,b.perd_desc,b.wk_id,d.dply_seq) z
group by z.perd_desc,z.wk_id,z.zone_no order by z.perd_desc,z.wk_id,z.zone_no) e
on e.perd_desc=lc.perd_desc group by lc.perd_desc order by lc.perd_desc) wge_hrs
order by wge_hrs.perd_desc]]> 
  </WeeklyPlannedCPHTotal>
  
  <ActualCPH>
<![CDATA[select lc.fin_wk_no,
CASE When NVL(wge_hrs.ACTL_WGE_WTSR,0)=0 and NVL(wge_hrs.ACTL_HRS_WTSR,0)=0 Then 0 
When NVL(wge_hrs.ACTL_WGE_WTSR,0)=0 Then 0 When NVL(wge_hrs.ACTL_HRS_WTSR,0)=0 Then 0 
ELSE ROUND((wge_hrs.ACTL_WGE_WTSR / wge_hrs.ACTL_HRS_WTSR),2) END as ACTL_CPH_WTSR from
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.actl_wage_amt) as ACTL_WGE_WTSR,sum(e.actl_hrs) as ACTL_HRS_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c, dept d/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
/*and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) wge_hrs
on wge_hrs.wk_id=lc.wk_id order by lc.wk_id]]> 
  </ActualCPH>
  
  <ActualCPHTotal>
<![CDATA[select 'Total' as Tot,
CASE When NVL(wge_hrs.ACTL_WGE_TOT_WTSR,0)=0 and NVL(wge_hrs.ACTL_HRS_TOT_WTSR,0)=0 Then 0 
When NVL(wge_hrs.ACTL_WGE_TOT_WTSR,0)=0 Then 0 When NVL(wge_hrs.ACTL_HRS_TOT_WTSR,0)=0 Then 0 
ELSE ROUND((wge_hrs.ACTL_WGE_TOT_WTSR / wge_hrs.ACTL_HRS_TOT_WTSR),2) END as ACTL_CPH_TOT_WTSR from
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.actl_wage_amt) as ACTL_WGE_TOT_WTSR,sum(e.actl_hrs) as ACTL_HRS_TOT_WTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c, dept d/*, loc_dept ld */
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no in 
(select b.loc_no from loc b where b.div_no='Division' and b.rgn_no='Region') and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
/*and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no */
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) wge_hrs 
on wge_hrs.perd_desc=lc.perd_desc]]> 
  </ActualCPHTotal>
</TCName>  

</configuration>