<?xml version="1.0" encoding="UTF-8"?>

<configuration>

<TCName name = "SalesView" >
	<PlannedSalesColumn>
	<![CDATA[select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
 order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTSG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DTSG from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) sls
on lc.loc_nm=sls.loc_nm order by lc.loc_nm]]>
	</PlannedSalesColumn>
	<PlannedSalesTotal>
	<![CDATA[ select lc.ar_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct ar_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTSG),0) as PLN_SLS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSG,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSG,sum(e.gnrt_itm) as GEN_ITM_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no]]>
	</PlannedSalesTotal>	
	<PlannedSalesWkToDt>
	<![CDATA[select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
 order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTSG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DTSG from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) sls
on lc.loc_nm=sls.loc_nm order by lc.loc_nm]]>
	</PlannedSalesWkToDt>
	<PlannedSalesWkToDtTotal>
	<![CDATA[select lc.ar_no,NVL(sls.wtd,0) as WTD from 
(select distinct ar_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
) lc
LEFT OUTER JOIN
(select z.ar_no,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.ar_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTSG) as PLN_SLS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSG,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSG,sum(e.gnrt_itm) as GEN_ITM_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no]]>
	</PlannedSalesWkToDtTotal>
	<ActualSalesColumn>
	<![CDATA[select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_SLS_DTS),0) as ACTL_SLS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm]]>
	</ActualSalesColumn>
	<ActualSalesTotal>
	<![CDATA[select lc.ar_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_SLS_DTS),0) as ACTL_SLS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no]]>
	</ActualSalesTotal>	
	<ActualSalesWkToDt>
	<![CDATA[select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm]]>
	</ActualSalesWkToDt>
	<ActualSalesWkToDtTotal>
	<![CDATA[select lc.ar_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no]]>
	</ActualSalesWkToDtTotal>
	
	<VarianceSalesColumn>
<![CDATA[select nyu.loc_nm,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
 order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTSG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DTSG from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) sls
on lc.loc_nm=sls.loc_nm order by lc.loc_nm) nyu,
(select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_SLS_DTS),0) as ACTL_SLS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceSalesColumn>
<VarianceSalesTotal>
<![CDATA[select nyu.ar_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select lc.ar_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct ar_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTSG),0) as PLN_SLS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSG,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSG,sum(e.gnrt_itm) as GEN_ITM_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no) nyu,
(select lc.ar_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_SLS_DTS),0) as ACTL_SLS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) den
where nyu.ar_no = den.ar_no ]]>
</VarianceSalesTotal>	
<VarianceSalesWkToDt>
<![CDATA[select nyu.loc_nm,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_SALES_DPS from
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
 order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTSG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DTSG from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) sls
on lc.loc_nm=sls.loc_nm order by lc.loc_nm) nyu,
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceSalesWkToDt>
<VarianceSalesWkToDtTotal>
<![CDATA[select nyu.ar_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_SALES_TOT_DPS from
(select lc.ar_no,NVL(sls.wtd,0) as WTD from 
(select distinct ar_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
) lc
LEFT OUTER JOIN
(select z.ar_no,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.ar_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTSG) as PLN_SLS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSG,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSG,sum(e.gnrt_itm) as GEN_ITM_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no) nyu,
(select lc.ar_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) den
where nyu.ar_no = den.ar_no ]]>
</VarianceSalesWkToDtTotal>
</TCName>

<TCName name = "ScheduledHoursView" >
	<PlannedHoursColumn>
	<![CDATA[select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DPG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_HRS_DTS),1) as PLN_HRS_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) wge
on wge.loc_nm=lc.loc_nm order by lc.loc_nm]]>
	</PlannedHoursColumn>
	<PlannedHoursTotal>
	<![CDATA[select lc.ar_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_HRS_DTS),1) as PLN_HRS_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no]]>
	</PlannedHoursTotal>
	<PlannedHoursWkToDt>
	<![CDATA[select lc.loc_nm,NVL(ROUND(wge.PLN_HOURS_DTS,1),0) as PLN_HRS_DPG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select e.loc_no,e.loc_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no,e.loc_nm order by e.loc_no,e.loc_nm) wge
on wge.loc_nm=lc.loc_nm order by lc.loc_nm]]>
	</PlannedHoursWkToDt>
	<PlannedHoursWkToDtTotal>
	<![CDATA[select lc.ar_no,NVL(ROUND(wge.PLN_HOURS_TOT_DTG,1),0) as PLN_HRS_TOT_DPG from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DTG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DTG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) wge
on wge.ar_no=lc.ar_no]]>
	</PlannedHoursWkToDtTotal>
	<ActualHoursColumn>
	<![CDATA[select lc.loc_nm,ROUND(NVL(wge.mon,0),1) as Mon,ROUND(NVL(wge.tue,0),1) as Tue,ROUND(NVL(wge.wed,0),1) as Wed,ROUND(NVL(wge.thu,0),1) as Thu,
ROUND(NVL(wge.fri,0),1) as Fri,ROUND(NVL(wge.sat,0),1) as Sat,ROUND(NVL(wge.sun,0),1) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTS),2) as ACTL_HRS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm]]>
	</ActualHoursColumn>
	<ActualHoursTotal>
	<![CDATA[select lc.ar_no,ROUND(NVL(wge.mon,0),1) as Mon,ROUND(NVL(wge.tue,0),1) as Tue,ROUND(NVL(wge.wed,0),1) as Wed,ROUND(NVL(wge.thu,0),1) as Thu,
ROUND(NVL(wge.fri,0),1) as Fri,ROUND(NVL(wge.sat,0),1) as Sat,ROUND(NVL(wge.sun,0),1) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTS),2) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.ar_no,g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no]]>
	</ActualHoursTotal>
	<ActualHoursWkToDt>
	<![CDATA[select lc.loc_nm,NVL(ROUND(wge.ACTL_HRS_DTSG,1),0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select j.loc_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_DTSG from 
(select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) f
/*UNION
select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) g */
/*UNION
select * from 
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) i*/) j
group by j.loc_no order by j.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm]]>
	</ActualHoursWkToDt>
	<ActualHoursWkToDtTotal>
	<![CDATA[select lc.ar_no,NVL(ROUND(wge.ACTL_HRS_TOT_DTSG,1),0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select j.ar_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_TOT_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) f
/*UNION
select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) g */
/*UNION
select * from 
(select e.ar_no,e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no order by e.ar_no,e.loc_no) i*/) j
group by j.ar_no order by j.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no]]>
	</ActualHoursWkToDtTotal>
	
	<PlannedPayHoursColumn>
	<![CDATA[select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DPG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_HRS_DTS),1) as PLN_HRS_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) wge
on wge.loc_nm=lc.loc_nm order by lc.loc_nm]]>
	</PlannedPayHoursColumn>
	<PlannedPayHoursTotal>
	<![CDATA[select lc.ar_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(ROUND(h.PLN_HRS_DTS,1)) as PLN_HRS_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no]]>
	</PlannedPayHoursTotal>
	<PlannedPayHoursWkToDt>
	<![CDATA[select lc.loc_nm,NVL(ROUND(wge.PLN_HOURS_DTS,1),0) as PLN_HRS_DPG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select e.loc_no,e.loc_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no,e.loc_nm order by e.loc_no,e.loc_nm) wge
on wge.loc_nm=lc.loc_nm order by lc.loc_nm]]>
	</PlannedPayHoursWkToDt>
	<PlannedPayHoursWkToDtTotal>
	<![CDATA[select lc.ar_no,NVL(ROUND(wge.PLN_HOURS_TOT_DTG,1),0) as PLN_HRS_TOT_DPG from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DTG,
(sum(ROUND(e.ta_pln_hrs,1))) + sum((ROUND(e.wage_adj_hrs,1))) as PLN_HOURS_TOT_DTG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) wge
on wge.ar_no=lc.ar_no]]>
	</PlannedPayHoursWkToDtTotal>
	<ActualPayHoursColumn>
	<![CDATA[select lc.loc_nm,ROUND(NVL(wge.mon,0),1) as Mon,ROUND(NVL(wge.tue,0),1) as Tue,ROUND(NVL(wge.wed,0),1) as Wed,ROUND(NVL(wge.thu,0),1) as Thu,
ROUND(NVL(wge.fri,0),1) as Fri,ROUND(NVL(wge.sat,0),1) as Sat,ROUND(NVL(wge.sun,0),1) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTS),2) as ACTL_HRS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm]]>
	</ActualPayHoursColumn>
	<ActualPayHoursTotal>
	<![CDATA[select lc.ar_no,ROUND(NVL(wge.mon,0),1) as Mon,ROUND(NVL(wge.tue,0),1) as Tue,ROUND(NVL(wge.wed,0),1) as Wed,ROUND(NVL(wge.thu,0),1) as Thu,
ROUND(NVL(wge.fri,0),1) as Fri,ROUND(NVL(wge.sat,0),1) as Sat,ROUND(NVL(wge.sun,0),1) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTS),2) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.ar_no,g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no]]>
	</ActualPayHoursTotal>
	<ActualPayHoursWkToDt>
	<![CDATA[select lc.loc_nm,NVL(ROUND(wge.ACTL_HRS_DTSG,1),0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select j.loc_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_DTSG from 
(select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) f
/*UNION
select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) g */
/*UNION
select * from 
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) i*/) j
group by j.loc_no order by j.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm]]>
	</ActualPayHoursWkToDt>
	<ActualPayHoursWkToDtTotal>
	<![CDATA[select lc.ar_no,NVL(ROUND(wge.ACTL_HRS_TOT_DTSG,1),0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select j.ar_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_TOT_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) f
/*UNION
select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) g */
/*UNION
select * from 
(select e.ar_no,e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no order by e.ar_no,e.loc_no) i*/) j
group by j.ar_no order by j.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no]]>
	</ActualPayHoursWkToDtTotal>
	
<VarianceHoursColumn>
<![CDATA[select nyu.loc_nm,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),1) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),1) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),1) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),1) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),1) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),1) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),1) end as Sun from
(select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DPG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_HRS_DTS),1) as PLN_HRS_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) wge
on wge.loc_nm=lc.loc_nm order by lc.loc_nm) nyu,
(select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTS),2) as ACTL_HRS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceHoursColumn>
<VarianceHoursTotal>
<![CDATA[select nyu.ar_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),1) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),1) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),1) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),1) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),1) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),1) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),1) end as Sun from
(select lc.ar_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_HRS_DTS),1) as PLN_HRS_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) nyu,
(select lc.ar_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTS),2) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.ar_no,g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) den
where nyu.ar_no = den.ar_no ]]>
</VarianceHoursTotal>	
<VarianceHoursWkToDt>
<![CDATA[select nyu.loc_nm,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),1) end as VAR_HOURS_DPS from
(select lc.loc_nm,NVL(ROUND(wge.PLN_HOURS_DTS,1),0) as WTD from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select e.loc_no,e.loc_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no,e.loc_nm order by e.loc_no,e.loc_nm) wge
on wge.loc_nm=lc.loc_nm) nyu,
(select lc.loc_nm,NVL(ROUND(wge.ACTL_HRS_DTSG,2),0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select j.loc_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_DTSG from 
(select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) f
/*UNION
select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) g */
/*UNION
select * from 
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) i*/) j
group by j.loc_no order by j.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceHoursWkToDt>
<VarianceHoursWkToDtTotal>
<![CDATA[select nyu.ar_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),1) end as VAR_HOURS_TOT_DPS from
(select lc.ar_no,NVL(ROUND(wge.PLN_HOURS_TOT_DTG,1),0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DTG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DTG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) wge
on wge.ar_no=lc.ar_no) nyu,
(select lc.ar_no,NVL(ROUND(wge.ACTL_HRS_TOT_DTSG,2),0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select j.ar_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_TOT_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) f
/*UNION
select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) g */
/*UNION
select * from 
(select e.ar_no,e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no order by e.ar_no,e.loc_no) i*/) j
group by j.ar_no order by j.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) den
where nyu.ar_no = den.ar_no ]]>
</VarianceHoursWkToDtTotal>
</TCName>

<TCName name = "WagesView" >
	<PlannedWagesColumn>
	<![CDATA[select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DPG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) wge
on wge.loc_nm=lc.loc_nm order by lc.loc_nm]]>
	</PlannedWagesColumn>
	<PlannedWagesTotal>
	<![CDATA[select lc.ar_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.ta_pln_wage_amt),0) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no]]>
	</PlannedWagesTotal>
	
	<PlannedWagesWkToDt>
	<![CDATA[select lc.loc_nm,NVL(ROUND(wge.PLN_WAGE_DTS,0),0) as PLN_WGE_DPG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select e.loc_no,e.loc_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no,e.loc_nm order by e.loc_no,e.loc_nm) wge
on wge.loc_nm=lc.loc_nm order by lc.loc_nm]]>
	</PlannedWagesWkToDt>
	<PlannedWagesWkToDtTotal>
	<![CDATA[select lc.ar_no,NVL(ROUND(wge.PLN_WAGE_TOT_DTG,0),0) as PLN_WGE_TOT_DPG from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DTG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DTG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) wge
on wge.ar_no=lc.ar_no]]>
	</PlannedWagesWkToDtTotal>
	<ActualWagesColumn>
	<![CDATA[select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_WGE_DTS),0) as ACTL_WGE_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm]]>
	</ActualWagesColumn>
	<ActualWagesTotal>
	<![CDATA[select lc.ar_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(ROUND(h.ACTL_WGE_DTS,0)) as ACTL_WGE_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,e.actl_amt as ACTL_WGE_DTS,e.actl_hrs as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.ar_no,g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no]]>
	</ActualWagesTotal>
	
	<ActualWagesWkToDt>
	<![CDATA[select lc.loc_nm,NVL(ROUND(wge.ACTL_WGE_DTSG,0),0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select j.loc_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_DTSG from 
(select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) f
UNION
select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) g 
/*UNION
select * from 
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) i*/) j
group by j.loc_no order by j.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm]]>
	</ActualWagesWkToDt>
	
	<ActualWagesWkToDtTotal>
	<![CDATA[select lc.ar_no,NVL(ROUND(wge.ACTL_WGE_TOT_DTSG,0),0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select j.ar_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_TOT_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) f
UNION
select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) g 
/* UNION
select * from 
(select e.ar_no,e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no order by e.ar_no,e.loc_no) i */) j
group by j.ar_no order by j.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no]]>
	</ActualWagesWkToDtTotal>
	
	<VarianceWagesColumn>
<![CDATA[select nyu.loc_nm,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DPG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) wge
on wge.loc_nm=lc.loc_nm order by lc.loc_nm) nyu,
(select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_WGE_DTS),0) as ACTL_WGE_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceWagesColumn>
<VarianceWagesTotal>
<![CDATA[select nyu.ar_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select lc.ar_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.ta_pln_wage_amt),0) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) nyu,
(select lc.ar_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(ROUND(h.ACTL_WGE_DTS,0)) as ACTL_WGE_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,e.actl_amt as ACTL_WGE_DTS,e.actl_hrs as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.ar_no,g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) den
where nyu.ar_no = den.ar_no ]]>
</VarianceWagesTotal>	
<VarianceWagesWkToDt>
<![CDATA[select nyu.loc_nm,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_WAGES_DPS from
(select lc.loc_nm,NVL(ROUND(wge.PLN_WAGE_DTS,0),0) as WTD from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select e.loc_no,e.loc_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no,e.loc_nm order by e.loc_no,e.loc_nm) wge
on wge.loc_nm=lc.loc_nm) nyu,
(select lc.loc_nm,NVL(ROUND(wge.ACTL_WGE_DTSG,0),0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select j.loc_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_DTSG from 
(select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) f
UNION
select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) g 
/*UNION
select * from 
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) i*/) j
group by j.loc_no order by j.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceWagesWkToDt>
<VarianceWagesWkToDtTotal>
<![CDATA[select nyu.ar_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_WAGES_TOT_DPS from
(select lc.ar_no,NVL(ROUND(wge.PLN_WAGE_TOT_DTG,0),0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DTG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DTG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) wge
on wge.ar_no=lc.ar_no) nyu,
(select lc.ar_no,NVL(ROUND(wge.ACTL_WGE_TOT_DTSG,0),0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select j.ar_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_TOT_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) f
UNION
select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) g 
/* UNION
select * from 
(select e.ar_no,e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no order by e.ar_no,e.loc_no) i */) j
group by j.ar_no order by j.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) den
where nyu.ar_no = den.ar_no ]]>
</VarianceWagesWkToDtTotal>
</TCName>

<TCName name = "WagesPercentageView" >
	<PlannedWagesPrcntColumn>
	<![CDATA[select wge.loc_nm,CASE WHEN NVL(wge.mon,0) = 0 AND NVL(sls.mon,0) = 0 THEN 0 
     WHEN NVL(wge.mon,0) = 0 THEN 0 WHEN NVL(sls.mon,0) = 0 THEN 0 
ELSE NVL(ROUND((wge.mon / sls.mon)*100,2),0)  END as Mon,
CASE WHEN NVL(wge.tue,0) = 0 AND NVL(sls.tue,0) = 0 THEN 0 
     WHEN NVL(wge.tue,0) = 0 THEN 0 WHEN NVL(sls.tue,0) = 0 THEN 0   
ELSE NVL(ROUND((wge.tue / sls.tue)*100,2),0)  END as Tue,
CASE WHEN NVL(wge.wed,0) = 0 AND NVL(sls.wed,0) = 0 THEN 0 
     WHEN NVL(wge.wed,0) = 0 THEN 0 WHEN NVL(sls.wed,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.wed / sls.wed)*100,2),0)  END as Wed,
CASE WHEN NVL(wge.thu,0) = 0 AND NVL(sls.thu,0) = 0 THEN 0 
     WHEN NVL(wge.thu,0) = 0 THEN 0 WHEN NVL(sls.thu,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.thu / sls.thu)*100,2),0)  END as Thu,
CASE WHEN NVL(wge.fri,0) = 0 AND NVL(sls.fri,0) = 0 THEN 0 
     WHEN NVL(wge.fri,0) = 0 THEN 0 WHEN NVL(sls.fri,0) = 0 THEN 0    
ELSE NVL(ROUND((wge.fri / sls.fri)*100,2),0) END as Fri,
CASE WHEN NVL(wge.sat,0) = 0 AND NVL(sls.sat,0) = 0 THEN 0 
     WHEN NVL(wge.sat,0) = 0 THEN 0 WHEN NVL(sls.sat,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.sat / sls.sat)*100,2),0)  END as Sat,
CASE WHEN NVL(wge.sun,0) = 0 AND NVL(sls.sun,0) = 0 THEN 0  
     WHEN NVL(wge.sun,0) = 0 THEN 0 WHEN NVL(sls.sun,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.sun / sls.sun)*100,2),0) END as Sun  from
(select lc.loc_nm,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DPG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_WGE_DTS) as PLN_WGE_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) wge
on wge.loc_nm=lc.loc_nm order by lc.loc_nm) wge,
(select z.loc_nm,y.Mon,y.Tue,y.Wed,y.Thu,y.Fri,y.Sat,y.Sun from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DPG from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) y
on z.loc_nm=y.loc_nm order by z.loc_nm) sls
where wge.loc_nm=sls.loc_nm ]]>
	</PlannedWagesPrcntColumn>
	<PlannedWagesPrcntTotal>
	<![CDATA[select wge.ar_no,CASE WHEN NVL(wge.mon,0) = 0 AND NVL(sls.mon,0) = 0 THEN 0 
     WHEN NVL(wge.mon,0) = 0 THEN 0 WHEN NVL(sls.mon,0) = 0 THEN 0 
ELSE NVL(ROUND((wge.mon / sls.mon)*100,2),0)  END as Mon,
CASE WHEN NVL(wge.tue,0) = 0 AND NVL(sls.tue,0) = 0 THEN 0 
     WHEN NVL(wge.tue,0) = 0 THEN 0 WHEN NVL(sls.tue,0) = 0 THEN 0   
ELSE NVL(ROUND((wge.tue / sls.tue)*100,2),0)  END as Tue,
CASE WHEN NVL(wge.wed,0) = 0 AND NVL(sls.wed,0) = 0 THEN 0 
     WHEN NVL(wge.wed,0) = 0 THEN 0 WHEN NVL(sls.wed,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.wed / sls.wed)*100,2),0)  END as Wed,
CASE WHEN NVL(wge.thu,0) = 0 AND NVL(sls.thu,0) = 0 THEN 0 
     WHEN NVL(wge.thu,0) = 0 THEN 0 WHEN NVL(sls.thu,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.thu / sls.thu)*100,2),0)  END as Thu,
CASE WHEN NVL(wge.fri,0) = 0 AND NVL(sls.fri,0) = 0 THEN 0 
     WHEN NVL(wge.fri,0) = 0 THEN 0 WHEN NVL(sls.fri,0) = 0 THEN 0    
ELSE NVL(ROUND((wge.fri / sls.fri)*100,2),0) END as Fri,
CASE WHEN NVL(wge.sat,0) = 0 AND NVL(sls.sat,0) = 0 THEN 0 
     WHEN NVL(wge.sat,0) = 0 THEN 0 WHEN NVL(sls.sat,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.sat / sls.sat)*100,2),0)  END as Sat,
CASE WHEN NVL(wge.sun,0) = 0 AND NVL(sls.sun,0) = 0 THEN 0  
     WHEN NVL(wge.sun,0) = 0 THEN 0 WHEN NVL(sls.sun,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.sun / sls.sun)*100,2),0) END as Sun  from
(select lc.ar_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) wge,
(select z.ar_no,y.Mon,y.Tue,y.Wed,y.Thu,y.Fri,y.Sat,y.Sun,y.wtd from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DPG from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) y
on z.ar_no=y.ar_no order by z.ar_no) sls 
where wge.ar_no=sls.ar_no order by wge.ar_no]]>
	</PlannedWagesPrcntTotal>
	
	<PlannedWagesPrcntWkToDt>
	<![CDATA[select wge.loc_nm,CASE WHEN NVL(wge.PLN_WGE_DPG,0) = 0 AND NVL(sls.WTD,0) = 0 THEN 0 
     WHEN NVL(wge.PLN_WGE_DPG,0) = 0 THEN 0 WHEN NVL(sls.WTD,0) = 0 THEN 0 
ELSE NVL(ROUND((wge.PLN_WGE_DPG / sls.WTD)*100,2),0) END  as PLN_WGE_PRCNT_DPG from
(select lc.loc_nm,wge.PLN_WAGE_DTS as PLN_WGE_DPG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select e.loc_no,e.loc_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no,e.loc_nm order by e.loc_no,e.loc_nm) wge
on wge.loc_nm=lc.loc_nm) wge,
(select z.loc_nm,y.Mon,y.Tue,y.Wed,y.Thu,y.Fri,y.Sat,y.Sun,y.wtd from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DPG from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) y
on z.loc_nm=y.loc_nm order by z.loc_nm) sls
where wge.loc_nm=sls.loc_nm]]>
	</PlannedWagesPrcntWkToDt>
	<PlannedWagesPrcntWkToDtTotal>
	<![CDATA[select wge.ar_no,CASE WHEN NVL(wge.wtd,0) = 0 AND NVL(sls.wtd,0) = 0 THEN 0 
     WHEN NVL(wge.wtd,0) = 0 THEN 0 WHEN NVL(sls.wtd,0) = 0 THEN 0 
ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as WTD from
(select lc.ar_no,wge.PLN_WAGE_TOT_DTG as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DTG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DTG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) wge
on wge.ar_no=lc.ar_no) wge,
(select z.ar_no,y.Mon,y.Tue,y.Wed,y.Thu,y.Fri,y.Sat,y.Sun,y.wtd from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DTG from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) y
on z.ar_no=y.ar_no order by z.ar_no) sls 
where wge.ar_no=sls.ar_no order by wge.ar_no]]>
	</PlannedWagesPrcntWkToDtTotal>
	<ActualWagesPrcntColumn>
	<![CDATA[select wge.loc_nm,CASE WHEN NVL(wge.mon,0) = 0 AND NVL(sls.mon,0) = 0 THEN 0 
     WHEN NVL(wge.mon,0) = 0 THEN 0 WHEN NVL(sls.mon,0) = 0 THEN 0 
ELSE NVL(ROUND((wge.mon / sls.mon)*100,2),0)  END as Mon,
CASE WHEN NVL(wge.tue,0) = 0 AND NVL(sls.tue,0) = 0 THEN 0 
     WHEN NVL(wge.tue,0) = 0 THEN 0 WHEN NVL(sls.tue,0) = 0 THEN 0   
ELSE NVL(ROUND((wge.tue / sls.tue)*100,2),0)  END as Tue,
CASE WHEN NVL(wge.wed,0) = 0 AND NVL(sls.wed,0) = 0 THEN 0 
     WHEN NVL(wge.wed,0) = 0 THEN 0 WHEN NVL(sls.wed,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.wed / sls.wed)*100,2),0)  END as Wed,
CASE WHEN NVL(wge.thu,0) = 0 AND NVL(sls.thu,0) = 0 THEN 0 
     WHEN NVL(wge.thu,0) = 0 THEN 0 WHEN NVL(sls.thu,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.thu / sls.thu)*100,2),0)  END as Thu,
CASE WHEN NVL(wge.fri,0) = 0 AND NVL(sls.fri,0) = 0 THEN 0 
     WHEN NVL(wge.fri,0) = 0 THEN 0 WHEN NVL(sls.fri,0) = 0 THEN 0    
ELSE NVL(ROUND((wge.fri / sls.fri)*100,2),0) END as Fri,
CASE WHEN NVL(wge.sat,0) = 0 AND NVL(sls.sat,0) = 0 THEN 0 
     WHEN NVL(wge.sat,0) = 0 THEN 0 WHEN NVL(sls.sat,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.sat / sls.sat)*100,2),0)  END as Sat,
CASE WHEN NVL(wge.sun,0) = 0 AND NVL(sls.sun,0) = 0 THEN 0  
     WHEN NVL(wge.sun,0) = 0 THEN 0 WHEN NVL(sls.sun,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.sun / sls.sun)*100,2),0) END as Sun 
 from
(select lc.loc_nm,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSG)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSG)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSG)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSG)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSG)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSG)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSG)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm) wge,
(select lc.loc_nm,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSG)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSG)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSG)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSG)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSG)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSG)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSG)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm]]>
	</ActualWagesPrcntColumn>
		
	<ActualWagesPrcntTotal>
	<![CDATA[select wge.ar_no,CASE WHEN NVL(wge.mon,0) = 0 AND NVL(sls.mon,0) = 0 THEN 0 
     WHEN NVL(wge.mon,0) = 0 THEN 0 WHEN NVL(sls.mon,0) = 0 THEN 0 
ELSE NVL(ROUND((wge.mon / sls.mon)*100,2),0)  END as Mon,
CASE WHEN NVL(wge.tue,0) = 0 AND NVL(sls.tue,0) = 0 THEN 0 
     WHEN NVL(wge.tue,0) = 0 THEN 0 WHEN NVL(sls.tue,0) = 0 THEN 0   
ELSE NVL(ROUND((wge.tue / sls.tue)*100,2),0)  END as Tue,
CASE WHEN NVL(wge.wed,0) = 0 AND NVL(sls.wed,0) = 0 THEN 0 
     WHEN NVL(wge.wed,0) = 0 THEN 0 WHEN NVL(sls.wed,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.wed / sls.wed)*100,2),0)  END as Wed,
CASE WHEN NVL(wge.thu,0) = 0 AND NVL(sls.thu,0) = 0 THEN 0 
     WHEN NVL(wge.thu,0) = 0 THEN 0 WHEN NVL(sls.thu,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.thu / sls.thu)*100,2),0)  END as Thu,
CASE WHEN NVL(wge.fri,0) = 0 AND NVL(sls.fri,0) = 0 THEN 0 
     WHEN NVL(wge.fri,0) = 0 THEN 0 WHEN NVL(sls.fri,0) = 0 THEN 0    
ELSE NVL(ROUND((wge.fri / sls.fri)*100,2),0) END as Fri,
CASE WHEN NVL(wge.sat,0) = 0 AND NVL(sls.sat,0) = 0 THEN 0 
     WHEN NVL(wge.sat,0) = 0 THEN 0 WHEN NVL(sls.sat,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.sat / sls.sat)*100,2),0)  END as Sat,
CASE WHEN NVL(wge.sun,0) = 0 AND NVL(sls.sun,0) = 0 THEN 0  
     WHEN NVL(wge.sun,0) = 0 THEN 0 WHEN NVL(sls.sun,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.sun / sls.sun)*100,2),0) END as Sun 
 from
(select lc.ar_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSG)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSG)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSG)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSG)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSG)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSG)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSG)) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.ar_no,g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) wge,
(select lc.ar_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSG)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSG)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSG)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSG)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSG)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSG)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSG)) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) sls
where wge.ar_no=sls.ar_no order by wge.ar_no]]>
	</ActualWagesPrcntTotal>
	
	<ActualWagesPrcntWkToDt>
	<![CDATA[select wge.loc_nm,CASE WHEN NVL(wge.wtd,0) = 0 AND NVL(sls.wtd,0) = 0 THEN 0 
     WHEN NVL(wge.wtd,0) = 0 THEN 0 WHEN NVL(sls.wtd,0) = 0 THEN 0 
ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END  as ACTL_WGE_PCT_DTSG from 
(select lc.loc_nm,wge.ACTL_WGE_DTSG as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select j.loc_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_DTSG from 
(select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) f
UNION
select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) g 
/*UNION
select * from 
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) i */) j
group by j.loc_no order by j.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm) wge,
(select lc.loc_nm,sls.wtd as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm]]>
	</ActualWagesPrcntWkToDt>
	
	<ActualWagesPrcntWkToDtTotal>
	<![CDATA[select wge.ar_no,CASE WHEN NVL(wge.wtd,0) = 0 AND NVL(sls.wtd,0) = 0 THEN 0 
     WHEN NVL(wge.wtd,0) = 0 THEN 0 WHEN NVL(sls.wtd,0) = 0 THEN 0 
ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END  as ACTL_WGE_PCT_TOT_DTSG from 
(select lc.ar_no,wge.ACTL_WGE_TOT_DTSG as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select j.ar_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_TOT_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) f
UNION
select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) g 
/*UNION
select * from 
(select e.ar_no,e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no order by e.ar_no,e.loc_no) i*/) j
group by j.ar_no order by j.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) wge,
(select lc.ar_no,sls.wtd as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) sls
where wge.ar_no=sls.ar_no order by wge.ar_no]]>
	</ActualWagesPrcntWkToDtTotal>
	
	<VarianceWagesPrcntColumn>
<![CDATA[select nyu.loc_nm,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select wge.loc_nm,CASE WHEN NVL(wge.mon,0) = 0 AND NVL(sls.mon,0) = 0 THEN 0 
     WHEN NVL(wge.mon,0) = 0 THEN 0 WHEN NVL(sls.mon,0) = 0 THEN 0 
ELSE NVL(ROUND((wge.mon / sls.mon)*100,2),0)  END as Mon,
CASE WHEN NVL(wge.tue,0) = 0 AND NVL(sls.tue,0) = 0 THEN 0 
     WHEN NVL(wge.tue,0) = 0 THEN 0 WHEN NVL(sls.tue,0) = 0 THEN 0   
ELSE NVL(ROUND((wge.tue / sls.tue)*100,2),0)  END as Tue,
CASE WHEN NVL(wge.wed,0) = 0 AND NVL(sls.wed,0) = 0 THEN 0 
     WHEN NVL(wge.wed,0) = 0 THEN 0 WHEN NVL(sls.wed,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.wed / sls.wed)*100,2),0)  END as Wed,
CASE WHEN NVL(wge.thu,0) = 0 AND NVL(sls.thu,0) = 0 THEN 0 
     WHEN NVL(wge.thu,0) = 0 THEN 0 WHEN NVL(sls.thu,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.thu / sls.thu)*100,2),0)  END as Thu,
CASE WHEN NVL(wge.fri,0) = 0 AND NVL(sls.fri,0) = 0 THEN 0 
     WHEN NVL(wge.fri,0) = 0 THEN 0 WHEN NVL(sls.fri,0) = 0 THEN 0    
ELSE NVL(ROUND((wge.fri / sls.fri)*100,2),0) END as Fri,
CASE WHEN NVL(wge.sat,0) = 0 AND NVL(sls.sat,0) = 0 THEN 0 
     WHEN NVL(wge.sat,0) = 0 THEN 0 WHEN NVL(sls.sat,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.sat / sls.sat)*100,2),0)  END as Sat,
CASE WHEN NVL(wge.sun,0) = 0 AND NVL(sls.sun,0) = 0 THEN 0  
     WHEN NVL(wge.sun,0) = 0 THEN 0 WHEN NVL(sls.sun,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.sun / sls.sun)*100,2),0) END as Sun from
(select lc.loc_nm,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DPG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_WGE_DTS) as PLN_WGE_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) wge
on wge.loc_nm=lc.loc_nm order by lc.loc_nm) wge,
(select z.loc_nm,y.Mon,y.Tue,y.Wed,y.Thu,y.Fri,y.Sat,y.Sun from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DPG from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) y
on z.loc_nm=y.loc_nm order by z.loc_no) sls
where wge.loc_nm=sls.loc_nm) nyu,
(select wge.loc_nm,CASE WHEN NVL(wge.mon,0) = 0 AND NVL(sls.mon,0) = 0 THEN 0 
     WHEN NVL(wge.mon,0) = 0 THEN 0 WHEN NVL(sls.mon,0) = 0 THEN 0 
ELSE NVL(ROUND((wge.mon / sls.mon)*100,2),0)  END as Mon,
CASE WHEN NVL(wge.tue,0) = 0 AND NVL(sls.tue,0) = 0 THEN 0 
     WHEN NVL(wge.tue,0) = 0 THEN 0 WHEN NVL(sls.tue,0) = 0 THEN 0   
ELSE NVL(ROUND((wge.tue / sls.tue)*100,2),0)  END as Tue,
CASE WHEN NVL(wge.wed,0) = 0 AND NVL(sls.wed,0) = 0 THEN 0 
     WHEN NVL(wge.wed,0) = 0 THEN 0 WHEN NVL(sls.wed,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.wed / sls.wed)*100,2),0)  END as Wed,
CASE WHEN NVL(wge.thu,0) = 0 AND NVL(sls.thu,0) = 0 THEN 0 
     WHEN NVL(wge.thu,0) = 0 THEN 0 WHEN NVL(sls.thu,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.thu / sls.thu)*100,2),0)  END as Thu,
CASE WHEN NVL(wge.fri,0) = 0 AND NVL(sls.fri,0) = 0 THEN 0 
     WHEN NVL(wge.fri,0) = 0 THEN 0 WHEN NVL(sls.fri,0) = 0 THEN 0    
ELSE NVL(ROUND((wge.fri / sls.fri)*100,2),0) END as Fri,
CASE WHEN NVL(wge.sat,0) = 0 AND NVL(sls.sat,0) = 0 THEN 0 
     WHEN NVL(wge.sat,0) = 0 THEN 0 WHEN NVL(sls.sat,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.sat / sls.sat)*100,2),0)  END as Sat,
CASE WHEN NVL(wge.sun,0) = 0 AND NVL(sls.sun,0) = 0 THEN 0  
     WHEN NVL(wge.sun,0) = 0 THEN 0 WHEN NVL(sls.sun,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.sun / sls.sun)*100,2),0) END as Sun  from
(select lc.loc_nm,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSG)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSG)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSG)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSG)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSG)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSG)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSG)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm) wge,
(select lc.loc_nm,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSG)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSG)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSG)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSG)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSG)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSG)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSG)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceWagesPrcntColumn>
<VarianceWagesPrcntTotal>
<![CDATA[select nyu.ar_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select wge.ar_no,CASE WHEN NVL(wge.mon,0) = 0 AND NVL(sls.mon,0) = 0 THEN 0 
     WHEN NVL(wge.mon,0) = 0 THEN 0 WHEN NVL(sls.mon,0) = 0 THEN 0 
ELSE NVL(ROUND((wge.mon / sls.mon)*100,2),0)  END as Mon,
CASE WHEN NVL(wge.tue,0) = 0 AND NVL(sls.tue,0) = 0 THEN 0 
     WHEN NVL(wge.tue,0) = 0 THEN 0 WHEN NVL(sls.tue,0) = 0 THEN 0   
ELSE NVL(ROUND((wge.tue / sls.tue)*100,2),0)  END as Tue,
CASE WHEN NVL(wge.wed,0) = 0 AND NVL(sls.wed,0) = 0 THEN 0 
     WHEN NVL(wge.wed,0) = 0 THEN 0 WHEN NVL(sls.wed,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.wed / sls.wed)*100,2),0)  END as Wed,
CASE WHEN NVL(wge.thu,0) = 0 AND NVL(sls.thu,0) = 0 THEN 0 
     WHEN NVL(wge.thu,0) = 0 THEN 0 WHEN NVL(sls.thu,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.thu / sls.thu)*100,2),0)  END as Thu,
CASE WHEN NVL(wge.fri,0) = 0 AND NVL(sls.fri,0) = 0 THEN 0 
     WHEN NVL(wge.fri,0) = 0 THEN 0 WHEN NVL(sls.fri,0) = 0 THEN 0    
ELSE NVL(ROUND((wge.fri / sls.fri)*100,2),0) END as Fri,
CASE WHEN NVL(wge.sat,0) = 0 AND NVL(sls.sat,0) = 0 THEN 0 
     WHEN NVL(wge.sat,0) = 0 THEN 0 WHEN NVL(sls.sat,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.sat / sls.sat)*100,2),0)  END as Sat,
CASE WHEN NVL(wge.sun,0) = 0 AND NVL(sls.sun,0) = 0 THEN 0  
     WHEN NVL(wge.sun,0) = 0 THEN 0 WHEN NVL(sls.sun,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.sun / sls.sun)*100,2),0) END as Sun  from
(select lc.ar_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) wge,
(select z.ar_no,y.Mon,y.Tue,y.Wed,y.Thu,y.Fri,y.Sat,y.Sun,y.wtd from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DPG from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) y
on z.ar_no=y.ar_no order by z.ar_no) sls 
where wge.ar_no=sls.ar_no order by wge.ar_no) nyu,
(select wge.ar_no,CASE WHEN NVL(wge.mon,0) = 0 AND NVL(sls.mon,0) = 0 THEN 0 
     WHEN NVL(wge.mon,0) = 0 THEN 0 WHEN NVL(sls.mon,0) = 0 THEN 0 
ELSE NVL(ROUND((wge.mon / sls.mon)*100,2),0)  END as Mon,
CASE WHEN NVL(wge.tue,0) = 0 AND NVL(sls.tue,0) = 0 THEN 0 
     WHEN NVL(wge.tue,0) = 0 THEN 0 WHEN NVL(sls.tue,0) = 0 THEN 0   
ELSE NVL(ROUND((wge.tue / sls.tue)*100,2),0)  END as Tue,
CASE WHEN NVL(wge.wed,0) = 0 AND NVL(sls.wed,0) = 0 THEN 0 
     WHEN NVL(wge.wed,0) = 0 THEN 0 WHEN NVL(sls.wed,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.wed / sls.wed)*100,2),0)  END as Wed,
CASE WHEN NVL(wge.thu,0) = 0 AND NVL(sls.thu,0) = 0 THEN 0 
     WHEN NVL(wge.thu,0) = 0 THEN 0 WHEN NVL(sls.thu,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.thu / sls.thu)*100,2),0)  END as Thu,
CASE WHEN NVL(wge.fri,0) = 0 AND NVL(sls.fri,0) = 0 THEN 0 
     WHEN NVL(wge.fri,0) = 0 THEN 0 WHEN NVL(sls.fri,0) = 0 THEN 0    
ELSE NVL(ROUND((wge.fri / sls.fri)*100,2),0) END as Fri,
CASE WHEN NVL(wge.sat,0) = 0 AND NVL(sls.sat,0) = 0 THEN 0 
     WHEN NVL(wge.sat,0) = 0 THEN 0 WHEN NVL(sls.sat,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.sat / sls.sat)*100,2),0)  END as Sat,
CASE WHEN NVL(wge.sun,0) = 0 AND NVL(sls.sun,0) = 0 THEN 0  
     WHEN NVL(wge.sun,0) = 0 THEN 0 WHEN NVL(sls.sun,0) = 0 THEN 0     
ELSE NVL(ROUND((wge.sun / sls.sun)*100,2),0) END as Sun  from
(select lc.ar_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSG)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSG)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSG)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSG)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSG)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSG)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSG)) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.ar_no,g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) wge,
(select lc.ar_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSG)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSG)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSG)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSG)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSG)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSG)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSG)) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) sls
where wge.ar_no=sls.ar_no order by wge.ar_no) den
where nyu.ar_no = den.ar_no ]]>
</VarianceWagesPrcntTotal>	
<VarianceWagesPrcntWkToDt>
<![CDATA[select nyu.loc_nm,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_WAGESPERCNT_DPS from
(select wge.loc_nm,
CASE WHEN NVL(wge.PLN_WGE_DPG,0) = 0 AND NVL(sls.WTD,0) = 0 THEN 0 
     WHEN NVL(wge.PLN_WGE_DPG,0) = 0 THEN 0 WHEN NVL(sls.WTD,0) = 0 THEN 0 
ELSE NVL(ROUND((wge.PLN_WGE_DPG / sls.WTD)*100,2),0) END  as WTD from
(select lc.loc_nm,wge.PLN_WAGE_DTS as PLN_WGE_DPG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select e.loc_no,e.loc_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no,e.loc_nm order by e.loc_no,e.loc_nm) wge
on wge.loc_nm=lc.loc_nm) wge,
(select z.loc_nm,y.Mon,y.Tue,y.Wed,y.Thu,y.Fri,y.Sat,y.Sun,y.wtd from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DPG from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) y
on z.loc_nm=y.loc_nm order by z.loc_no) sls
where wge.loc_nm=sls.loc_nm) nyu,
(select wge.loc_nm,CASE WHEN NVL(wge.wtd,0) = 0 AND NVL(sls.wtd,0) = 0 THEN 0 
     WHEN NVL(wge.wtd,0) = 0 THEN 0 WHEN NVL(sls.wtd,0) = 0 THEN 0 
ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as wtd from 
(select lc.loc_nm,wge.ACTL_WGE_DTSG as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select j.loc_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_DTSG from 
(select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) f
UNION
select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) g 
/*UNION
select * from 
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) i */) j
group by j.loc_no order by j.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm) wge,
(select lc.loc_nm,sls.wtd as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceWagesPrcntWkToDt>
<VarianceWagesPrcntWkToDtTotal>
<![CDATA[select nyu.ar_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_WAGESPERCNT_TOT_DPS from
(select wge.ar_no,CASE WHEN NVL(wge.wtd,0) = 0 AND NVL(sls.wtd,0) = 0 THEN 0 
     WHEN NVL(wge.wtd,0) = 0 THEN 0 WHEN NVL(sls.wtd,0) = 0 THEN 0 
ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as WTD from
(select lc.ar_no,wge.PLN_WAGE_TOT_DTG as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DTG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DTG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) wge
on wge.ar_no=lc.ar_no) wge,
(select z.ar_no,y.Mon,y.Tue,y.Wed,y.Thu,y.Fri,y.Sat,y.Sun,y.wtd from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DTG from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) y
on z.ar_no=y.ar_no order by z.ar_no) sls 
where wge.ar_no=sls.ar_no order by wge.ar_no) nyu,
(select wge.ar_no,CASE WHEN NVL(wge.wtd,0) = 0 AND NVL(sls.wtd,0) = 0 THEN 0 
     WHEN NVL(wge.wtd,0) = 0 THEN 0 WHEN NVL(sls.wtd,0) = 0 THEN 0 
ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as wtd from 
(select lc.ar_no,wge.ACTL_WGE_TOT_DTSG as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select j.ar_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_TOT_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) f
UNION
select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) g 
/*UNION
select * from 
(select e.ar_no,e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no order by e.ar_no,e.loc_no) i*/) j
group by j.ar_no order by j.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) wge,
(select lc.ar_no,sls.wtd as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) sls
where wge.ar_no=sls.ar_no order by wge.ar_no) den
where nyu.ar_no = den.ar_no ]]>
</VarianceWagesPrcntWkToDtTotal>
</TCName>

<TCName name = "ORPercentageView" >
	<PlannedORPrcntColumn>
	<![CDATA[select sms_hrs.loc_nm,
	case when sms_hrs.mon=0 and pln_hrs.mon=0 then 0 when sms_hrs.mon=0 then 0 when pln_hrs.mon=0 then 0
else NVL(ROUND((sms_hrs.mon / pln_hrs.mon)*100,1),0) end as Mon,
case when sms_hrs.Tue=0 and pln_hrs.Tue=0 then 0 when sms_hrs.Tue=0 then 0 when pln_hrs.Tue=0 then 0
else NVL(ROUND((sms_hrs.Tue / pln_hrs.Tue)*100,1),0) end as Tue,
case when sms_hrs.Wed=0 and pln_hrs.Wed=0 then 0 when sms_hrs.Wed=0 then 0 when pln_hrs.Wed=0 then 0
else NVL(ROUND((sms_hrs.Wed / pln_hrs.Wed)*100,1),0) end as Wed,
case when sms_hrs.Thu=0 and pln_hrs.Thu=0 then 0 when sms_hrs.Thu=0 then 0 when pln_hrs.Thu=0 then 0
else NVL(ROUND((sms_hrs.Thu / pln_hrs.Thu)*100,1),0) end as Thu,
case when sms_hrs.Fri=0 and pln_hrs.Fri=0 then 0 when sms_hrs.Fri=0 then 0 when pln_hrs.Fri=0 then 0
else NVL(ROUND((sms_hrs.Fri / pln_hrs.Fri)*100,1),0) end as Fri,
case when sms_hrs.Sat=0 and pln_hrs.Sat=0 then 0 when sms_hrs.Sat=0 then 0 when pln_hrs.Sat=0 then 0
else NVL(ROUND((sms_hrs.Sat / pln_hrs.Sat)*100,1),0) end as Sat,
case when sms_hrs.Sun=0 and pln_hrs.Sun=0 then 0 when sms_hrs.Sun=0 then 0 when pln_hrs.Sun=0 then 0
else NVL(ROUND((sms_hrs.Sun / pln_hrs.Sun)*100,1),0) end as Sun from
(select lc.loc_nm,sms.mon,sms.tue,sms.wed,sms.thu,sms.fri,sms.sat,sms.sun from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DPG)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DPG)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DPG)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DPG)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DPG)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DPG)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DPG)) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and tsk.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z ) sms
on sms.loc_nm=lc.loc_nm) sms_hrs,
(select lc.loc_nm,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DPG)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DPG)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DPG)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DPG)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DPG)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DPG)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DPG)) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_HRS_DTS) as PLN_HRS_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
a.ta_pln_wage_amt as ta_pln_wage_amt,a.ta_pln_hrs as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no  IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) wge
on wge.loc_nm=lc.loc_nm) pln_hrs 
where sms_hrs.loc_nm=pln_hrs.loc_nm ]]>
	</PlannedORPrcntColumn>
	<PlannedORPrcntTotal>
	<![CDATA[select sms_hrs.ar_no,
case when sms_hrs.mon=0 and pln_hrs.mon=0 then 0 when sms_hrs.mon=0 then 0 when pln_hrs.mon=0 then 0
else NVL(ROUND((sms_hrs.mon / pln_hrs.mon)*100,1),0) end as Mon,
case when sms_hrs.Tue=0 and pln_hrs.Tue=0 then 0 when sms_hrs.Tue=0 then 0 when pln_hrs.Tue=0 then 0
else NVL(ROUND((sms_hrs.Tue / pln_hrs.Tue)*100,1),0) end as Tue,
case when sms_hrs.Wed=0 and pln_hrs.Wed=0 then 0 when sms_hrs.Wed=0 then 0 when pln_hrs.Wed=0 then 0
else NVL(ROUND((sms_hrs.Wed / pln_hrs.Wed)*100,1),0) end as Wed,
case when sms_hrs.Thu=0 and pln_hrs.Thu=0 then 0 when sms_hrs.Thu=0 then 0 when pln_hrs.Thu=0 then 0
else NVL(ROUND((sms_hrs.Thu / pln_hrs.Thu)*100,1),0) end as Thu,
case when sms_hrs.Fri=0 and pln_hrs.Fri=0 then 0 when sms_hrs.Fri=0 then 0 when pln_hrs.Fri=0 then 0
else NVL(ROUND((sms_hrs.Fri / pln_hrs.Fri)*100,1),0) end as Fri,
case when sms_hrs.Sat=0 and pln_hrs.Sat=0 then 0 when sms_hrs.Sat=0 then 0 when pln_hrs.Sat=0 then 0
else NVL(ROUND((sms_hrs.Sat / pln_hrs.Sat)*100,1),0) end as Sat,
case when sms_hrs.Sun=0 and pln_hrs.Sun=0 then 0 when sms_hrs.Sun=0 then 0 when pln_hrs.Sun=0 then 0
else NVL(ROUND((sms_hrs.Sun / pln_hrs.Sun)*100,1),0) end as Sun	from  
(select lc.ar_no,sms.mon,sms.tue,sms.wed,sms.thu,sms.fri,sms.sat,sms.sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and tsk.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z ) sms
on sms.ar_no=lc.ar_no) sms_hrs,
(select lc.ar_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_HRS_DTS) as PLN_HRS_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
a.ta_pln_wage_amt as ta_pln_wage_amt,a.ta_pln_hrs as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no) pln_hrs 
where sms_hrs.ar_no=pln_hrs.ar_no order by sms_hrs.ar_no]]>
	</PlannedORPrcntTotal>
	
	<PlannedORPrcntWkToDt>
	<![CDATA[select sms_hrs.loc_nm,
case when NVL(sms_hrs.wtd,0)=0 and NVL(pln_hrs.wtd,0)=0 then 0 
when NVL(sms_hrs.wtd,0)=0 then 0 when NVL(pln_hrs.wtd,0)=0 then 0 
else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end as WTD from  
(select lc.loc_nm,sms.wtd from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DPG)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DPG)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DPG)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DPG)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DPG)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DPG)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DPG)) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and tsk.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z ) sms
on sms.loc_nm=lc.loc_nm) sms_hrs,
(select lc.loc_no,lc.loc_nm,sum(wge.PLN_HOURS_DTS) as WTD from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
a.ta_pln_wage_amt as ta_pln_wage_amt,a.wage_adj_amt as wage_adj_amt,a.ta_pln_hrs as ta_pln_hrs,a.wage_adj_hrs as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm order by e.loc_no,e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_no,lc.loc_nm order by lc.loc_nm) pln_hrs 
where sms_hrs.loc_nm=pln_hrs.loc_nm]]>
	</PlannedORPrcntWkToDt>
	<PlannedORPrcntWkToDtTotal>
	<![CDATA[select sms_hrs.ar_no,
case when NVL(sms_hrs.wtd,0)=0 and NVL(pln_hrs.wtd,0)=0 then 0 
when NVL(sms_hrs.wtd,0)=0 then 0 when NVL(pln_hrs.wtd,0)=0 then 0 
else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end as WTD from  
(select lc.ar_no,sms.wtd from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and tsk.dept_no IN ('Dept')  
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z ) sms
on sms.ar_no=lc.ar_no) sms_hrs,
(select lc.ar_no,sum(wge.PLN_HOURS_DTS) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
a.ta_pln_wage_amt as ta_pln_wage_amt,a.wage_adj_amt as wage_adj_amt,a.ta_pln_hrs as ta_pln_hrs,a.wage_adj_hrs as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm order by e.ar_no,e.loc_no,e.loc_nm,e.dply_seq) wge
on wge.ar_no=lc.ar_no group by lc.ar_no order by lc.ar_no) pln_hrs 
where sms_hrs.ar_no=pln_hrs.ar_no]]>
	</PlannedORPrcntWkToDtTotal>
	<ActualORPrcntColumn>
	<![CDATA[select actl_sms.loc_nm,
case when actl_sms.mon=0 and actl_hrs.mon=0 then 0 when actl_sms.mon=0 then 0 when actl_hrs.mon=0 then 0
else NVL(ROUND((actl_sms.mon / actl_hrs.mon)*100,1),0) end as Mon,
case when actl_sms.Tue=0 and actl_hrs.Tue=0 then 0 when actl_sms.Tue=0 then 0 when actl_hrs.Tue=0 then 0
else NVL(ROUND((actl_sms.Tue / actl_hrs.Tue)*100,1),0) end as Tue,
case when actl_sms.Wed=0 and actl_hrs.Wed=0 then 0 when actl_sms.Wed=0 then 0 when actl_hrs.Wed=0 then 0
else NVL(ROUND((actl_sms.Wed / actl_hrs.Wed)*100,1),0) end as Wed,
case when actl_sms.Thu=0 and actl_hrs.Thu=0 then 0 when actl_sms.Thu=0 then 0 when actl_hrs.Thu=0 then 0
else NVL(ROUND((actl_sms.Thu / actl_hrs.Thu)*100,1),0) end as Thu,
case when actl_sms.Fri=0 and actl_hrs.Fri=0 then 0 when actl_sms.Fri=0 then 0 when actl_hrs.Fri=0 then 0
else NVL(ROUND((actl_sms.Fri / actl_hrs.Fri)*100,1),0) end as Fri,
case when actl_sms.Sat=0 and actl_hrs.Sat=0 then 0 when actl_sms.Sat=0 then 0 when actl_hrs.Sat=0 then 0
else NVL(ROUND((actl_sms.Sat / actl_hrs.Sat)*100,1),0) end as Sat,
case when actl_sms.Sun=0 and actl_hrs.Sun=0 then 0 when actl_sms.Sun=0 then 0 when actl_hrs.Sun=0 then 0
else NVL(ROUND((actl_sms.Sun / actl_hrs.Sun)*100,1),0) end as Sun from
(select e.loc_nm,(sms_src.Monday) as Mon,(sms_src.Tuesday) as Tue,(sms_src.Wednesday) as Wed,(sms_src.Thursday) as Thu,(sms_src.Friday) as Fri,(sms_src.Saturday) as Sat,(sms_src.Sunday) as Sun from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area' 
 order by div_no,rgn_no,zone_no,ar_no,loc_nm) e 
LEFT OUTER JOIN 
(select loc_no ,
Sum(decode(day_of_wk, 0 , plan_actl_sms )) Monday,
sum(decode(day_of_wk, 1 , plan_actl_sms )) Tuesday,
sum(decode(day_of_wk, 2 , plan_actl_sms )) Wednesday,
sum(decode(day_of_wk, 3 , plan_actl_sms )) Thursday,
sum(decode(day_of_wk, 4 , plan_actl_sms )) Friday,
sum(decode(day_of_wk, 5 , plan_actl_sms )) Saturday,
sum(decode(day_of_wk, 6 , plan_actl_sms )) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as plan_actl_sms
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no in (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area') --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN ('Dept')
order by src.loc_no,src.dept_no,src.task_no ) sto group by loc_no) sms_src on sms_src.loc_no=e.loc_no order by e.loc_nm)actl_sms
LEFT OUTER JOIN
(select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm)actl_hrs
on actl_hrs.loc_nm=actl_sms.loc_nm]]>
	</ActualORPrcntColumn>
	
	<ActualORPrcntTotal>
	<![CDATA[select 'TOTAL' as Total,
case when actl_sms.mon=0 and actl_hrs.mon=0 then 0 when actl_sms.mon=0 then 0 when actl_hrs.mon=0 then 0 
else NVL(ROUND((actl_sms.mon / actl_hrs.mon)*100,1),0) end as Mon,
case when actl_sms.tue=0 and actl_hrs.tue=0 then 0 when actl_sms.tue=0 then 0 when actl_hrs.tue=0 then 0 
else NVL(ROUND((actl_sms.tue / actl_hrs.tue)*100,1),0) end as tue,
case when actl_sms.wed=0 and actl_hrs.wed=0 then 0 when actl_sms.wed=0 then 0 when actl_hrs.wed=0 then 0 
else NVL(ROUND((actl_sms.wed / actl_hrs.wed)*100,1),0) end as wed,
case when actl_sms.thu=0 and actl_hrs.thu=0 then 0 when actl_sms.thu=0 then 0 when actl_hrs.thu=0 then 0 
else NVL(ROUND((actl_sms.thu / actl_hrs.thu)*100,1),0) end as thu,
case when actl_sms.fri=0 and actl_hrs.fri=0 then 0 when actl_sms.fri=0 then 0 when actl_hrs.fri=0 then 0 
else NVL(ROUND((actl_sms.fri / actl_hrs.fri)*100,1),0) end as fri,
case when actl_sms.sat=0 and actl_hrs.sat=0 then 0 when actl_sms.sat=0 then 0 when actl_hrs.sat=0 then 0 
else NVL(ROUND((actl_sms.sat / actl_hrs.sat)*100,1),0) end as sat,
case when actl_sms.sun=0 and actl_hrs.sun=0 then 0 when actl_sms.sun=0 then 0 when actl_hrs.sun=0 then 0 
else NVL(ROUND((actl_sms.sun / actl_hrs.sun)*100,1),0) end as sun from  
(select 'TOTAL' as Total,sum(Monday)as Mon,sum(Tuesday) as TUE,sum(Wednesday)as WED,sum(Thursday)as THU,sum(Friday) as FRI,sum(Saturday) as SAT,sum(Sunday) as SUN from
(select e.loc_nm,sms_src.Monday,sms_src.Tuesday,sms_src.Wednesday,sms_src.Thursday,sms_src.Friday,sms_src.Saturday,sms_src.Sunday from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and ar_no='Area'  order by div_no,rgn_no,zone_no,ar_no) e LEFT OUTER JOIN 
(select loc_no ,
Sum(decode(day_of_wk, 0 , plan_actl_sms )) Monday,
sum(decode(day_of_wk, 1 , plan_actl_sms )) Tuesday,
sum(decode(day_of_wk, 2 , plan_actl_sms )) Wednesday,
sum(decode(day_of_wk, 3 , plan_actl_sms )) Thursday,
sum(decode(day_of_wk, 4 , plan_actl_sms )) Friday,
sum(decode(day_of_wk, 5 , plan_actl_sms )) Saturday,
sum(decode(day_of_wk, 6 , plan_actl_sms )) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as plan_actl_sms
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no  and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no in (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area') --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN ('Dept')
order by src.loc_no,src.dept_no,src.task_no ) sto group by loc_no) sms_src on sms_src.loc_no=e.loc_no))actl_sms,
(select lc.ar_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.ar_no,g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no)actl_hrs]]>
	</ActualORPrcntTotal>
	<ActualORPrcntWkToDt>
	<![CDATA[select actl_sms.loc_nm,
	case when NVL(actl_sms.actl_actl_sms_wk_to_dt,0)=0 and NVL(actl_hrs.wtd,0)=0 then 0 
	when NVL(actl_sms.actl_actl_sms_wk_to_dt,0)=0 then 0 when  NVL(actl_hrs.wtd,0)=0 then 0 
	else NVL(ROUND((actl_sms.actl_actl_sms_wk_to_dt / actl_hrs.wtd)*100,1),0) end as WTD from  
(select e.loc_nm,actl_actl_sms_wk_to_dt from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and ar_no='Area'  order by div_no,rgn_no,zone_no,ar_no,loc_nm) e LEFT OUTER JOIN 
(select loc_no ,Sum(plan_actl_sms) as actl_actl_sms_wk_to_dt
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as plan_actl_sms
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no  and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no in (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area') --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN ('Dept')
order by src.loc_no,src.dept_no,src.task_no ) sto group by loc_no) sms_src on sms_src.loc_no=e.loc_no order by e.loc_nm)actl_sms
LEFT OUTER JOIN
(select lc.loc_nm,NVL(wge.ACTL_HRS_DTSG,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select j.loc_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_DTSG from 
(select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) f
/*UNION
select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) g 
UNION
select * from 
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) i*/) j
group by j.loc_no order by j.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm)actl_hrs
on actl_sms.loc_nm=actl_hrs.loc_nm]]>
	</ActualORPrcntWkToDt>	
	
	<ActualORPrcntWkToDtTotal>
	<![CDATA[select 'STORE TOTAL' as Totl,
	case when NVL(actl_sms.Storetotal_wktodt,0)=0 and NVL(actl_hrs.wtd,0)=0 then 0 
	when NVL(actl_sms.Storetotal_wktodt,0)=0 then 0 when NVL(actl_hrs.wtd,0)=0 then 0 
	else NVL(ROUND((actl_sms.Storetotal_wktodt / actl_hrs.wtd)*100,1),0) end as WTD from 
(select 'STORE TOTAL' as Totl,sum(actl_sms_hrs_wk_to_dt) as Storetotal_wktodt from
(select e.loc_nm,actl_sms_hrs_wk_to_dt from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and ar_no='Area'  order by div_no,rgn_no,zone_no,ar_no) e LEFT OUTER JOIN 
(select loc_no ,Sum(plan_sms_hrs) as actl_sms_hrs_wk_to_dt
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no  and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no in (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area') --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN ('Dept')
order by src.loc_no,src.dept_no,src.task_no ) sto group by loc_no) sms_src on sms_src.loc_no=e.loc_no))actl_sms,
(select lc.ar_no,NVL(wge.ACTL_HRS_TOT_DTSG,0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select j.ar_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_TOT_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) f
/*UNION
select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) g 
UNION
select * from 
(select e.ar_no,e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no order by e.ar_no,e.loc_no) i*/) j
group by j.ar_no order by j.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no)actl_hrs]]>
	</ActualORPrcntWkToDtTotal>
	
<PlannedORPrcntColumnPayPlan>
	<![CDATA[select sms_hrs.loc_nm,
	case when sms_hrs.mon=0 and pln_hrs.mon=0 then 0 when sms_hrs.mon=0 then 0 when pln_hrs.mon=0 then 0
else NVL(ROUND((sms_hrs.mon / pln_hrs.mon)*100,1),0) end as Mon,
case when sms_hrs.Tue=0 and pln_hrs.Tue=0 then 0 when sms_hrs.Tue=0 then 0 when pln_hrs.Tue=0 then 0
else NVL(ROUND((sms_hrs.Tue / pln_hrs.Tue)*100,1),0) end as Tue,
case when sms_hrs.Wed=0 and pln_hrs.Wed=0 then 0 when sms_hrs.Wed=0 then 0 when pln_hrs.Wed=0 then 0
else NVL(ROUND((sms_hrs.Wed / pln_hrs.Wed)*100,1),0) end as Wed,
case when sms_hrs.Thu=0 and pln_hrs.Thu=0 then 0 when sms_hrs.Thu=0 then 0 when pln_hrs.Thu=0 then 0
else NVL(ROUND((sms_hrs.Thu / pln_hrs.Thu)*100,1),0) end as Thu,
case when sms_hrs.Fri=0 and pln_hrs.Fri=0 then 0 when sms_hrs.Fri=0 then 0 when pln_hrs.Fri=0 then 0
else NVL(ROUND((sms_hrs.Fri / pln_hrs.Fri)*100,1),0) end as Fri,
case when sms_hrs.Sat=0 and pln_hrs.Sat=0 then 0 when sms_hrs.Sat=0 then 0 when pln_hrs.Sat=0 then 0
else NVL(ROUND((sms_hrs.Sat / pln_hrs.Sat)*100,1),0) end as Sat,
case when sms_hrs.Sun=0 and pln_hrs.Sun=0 then 0 when sms_hrs.Sun=0 then 0 when pln_hrs.Sun=0 then 0
else NVL(ROUND((sms_hrs.Sun / pln_hrs.Sun)*100,1),0) end as Sun from
(select lc.loc_nm,sms.mon,sms.tue,sms.wed,sms.thu,sms.fri,sms.sat,sms.sun from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DPG)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DPG)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DPG)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DPG)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DPG)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DPG)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DPG)) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and tsk.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z ) sms
on sms.loc_nm=lc.loc_nm) sms_hrs,
(select lc.loc_nm,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DPG)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DPG)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DPG)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DPG)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DPG)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DPG)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DPG)) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_HRS_DTS) as PLN_HRS_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
a.ta_pln_wage_amt as ta_pln_wage_amt,a.ta_pln_adj_hrs as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no  IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) wge
on wge.loc_nm=lc.loc_nm) pln_hrs 
where sms_hrs.loc_nm=pln_hrs.loc_nm ]]>
	</PlannedORPrcntColumnPayPlan>
	<PlannedORPrcntTotalPayPlan>
	<![CDATA[select sms_hrs.ar_no,
	case when sms_hrs.mon=0 and pln_hrs.mon=0 then 0 when sms_hrs.mon=0 then 0 when pln_hrs.mon=0 then 0
else NVL(ROUND((sms_hrs.mon / pln_hrs.mon)*100,1),0) end as Mon,
case when sms_hrs.Tue=0 and pln_hrs.Tue=0 then 0 when sms_hrs.Tue=0 then 0 when pln_hrs.Tue=0 then 0
else NVL(ROUND((sms_hrs.Tue / pln_hrs.Tue)*100,1),0) end as Tue,
case when sms_hrs.Wed=0 and pln_hrs.Wed=0 then 0 when sms_hrs.Wed=0 then 0 when pln_hrs.Wed=0 then 0
else NVL(ROUND((sms_hrs.Wed / pln_hrs.Wed)*100,1),0) end as Wed,
case when sms_hrs.Thu=0 and pln_hrs.Thu=0 then 0 when sms_hrs.Thu=0 then 0 when pln_hrs.Thu=0 then 0
else NVL(ROUND((sms_hrs.Thu / pln_hrs.Thu)*100,1),0) end as Thu,
case when sms_hrs.Fri=0 and pln_hrs.Fri=0 then 0 when sms_hrs.Fri=0 then 0 when pln_hrs.Fri=0 then 0
else NVL(ROUND((sms_hrs.Fri / pln_hrs.Fri)*100,1),0) end as Fri,
case when sms_hrs.Sat=0 and pln_hrs.Sat=0 then 0 when sms_hrs.Sat=0 then 0 when pln_hrs.Sat=0 then 0
else NVL(ROUND((sms_hrs.Sat / pln_hrs.Sat)*100,1),0) end as Sat,
case when sms_hrs.Sun=0 and pln_hrs.Sun=0 then 0 when sms_hrs.Sun=0 then 0 when pln_hrs.Sun=0 then 0
else NVL(ROUND((sms_hrs.Sun / pln_hrs.Sun)*100,1),0) end as Sun	from  
(select lc.ar_no,sms.mon,sms.tue,sms.wed,sms.thu,sms.fri,sms.sat,sms.sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and tsk.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z ) sms
on sms.ar_no=lc.ar_no) sms_hrs,
(select lc.ar_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_HRS_DTS) as PLN_HRS_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
a.ta_pln_wage_amt as ta_pln_wage_amt,a.ta_pln_adj_hrs as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no) pln_hrs 
where sms_hrs.ar_no=pln_hrs.ar_no order by sms_hrs.ar_no]]>
	</PlannedORPrcntTotalPayPlan>
	
	<PlannedORPrcntWkToDtPayPlan>
	<![CDATA[select sms_hrs.loc_nm,
	case when NVL(sms_hrs.wtd,0)=0 and NVL(pln_hrs.wtd,0)=0 then 0 
	when NVL(sms_hrs.wtd,0)=0 then 0 when NVL(pln_hrs.wtd,0)=0 then 0 
	else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end as WTD from  
(select lc.loc_nm,sms.wtd from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DPG)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DPG)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DPG)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DPG)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DPG)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DPG)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DPG)) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and tsk.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z ) sms
on sms.loc_nm=lc.loc_nm) sms_hrs,
(select lc.loc_no,lc.loc_nm,sum(wge.PLN_HOURS_DTS) as WTD from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
a.ta_pln_wage_amt as ta_pln_wage_amt,a.wage_adj_amt as wage_adj_amt,a.ta_pln_adj_hrs as ta_pln_hrs,a.wage_adj_hrs as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm order by e.loc_no,e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_no,lc.loc_nm order by lc.loc_nm) pln_hrs 
where sms_hrs.loc_nm=pln_hrs.loc_nm]]>
	</PlannedORPrcntWkToDtPayPlan>
	<PlannedORPrcntWkToDtTotalPayPlan>
	<![CDATA[select sms_hrs.ar_no,
	case when NVL(sms_hrs.wtd,0)=0 and NVL(pln_hrs.wtd,0)=0 then 0 
	when NVL(sms_hrs.wtd,0)=0 then 0 when NVL(pln_hrs.wtd,0)=0 then 0 
	else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end 	as WTD from  
(select lc.ar_no,sms.wtd from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and tsk.dept_no IN ('Dept')  
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z ) sms
on sms.ar_no=lc.ar_no) sms_hrs,
(select lc.ar_no,sum(wge.PLN_HOURS_DTS) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
a.ta_pln_wage_amt as ta_pln_wage_amt,a.wage_adj_amt as wage_adj_amt,a.ta_pln_adj_hrs as ta_pln_hrs,a.wage_adj_hrs as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm order by e.ar_no,e.loc_no,e.loc_nm,e.dply_seq) wge
on wge.ar_no=lc.ar_no group by lc.ar_no order by lc.ar_no) pln_hrs 
where sms_hrs.ar_no=pln_hrs.ar_no]]>
	</PlannedORPrcntWkToDtTotalPayPlan>
	<ActualORPrcntColumnPayPlan>
	<![CDATA[select actl_sms.loc_nm,
case when actl_sms.mon=0 and actl_hrs.mon=0 then 0 when actl_sms.mon=0 then 0 when actl_hrs.mon=0 then 0
else NVL(ROUND((actl_sms.mon / actl_hrs.mon)*100,1),0) end as Mon,
case when actl_sms.Tue=0 and actl_hrs.Tue=0 then 0 when actl_sms.Tue=0 then 0 when actl_hrs.Tue=0 then 0
else NVL(ROUND((actl_sms.Tue / actl_hrs.Tue)*100,1),0) end as Tue,
case when actl_sms.Wed=0 and actl_hrs.Wed=0 then 0 when actl_sms.Wed=0 then 0 when actl_hrs.Wed=0 then 0
else NVL(ROUND((actl_sms.Wed / actl_hrs.Wed)*100,1),0) end as Wed,
case when actl_sms.Thu=0 and actl_hrs.Thu=0 then 0 when actl_sms.Thu=0 then 0 when actl_hrs.Thu=0 then 0
else NVL(ROUND((actl_sms.Thu / actl_hrs.Thu)*100,1),0) end as Thu,
case when actl_sms.Fri=0 and actl_hrs.Fri=0 then 0 when actl_sms.Fri=0 then 0 when actl_hrs.Fri=0 then 0
else NVL(ROUND((actl_sms.Fri / actl_hrs.Fri)*100,1),0) end as Fri,
case when actl_sms.Sat=0 and actl_hrs.Sat=0 then 0 when actl_sms.Sat=0 then 0 when actl_hrs.Sat=0 then 0
else NVL(ROUND((actl_sms.Sat / actl_hrs.Sat)*100,1),0) end as Sat,
case when actl_sms.Sun=0 and actl_hrs.Sun=0 then 0 when actl_sms.Sun=0 then 0 when actl_hrs.Sun=0 then 0
else NVL(ROUND((actl_sms.Sun / actl_hrs.Sun)*100,1),0) end as Sun from
(select e.loc_nm,(sms_src.Monday) as Mon,(sms_src.Tuesday) as Tue,(sms_src.Wednesday) as Wed,(sms_src.Thursday) as Thu,(sms_src.Friday) as Fri,(sms_src.Saturday) as Sat,(sms_src.Sunday) as Sun from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area' 
 order by div_no,rgn_no,zone_no,ar_no,loc_nm) e 
LEFT OUTER JOIN 
(select loc_no ,
Sum(decode(day_of_wk, 0 , plan_actl_sms )) Monday,
sum(decode(day_of_wk, 1 , plan_actl_sms )) Tuesday,
sum(decode(day_of_wk, 2 , plan_actl_sms )) Wednesday,
sum(decode(day_of_wk, 3 , plan_actl_sms )) Thursday,
sum(decode(day_of_wk, 4 , plan_actl_sms )) Friday,
sum(decode(day_of_wk, 5 , plan_actl_sms )) Saturday,
sum(decode(day_of_wk, 6 , plan_actl_sms )) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as plan_actl_sms
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no in (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area') --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN ('Dept')
order by src.loc_no,src.dept_no,src.task_no ) sto group by loc_no) sms_src on sms_src.loc_no=e.loc_no order by e.loc_nm)actl_sms
LEFT OUTER JOIN
(select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm)actl_hrs
on actl_hrs.loc_nm=actl_sms.loc_nm]]>
	</ActualORPrcntColumnPayPlan>
	
	<ActualORPrcntTotalPayPlan>
	<![CDATA[select 'TOTAL' as Total,
case when actl_sms.mon=0 and actl_hrs.mon=0 then 0 when actl_sms.mon=0 then 0 when actl_hrs.mon=0 then 0 
else NVL(ROUND((actl_sms.mon / actl_hrs.mon)*100,1),0) end as Mon,
case when actl_sms.tue=0 and actl_hrs.tue=0 then 0 when actl_sms.tue=0 then 0 when actl_hrs.tue=0 then 0 
else NVL(ROUND((actl_sms.tue / actl_hrs.tue)*100,1),0) end as tue,
case when actl_sms.wed=0 and actl_hrs.wed=0 then 0 when actl_sms.wed=0 then 0 when actl_hrs.wed=0 then 0 
else NVL(ROUND((actl_sms.wed / actl_hrs.wed)*100,1),0) end as wed,
case when actl_sms.thu=0 and actl_hrs.thu=0 then 0 when actl_sms.thu=0 then 0 when actl_hrs.thu=0 then 0 
else NVL(ROUND((actl_sms.thu / actl_hrs.thu)*100,1),0) end as thu,
case when actl_sms.fri=0 and actl_hrs.fri=0 then 0 when actl_sms.fri=0 then 0 when actl_hrs.fri=0 then 0 
else NVL(ROUND((actl_sms.fri / actl_hrs.fri)*100,1),0) end as fri,
case when actl_sms.sat=0 and actl_hrs.sat=0 then 0 when actl_sms.sat=0 then 0 when actl_hrs.sat=0 then 0 
else NVL(ROUND((actl_sms.sat / actl_hrs.sat)*100,1),0) end as sat,
case when actl_sms.sun=0 and actl_hrs.sun=0 then 0 when actl_sms.sun=0 then 0 when actl_hrs.sun=0 then 0 
else NVL(ROUND((actl_sms.sun / actl_hrs.sun)*100,1),0) end as sun from  
(select 'TOTAL' as Total,sum(Monday)as Mon,sum(Tuesday) as TUE,sum(Wednesday)as WED,sum(Thursday)as THU,sum(Friday) as FRI,sum(Saturday) as SAT,sum(Sunday) as SUN from
(select e.loc_nm,sms_src.Monday,sms_src.Tuesday,sms_src.Wednesday,sms_src.Thursday,sms_src.Friday,sms_src.Saturday,sms_src.Sunday from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and ar_no='Area'  order by div_no,rgn_no,zone_no,ar_no) e LEFT OUTER JOIN 
(select loc_no ,
Sum(decode(day_of_wk, 0 , plan_actl_sms )) Monday,
sum(decode(day_of_wk, 1 , plan_actl_sms )) Tuesday,
sum(decode(day_of_wk, 2 , plan_actl_sms )) Wednesday,
sum(decode(day_of_wk, 3 , plan_actl_sms )) Thursday,
sum(decode(day_of_wk, 4 , plan_actl_sms )) Friday,
sum(decode(day_of_wk, 5 , plan_actl_sms )) Saturday,
sum(decode(day_of_wk, 6 , plan_actl_sms )) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as plan_actl_sms
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no  and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no in (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area') --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN ('Dept')
order by src.loc_no,src.dept_no,src.task_no ) sto group by loc_no) sms_src on sms_src.loc_no=e.loc_no))actl_sms,
(select lc.ar_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.ar_no,g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no)actl_hrs]]>
	</ActualORPrcntTotalPayPlan>
	<ActualORPrcntWkToDtPayPlan>
	<![CDATA[select actl_sms.loc_nm,
	case when actl_sms.actl_actl_sms_wk_to_dt=0 and actl_hrs.wtd=0 then 0 
	when actl_sms.actl_actl_sms_wk_to_dt=0 then 0 
	when actl_hrs.wtd=0 then 0 
	else NVL(ROUND((actl_sms.actl_actl_sms_wk_to_dt / actl_hrs.wtd)*100,1),0) end as WTD from  
(select e.loc_nm,actl_actl_sms_wk_to_dt from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and ar_no='Area'  order by div_no,rgn_no,zone_no,ar_no,loc_nm) e LEFT OUTER JOIN 
(select loc_no ,Sum(plan_actl_sms) as actl_actl_sms_wk_to_dt
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as plan_actl_sms
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no  and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no in (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area') --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN ('Dept')
order by src.loc_no,src.dept_no,src.task_no ) sto group by loc_no) sms_src on sms_src.loc_no=e.loc_no order by e.loc_nm)actl_sms
LEFT OUTER JOIN
(select lc.loc_nm,NVL(wge.ACTL_HRS_DTSG,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select j.loc_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_DTSG from 
(select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) f
/*UNION
select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) g 
UNION
select * from 
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) i*/) j
group by j.loc_no order by j.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm)actl_hrs
on actl_sms.loc_nm=actl_hrs.loc_nm]]>
	</ActualORPrcntWkToDtPayPlan>	
	
	<ActualORPrcntWkToDtTotalPayPlan>
	<![CDATA[select 'STORE TOTAL' as Totl,
	case when NVL(actl_sms.Storetotal_wktodt,0)=0 and NVL(actl_hrs.wtd,0)=0 then 0 
	when NVL(actl_sms.Storetotal_wktodt,0)=0 then 0 when NVL(actl_hrs.wtd,0)=0 then 0 
	else NVL(ROUND((actl_sms.Storetotal_wktodt / actl_hrs.wtd)*100,1),0) end as WTD from 
(select 'STORE TOTAL' as Totl,sum(actl_sms_hrs_wk_to_dt) as Storetotal_wktodt from
(select e.loc_nm,actl_sms_hrs_wk_to_dt from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and ar_no='Area'  order by div_no,rgn_no,zone_no,ar_no) e LEFT OUTER JOIN 
(select loc_no ,Sum(plan_sms_hrs) as actl_sms_hrs_wk_to_dt
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no  and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no in (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area') --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN ('Dept')
order by src.loc_no,src.dept_no,src.task_no ) sto group by loc_no) sms_src on sms_src.loc_no=e.loc_no))actl_sms,
(select lc.ar_no,NVL(wge.ACTL_HRS_TOT_DTSG,0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select j.ar_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_TOT_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) f
/*UNION
select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) g 
UNION
select * from 
(select e.ar_no,e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no order by e.ar_no,e.loc_no) i*/) j
group by j.ar_no order by j.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no)actl_hrs]]>
	</ActualORPrcntWkToDtTotalPayPlan>
	
<VarianceORPrcntColumn>
<![CDATA[select nyu.loc_nm,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select sms_hrs.loc_nm,
case when sms_hrs.mon=0 and pln_hrs.mon=0 then 0 when sms_hrs.mon=0 then 0 when pln_hrs.mon=0 then 0
else NVL(ROUND((sms_hrs.mon / pln_hrs.mon)*100,1),0) end as Mon,
case when sms_hrs.Tue=0 and pln_hrs.Tue=0 then 0 when sms_hrs.Tue=0 then 0 when pln_hrs.Tue=0 then 0
else NVL(ROUND((sms_hrs.Tue / pln_hrs.Tue)*100,1),0) end as Tue,
case when sms_hrs.Wed=0 and pln_hrs.Wed=0 then 0 when sms_hrs.Wed=0 then 0 when pln_hrs.Wed=0 then 0
else NVL(ROUND((sms_hrs.Wed / pln_hrs.Wed)*100,1),0) end as Wed,
case when sms_hrs.Thu=0 and pln_hrs.Thu=0 then 0 when sms_hrs.Thu=0 then 0 when pln_hrs.Thu=0 then 0
else NVL(ROUND((sms_hrs.Thu / pln_hrs.Thu)*100,1),0) end as Thu,
case when sms_hrs.Fri=0 and pln_hrs.Fri=0 then 0 when sms_hrs.Fri=0 then 0 when pln_hrs.Fri=0 then 0
else NVL(ROUND((sms_hrs.Fri / pln_hrs.Fri)*100,1),0) end as Fri,
case when sms_hrs.Sat=0 and pln_hrs.Sat=0 then 0 when sms_hrs.Sat=0 then 0 when pln_hrs.Sat=0 then 0
else NVL(ROUND((sms_hrs.Sat / pln_hrs.Sat)*100,1),0) end as Sat,
case when sms_hrs.Sun=0 and pln_hrs.Sun=0 then 0 when sms_hrs.Sun=0 then 0 when pln_hrs.Sun=0 then 0
else NVL(ROUND((sms_hrs.Sun / pln_hrs.Sun)*100,1),0) end as Sun from
(select lc.loc_nm,sms.mon,sms.tue,sms.wed,sms.thu,sms.fri,sms.sat,sms.sun from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DPG)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DPG)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DPG)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DPG)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DPG)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DPG)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DPG)) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and tsk.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z ) sms
on sms.loc_nm=lc.loc_nm) sms_hrs,
(select lc.loc_nm,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DPG)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DPG)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DPG)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DPG)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DPG)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DPG)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DPG)) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_HRS_DTS) as PLN_HRS_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
a.ta_pln_wage_amt as ta_pln_wage_amt,a.ta_pln_hrs as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no  IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) wge
on wge.loc_nm=lc.loc_nm) pln_hrs 
where sms_hrs.loc_nm=pln_hrs.loc_nm ) nyu,
(select actl_sms.loc_nm,
case when actl_sms.mon=0 and actl_hrs.mon=0 then 0 when actl_sms.mon=0 then 0 when actl_hrs.mon=0 then 0
else NVL(ROUND((actl_sms.mon / actl_hrs.mon)*100,1),0) end as Mon,
case when actl_sms.Tue=0 and actl_hrs.Tue=0 then 0 when actl_sms.Tue=0 then 0 when actl_hrs.Tue=0 then 0
else NVL(ROUND((actl_sms.Tue / actl_hrs.Tue)*100,1),0) end as Tue,
case when actl_sms.Wed=0 and actl_hrs.Wed=0 then 0 when actl_sms.Wed=0 then 0 when actl_hrs.Wed=0 then 0
else NVL(ROUND((actl_sms.Wed / actl_hrs.Wed)*100,1),0) end as Wed,
case when actl_sms.Thu=0 and actl_hrs.Thu=0 then 0 when actl_sms.Thu=0 then 0 when actl_hrs.Thu=0 then 0
else NVL(ROUND((actl_sms.Thu / actl_hrs.Thu)*100,1),0) end as Thu,
case when actl_sms.Fri=0 and actl_hrs.Fri=0 then 0 when actl_sms.Fri=0 then 0 when actl_hrs.Fri=0 then 0
else NVL(ROUND((actl_sms.Fri / actl_hrs.Fri)*100,1),0) end as Fri,
case when actl_sms.Sat=0 and actl_hrs.Sat=0 then 0 when actl_sms.Sat=0 then 0 when actl_hrs.Sat=0 then 0
else NVL(ROUND((actl_sms.Sat / actl_hrs.Sat)*100,1),0) end as Sat,
case when actl_sms.Sun=0 and actl_hrs.Sun=0 then 0 when actl_sms.Sun=0 then 0 when actl_hrs.Sun=0 then 0
else NVL(ROUND((actl_sms.Sun / actl_hrs.Sun)*100,1),0) end as Sun from
(select e.loc_nm,(sms_src.Monday) as Mon,(sms_src.Tuesday) as Tue,(sms_src.Wednesday) as Wed,(sms_src.Thursday) as Thu,(sms_src.Friday) as Fri,(sms_src.Saturday) as Sat,(sms_src.Sunday) as Sun from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area' 
 order by div_no,rgn_no,zone_no,ar_no) e 
LEFT OUTER JOIN 
(select loc_no ,
Sum(decode(day_of_wk, 0 , plan_actl_sms )) Monday,
sum(decode(day_of_wk, 1 , plan_actl_sms )) Tuesday,
sum(decode(day_of_wk, 2 , plan_actl_sms )) Wednesday,
sum(decode(day_of_wk, 3 , plan_actl_sms )) Thursday,
sum(decode(day_of_wk, 4 , plan_actl_sms )) Friday,
sum(decode(day_of_wk, 5 , plan_actl_sms )) Saturday,
sum(decode(day_of_wk, 6 , plan_actl_sms )) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as plan_actl_sms
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no in (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area') --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN ('Dept')
order by src.loc_no,src.dept_no,src.task_no ) sto group by loc_no) sms_src on sms_src.loc_no=e.loc_no)actl_sms
LEFT OUTER JOIN
(select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm)actl_hrs
on actl_hrs.loc_nm=actl_sms.loc_nm) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceORPrcntColumn>
<VarianceORPrcntTotal>
<![CDATA[select nyu.ar_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select sms_hrs.ar_no,
case when sms_hrs.mon=0 and pln_hrs.mon=0 then 0 when sms_hrs.mon=0 then 0 when pln_hrs.mon=0 then 0
else NVL(ROUND((sms_hrs.mon / pln_hrs.mon)*100,1),0) end as Mon,
case when sms_hrs.Tue=0 and pln_hrs.Tue=0 then 0 when sms_hrs.Tue=0 then 0 when pln_hrs.Tue=0 then 0
else NVL(ROUND((sms_hrs.Tue / pln_hrs.Tue)*100,1),0) end as Tue,
case when sms_hrs.Wed=0 and pln_hrs.Wed=0 then 0 when sms_hrs.Wed=0 then 0 when pln_hrs.Wed=0 then 0
else NVL(ROUND((sms_hrs.Wed / pln_hrs.Wed)*100,1),0) end as Wed,
case when sms_hrs.Thu=0 and pln_hrs.Thu=0 then 0 when sms_hrs.Thu=0 then 0 when pln_hrs.Thu=0 then 0
else NVL(ROUND((sms_hrs.Thu / pln_hrs.Thu)*100,1),0) end as Thu,
case when sms_hrs.Fri=0 and pln_hrs.Fri=0 then 0 when sms_hrs.Fri=0 then 0 when pln_hrs.Fri=0 then 0
else NVL(ROUND((sms_hrs.Fri / pln_hrs.Fri)*100,1),0) end as Fri,
case when sms_hrs.Sat=0 and pln_hrs.Sat=0 then 0 when sms_hrs.Sat=0 then 0 when pln_hrs.Sat=0 then 0
else NVL(ROUND((sms_hrs.Sat / pln_hrs.Sat)*100,1),0) end as Sat,
case when sms_hrs.Sun=0 and pln_hrs.Sun=0 then 0 when sms_hrs.Sun=0 then 0 when pln_hrs.Sun=0 then 0
else NVL(ROUND((sms_hrs.Sun / pln_hrs.Sun)*100,1),0) end as Sun from  
(select lc.ar_no,sms.mon,sms.tue,sms.wed,sms.thu,sms.fri,sms.sat,sms.sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and tsk.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z ) sms
on sms.ar_no=lc.ar_no) sms_hrs,
(select lc.ar_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_HRS_DTS) as PLN_HRS_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
a.ta_pln_wage_amt as ta_pln_wage_amt,a.ta_pln_hrs as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no) pln_hrs 
where sms_hrs.ar_no=pln_hrs.ar_no order by sms_hrs.ar_no) nyu,
(select actl_sms.ar_no,
case when actl_sms.mon=0 and actl_hrs.mon=0 then 0 when actl_sms.mon=0 then 0 when actl_hrs.mon=0 then 0 
else NVL(ROUND((actl_sms.mon / actl_hrs.mon)*100,1),0) end as Mon,
case when actl_sms.tue=0 and actl_hrs.tue=0 then 0 when actl_sms.tue=0 then 0 when actl_hrs.tue=0 then 0 
else NVL(ROUND((actl_sms.tue / actl_hrs.tue)*100,1),0) end as tue,
case when actl_sms.wed=0 and actl_hrs.wed=0 then 0 when actl_sms.wed=0 then 0 when actl_hrs.wed=0 then 0 
else NVL(ROUND((actl_sms.wed / actl_hrs.wed)*100,1),0) end as wed,
case when actl_sms.thu=0 and actl_hrs.thu=0 then 0 when actl_sms.thu=0 then 0 when actl_hrs.thu=0 then 0 
else NVL(ROUND((actl_sms.thu / actl_hrs.thu)*100,1),0) end as thu,
case when actl_sms.fri=0 and actl_hrs.fri=0 then 0 when actl_sms.fri=0 then 0 when actl_hrs.fri=0 then 0 
else NVL(ROUND((actl_sms.fri / actl_hrs.fri)*100,1),0) end as fri,
case when actl_sms.sat=0 and actl_hrs.sat=0 then 0 when actl_sms.sat=0 then 0 when actl_hrs.sat=0 then 0 
else NVL(ROUND((actl_sms.sat / actl_hrs.sat)*100,1),0) end as sat,
case when actl_sms.sun=0 and actl_hrs.sun=0 then 0 when actl_sms.sun=0 then 0 when actl_hrs.sun=0 then 0 
else NVL(ROUND((actl_sms.sun / actl_hrs.sun)*100,1),0) end as sun from  
(select ar_no,sum(Monday)as Mon,sum(Tuesday) as TUE,sum(Wednesday)as WED,sum(Thursday)as THU,sum(Friday) as FRI,sum(Saturday) as SAT,sum(Sunday) as SUN from
(select e.ar_no,e.loc_nm,sms_src.Monday,sms_src.Tuesday,sms_src.Wednesday,sms_src.Thursday,sms_src.Friday,sms_src.Saturday,sms_src.Sunday from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and ar_no='Area'  order by div_no,rgn_no,zone_no,ar_no) e LEFT OUTER JOIN 
(select ar_no,loc_no ,
Sum(decode(day_of_wk, 0 , plan_actl_sms )) Monday,
sum(decode(day_of_wk, 1 , plan_actl_sms )) Tuesday,
sum(decode(day_of_wk, 2 , plan_actl_sms )) Wednesday,
sum(decode(day_of_wk, 3 , plan_actl_sms )) Thursday,
sum(decode(day_of_wk, 4 , plan_actl_sms )) Friday,
sum(decode(day_of_wk, 5 , plan_actl_sms )) Saturday,
sum(decode(day_of_wk, 6 , plan_actl_sms )) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as plan_actl_sms
from
(select LL.task_no,LL.task_nm,LL.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no  and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no in (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area') --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN ('Dept')
order by src.loc_no,src.dept_no,src.task_no ) sto group by ar_no,loc_no) sms_src on sms_src.loc_no=e.loc_no) group by ar_no order by ar_no)actl_sms,
(select lc.ar_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.ar_no,g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no)actl_hrs) den
where nyu.ar_no = den.ar_no ]]>
</VarianceORPrcntTotal>	
<VarianceORPrcntWkToDt>
<![CDATA[select nyu.loc_nm,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_OR_DPS from
(select sms_hrs.loc_nm,
case when NVL(sms_hrs.wtd,0)=0 and NVL(pln_hrs.wtd,0)=0 then 0 
when NVL(sms_hrs.wtd,0)=0 then 0 when NVL(pln_hrs.wtd,0)=0 then 0 
else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end as WTD from  
(select lc.loc_nm,sms.wtd from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DPG)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DPG)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DPG)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DPG)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DPG)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DPG)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DPG)) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and tsk.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z ) sms
on sms.loc_nm=lc.loc_nm) sms_hrs,
(select lc.loc_no,lc.loc_nm,sum(wge.PLN_HOURS_DTS) as WTD from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
a.ta_pln_wage_amt as ta_pln_wage_amt,a.wage_adj_amt as wage_adj_amt,a.ta_pln_hrs as ta_pln_hrs,a.wage_adj_hrs as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm order by e.loc_no,e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_no,lc.loc_nm order by lc.loc_nm) pln_hrs 
where sms_hrs.loc_nm=pln_hrs.loc_nm) nyu,
(select actl_sms.loc_nm,
case when NVL(actl_sms.actl_actl_sms_wk_to_dt,0)=0 and NVL(actl_hrs.wtd,0)=0 then 0 
when NVL(actl_sms.actl_actl_sms_wk_to_dt,0)=0 then 0 when NVL(actl_hrs.wtd,0)=0 then 0 
else NVL(ROUND((actl_sms.actl_actl_sms_wk_to_dt / actl_hrs.wtd)*100,1),0) end as WTD from  
(select e.loc_nm,actl_actl_sms_wk_to_dt from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and ar_no='Area'  order by div_no,rgn_no,zone_no,ar_no) e LEFT OUTER JOIN 
(select loc_no ,Sum(plan_actl_sms) as actl_actl_sms_wk_to_dt
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as plan_actl_sms
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no  and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no in (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area') --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN ('Dept')
order by src.loc_no,src.dept_no,src.task_no ) sto group by loc_no) sms_src on sms_src.loc_no=e.loc_no)actl_sms
LEFT OUTER JOIN
(select lc.loc_nm,NVL(wge.ACTL_HRS_DTSG,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select j.loc_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_DTSG from 
(select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) f
/*UNION
select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) g 
UNION
select * from 
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) i*/) j
group by j.loc_no order by j.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm)actl_hrs
on actl_sms.loc_nm=actl_hrs.loc_nm) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceORPrcntWkToDt>
<VarianceORPrcntWkToDtTotal>
<![CDATA[select nyu.ar_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_OR_TOT_DPS from
(select sms_hrs.ar_no,
case when NVL(sms_hrs.wtd,0)=0 and NVL(pln_hrs.wtd,0)=0 then 0 
when NVL(sms_hrs.wtd,0)=0 then 0 when NVL(pln_hrs.wtd,0)=0 then 0 
else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end as WTD from  
(select lc.ar_no,sms.wtd from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DPG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DPG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DPG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DPG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DPG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DPG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DPG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and tsk.dept_no IN ('Dept')  
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z ) sms
on sms.ar_no=lc.ar_no) sms_hrs,
(select lc.ar_no,sum(wge.PLN_HOURS_DTS) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
a.ta_pln_wage_amt as ta_pln_wage_amt,a.wage_adj_amt as wage_adj_amt,a.ta_pln_hrs as ta_pln_hrs,a.wage_adj_hrs as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm order by e.ar_no,e.loc_no,e.loc_nm,e.dply_seq) wge
on wge.ar_no=lc.ar_no group by lc.ar_no order by lc.ar_no) pln_hrs 
where sms_hrs.ar_no=pln_hrs.ar_no) nyu,
(select actl_sms.ar_no,
case when NVL(actl_sms.Storetotal_wktodt,0)=0 and NVL(actl_hrs.wtd,0)=0 then 0 
when NVL(actl_sms.Storetotal_wktodt,0)=0 then 0 when NVL(actl_hrs.wtd,0)=0 then 0 
else NVL(ROUND((actl_sms.Storetotal_wktodt / actl_hrs.wtd)*100,1),0) end as WTD from 
(select ar_no,sum(actl_sms_hrs_wk_to_dt) as Storetotal_wktodt from
(select e.ar_no,e.loc_nm,actl_sms_hrs_wk_to_dt from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and ar_no='Area'  order by div_no,rgn_no,zone_no,ar_no) e LEFT OUTER JOIN 
(select ar_no,loc_no ,Sum(plan_sms_hrs) as actl_sms_hrs_wk_to_dt
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no  and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no in (select loc_no from loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area') --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN ('Dept')
order by src.loc_no,src.dept_no,src.task_no ) sto group by ar_no,loc_no) sms_src on sms_src.loc_no=e.loc_no) group by ar_no order by ar_no) actl_sms,
(select lc.ar_no,NVL(wge.ACTL_HRS_TOT_DTSG,0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select j.ar_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_TOT_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) f
/*UNION
select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) g 
UNION
select * from 
(select e.ar_no,e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no order by e.ar_no,e.loc_no) i*/) j
group by j.ar_no order by j.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no)actl_hrs) den
where nyu.ar_no = den.ar_no ]]>
</VarianceORPrcntWkToDtTotal>
</TCName>

<TCName name = "ItemsView" >
	<PlannedItemsColumn>
	<![CDATA[select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
 order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DTSG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DTSG from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) sls
on lc.loc_nm=sls.loc_nm]]>
	</PlannedItemsColumn>
	<PlannedItemsTotal>
	<![CDATA[ select lc.ar_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct ar_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTSG),0) as PLN_ITM_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSG,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSG,sum(e.gnrt_itm) as GEN_ITM_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no]]>
	</PlannedItemsTotal>	
	<PlannedItemsWkToDt>
	<![CDATA[select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
 order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DTSG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DTSG from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) sls
on lc.loc_nm=sls.loc_nm]]>
	</PlannedItemsWkToDt>
	<PlannedItemsWkToDtTotal>
	<![CDATA[select lc.ar_no,NVL(sls.wtd,0) as WTD from 
(select distinct ar_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
) lc
LEFT OUTER JOIN
(select z.ar_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTSG),0) as PLN_ITM_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSG,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSG,sum(e.gnrt_itm) as GEN_ITM_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no]]>
	</PlannedItemsWkToDtTotal>
	<ActualItemsColumn>
	<![CDATA[select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_ITM_DTS),0) as ACTL_ITM_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm]]>
	</ActualItemsColumn>
	<ActualItemsTotal>
	<![CDATA[select lc.ar_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_ITM_DTS),0) as ACTL_ITM_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no]]>
	</ActualItemsTotal>	
	<ActualItemsWkToDt>
	<![CDATA[select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm]]>
	</ActualItemsWkToDt>
	<ActualItemsWkToDtTotal>
	<![CDATA[select lc.ar_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no]]>
	</ActualItemsWkToDtTotal>
	
	<VarianceItemsColumn>
<![CDATA[select nyu.loc_nm,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
 order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DTSG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DTSG from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) sls
on lc.loc_nm=sls.loc_nm order by lc.loc_nm) nyu,
(select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_ITM_DTS),0) as ACTL_ITM_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceItemsColumn>
<VarianceItemsTotal>
<![CDATA[select nyu.ar_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select lc.ar_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct ar_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTSG),0) as PLN_ITM_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSG,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSG,sum(e.gnrt_itm) as GEN_ITM_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no) nyu,
(select lc.ar_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_ITM_DTS),0) as ACTL_ITM_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) den
where nyu.ar_no = den.ar_no ]]>
</VarianceItemsTotal>	
<VarianceItemsWkToDt>
<![CDATA[select nyu.loc_nm,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_WAGESPERCNT_DPS from
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
 order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc
LEFT OUTER JOIN
(select z.loc_nm,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DTSG)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DTSG from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) sls
on lc.loc_nm=sls.loc_nm order by lc.loc_nm) nyu,
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceItemsWkToDt>
<VarianceItemsWkToDtTotal>
<![CDATA[select nyu.ar_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_ITEMS_TOT_DPS from
(select lc.ar_no,NVL(sls.wtd,0) as WTD from 
(select distinct ar_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
) lc
LEFT OUTER JOIN
(select z.ar_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTSG),0) as PLN_ITM_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSG,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSG,sum(e.gnrt_itm) as GEN_ITM_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no) nyu,
(select lc.ar_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) den
where nyu.ar_no = den.ar_no ]]>
</VarianceItemsWkToDtTotal>
</TCName>

<TCName name = "ItemsPriceView" >
	<PlannedItemsPriceColumn>
	<![CDATA[select sls_itm.loc_nm,CASE WHEN NVL(sls_itm.mon_sls,0) = 0 AND NVL(sls_itm.mon_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.mon_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.mon_itm,0) = 0 THEN 0 
ELSE NVL(ROUND((sls_itm.mon_sls / sls_itm.mon_itm),2),0) END as Mon,
CASE WHEN NVL(sls_itm.tue_sls,0) = 0 AND NVL(sls_itm.tue_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.tue_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.tue_itm,0) = 0 THEN 0   
ELSE NVL(ROUND((sls_itm.tue_sls / sls_itm.tue_itm),2),0) END as Tue,
CASE WHEN NVL(sls_itm.wed_sls,0) = 0 AND NVL(sls_itm.wed_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.wed_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.wed_itm,0) = 0 THEN 0     
ELSE NVL(ROUND((sls_itm.wed_sls / sls_itm.wed_itm),2),0) END as Wed,
CASE WHEN NVL(sls_itm.thu_sls,0) = 0 AND NVL(sls_itm.thu_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.thu_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.thu_itm,0) = 0 THEN 0     
ELSE NVL(ROUND((sls_itm.thu_sls / sls_itm.thu_itm),2),0) END as Thu,
CASE WHEN NVL(sls_itm.fri_sls,0) = 0 AND NVL(sls_itm.fri_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.fri_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.fri_itm,0) = 0 THEN 0    
ELSE NVL(ROUND((sls_itm.fri_sls / sls_itm.fri_itm),2),0) END as Fri,
CASE WHEN NVL(sls_itm.sat_sls,0) = 0 AND NVL(sls_itm.sat_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.sat_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.sat_itm,0) = 0 THEN 0     
ELSE NVL(ROUND((sls_itm.sat_sls / sls_itm.sat_itm),2),0) END as Sat,
CASE WHEN NVL(sls_itm.sun_sls,0) = 0 AND NVL(sls_itm.sun_itm,0) = 0 THEN 0  
     WHEN NVL(sls_itm.sun_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.sun_itm,0) = 0 THEN 0     
ELSE NVL(ROUND((sls_itm.sun_sls / sls_itm.sun_itm),2),0) END as Sun from
(select z.loc_nm,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.loc_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTS)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTS)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTS)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTS)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTS)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTS)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTS)),0) Sun_itm from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DTS,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_DTS from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) y
on z.loc_nm=y.loc_nm order by z.loc_nm) sls_itm]]>
	</PlannedItemsPriceColumn>
	<PlannedItemsPriceTotal>
	<![CDATA[select sls_itm.ar_no,CASE WHEN NVL(sls_itm.mon_sls,0) = 0 AND NVL(sls_itm.mon_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.mon_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.mon_itm,0) = 0 THEN 0 
ELSE NVL(ROUND((sls_itm.mon_sls / sls_itm.mon_itm),2),0) END as Mon,
CASE WHEN NVL(sls_itm.tue_sls,0) = 0 AND NVL(sls_itm.tue_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.tue_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.tue_itm,0) = 0 THEN 0   
ELSE NVL(ROUND((sls_itm.tue_sls / sls_itm.tue_itm),2),0) END as Tue,
CASE WHEN NVL(sls_itm.wed_sls,0) = 0 AND NVL(sls_itm.wed_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.wed_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.wed_itm,0) = 0 THEN 0     
ELSE NVL(ROUND((sls_itm.wed_sls / sls_itm.wed_itm),2),0) END as Wed,
CASE WHEN NVL(sls_itm.thu_sls,0) = 0 AND NVL(sls_itm.thu_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.thu_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.thu_itm,0) = 0 THEN 0     
ELSE NVL(ROUND((sls_itm.thu_sls / sls_itm.thu_itm),2),0) END as Thu,
CASE WHEN NVL(sls_itm.fri_sls,0) = 0 AND NVL(sls_itm.fri_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.fri_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.fri_itm,0) = 0 THEN 0    
ELSE NVL(ROUND((sls_itm.fri_sls / sls_itm.fri_itm),2),0) END as Fri,
CASE WHEN NVL(sls_itm.sat_sls,0) = 0 AND NVL(sls_itm.sat_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.sat_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.sat_itm,0) = 0 THEN 0     
ELSE NVL(ROUND((sls_itm.sat_sls / sls_itm.sat_itm),2),0) END as Sat,
CASE WHEN NVL(sls_itm.sun_sls,0) = 0 AND NVL(sls_itm.sun_itm,0) = 0 THEN 0  
     WHEN NVL(sls_itm.sun_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.sun_itm,0) = 0 THEN 0     
ELSE NVL(ROUND((sls_itm.sun_sls / sls_itm.sun_itm),2),0) END as Sun from
(select z.ar_no,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,y.wtd_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm,y.wtd_itm from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTS)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTS)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTS)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTS)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTS)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTS)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTS)),0) Sun_itm from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DTS,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_DTS from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) y
on z.ar_no=y.ar_no order by z.ar_no) sls_itm]]>
	</PlannedItemsPriceTotal>
	
	<PlannedItemsPriceWkToDt>
	<![CDATA[select sls_itm.loc_nm,CASE WHEN NVL(sls_itm.wtd_sls,0) = 0 AND NVL(sls_itm.wtd_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.wtd_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.wtd_itm,0) = 0 THEN 0 
ELSE ROUND((sls_itm.wtd_sls/ sls_itm.wtd_itm),2) END  as WTD from
(select z.loc_nm,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,y.wtd_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm,y.wtd_itm from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.loc_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTS)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTS)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTS)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTS)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTS)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTS)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTS)),0) Sun_itm from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DTS,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_DTS from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) y
on z.loc_nm=y.loc_nm order by z.loc_nm) sls_itm]]>
	</PlannedItemsPriceWkToDt>
	<PlannedItemsPriceWkToDtTotal>
	<![CDATA[select sls_itm.ar_no,CASE WHEN NVL(sls_itm.wtd_sls,0) = 0 AND NVL(sls_itm.wtd_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.wtd_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.wtd_itm,0) = 0 THEN 0 
ELSE ROUND((sls_itm.wtd_sls/ sls_itm.wtd_itm),2) END as WTD from
(select z.ar_no,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,y.wtd_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm,y.wtd_itm from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTS)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTS)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTS)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTS)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTS)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTS)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTS)),0) Sun_itm from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DTS,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_DTS from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) y
on z.ar_no=y.ar_no order by z.ar_no) sls_itm]]>
	</PlannedItemsPriceWkToDtTotal>
	<ActualItemsPriceColumn>
	<![CDATA[select sls.loc_nm,
case when sls.mon=0 and itm.mon=0 then 0 when sls.mon=0 then 0 when itm.mon=0 then 0 
else NVL(ROUND((sls.mon / itm.mon),2),0) end as mon,
case when sls.tue=0 and itm.tue=0 then 0 when sls.tue=0 then 0 when itm.tue=0 then 0 
else NVL(ROUND((sls.tue / itm.tue),2),0) end as tue,
case when sls.wed=0 and itm.wed=0 then 0 when sls.wed=0 then 0 when itm.wed=0 then 0 
else NVL(ROUND((sls.wed / itm.wed),2),0) end as wed,
case when sls.thu=0 and itm.thu=0 then 0 when sls.thu=0 then 0 when itm.thu=0 then 0 
else NVL(ROUND((sls.thu / itm.thu),2),0) end as thu,
case when sls.fri=0 and itm.fri=0 then 0 when sls.fri=0 then 0 when itm.fri=0 then 0 
else NVL(ROUND((sls.fri / itm.fri),2),0) end as fri,
case when sls.sat=0 and itm.sat=0 then 0 when sls.sat=0 then 0 when itm.sat=0 then 0 
else NVL(ROUND((sls.sat / itm.sat),2),0) end as sat,
case when sls.sun=0 and itm.sun=0 then 0 when sls.sun=0 then 0 when itm.sun=0 then 0 
else NVL(ROUND((sls.sun / itm.sun),2),0) end as sun from 
(select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) sls,
(select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) itm 
where sls.loc_nm=itm.loc_nm]]>
	</ActualItemsPriceColumn>
		
	<ActualItemsPriceTotal>
	<![CDATA[select sls.ar_no,
case when sls.mon=0 and itm.mon=0 then 0 when sls.mon=0 then 0 when itm.mon=0 then 0 
else NVL(ROUND((sls.mon / itm.mon),2),0) end as mon,
case when sls.tue=0 and itm.tue=0 then 0 when sls.tue=0 then 0 when itm.tue=0 then 0 
else NVL(ROUND((sls.tue / itm.tue),2),0) end as tue,
case when sls.wed=0 and itm.wed=0 then 0 when sls.wed=0 then 0 when itm.wed=0 then 0 
else NVL(ROUND((sls.wed / itm.wed),2),0) end as wed,
case when sls.thu=0 and itm.thu=0 then 0 when sls.thu=0 then 0 when itm.thu=0 then 0 
else NVL(ROUND((sls.thu / itm.thu),2),0) end as thu,
case when sls.fri=0 and itm.fri=0 then 0 when sls.fri=0 then 0 when itm.fri=0 then 0 
else NVL(ROUND((sls.fri / itm.fri),2),0) end as fri,
case when sls.sat=0 and itm.sat=0 then 0 when sls.sat=0 then 0 when itm.sat=0 then 0 
else NVL(ROUND((sls.sat / itm.sat),2),0) end as sat,
case when sls.sun=0 and itm.sun=0 then 0 when sls.sun=0 then 0 when itm.sun=0 then 0 
else NVL(ROUND((sls.sun / itm.sun),2),0) end as sun from 
(select lc.ar_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) sls,
(select lc.ar_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no ) itm 
where sls.ar_no=itm.ar_no]]>
	</ActualItemsPriceTotal>
	<ActualItemsPriceWkToDt>
	<![CDATA[select sls.loc_nm,
case when sls.wtd=0 and itm.wtd=0 then 0 when sls.wtd=0 then 0 when itm.wtd=0 then 0
else NVL(ROUND((sls.wtd / itm.wtd),2),0) end as wtd from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) sls,
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) itm 
where sls.loc_nm=itm.loc_nm]]>
	</ActualItemsPriceWkToDt>
	
	<ActualItemsPriceWkToDtTotal>
	<![CDATA[select sls.ar_no,
case when sls.wtd=0 and itm.wtd=0 then 0 when sls.wtd=0 then 0 when itm.wtd=0 then 0
else NVL(ROUND((sls.wtd / itm.wtd),2),0) end as wtd from 
(select lc.ar_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) sls,
(select lc.ar_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) itm 
where sls.ar_no=itm.ar_no]]>
	</ActualItemsPriceWkToDtTotal>
	
<VarianceItemsPriceColumn>
<![CDATA[select nyu.loc_nm,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select sls_itm.loc_nm,CASE WHEN NVL(sls_itm.mon_sls,0) = 0 AND NVL(sls_itm.mon_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.mon_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.mon_itm,0) = 0 THEN 0 
ELSE NVL(ROUND((sls_itm.mon_sls / sls_itm.mon_itm),2),0) END as Mon,
CASE WHEN NVL(sls_itm.tue_sls,0) = 0 AND NVL(sls_itm.tue_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.tue_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.tue_itm,0) = 0 THEN 0   
ELSE NVL(ROUND((sls_itm.tue_sls / sls_itm.tue_itm),2),0) END as Tue,
CASE WHEN NVL(sls_itm.wed_sls,0) = 0 AND NVL(sls_itm.wed_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.wed_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.wed_itm,0) = 0 THEN 0     
ELSE NVL(ROUND((sls_itm.wed_sls / sls_itm.wed_itm),2),0) END as Wed,
CASE WHEN NVL(sls_itm.thu_sls,0) = 0 AND NVL(sls_itm.thu_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.thu_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.thu_itm,0) = 0 THEN 0     
ELSE NVL(ROUND((sls_itm.thu_sls / sls_itm.thu_itm),2),0) END as Thu,
CASE WHEN NVL(sls_itm.fri_sls,0) = 0 AND NVL(sls_itm.fri_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.fri_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.fri_itm,0) = 0 THEN 0    
ELSE NVL(ROUND((sls_itm.fri_sls / sls_itm.fri_itm),2),0) END as Fri,
CASE WHEN NVL(sls_itm.sat_sls,0) = 0 AND NVL(sls_itm.sat_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.sat_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.sat_itm,0) = 0 THEN 0     
ELSE NVL(ROUND((sls_itm.sat_sls / sls_itm.sat_itm),2),0) END as Sat,
CASE WHEN NVL(sls_itm.sun_sls,0) = 0 AND NVL(sls_itm.sun_itm,0) = 0 THEN 0  
     WHEN NVL(sls_itm.sun_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.sun_itm,0) = 0 THEN 0     
ELSE NVL(ROUND((sls_itm.sun_sls / sls_itm.sun_itm),2),0) END as Sun  from
(select z.loc_nm,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.loc_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTS)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTS)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTS)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTS)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTS)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTS)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTS)),0) Sun_itm from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DTS,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_DTS from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) y
on z.loc_nm=y.loc_nm order by z.loc_no) sls_itm) nyu,
(select sls.loc_nm,
case when sls.mon=0 and itm.mon=0 then 0 when sls.mon=0 then 0 when itm.mon=0 then 0 
else NVL(ROUND((sls.mon / itm.mon),2),0) end as mon,
case when sls.tue=0 and itm.tue=0 then 0 when sls.tue=0 then 0 when itm.tue=0 then 0 
else NVL(ROUND((sls.tue / itm.tue),2),0) end as tue,
case when sls.wed=0 and itm.wed=0 then 0 when sls.wed=0 then 0 when itm.wed=0 then 0 
else NVL(ROUND((sls.wed / itm.wed),2),0) end as wed,
case when sls.thu=0 and itm.thu=0 then 0 when sls.thu=0 then 0 when itm.thu=0 then 0 
else NVL(ROUND((sls.thu / itm.thu),2),0) end as thu,
case when sls.fri=0 and itm.fri=0 then 0 when sls.fri=0 then 0 when itm.fri=0 then 0 
else NVL(ROUND((sls.fri / itm.fri),2),0) end as fri,
case when sls.sat=0 and itm.sat=0 then 0 when sls.sat=0 then 0 when itm.sat=0 then 0 
else NVL(ROUND((sls.sat / itm.sat),2),0) end as sat,
case when sls.sun=0 and itm.sun=0 then 0 when sls.sun=0 then 0 when itm.sun=0 then 0 
else NVL(ROUND((sls.sun / itm.sun),2),0) end as sun from 
(select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) sls,
(select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) itm 
where sls.loc_nm=itm.loc_nm) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceItemsPriceColumn>
<VarianceItemsPriceTotal>
<![CDATA[select nyu.ar_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select sls_itm.ar_no,CASE WHEN NVL(sls_itm.mon_sls,0) = 0 AND NVL(sls_itm.mon_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.mon_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.mon_itm,0) = 0 THEN 0 
ELSE NVL(ROUND((sls_itm.mon_sls / sls_itm.mon_itm),2),0) END as Mon,
CASE WHEN NVL(sls_itm.tue_sls,0) = 0 AND NVL(sls_itm.tue_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.tue_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.tue_itm,0) = 0 THEN 0   
ELSE NVL(ROUND((sls_itm.tue_sls / sls_itm.tue_itm),2),0) END as Tue,
CASE WHEN NVL(sls_itm.wed_sls,0) = 0 AND NVL(sls_itm.wed_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.wed_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.wed_itm,0) = 0 THEN 0     
ELSE NVL(ROUND((sls_itm.wed_sls / sls_itm.wed_itm),2),0) END as Wed,
CASE WHEN NVL(sls_itm.thu_sls,0) = 0 AND NVL(sls_itm.thu_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.thu_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.thu_itm,0) = 0 THEN 0     
ELSE NVL(ROUND((sls_itm.thu_sls / sls_itm.thu_itm),2),0) END as Thu,
CASE WHEN NVL(sls_itm.fri_sls,0) = 0 AND NVL(sls_itm.fri_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.fri_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.fri_itm,0) = 0 THEN 0    
ELSE NVL(ROUND((sls_itm.fri_sls / sls_itm.fri_itm),2),0) END as Fri,
CASE WHEN NVL(sls_itm.sat_sls,0) = 0 AND NVL(sls_itm.sat_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.sat_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.sat_itm,0) = 0 THEN 0     
ELSE NVL(ROUND((sls_itm.sat_sls / sls_itm.sat_itm),2),0) END as Sat,
CASE WHEN NVL(sls_itm.sun_sls,0) = 0 AND NVL(sls_itm.sun_itm,0) = 0 THEN 0  
     WHEN NVL(sls_itm.sun_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.sun_itm,0) = 0 THEN 0     
ELSE NVL(ROUND((sls_itm.sun_sls / sls_itm.sun_itm),2),0) END as Sun  from
(select z.ar_no,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,y.wtd_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm,y.wtd_itm from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTS)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTS)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTS)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTS)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTS)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTS)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTS)),0) Sun_itm from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DTS,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_DTS from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) y
on z.ar_no=y.ar_no order by z.ar_no) sls_itm) nyu,
(select sls.ar_no,
case when sls.mon=0 and itm.mon=0 then 0 when sls.mon=0 then 0 when itm.mon=0 then 0 
else NVL(ROUND((sls.mon / itm.mon),2),0) end as mon,
case when sls.tue=0 and itm.tue=0 then 0 when sls.tue=0 then 0 when itm.tue=0 then 0 
else NVL(ROUND((sls.tue / itm.tue),2),0) end as tue,
case when sls.wed=0 and itm.wed=0 then 0 when sls.wed=0 then 0 when itm.wed=0 then 0 
else NVL(ROUND((sls.wed / itm.wed),2),0) end as wed,
case when sls.thu=0 and itm.thu=0 then 0 when sls.thu=0 then 0 when itm.thu=0 then 0 
else NVL(ROUND((sls.thu / itm.thu),2),0) end as thu,
case when sls.fri=0 and itm.fri=0 then 0 when sls.fri=0 then 0 when itm.fri=0 then 0 
else NVL(ROUND((sls.fri / itm.fri),2),0) end as fri,
case when sls.sat=0 and itm.sat=0 then 0 when sls.sat=0 then 0 when itm.sat=0 then 0 
else NVL(ROUND((sls.sat / itm.sat),2),0) end as sat,
case when sls.sun=0 and itm.sun=0 then 0 when sls.sun=0 then 0 when itm.sun=0 then 0 
else NVL(ROUND((sls.sun / itm.sun),2),0) end as sun from 
(select lc.ar_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) sls,
(select lc.ar_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no ) itm 
where sls.ar_no=itm.ar_no) den
where nyu.ar_no = den.ar_no ]]>
</VarianceItemsPriceTotal>	
<VarianceItemsPriceWkToDt>
<![CDATA[select nyu.loc_nm,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_ITMPRICE_DPS from
(select sls_itm.loc_nm,CASE WHEN NVL(sls_itm.wtd_sls,0) = 0 AND NVL(sls_itm.wtd_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.wtd_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.wtd_itm,0) = 0 THEN 0 
ELSE ROUND((sls_itm.wtd_sls/ sls_itm.wtd_itm),2) END as WTD from
(select z.loc_nm,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,y.wtd_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm,y.wtd_itm from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.loc_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTS)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTS)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTS)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTS)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTS)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTS)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTS)),0) Sun_itm from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DTS,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_DTS from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) y
on z.loc_nm=y.loc_nm order by z.loc_no) sls_itm) nyu,
(select sls.loc_nm,
case when sls.wtd=0 and itm.wtd=0 then 0 when sls.wtd=0 then 0 when itm.wtd=0 then 0
else NVL(ROUND((sls.wtd / itm.wtd),2),0) end as wtd from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) sls,
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) itm 
where sls.loc_nm=itm.loc_nm) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceItemsPriceWkToDt>
<VarianceItemsPriceWkToDtTotal>
<![CDATA[select nyu.ar_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_ITMPRICE_TOT_DPS from
(select sls_itm.ar_no,CASE WHEN NVL(sls_itm.wtd_sls,0) = 0 AND NVL(sls_itm.wtd_itm,0) = 0 THEN 0 
     WHEN NVL(sls_itm.wtd_sls,0) = 0 THEN 0 WHEN NVL(sls_itm.wtd_itm,0) = 0 THEN 0 
ELSE ROUND((sls_itm.wtd_sls/ sls_itm.wtd_itm),2) END as WTD from
(select z.ar_no,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,y.wtd_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm,y.wtd_itm from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTS)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTS)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTS)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTS)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTS)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTS)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTS)),0) Sun_itm from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DTS,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_DTS from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) y
on z.ar_no=y.ar_no order by z.ar_no) sls_itm) nyu,
(select sls.ar_no,
case when sls.wtd=0 and itm.wtd=0 then 0 when sls.wtd=0 then 0 when itm.wtd=0 then 0
else NVL(ROUND((sls.wtd / itm.wtd),2),0) end as wtd from 
(select lc.ar_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) sls,
(select lc.ar_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.fcst_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) itm 
where sls.ar_no=itm.ar_no) den
where nyu.ar_no = den.ar_no ]]>
</VarianceItemsPriceWkToDtTotal>
</TCName>

<TCName name = "CustomersView" >
	<PlannedCustomersColumn>
	<![CDATA[select lc.loc_nm,NVL(cust.mon,0) as Mon,NVL(cust.tue,0) as Tue,NVL(cust.wed,0) as Wed,NVL(cust.thu,0) as Thu,
	NVL(cust.fri,0) as Fri,NVL(cust.sat,0) as Sat,NVL(cust.sun,0) as Sun from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
 	order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc
	LEFT OUTER JOIN
	(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.loc_nm,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DTS)),0) Sun from 
	(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_DTS from 
	(select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
	nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
	from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90)
	and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
	and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.loc_nm,e.dply_seq,e.day_of_wk) f
	UNION
	select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_cust) as GEN_CUST_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
	nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90)
	and a.fcst_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
	and (a.dept_no,fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
	where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end  and c.wk_id='Week' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
	and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
	group by b.loc_nm order by b.loc_nm) x ) z ) cust
	on cust.loc_nm=lc.loc_nm

]]>
	</PlannedCustomersColumn>
	<PlannedCustomersTotal>
	<![CDATA[ select z.ar_no,NVL(y.Mon,0) as Mon,NVL(y.Tue,0) as Tue,NVL(y.Wed,0) as Wed,NVL(y.Thu,0) as Thu,
NVL(y.Fri,0) as Fri,NVL(y.Sat,0) as Sat,NVL(y.Sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DPZ)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DPZ)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DPZ)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DPZ)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DPZ)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DPZ)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DPZ)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_DPZ from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,ROUND(sum(e.mgr_pln_cust_cnt),0) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) y
on z.ar_no=y.ar_no order by z.ar_no

  ]]>
	</PlannedCustomersTotal>
	<PlannedCustomersWkToDt>
	<![CDATA[select lc.loc_nm,NVL(cust.wtd,0) as WTD from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
  	order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc
	LEFT OUTER JOIN
	(select z.loc_nm,z.wtd from 
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.loc_nm,'store Total' as STR_TOT,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DTS)),0) Sun from 
	(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_DTS from 
	(select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.mgr_pln_cust_cnt),0) as PLN_CUST_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
	nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
	from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
	and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
	and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.loc_nm,e.dply_seq,e.day_of_wk) f
	UNION
	select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.gnrt_cust),0) as GEN_CUST_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
	nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
	and a.fcst_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
	and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
	where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
	and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
	group by b.loc_nm order by b.loc_nm) x ) z ) cust
	on cust.loc_nm=lc.loc_nm

  ]]>
	</PlannedCustomersWkToDt>
	<PlannedCustomersWkToDtTotal>
	<![CDATA[select z.ar_no,NVL(ROUND(y.wtd,0),0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DPZ)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DPZ)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DPZ)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DPZ)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DPZ)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DPZ)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DPZ)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_CUST_DTS) as PLN_CUST_DPZ from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) y
on z.ar_no=y.ar_no order by z.ar_no

  ]]>
	</PlannedCustomersWkToDtTotal>
	<ActualCustomersColumn>
	<![CDATA[select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_CUST_DTS),0) as ACTL_CUST_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm]]>
	</ActualCustomersColumn>
	<ActualCustomersTotal>
	<![CDATA[select lc.ar_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_CUST_DTS),0) as ACTL_CUST_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no]]>
	</ActualCustomersTotal>
	<ActualCustomersWkToDt>
	<![CDATA[select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm]]>
	</ActualCustomersWkToDt>
	<ActualCustomersWkToDtTotal>
	<![CDATA[select lc.ar_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no]]>
	</ActualCustomersWkToDtTotal>
	
<VarianceCustomersColumn>
<![CDATA[select nyu.loc_nm,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select lc.loc_nm,NVL(cust.mon,0) as Mon,NVL(cust.tue,0) as Tue,NVL(cust.wed,0) as Wed,NVL(cust.thu,0) as Thu,
	NVL(cust.fri,0) as Fri,NVL(cust.sat,0) as Sat,NVL(cust.sun,0) as Sun from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
 	order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc
	LEFT OUTER JOIN
	(select z.loc_nm,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.loc_nm,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DTS)),0) Sun from 
	(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_DTS from 
	(select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
	nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
	from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90)
	and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
	and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.loc_nm,e.dply_seq,e.day_of_wk) f
	UNION
	select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_cust) as GEN_CUST_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
	nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90)
	and a.fcst_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
	and (a.dept_no,fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
	where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end  and c.wk_id='Week' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
	and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
	group by b.loc_nm order by b.loc_nm) x ) z ) cust
	on cust.loc_nm=lc.loc_nm
) nyu,
(select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_CUST_DTS),0) as ACTL_CUST_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceCustomersColumn>
<VarianceCustomersTotal>
<![CDATA[select nyu.ar_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select z.ar_no,NVL(y.Mon,0) as Mon,NVL(y.Tue,0) as Tue,NVL(y.Wed,0) as Wed,NVL(y.Thu,0) as Thu,
NVL(y.Fri,0) as Fri,NVL(y.Sat,0) as Sat,NVL(y.Sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DPZ)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DPZ)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DPZ)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DPZ)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DPZ)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DPZ)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DPZ)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_DPZ from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,ROUND(sum(e.mgr_pln_cust_cnt),0) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) y
on z.ar_no=y.ar_no order by z.ar_no
) nyu,
(select lc.ar_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_CUST_DTS),0) as ACTL_CUST_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) den
where nyu.ar_no = den.ar_no ]]>
</VarianceCustomersTotal>	
<VarianceCustomersWkToDt>
<![CDATA[select nyu.loc_nm,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_CUST_DPS from
(select lc.loc_nm,NVL(cust.wtd,0) as WTD from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and ar_no='Area'
  	order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc
	LEFT OUTER JOIN
	(select z.loc_nm,z.wtd from 
	(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
	(select b.loc_nm,'store Total' as STR_TOT,
	NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DTS)),0) Sun from 
	(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_DTS from 
	(select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.mgr_pln_cust_cnt),0) as PLN_CUST_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
	nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
	from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
	and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
	and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.loc_nm,e.dply_seq,e.day_of_wk) f
	UNION
	select * from 
	(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,ROUND(sum(e.gnrt_cust),0) as GEN_CUST_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
	nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
	and a.fcst_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
	and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
	where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
	and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
	group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) g) h group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
	group by b.loc_nm order by b.loc_nm) x ) z ) cust
	on cust.loc_nm=lc.loc_nm

  ) nyu,
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceCustomersWkToDt>
<VarianceCustomersWkToDtTotal>
<![CDATA[select nyu.ar_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_CUST_TOT_DPS from
(select z.ar_no,NVL(ROUND(y.wtd,0),0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DPZ)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DPZ)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DPZ)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DPZ)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DPZ)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DPZ)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DPZ)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_CUST_DTS) as PLN_CUST_DPZ from 
(select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) y
on z.ar_no=y.ar_no order by z.ar_no
) nyu,
(select lc.ar_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.txn_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) den
where nyu.ar_no = den.ar_no ]]>
</VarianceCustomersWkToDtTotal>
</TCName>

<TCName name = "CPHView" >
	<PlannedCPHColumn>
	<![CDATA[select wge_hrs.loc_nm,
case when wge_hrs.mon_wge=0 and wge_hrs.mon_hrs=0 then 0 when wge_hrs.mon_wge=0 then 0 when wge_hrs.mon_hrs=0 then 0  
else NVL(ROUND((wge_hrs.mon_wge / wge_hrs.mon_hrs),2),0) end as Mon,
case when wge_hrs.tue_wge=0 and wge_hrs.tue_hrs=0 then 0 when wge_hrs.tue_wge=0 then 0 when wge_hrs.tue_hrs=0 then 0
else NVL(ROUND((wge_hrs.tue_wge / wge_hrs.tue_hrs),2),0) end as Tue,
case when wge_hrs.wed_wge=0 and wge_hrs.wed_hrs=0 then 0 when wge_hrs.wed_wge=0 then 0 when wge_hrs.wed_hrs=0 then 0
else NVL(ROUND((wge_hrs.wed_wge / wge_hrs.wed_hrs),2),0) end as Wed,
case when wge_hrs.thu_wge=0 and wge_hrs.thu_hrs=0 then 0 when wge_hrs.thu_wge=0 then 0 when wge_hrs.thu_hrs=0 then 0
else NVL(ROUND((wge_hrs.thu_wge / wge_hrs.thu_hrs),2),0) end as Thu,
case when wge_hrs.fri_wge=0 and wge_hrs.fri_hrs=0 then 0 when wge_hrs.fri_wge=0 then 0 when wge_hrs.fri_hrs=0 then 0
else NVL(ROUND((wge_hrs.fri_wge / wge_hrs.fri_hrs),2),0) end as Fri,
case when wge_hrs.sat_wge=0 and wge_hrs.sat_hrs=0 then 0 when wge_hrs.sat_wge=0 then 0 when wge_hrs.sat_hrs=0 then 0
else NVL(ROUND((wge_hrs.sat_wge / wge_hrs.sat_hrs),2),0) end as Sat,
case when wge_hrs.sun_wge=0 and wge_hrs.sun_hrs=0 then 0 when wge_hrs.sun_wge=0 then 0 when wge_hrs.sun_hrs=0 then 0
else NVL(ROUND((wge_hrs.sun_wge / wge_hrs.sun_hrs),2),0) end as Sun from
(select z.loc_nm,y.Mon_wge,y.Tue_wge,y.Wed_wge,y.Thu_wge,y.Fri_wge,y.Sat_wge,y.Sun_wge,y.wtd_wge,
y.Mon_hrs,y.Tue_hrs,y.Wed_hrs,y.Thu_hrs,y.Fri_hrs,y.Sat_hrs,y.Sun_hrs,y.wtd_hrs from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) z
LEFT OUTER JOIN
(select x.*,(x.Mon_wge + x.Tue_wge + x.Wed_wge + x.Thu_wge + x.Fri_wge + x.Sat_wge + x.Sun_wge) as WTD_wge,
(x.Mon_hrs + x.Tue_hrs + x.Wed_hrs + x.Thu_hrs + x.Fri_hrs + x.Sat_hrs + x.Sun_hrs) as WTD_hrs from 
(select b.loc_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DPG)),0) Mon_wge,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DPG)),0) Tue_wge,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DPG)),0) Wed_wge,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DPG)),0) Thu_wge,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DPG)),0) Fri_wge,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DPG)),0) Sat_wge,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DPG)),0) Sun_wge,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DPG)),0) Mon_hrs,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DPG)),0) Tue_hrs,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DPG)),0) Wed_hrs,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DPG)),0) Thu_hrs,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DPG)),0) Fri_hrs,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DPG)),0) Sat_hrs,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DPG)),0) Sun_hrs from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_WGE_DTS) as PLN_WGE_DPG,sum(h.PLN_HRS_DTS) as PLN_HRS_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) y
on z.loc_nm=y.loc_nm order by z.loc_nm) wge_hrs]]>
	</PlannedCPHColumn>
	<PlannedCPHTotal>
	<![CDATA[select wge_hrs.ar_no,
case when wge_hrs.mon_wge=0 and wge_hrs.mon_hrs=0 then 0 when wge_hrs.mon_wge=0 then 0 when wge_hrs.mon_hrs=0 then 0  
else NVL(ROUND((wge_hrs.mon_wge / wge_hrs.mon_hrs),2),0) end as Mon,
case when wge_hrs.tue_wge=0 and wge_hrs.tue_hrs=0 then 0 when wge_hrs.tue_wge=0 then 0 when wge_hrs.tue_hrs=0 then 0
else NVL(ROUND((wge_hrs.tue_wge / wge_hrs.tue_hrs),2),0) end as Tue,
case when wge_hrs.wed_wge=0 and wge_hrs.wed_hrs=0 then 0 when wge_hrs.wed_wge=0 then 0 when wge_hrs.wed_hrs=0 then 0
else NVL(ROUND((wge_hrs.wed_wge / wge_hrs.wed_hrs),2),0) end as Wed,
case when wge_hrs.thu_wge=0 and wge_hrs.thu_hrs=0 then 0 when wge_hrs.thu_wge=0 then 0 when wge_hrs.thu_hrs=0 then 0
else NVL(ROUND((wge_hrs.thu_wge / wge_hrs.thu_hrs),2),0) end as Thu,
case when wge_hrs.fri_wge=0 and wge_hrs.fri_hrs=0 then 0 when wge_hrs.fri_wge=0 then 0 when wge_hrs.fri_hrs=0 then 0
else NVL(ROUND((wge_hrs.fri_wge / wge_hrs.fri_hrs),2),0) end as Fri,
case when wge_hrs.sat_wge=0 and wge_hrs.sat_hrs=0 then 0 when wge_hrs.sat_wge=0 then 0 when wge_hrs.sat_hrs=0 then 0
else NVL(ROUND((wge_hrs.sat_wge / wge_hrs.sat_hrs),2),0) end as Sat,
case when wge_hrs.sun_wge=0 and wge_hrs.sun_hrs=0 then 0 when wge_hrs.sun_wge=0 then 0 when wge_hrs.sun_hrs=0 then 0
else NVL(ROUND((wge_hrs.sun_wge / wge_hrs.sun_hrs),2),0) end as Sun from
(select z.ar_no,y.Mon_wge,y.Tue_wge,y.Wed_wge,y.Thu_wge,y.Fri_wge,y.Sat_wge,y.Sun_wge,y.wtd_wge,
y.Mon_hrs,y.Tue_hrs,y.Wed_hrs,y.Thu_hrs,y.Fri_hrs,y.Sat_hrs,y.Sun_hrs,y.wtd_hrs from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_wge + x.Tue_wge + x.Wed_wge + x.Thu_wge + x.Fri_wge + x.Sat_wge + x.Sun_wge) as WTD_wge,
(x.Mon_hrs + x.Tue_hrs + x.Wed_hrs + x.Thu_hrs + x.Fri_hrs + x.Sat_hrs + x.Sun_hrs) as WTD_hrs from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DPG)),0) Mon_wge,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DPG)),0) Tue_wge,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DPG)),0) Wed_wge,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DPG)),0) Thu_wge,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DPG)),0) Fri_wge,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DPG)),0) Sat_wge,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DPG)),0) Sun_wge,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DPG)),0) Mon_hrs,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DPG)),0) Tue_hrs,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DPG)),0) Wed_hrs,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DPG)),0) Thu_hrs,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DPG)),0) Fri_hrs,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DPG)),0) Sat_hrs,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DPG)),0) Sun_hrs from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(round(h.PLN_WGE_DTS,0)) as PLN_WGE_TOT_DPG,sum(round(h.PLN_HRS_DTS,1)) as PLN_HRS_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) y
on z.ar_no=y.ar_no order by z.ar_no) wge_hrs]]>
	</PlannedCPHTotal>
	
	<PlannedCPHWkToDt>
	<![CDATA[select wge_hrs.loc_nm,
case when wge_hrs.PLN_WGE_DPG=0 and wge_hrs.PLN_HRS_DPG=0 then 0 when wge_hrs.PLN_WGE_DPG=0 then 0 when wge_hrs.PLN_HRS_DPG=0 then 0
else NVL(ROUND((wge_hrs.PLN_WGE_DPG / wge_hrs.PLN_HRS_DPG),2),0) end as WTD from
(select lc.loc_no,lc.loc_nm,wge.PLN_WGE_DPG as PLN_WGE_DPG,wge.PLN_HRS_DPG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select e.loc_no,e.loc_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WGE_DPG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HRS_DPG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no,e.loc_nm order by e.loc_no,e.loc_nm) wge
on wge.loc_nm=lc.loc_nm order by lc.loc_nm) wge_hrs]]>
	</PlannedCPHWkToDt>
	<PlannedCPHWkToDtTotal>
	<![CDATA[select wge_hrs.ar_no,
case when wge_hrs.PLN_WGE_TOT_DPG=0 and wge_hrs.PLN_HRS_TOT_DPG=0 then 0 when wge_hrs.PLN_WGE_TOT_DPG=0 then 0 when wge_hrs.PLN_HRS_TOT_DPG=0 then 0 
else NVL(ROUND((wge_hrs.PLN_WGE_TOT_DPG / wge_hrs.PLN_HRS_TOT_DPG),2),0) end as WTD from
(select lc.ar_no,wge.PLN_WGE_TOT_DPG as PLN_WGE_TOT_DPG,wge.PLN_HRS_TOT_DPG from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WGE_TOT_DPG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HRS_TOT_DPG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) wge_hrs]]>
	</PlannedCPHWkToDtTotal>
	<ActualCPHColumn>
	<![CDATA[select wge.loc_nm,
case when wge.mon=0 and hrs.mon=0 then 0 when wge.mon=0 then 0 when hrs.mon=0 then 0
else NVL(ROUND((wge.mon / hrs.mon),2),0) end as mon, 
case when wge.tue=0 and hrs.tue=0 then 0 when wge.tue=0 then 0 when hrs.tue=0 then 0
else NVL(ROUND((wge.tue / hrs.tue),2),0) end as tue,
case when wge.wed=0 and hrs.wed=0 then 0 when wge.wed=0 then 0 when hrs.wed=0 then 0
else NVL(ROUND((wge.wed / hrs.wed),2),0) end as wed,
case when wge.thu=0 and hrs.thu=0 then 0 when wge.thu=0 then 0 when hrs.thu=0 then 0
else NVL(ROUND((wge.thu / hrs.thu),2),0) end as thu,
case when wge.fri=0 and hrs.fri=0 then 0 when wge.fri=0 then 0 when hrs.fri=0 then 0
else NVL(ROUND((wge.fri / hrs.fri),2),0) end as fri,
case when wge.sat=0 and hrs.sat=0 then 0 when wge.sat=0 then 0 when hrs.sat=0 then 0
else NVL(ROUND((wge.sat / hrs.sat),2),0) end as sat,
case when wge.sun=0 and hrs.sun=0 then 0 when wge.sun=0 then 0 when hrs.sun=0 then 0
else NVL(ROUND((wge.sun / hrs.sun),2),0) end as sun from 
(select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm) hrs 
where wge.loc_nm=hrs.loc_nm ]]>
	</ActualCPHColumn>
	
	<ActualCPHTotal>
	<![CDATA[select wge.ar_no,
case when wge.mon=0 and hrs.mon=0 then 0 when wge.mon=0 then 0 when hrs.mon=0 then 0
else NVL(ROUND((wge.mon / hrs.mon),2),0) end as mon, 
case when wge.tue=0 and hrs.tue=0 then 0 when wge.tue=0 then 0 when hrs.tue=0 then 0
else NVL(ROUND((wge.tue / hrs.tue),2),0) end as tue,
case when wge.wed=0 and hrs.wed=0 then 0 when wge.wed=0 then 0 when hrs.wed=0 then 0
else NVL(ROUND((wge.wed / hrs.wed),2),0) end as wed,
case when wge.thu=0 and hrs.thu=0 then 0 when wge.thu=0 then 0 when hrs.thu=0 then 0
else NVL(ROUND((wge.thu / hrs.thu),2),0) end as thu,
case when wge.fri=0 and hrs.fri=0 then 0 when wge.fri=0 then 0 when hrs.fri=0 then 0
else NVL(ROUND((wge.fri / hrs.fri),2),0) end as fri,
case when wge.sat=0 and hrs.sat=0 then 0 when wge.sat=0 then 0 when hrs.sat=0 then 0
else NVL(ROUND((wge.sat / hrs.sat),2),0) end as sat,
case when wge.sun=0 and hrs.sun=0 then 0 when wge.sun=0 then 0 when hrs.sun=0 then 0
else NVL(ROUND((wge.sun / hrs.sun),2),0) end as sun from 
(select lc.ar_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(Round(e.actl_amt,0)) as ACTL_WGE_DTS,sum(Round(e.actl_hrs,1)) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.ar_no,g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) wge,
(select lc.ar_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.ar_no,g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) hrs 
where wge.ar_no=hrs.ar_no]]>
	</ActualCPHTotal>
	<ActualCPHWkToDt>
	<![CDATA[select wge_hrs.loc_nm,
case when  wge_hrs.wtd_wge=0 and wge_hrs.wtd_hrs=0 then 0 when wge_hrs.wtd_wge=0 then 0 when wge_hrs.wtd_hrs=0 then 0 
else NVL(ROUND((wge_hrs.wtd_wge / wge_hrs.wtd_hrs),2),0) end as WTD from 
(select wge.loc_nm,wge.WTD_WGE,hrs.WTD_HRS from 
(select lc.loc_nm,wge.ACTL_WGE_DTSG as WTD_WGE from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select j.loc_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_DTSG from 
(select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) f
UNION
select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) g 
/*UNION
select * from 
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) i */) j
group by j.loc_no order by j.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm) wge,
(select lc.loc_nm,wge.ACTL_HRS_DTSG as WTD_HRS from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select j.loc_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_DTSG from 
(select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) f
UNION
select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) g 
/*UNION
select * from 
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) i */) j
group by j.loc_no order by j.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm) hrs 
where wge.loc_nm=hrs.loc_nm) wge_hrs]]>
	</ActualCPHWkToDt>

	<ActualCPHWkToDtTotal>
	<![CDATA[select wge_hrs.ar_no,
case when wge_hrs.wtd_wge=0 and wge_hrs.wtd_hrs=0 then 0 when wge_hrs.wtd_wge=0 then 0 when wge_hrs.wtd_hrs=0 then 0 
else NVL(ROUND((wge_hrs.wtd_wge / wge_hrs.wtd_hrs),2),0) end as WTD from 
(select wge.ar_no,wge.wtd_wge,hrs.wtd_hrs from 
(select lc.ar_no,wge.ACTL_WGE_TOT_DTSG as WTD_WGE from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select j.ar_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_TOT_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) f
UNION
select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) g 
/*UNION
select * from 
(select e.ar_no,e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no order by e.ar_no,e.loc_no) i*/) j
group by j.ar_no order by j.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) wge,
(select lc.ar_no,wge.ACTL_HRS_TOT_DTSG as WTD_HRS from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select j.ar_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_TOT_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) f
UNION
select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) g 
/*UNION
select * from 
(select e.ar_no,e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no order by e.ar_no,e.loc_no) i*/) j
group by j.ar_no order by j.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) hrs where wge.ar_no=hrs.ar_no order by wge.ar_no) wge_hrs
order by wge_hrs.ar_no]]>
	</ActualCPHWkToDtTotal>
	
	<VarianceCPHColumn>
<![CDATA[select nyu.loc_nm,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select wge_hrs.loc_nm,
case when wge_hrs.mon_wge=0 and wge_hrs.mon_hrs=0 then 0 when wge_hrs.mon_wge=0 then 0 when wge_hrs.mon_hrs=0 then 0  
else NVL(ROUND((wge_hrs.mon_wge / wge_hrs.mon_hrs),2),0) end as Mon,
case when wge_hrs.tue_wge=0 and wge_hrs.tue_hrs=0 then 0 when wge_hrs.tue_wge=0 then 0 when wge_hrs.tue_hrs=0 then 0
else NVL(ROUND((wge_hrs.tue_wge / wge_hrs.tue_hrs),2),0) end as Tue,
case when wge_hrs.wed_wge=0 and wge_hrs.wed_hrs=0 then 0 when wge_hrs.wed_wge=0 then 0 when wge_hrs.wed_hrs=0 then 0
else NVL(ROUND((wge_hrs.wed_wge / wge_hrs.wed_hrs),2),0) end as Wed,
case when wge_hrs.thu_wge=0 and wge_hrs.thu_hrs=0 then 0 when wge_hrs.thu_wge=0 then 0 when wge_hrs.thu_hrs=0 then 0
else NVL(ROUND((wge_hrs.thu_wge / wge_hrs.thu_hrs),2),0) end as Thu,
case when wge_hrs.fri_wge=0 and wge_hrs.fri_hrs=0 then 0 when wge_hrs.fri_wge=0 then 0 when wge_hrs.fri_hrs=0 then 0
else NVL(ROUND((wge_hrs.fri_wge / wge_hrs.fri_hrs),2),0) end as Fri,
case when wge_hrs.sat_wge=0 and wge_hrs.sat_hrs=0 then 0 when wge_hrs.sat_wge=0 then 0 when wge_hrs.sat_hrs=0 then 0
else NVL(ROUND((wge_hrs.sat_wge / wge_hrs.sat_hrs),2),0) end as Sat,
case when wge_hrs.sun_wge=0 and wge_hrs.sun_hrs=0 then 0 when wge_hrs.sun_wge=0 then 0 when wge_hrs.sun_hrs=0 then 0
else NVL(ROUND((wge_hrs.sun_wge / wge_hrs.sun_hrs),2),0) end as Sun from
(select z.loc_nm,y.Mon_wge,y.Tue_wge,y.Wed_wge,y.Thu_wge,y.Fri_wge,y.Sat_wge,y.Sun_wge,y.wtd_wge,
y.Mon_hrs,y.Tue_hrs,y.Wed_hrs,y.Thu_hrs,y.Fri_hrs,y.Sat_hrs,y.Sun_hrs,y.wtd_hrs from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_wge + x.Tue_wge + x.Wed_wge + x.Thu_wge + x.Fri_wge + x.Sat_wge + x.Sun_wge) as WTD_wge,
(x.Mon_hrs + x.Tue_hrs + x.Wed_hrs + x.Thu_hrs + x.Fri_hrs + x.Sat_hrs + x.Sun_hrs) as WTD_hrs from 
(select b.loc_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DPG)),0) Mon_wge,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DPG)),0) Tue_wge,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DPG)),0) Wed_wge,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DPG)),0) Thu_wge,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DPG)),0) Fri_wge,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DPG)),0) Sat_wge,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DPG)),0) Sun_wge,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DPG)),0) Mon_hrs,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DPG)),0) Tue_hrs,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DPG)),0) Wed_hrs,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DPG)),0) Thu_hrs,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DPG)),0) Fri_hrs,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DPG)),0) Sat_hrs,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DPG)),0) Sun_hrs from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_WGE_DTS) as PLN_WGE_DPG,sum(h.PLN_HRS_DTS) as PLN_HRS_DPG from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) y
on z.loc_nm=y.loc_nm order by z.loc_no) wge_hrs) nyu,
(select wge.loc_nm,
case when wge.mon=0 and hrs.mon=0 then 0 when wge.mon=0 then 0 when hrs.mon=0 then 0
else NVL(ROUND((wge.mon / hrs.mon),2),0) end as mon, 
case when wge.tue=0 and hrs.tue=0 then 0 when wge.tue=0 then 0 when hrs.tue=0 then 0
else NVL(ROUND((wge.tue / hrs.tue),2),0) end as tue,
case when wge.wed=0 and hrs.wed=0 then 0 when wge.wed=0 then 0 when hrs.wed=0 then 0
else NVL(ROUND((wge.wed / hrs.wed),2),0) end as wed,
case when wge.thu=0 and hrs.thu=0 then 0 when wge.thu=0 then 0 when hrs.thu=0 then 0
else NVL(ROUND((wge.thu / hrs.thu),2),0) end as thu,
case when wge.fri=0 and hrs.fri=0 then 0 when wge.fri=0 then 0 when hrs.fri=0 then 0
else NVL(ROUND((wge.fri / hrs.fri),2),0) end as fri,
case when wge.sat=0 and hrs.sat=0 then 0 when wge.sat=0 then 0 when hrs.sat=0 then 0
else NVL(ROUND((wge.sat / hrs.sat),2),0) end as sat,
case when wge.sun=0 and hrs.sun=0 then 0 when wge.sun=0 then 0 when hrs.sun=0 then 0
else NVL(ROUND((wge.sun / hrs.sun),2),0) end as sun from 
(select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSG)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_DTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm) hrs 
where wge.loc_nm=hrs.loc_nm) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceCPHColumn>
<VarianceCPHTotal>
<![CDATA[select nyu.ar_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select wge_hrs.ar_no,
case when wge_hrs.mon_wge=0 and wge_hrs.mon_hrs=0 then 0 when wge_hrs.mon_wge=0 then 0 when wge_hrs.mon_hrs=0 then 0  
else NVL(ROUND((wge_hrs.mon_wge / wge_hrs.mon_hrs),2),0) end as Mon,
case when wge_hrs.tue_wge=0 and wge_hrs.tue_hrs=0 then 0 when wge_hrs.tue_wge=0 then 0 when wge_hrs.tue_hrs=0 then 0
else NVL(ROUND((wge_hrs.tue_wge / wge_hrs.tue_hrs),2),0) end as Tue,
case when wge_hrs.wed_wge=0 and wge_hrs.wed_hrs=0 then 0 when wge_hrs.wed_wge=0 then 0 when wge_hrs.wed_hrs=0 then 0
else NVL(ROUND((wge_hrs.wed_wge / wge_hrs.wed_hrs),2),0) end as Wed,
case when wge_hrs.thu_wge=0 and wge_hrs.thu_hrs=0 then 0 when wge_hrs.thu_wge=0 then 0 when wge_hrs.thu_hrs=0 then 0
else NVL(ROUND((wge_hrs.thu_wge / wge_hrs.thu_hrs),2),0) end as Thu,
case when wge_hrs.fri_wge=0 and wge_hrs.fri_hrs=0 then 0 when wge_hrs.fri_wge=0 then 0 when wge_hrs.fri_hrs=0 then 0
else NVL(ROUND((wge_hrs.fri_wge / wge_hrs.fri_hrs),2),0) end as Fri,
case when wge_hrs.sat_wge=0 and wge_hrs.sat_hrs=0 then 0 when wge_hrs.sat_wge=0 then 0 when wge_hrs.sat_hrs=0 then 0
else NVL(ROUND((wge_hrs.sat_wge / wge_hrs.sat_hrs),2),0) end as Sat,
case when wge_hrs.sun_wge=0 and wge_hrs.sun_hrs=0 then 0 when wge_hrs.sun_wge=0 then 0 when wge_hrs.sun_hrs=0 then 0
else NVL(ROUND((wge_hrs.sun_wge / wge_hrs.sun_hrs),2),0) end as Sun from
(select z.ar_no,y.Mon_wge,y.Tue_wge,y.Wed_wge,y.Thu_wge,y.Fri_wge,y.Sat_wge,y.Sun_wge,y.wtd_wge,
y.Mon_hrs,y.Tue_hrs,y.Wed_hrs,y.Thu_hrs,y.Fri_hrs,y.Sat_hrs,y.Sun_hrs,y.wtd_hrs from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_wge + x.Tue_wge + x.Wed_wge + x.Thu_wge + x.Fri_wge + x.Sat_wge + x.Sun_wge) as WTD_wge,
(x.Mon_hrs + x.Tue_hrs + x.Wed_hrs + x.Thu_hrs + x.Fri_hrs + x.Sat_hrs + x.Sun_hrs) as WTD_hrs from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DPG)),0) Mon_wge,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DPG)),0) Tue_wge,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DPG)),0) Wed_wge,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DPG)),0) Thu_wge,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DPG)),0) Fri_wge,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DPG)),0) Sat_wge,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DPG)),0) Sun_wge,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DPG)),0) Mon_hrs,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DPG)),0) Tue_hrs,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DPG)),0) Wed_hrs,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DPG)),0) Thu_hrs,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DPG)),0) Fri_hrs,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DPG)),0) Sat_hrs,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DPG)),0) Sun_hrs from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(round(h.PLN_WGE_DTS,0)) as PLN_WGE_TOT_DPG,sum(round(h.PLN_HRS_DTS,1)) as PLN_HRS_TOT_DPG from 
(select e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) y
on z.ar_no=y.ar_no order by z.ar_no) wge_hrs) nyu,
(select wge.ar_no,
case when wge.mon=0 and hrs.mon=0 then 0 when wge.mon=0 then 0 when hrs.mon=0 then 0
else NVL(ROUND((wge.mon / hrs.mon),2),0) end as mon, 
case when wge.tue=0 and hrs.tue=0 then 0 when wge.tue=0 then 0 when hrs.tue=0 then 0
else NVL(ROUND((wge.tue / hrs.tue),2),0) end as tue,
case when wge.wed=0 and hrs.wed=0 then 0 when wge.wed=0 then 0 when hrs.wed=0 then 0
else NVL(ROUND((wge.wed / hrs.wed),2),0) end as wed,
case when wge.thu=0 and hrs.thu=0 then 0 when wge.thu=0 then 0 when hrs.thu=0 then 0
else NVL(ROUND((wge.thu / hrs.thu),2),0) end as thu,
case when wge.fri=0 and hrs.fri=0 then 0 when wge.fri=0 then 0 when hrs.fri=0 then 0
else NVL(ROUND((wge.fri / hrs.fri),2),0) end as fri,
case when wge.sat=0 and hrs.sat=0 then 0 when wge.sat=0 then 0 when hrs.sat=0 then 0
else NVL(ROUND((wge.sat / hrs.sat),2),0) end as sat,
case when wge.sun=0 and hrs.sun=0 then 0 when wge.sun=0 then 0 when hrs.sun=0 then 0
else NVL(ROUND((wge.sun / hrs.sun),2),0) end as sun from 
(select lc.ar_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(Round(e.actl_amt,0)) as ACTL_WGE_DTS,sum(Round(e.actl_hrs,1)) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.ar_no,g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) wge,
(select lc.ar_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.ar_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.ar_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSG)),0) Sun from 
(select h.ar_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.ar_no,g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.ar_no,h.day_of_wk order by h.ar_no,h.day_of_wk) b
group by b.ar_no order by b.ar_no) x ) z) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) hrs 
where wge.ar_no=hrs.ar_no) den
where nyu.ar_no = den.ar_no ]]>
</VarianceCPHTotal>	
<VarianceCPHWkToDt>
<![CDATA[select nyu.loc_nm,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_CPH_DPS from
(select wge_hrs.loc_nm,
case when wge_hrs.PLN_WGE_DPG=0 and wge_hrs.PLN_HRS_DPG=0 then 0 when wge_hrs.PLN_WGE_DPG=0 then 0 when wge_hrs.PLN_HRS_DPG=0 then 0
else NVL(ROUND((wge_hrs.PLN_WGE_DPG / wge_hrs.PLN_HRS_DPG),2),0) end as WTD from
(select lc.loc_no,lc.loc_nm,wge.PLN_WGE_DPG as PLN_WGE_DPG,wge.PLN_HRS_DPG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm) lc
LEFT OUTER JOIN
(select e.loc_no,e.loc_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WGE_DPG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HRS_DPG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no,e.loc_nm order by e.loc_no,e.loc_nm) wge
on wge.loc_nm=lc.loc_nm order by lc.loc_nm) wge_hrs) nyu,
(select wge_hrs.loc_nm,
case when  wge_hrs.wtd_wge=0 and wge_hrs.wtd_hrs=0 then 0 when wge_hrs.wtd_wge=0 then 0 when wge_hrs.wtd_hrs=0 then 0 
else NVL(ROUND((wge_hrs.wtd_wge / wge_hrs.wtd_hrs),2),0) end as WTD from 
(select wge.loc_nm,wge.WTD_WGE,hrs.WTD_HRS from 
(select lc.loc_nm,wge.ACTL_WGE_DTSG as WTD_WGE from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select j.loc_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_DTSG from 
(select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) f
UNION
select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) g 
/*UNION
select * from 
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) i */) j
group by j.loc_no order by j.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm) wge,
(select lc.loc_nm,wge.ACTL_HRS_DTSG as WTD_HRS from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_nm) lc
LEFT OUTER JOIN
(select j.loc_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_DTSG from 
(select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) f
UNION
select * from 
(select h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no order by h.loc_no) g 
/*UNION
select * from 
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) i */) j
group by j.loc_no order by j.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm) hrs 
where wge.loc_nm=hrs.loc_nm) wge_hrs) den
where nyu.loc_nm = den.loc_nm ]]>
</VarianceCPHWkToDt>
<VarianceCPHWkToDtTotal>
<![CDATA[select nyu.ar_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_CPH_TOT_DPS from
(select wge_hrs.ar_no,
case when wge_hrs.PLN_WGE_TOT_DPG=0 and wge_hrs.PLN_HRS_TOT_DPG=0 then 0 when wge_hrs.PLN_WGE_TOT_DPG=0 then 0 when wge_hrs.PLN_HRS_TOT_DPG=0 then 0 
else NVL(ROUND((wge_hrs.PLN_WGE_TOT_DPG / wge_hrs.PLN_HRS_TOT_DPG),2),0) end as WTD from
(select lc.ar_no,wge.PLN_WGE_TOT_DPG as PLN_WGE_TOT_DPG,wge.PLN_HRS_TOT_DPG from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WGE_TOT_DPG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HRS_TOT_DPG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept') 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) wge_hrs) nyu,
(select wge_hrs.ar_no,
case when wge_hrs.wtd_wge=0 and wge_hrs.wtd_hrs=0 then 0 when wge_hrs.wtd_wge=0 then 0 when wge_hrs.wtd_hrs=0 then 0 
else NVL(ROUND((wge_hrs.wtd_wge / wge_hrs.wtd_hrs),2),0) end as WTD from 
(select wge.ar_no,wge.wtd_wge,hrs.wtd_hrs from 
(select lc.ar_no,wge.ACTL_WGE_TOT_DTSG as WTD_WGE from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select j.ar_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_TOT_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) f
UNION
select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) g 
/*UNION
select * from 
(select e.ar_no,e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no order by e.ar_no,e.loc_no) i*/) j
group by j.ar_no order by j.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) wge,
(select lc.ar_no,wge.ACTL_HRS_TOT_DTSG as WTD_HRS from 
(select distinct b.ar_no from ww_wlp.loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select j.ar_no,sum(j.ACTL_WAGE_DTSG) as ACTL_WGE_TOT_DTSG,sum(j.ACTL_HOURS_DTSG) as ACTL_HRS_TOT_DTSG from 
(select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) f
UNION
select * from 
(select h.ar_no,h.loc_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) h
group by h.ar_no,h.loc_no order by h.ar_no,h.loc_no) g 
/*UNION
select * from 
(select e.ar_no,e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.ar_no,a.loc_no) NOT IN 
(select distinct b.ar_no,a.loc_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN ('Dept')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no order by e.ar_no,e.loc_no) i*/) j
group by j.ar_no order by j.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no) hrs where wge.ar_no=hrs.ar_no order by wge.ar_no) wge_hrs
order by wge_hrs.ar_no) den
where nyu.ar_no = den.ar_no ]]>
</VarianceCPHWkToDtTotal>
</TCName>

</configuration>