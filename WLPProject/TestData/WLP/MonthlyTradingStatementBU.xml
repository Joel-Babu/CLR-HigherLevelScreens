<?xml version="1.0" encoding="UTF-8" ?> 
<configuration>

<TCName name="SalesColumnValidation">

<PlannedSales>
<![CDATA[select lc.rgn_no,NVL(ROUND(sls.PLN_SLS_MTSBU,0),0) as PLN_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.PLN_SLS_DTS) as PLN_SLS_MTSBU from 
(/*select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk 
order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk
order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk
order by e.rgn_no,e.zone_no,e.day_of_wk) g*/) sec_prty) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no ]]> 
 </PlannedSales>
 
 <PlannedSalesTotal>
<![CDATA[select lc.div_no,NVL(ROUND(sls.PLN_SLS_TOT_MTSBU,0),0) as PLN_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_MTSBU from 
(/*select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no]]> 
 </PlannedSalesTotal>
 
 <ActualSales>
<![CDATA[select lc.rgn_no,NVL(ROUND(sls.ACTL_SLS_MTSBU,0),0) as ACTL_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_MTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]> 
 </ActualSales>
 
 <ActualSalesTotal>
<![CDATA[select lc.div_no,NVL(ROUND(sls.ACTL_SLS_TOT_MTSBU,0),0) as ACTL_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no order by lc.div_no]]> 
 </ActualSalesTotal>
 
 <VarSales>
<![CDATA[select pln.rgn_no,ROUND((actl.ACTL_SLS_MTSBU - pln.PLN_SLS_MTSBU),0) as VAR_SLS_WTD_MTSBU from 
(select lc.rgn_no,NVL(sls.PLN_SLS_MTSBU,0) as PLN_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.PLN_SLS_DTS) as PLN_SLS_MTSBU from 
(/*select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk 
order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk 
order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk 
order by e.rgn_no,e.zone_no,e.day_of_wk) g*/) sec_prty) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no) pln,
(select lc.rgn_no,NVL(sls.ACTL_SLS_MTSBU,0) as ACTL_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' 
order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_MTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.loc_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.loc_no,e.zone_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]> 
 </VarSales>
 
 <VarSalesTotal>
<![CDATA[select pln.div_no,ROUND((actl.ACTL_SLS_TOT_MTSBU - pln.PLN_SLS_TOT_MTSBU),0) as VAR_SLS_WTD_MTSBU from 
(select lc.div_no,NVL(sls.PLN_SLS_TOT_MTSBU,0) as PLN_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_MTSBU from 
(/*select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no) pln,
(select lc.div_no,NVL(ROUND(sls.ACTL_SLS_TOT_MTSBU,9),0) as ACTL_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no order by lc.div_no) actl
where pln.div_no=actl.div_no]]> 
 </VarSalesTotal>
 
 <LYSales>
<![CDATA[select lc.rgn_no,NVL(ROUND(sls.ACTL_SLS_MTSBU,0),0) as ACTL_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_MTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]> 
 </LYSales>
 
 <LYSalesTotal>
<![CDATA[select lc.div_no,NVL(ROUND(sls.ACTL_SLS_TOT_MTSBU,0),0) as ACTL_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.zone_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.zone_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no order by lc.div_no]]> 
 </LYSalesTotal>
 
 <LYSalesPct>
<![CDATA[select lc.rgn_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' 
order by b.rgn_no) lc
LEFT OUTER JOIN
(select cy_val.rgn_no,sum(cy_val.ACTL_SLS_MTSBU) as cy_wtd,sum(ly_val.ACTL_SLS_MTSBU) as ly_wtd from 
(select lc.rgn_no,NVL(sls.ACTL_SLS_MTSBU,0) as ACTL_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' 
order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_MTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.loc_no,e.zone_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) cy_val
LEFT OUTER JOIN
(select lc.rgn_no,NVL(sls.ACTL_SLS_MTSBU,0) as ACTL_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' 
order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_MTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) ly_val
on cy_val.rgn_no=ly_val.rgn_no group by cy_val.rgn_no) cyly_wtd
on cyly_wtd.rgn_no=lc.rgn_no order by lc.rgn_no]]> 
 </LYSalesPct>
 
 <LYSalesPctTotal>
<![CDATA[select lc.div_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select cy_val.div_no,sum(cy_val.ACTL_SLS_TOT_MTSBU) as cy_wtd,sum(ly_val.ACTL_SLS_TOT_MTSBU) as ly_wtd from 
(select lc.div_no,NVL(sls.ACTL_SLS_TOT_MTSBU,0) as ACTL_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no order by lc.div_no) cy_val
LEFT OUTER JOIN
(select lc.div_no,NVL(sls.ACTL_SLS_TOT_MTSBU,0) as ACTL_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no order by lc.div_no) ly_val
on cy_val.div_no=ly_val.div_no group by cy_val.div_no) cyly_wtd
on cyly_wtd.div_no=lc.div_no]]> 
 </LYSalesPctTotal>
 
 <BudgetSales>
<![CDATA[select lc.rgn_no,NVL(bdgt.BDGT_SALES_MTSBU,0) as BDGT_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' 
order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_MTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no]]> 
 </BudgetSales>
 
 <BudgetSalesTotal>
<![CDATA[select lc.div_no,NVL(bdgt.BDGT_SALES_TOT_MTSBU,0) as BDGT_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_TOT_MTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) bdgt
on lc.div_no=bdgt.div_no order by lc.div_no]]> 
 </BudgetSalesTotal>
 
 <ForecastSales>
<![CDATA[select lc.rgn_no,NVL(fcst.FCST_SALES_MTSBU,0) as FCST_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' 
order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,ROUND(sum(e.frcst_sls),0) as FCST_SALES_MTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) fcst
on lc.rgn_no=fcst.rgn_no order by lc.rgn_no]]> 
 </ForecastSales>
 
<ForecastSalesTotal>
<![CDATA[select lc.div_no,NVL(bdgt.FCST_SALES_TOT_MTSBU,0) as FCST_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,ROUND(sum(e.frcst_sls),0) as FCST_SALES_TOT_MTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) bdgt
on lc.div_no=bdgt.div_no order by lc.div_no]]> 
 </ForecastSalesTotal>
 
 <VarBudgetSales>
<![CDATA[select actl.rgn_no,ROUND((actl.ACTL_SLS_MTSBU - bdgt.BDGT_SLS_MTSBU),0) as VAR_BDGT_SLS_MTSBU from 
(select lc.rgn_no,NVL(sls.ACTL_SLS_MTSBU,0) as ACTL_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_MTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl,
(select lc.rgn_no,NVL(bdgt.BDGT_SALES_MTSBU,0) as BDGT_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' 
order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.bdgt_sls) as BDGT_SALES_MTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no) bdgt
where bdgt.rgn_no=actl.rgn_no order by bdgt.rgn_no]]> 
 </VarBudgetSales>
 
 <VarBudgetSalesTotal>
<![CDATA[select actl.div_no,ROUND((actl.ACTL_SLS_TOT_MTSBU - bdgt.BDGT_SLS_TOT_MTSBU),0) as VAR_BDGT_SLS_TOT_MTSBU from 
(select lc.div_no,NVL(ROUND(sls.ACTL_SLS_TOT_MTSBU,0),0) as ACTL_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no order by lc.div_no) actl,
(select lc.div_no,NVL(bdgt.BDGT_SALES_TOT_MTSBU,0) as BDGT_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.bdgt_sls) as BDGT_SALES_TOT_MTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) bdgt
on lc.div_no=bdgt.div_no order by lc.div_no) bdgt
where bdgt.div_no=actl.div_no]]> 
 </VarBudgetSalesTotal>
 
 <VarFcstSales>
<![CDATA[select actl.rgn_no,ROUND((actl.ACTL_SLS_MTSBU - fcst.FCST_SLS_MTSBU),0) as VAR_FCST_SLS_MTSBU from 
(select lc.rgn_no,NVL(sls.ACTL_SLS_MTSBU,0) as ACTL_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' 
order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_MTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.zone_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.zone_no,e.day_of_wk from 
(select b.div_no,b.zone_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl,
(select lc.rgn_no,NVL(fcst.FCST_SALES_MTSBU,0) as FCST_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' 
order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.frcst_sls) as FCST_SALES_MTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) fcst
on lc.rgn_no=fcst.rgn_no order by lc.rgn_no) fcst
where fcst.rgn_no=actl.rgn_no order by fcst.rgn_no]]> 
 </VarFcstSales>
 
 <VarFcstSalesTotal>
<![CDATA[select actl.div_no,ROUND((actl.ACTL_SLS_TOT_MTSBU - fcst.FCST_SLS_TOT_MTSBU),0) as VAR_FCST_SLS_TOT_MTSBU from 
(select lc.div_no,NVL(sls.ACTL_SLS_TOT_MTSBU,0) as ACTL_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.zone_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.zone_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no order by lc.div_no) actl,
(select lc.div_no,NVL(bdgt.FCST_SALES_TOT_MTSBU,0) as FCST_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.frcst_sls) as FCST_SALES_TOT_MTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) bdgt
on lc.div_no=bdgt.div_no order by lc.div_no) fcst
where fcst.div_no=actl.div_no]]> 
 </VarFcstSalesTotal>
 
 <AvgBasketSales>
<![CDATA[select lc.rgn_no,
CASE WHEN NVL(nume_den.ACTL_SLS_MTSBU,0) = 0 AND NVL(nume_den.ACTL_CUST_MTSBU,0) = 0 THEN 0
WHEN NVL(nume_den.ACTL_SLS_MTSBU,0) = 0 THEN 0 WHEN NVL(nume_den.ACTL_CUST_MTSBU,0) = 0 THEN 100
ELSE NVL(ROUND((nume_den.ACTL_SLS_MTSBU / nume_den.ACTL_CUST_MTSBU),2),0) END as AVG_BASKET_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' 
order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_MTSBU,sum(h.ACTL_CUST_DTS) as ACTL_CUST_MTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.rgn_no order by h.rgn_no) nume_den
on nume_den.rgn_no=lc.rgn_no order by nume_den.rgn_no]]> 
 </AvgBasketSales>
 
 <AvgBasketSalesTotal>
<![CDATA[select lc.div_no,
CASE WHEN NVL(nume_den.ACTL_SLS_TOT_MTSBU,0) = 0 AND NVL(nume_den.ACTL_CUST_TOT_MTSBU,0) = 0 THEN 0
WHEN NVL(nume_den.ACTL_SLS_TOT_MTSBU,0) = 0 THEN 0 WHEN NVL(nume_den.ACTL_CUST_TOT_MTSBU,0) = 0 THEN 100
ELSE nvl(ROUND((nume_den.ACTL_SLS_TOT_MTSBU / nume_den.ACTL_CUST_TOT_MTSBU),2),0) END as AVG_BASKET_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSBU,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct pln_sls.div_no,pln_sls.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.div_no order by h.div_no) nume_den
on nume_den.div_no=lc.div_no]]> 
 </AvgBasketSalesTotal>
 
 <WkyMixSales>
<![CDATA[select lc.rgn_no,
CASE WHEN NVL(nume_den.ACTL_SLS_MTSBU,0) = 0 AND NVL(nume_den.ACTL_SLS_TOT_MTSBU,0) = 0 THEN 0
WHEN NVL(nume_den.ACTL_SLS_MTSBU,0) = 0 THEN 0 WHEN NVL(nume_den.ACTL_SLS_TOT_MTSBU,0) = 0 THEN 0
ELSE ROUND((nume_den.ACTL_SLS_MTSBU / nume_den.ACTL_SLS_TOT_MTSBU)*100,2) END as WKY_MIX_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select nume.rgn_no,nume.ACTL_SLS_MTSBU,den.ACTL_SLS_TOT_MTSBU from 
(select lc.rgn_no,NVL(sls.ACTL_SLS_MTSBU,0) as ACTL_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_MTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) nume,
(select lc.div_no,NVL(sls.ACTL_SLS_TOT_MTSBU,0) as ACTL_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.zone_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no order by lc.div_no) den ) nume_den
on nume_den.rgn_no=lc.rgn_no order by lc.rgn_no]]> 
 </WkyMixSales>
 
 <WkyMixSalesTotal>
<![CDATA[select nume_den.div_no,
CASE WHEN NVL(nume_den.ACTL_SLS_TOT_MTSBU,0) = 0 AND NVL(nume_den.ACTL_SLS_TOT_MTSBU,0) = 0 THEN 0
WHEN NVL(nume_den.ACTL_SLS_TOT_MTSBU,0) = 0 THEN 0 WHEN NVL(nume_den.ACTL_SLS_TOT_MTSBU,0) = 0 THEN 0
ELSE ROUND((nume_den.ACTL_SLS_TOT_MTSBU / nume_den.ACTL_SLS_TOT_MTSBU)*100,2) END as WKY_MIX_SLS_TOT_MTSBU from 
(select lc.div_no,NVL(sls.ACTL_SLS_TOT_MTSBU,0) as ACTL_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no order by lc.div_no) nume_den]]> 
 </WkyMixSalesTotal>
</TCName>
 
<TCName name="ItemsColumnValidation"> 
<PlannedItems>
<![CDATA[select lc.rgn_no,NVL(ROUND(itm.PLN_ITM_MTSBU,0),0) as PLN_ITM_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.PLN_ITM_DTS) as PLN_ITM_MTSBU from 
(/*select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk 
order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk 
order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk 
order by e.rgn_no,e.zone_no,e.day_of_wk) g*/) sec_prty) h 
group by h.rgn_no order by h.rgn_no) itm
on lc.rgn_no=itm.rgn_no order by lc.rgn_no ]]> 
 </PlannedItems>
 
 <PlannedItemsTotal>
<![CDATA[select lc.div_no,NVL(ROUND(itm.PLN_ITM_TOT_MTSBU,0),0) as PLN_ITM_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_MTSBU from 
(/*select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.div_no order by h.div_no) itm
on lc.div_no=itm.div_no]]> 
 </PlannedItemsTotal>
 
 <ActualItems>
<![CDATA[select lc.rgn_no,NVL(ROUND(itm.ACTL_ITM_MTSBU,0),0) as ACTL_ITM_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_ITM_DTS) as ACTL_ITM_MTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.loc_no,e.zone_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.rgn_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e )*/ ) h 
group by h.rgn_no order by h.rgn_no) itm
on lc.rgn_no=itm.rgn_no order by lc.rgn_no]]> 
 </ActualItems>
 
 <ActualItemsTotal>
<![CDATA[select lc.div_no,NVL(ROUND(itm.ACTL_ITM_TOT_MTSBU,0),0) as ACTL_ITM_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.div_no,pln_itm.rgn_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.div_no order by h.div_no) itm
on lc.div_no=itm.div_no order by lc.div_no]]> 
 </ActualItemsTotal>

 <PlannedItemPrice>
<![CDATA[select lc.rgn_no,
case when NVL(sls_itm.PLN_SLS_MTSBU,0)=0 and NVL(sls_itm.PLN_ITM_MTSBU,0)=0 then 0
when NVL(sls_itm.PLN_SLS_MTSBU,0)=0 then 0 when NVL(sls_itm.PLN_ITM_MTSBU,0)=0 then 100 
else NVL(ROUND((sls_itm.PLN_SLS_MTSBU / sls_itm.PLN_ITM_MTSBU),2),0) END as PLN_ITMPRZ_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.PLN_SLS_DTS) as PLN_SLS_MTSBU,sum(h.PLN_ITM_DTS) as PLN_ITM_MTSBU from 
(/*select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk 
order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk 
order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk 
order by e.rgn_no,e.zone_no,e.day_of_wk) g*/) sec_prty) h 
group by h.rgn_no order by h.rgn_no) sls_itm
on lc.rgn_no=sls_itm.rgn_no order by lc.rgn_no ]]> 
 </PlannedItemPrice>
 
 <PlannedItemPriceTotal>
<![CDATA[select lc.div_no,
case when NVL(sls_itm.PLN_SLS_TOT_MTSBU,0)=0 and NVL(sls_itm.PLN_ITM_TOT_MTSBU,0)=0 then 0
when NVL(sls_itm.PLN_SLS_TOT_MTSBU,0)=0 then 0 when NVL(sls_itm.PLN_ITM_TOT_MTSBU,0)=0 then 100 
else NVL(ROUND((sls_itm.PLN_SLS_TOT_MTSBU / sls_itm.PLN_ITM_TOT_MTSBU),2),0) end as PLN_ITMPRZ_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_MTSBU,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_MTSBU from 
(/*select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.div_no order by h.div_no) sls_itm
on lc.div_no=sls_itm.div_no]]> 
 </PlannedItemPriceTotal>
 
 <ActualItemPrice>
<![CDATA[select lc.rgn_no,
CASE WHEN NVL(sls_itm.ACTL_SLS_MTSBU,0) = 0 AND NVL(sls_itm.ACTL_ITM_MTSBU,0) = 0 THEN 0
WHEN NVL(sls_itm.ACTL_SLS_MTSBU,0) = 0 THEN 0 WHEN NVL(sls_itm.ACTL_ITM_MTSBU,0) = 0 THEN 0
ELSE NVL(ROUND((sls_itm.ACTL_SLS_MTSBU / sls_itm.ACTL_ITM_MTSBU),2),0) END as ACTL_ITMPRZ_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_MTSBU,sum(h.ACTL_ITM_DTS) as ACTL_ITM_MTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls_itm.rgn_no,pln_sls_itm.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e )*/ ) h 
group by h.rgn_no order by h.rgn_no) sls_itm
on lc.rgn_no=sls_itm.rgn_no order by lc.rgn_no]]> 
 </ActualItemPrice>
 
 <ActualItemPriceTotal>
<![CDATA[select lc.div_no,
CASE WHEN NVL(sls_itm.ACTL_SLS_TOT_MTSBU,0) = 0 AND NVL(sls_itm.ACTL_ITM_TOT_MTSBU,0) = 0 THEN 0
WHEN NVL(sls_itm.ACTL_SLS_TOT_MTSBU,0) = 0 THEN 0 WHEN NVL(sls_itm.ACTL_ITM_TOT_MTSBU,0) = 0 THEN 0
ELSE NVL(ROUND((sls_itm.ACTL_SLS_TOT_MTSBU / sls_itm.ACTL_ITM_TOT_MTSBU),2),0) END as ACTL_ITMPRZ_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSBU,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls_itm.div_no,pln_sls_itm.rgn_no,pln_sls_itm.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.div_no order by h.div_no) sls_itm
on lc.div_no=sls_itm.div_no order by lc.div_no]]> 
 </ActualItemPriceTotal> 
</TCName> 

<TCName name="CustomersColumnValidation"> 
 <ThisYrActlCustomers>
<![CDATA[select lc.rgn_no,NVL(ROUND(itm.ACTL_CUST_MTSBU,0),0) as ACTL_CUST_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_MTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.loc_no,e.zone_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.rgn_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )*/ ) h 
group by h.rgn_no order by h.rgn_no) itm
on lc.rgn_no=itm.rgn_no order by lc.rgn_no]]> 
 </ThisYrActlCustomers>
 
 <ThisYrActlCustomersTotal>
<![CDATA[select lc.div_no,NVL(ROUND(itm.ACTL_CUST_TOT_MTSBU,0),0) as ACTL_CUST_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.div_no,pln_itm.rgn_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.div_no order by h.div_no) itm
on lc.div_no=itm.div_no order by lc.div_no]]> 
 </ThisYrActlCustomersTotal>
 
 <PctLastYrCustomers>
<![CDATA[select lc.rgn_no,
CASE  WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select cy_val.rgn_no,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.rgn_no,NVL(sls.ACTL_CUST_MTSBU,0) as WTD from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_MTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) cy_val
LEFT OUTER JOIN
(select lc.rgn_no,NVL(sls.ACTL_CUST_MTSBU,0) as WTD from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_MTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) ly_val
on cy_val.rgn_no=ly_val.rgn_no 
group by cy_val.rgn_no) cyly_wtd
on cyly_wtd.rgn_no=lc.rgn_no order by lc.rgn_no]]> 
 </PctLastYrCustomers>
 
 <PctLastYrCustomersTotal>
<![CDATA[select lc.div_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select cy_val.div_no,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.div_no,NVL(sls.ACTL_CUST_MTSBU,0) as WTD from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.zone_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no order by lc.div_no) cy_val
LEFT OUTER JOIN
(select lc.div_no,NVL(sls.ACTL_CUST_MTSBU,0) as WTD from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no order by lc.div_no) ly_val
on cy_val.div_no=ly_val.div_no 
group by cy_val.div_no ) cyly_wtd
on cyly_wtd.div_no=lc.div_no]]> 
 </PctLastYrCustomersTotal>
 
 <DataPenetrationCustomers>
<![CDATA[select nume_den.rgn_no,
CASE WHEN NVL(nume_den.ACTL_CUST_MTSBU,0) = 0 AND NVL(nume_den.ACTL_CUST_TOT_MTSBU,0) = 0 THEN 0
WHEN NVL(nume_den.ACTL_CUST_MTSBU,0) = 0 THEN 0 WHEN NVL(nume_den.ACTL_CUST_TOT_MTSBU,0) = 0 THEN 0
ELSE ROUND((nume_den.ACTL_CUST_MTSBU / nume_den.ACTL_CUST_TOT_MTSBU)*100,2) END as DATA_PEN_CUST_MTSBU from
(select nume.rgn_no,NVL(nume.ACTL_CUST_MTSBU,0) as ACTL_CUST_MTSBU,NVL(den.ACTL_CUST_TOT_MTSBU,0) as ACTL_CUST_TOT_MTSBU from 
(select lc.rgn_no,itm.ACTL_CUST_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_MTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.loc_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.rgn_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )*/ ) h 
group by h.rgn_no order by h.rgn_no) itm
on lc.rgn_no=itm.rgn_no order by lc.rgn_no) nume,
(select lc.div_no,itm.ACTL_CUST_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.div_no,pln_itm.rgn_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )*/ ) h 
group by h.div_no order by h.div_no) itm
on lc.div_no=itm.div_no order by lc.div_no) den order by nume.rgn_no) nume_den order by nume_den.rgn_no]]> 
 </DataPenetrationCustomers>
 
 <DataPenetrationCustomersTotal>
<![CDATA[select nume_den.div_no,
CASE WHEN NVL(nume_den.ACTL_CUST_TOT_MTSBU,0) = 0 AND NVL(nume_den.ACTL_CUST_TOT_MTSBU,0) = 0 THEN 0
WHEN NVL(nume_den.ACTL_CUST_TOT_MTSBU,0) = 0 THEN 0 WHEN NVL(nume_den.ACTL_CUST_TOT_MTSBU,0) = 0 THEN 0
ELSE ROUND((nume_den.ACTL_CUST_TOT_MTSBU / nume_den.ACTL_CUST_TOT_MTSBU)*100,2) END as DATA_PEN_CUST_TOT_MTSBU from 
(select lc.div_no,NVL(itm.ACTL_CUST_TOT_MTSBU,0) as ACTL_CUST_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.div_no,pln_itm.rgn_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )*/ ) h 
group by h.div_no order by h.div_no) itm
on lc.div_no=itm.div_no order by lc.div_no) nume_den]]> 
 </DataPenetrationCustomersTotal> 
</TCName> 


<TCName name="HoursColumnValidation"> 
 <ActualHours>
<![CDATA[select lc.rgn_no,NVL(ROUND(hrs.ACTL_HRS_DTS,2),0) as ACTL_HRS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) hrs
on hrs.rgn_no=lc.rgn_no order by lc.rgn_no]]> 
 </ActualHours>
 
 <ActualHoursTotal>
<![CDATA[select lc.div_no,NVL(ROUND(hrs.ACTL_HRS_DTS,2),0) as ACTL_HRS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) hrs
on hrs.div_no=lc.div_no order by lc.div_no]]> 
 </ActualHoursTotal>
 
 <PlannedHours>
<![CDATA[select z.rgn_no,NVL(ROUND(y.PLN_HOURS_MTSBU,2),0) as PLN_HRS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) z
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_MTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) y
on z.rgn_no=y.rgn_no order by z.rgn_no]]> 
 </PlannedHours>
 
 <PlannedHoursTotal>
<![CDATA[select lc.div_no,NVL(ROUND(hrs.PLN_HOURS_TOT_MTSBU,2),0) as PLN_HRS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_MTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) hrs
on hrs.div_no=lc.div_no order by lc.div_no]]> 
 </PlannedHoursTotal>
 
 <VarHours>
<![CDATA[select pln.rgn_no,ROUND((actl.ACTL_HRS_MTSBU - pln.PLN_HRS_MTSBU),2) as VAR_HRS_MTSBU from 
(select z.rgn_no,NVL(y.PLN_HOURS_MTSBU,0) as PLN_HRS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) z
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_MTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) y
on z.rgn_no=y.rgn_no order by z.rgn_no) pln,
(select lc.rgn_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) hrs
on hrs.rgn_no=lc.rgn_no order by lc.rgn_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]> 
 </VarHours>
 
 <VarHoursTotal>
<![CDATA[select pln.div_no,ROUND((actl.ACTL_HRS_TOT_MTSBU - pln.PLN_HRS_TOT_MTSBU),2) as VAR_HRS_TOT_MTSBU from 
(select lc.div_no,NVL(hrs.PLN_HOURS_TOT_MTSBU,0) as PLN_HRS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_MTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) hrs
on hrs.div_no=lc.div_no order by lc.div_no) pln,
(select lc.div_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) hrs
on hrs.div_no=lc.div_no order by lc.div_no) actl
where pln.div_no=actl.div_no]]> 
 </VarHoursTotal>
</TCName>

<TCName name = "WagesColumnValidation" >

 <ActualWages>
<![CDATA[select lc.rgn_no,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) hrs
on hrs.rgn_no=lc.rgn_no order by lc.rgn_no]]> 
 </ActualWages>
 
 <ActualWagesTotal>
<![CDATA[select lc.div_no,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) hrs
on hrs.div_no=lc.div_no order by lc.div_no]]> 
 </ActualWagesTotal>
 
 <ActualWagePercentage>
<![CDATA[select nume_den.rgn_no,
CASE WHEN NVL(nume_den.ACTL_WGE_MTSBU,0) = 0 AND NVL(nume_den.ACTL_SLS_MTSBU,0) = 0 THEN 0
WHEN NVL(nume_den.ACTL_WGE_MTSBU,0) = 0 THEN 0 WHEN NVL(nume_den.ACTL_SLS_MTSBU,0) = 0 THEN 0
ELSE ROUND((nume_den.ACTL_WGE_MTSBU / nume_den.ACTL_SLS_MTSBU)*100,2) END as ACTL_WGE_PCT_MTSBU from 
(select nume.rgn_no,NVL(nume.ACTL_WGE_MTSBU,0) as ACTL_WGE_MTSBU,NVL(den.ACTL_SLS_MTSBU,0) as ACTL_SLS_MTSBU from 
(select lc.rgn_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) hrs
on hrs.rgn_no=lc.rgn_no order by lc.rgn_no) nume,
(select lc.rgn_no,NVL(sls.ACTL_SLS_MTSBU,0) as ACTL_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_MTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) den 
where nume.rgn_no=den.rgn_no) nume_den order by nume_den.rgn_no]]> 
 </ActualWagePercentage>
 
 <ActualWagePercentageTotal>
<![CDATA[select nume_den.div_no,
CASE WHEN NVL(nume_den.ACTL_WGE_TOT_MTSBU,0) = 0 AND NVL(nume_den.ACTL_SLS_TOT_MTSBU,0) = 0 THEN 0
WHEN NVL(nume_den.ACTL_WGE_TOT_MTSBU,0) = 0 THEN 0 WHEN NVL(nume_den.ACTL_SLS_TOT_MTSBU,0) = 0 THEN 0
ELSE ROUND((nume_den.ACTL_WGE_TOT_MTSBU / nume_den.ACTL_SLS_TOT_MTSBU)*100,2) END as ACTL_WGE_PCT_TOT_MTSBU from 
(select nume.div_no,NVL(nume.ACTL_WGE_TOT_MTSBU,0) as ACTL_WGE_TOT_MTSBU,NVL(den.ACTL_SLS_TOT_MTSBU,0) as ACTL_SLS_TOT_MTSBU from 
(select lc.div_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) hrs
on hrs.div_no=lc.div_no order by lc.div_no) nume,
(select lc.div_no,NVL(sls.ACTL_SLS_TOT_MTSBU,0) as ACTL_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSBU from 
(select * from 
(select e.div_no,e.zone_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.zone_no,e.dply_seq,e.day_of_wk order by e.div_no,e.zone_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.div_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.div_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.div_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no order by lc.div_no) den 
where nume.div_no=den.div_no) nume_den]]> 
 </ActualWagePercentageTotal>
 
 <BudgetWages>
<![CDATA[select lc.rgn_no,NVL(ROUND(bdgt.BDGT_WAGE_MTSBU,0),0) as BDGT_WGE_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.bdgt_wage_amt) as BDGT_WAGE_MTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no]]> 
 </BudgetWages>
 
 <BudgetWagesTotal>
<![CDATA[select lc.div_no,NVL(ROUND(bdgt.BDGT_WAGE_TOT_MTSBU,0),0) as BDGT_WGE_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.bdgt_wage_amt) as BDGT_WAGE_TOT_MTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) bdgt
on lc.div_no=bdgt.div_no order by lc.div_no]]> 
 </BudgetWagesTotal>
 
 <ForecastWages>
<![CDATA[select lc.rgn_no,NVL(ROUND(fcst.FCST_WAGE_MTSBU,0),0) as FCST_WGE_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.frcst_wage_amt) as FCST_WAGE_MTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) fcst
on lc.rgn_no=fcst.rgn_no order by lc.rgn_no]]> 
 </ForecastWages>
 
 <ForecastWagesTotal>
<![CDATA[select lc.div_no,NVL(ROUND(fcst.FCST_WAGE_TOT_MTSBU,0),0) as FCST_WGE_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.frcst_wage_amt) as FCST_WAGE_TOT_MTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) fcst
on lc.div_no=fcst.div_no order by lc.div_no]]> 
 </ForecastWagesTotal>
 
 <BudgetWagePercentage>
<![CDATA[select wge.rgn_no,
CASE WHEN NVL(wge.BDGT_WGE_MTSBU,0) = 0 AND NVL(sls.BDGT_SLS_MTSBU,0) = 0 THEN 0
WHEN NVL(wge.BDGT_WGE_MTSBU,0) = 0 THEN 0 WHEN NVL(sls.BDGT_SLS_MTSBU,0) = 0 THEN 0
ELSE NVL(ROUND((wge.BDGT_WGE_MTSBU / sls.BDGT_SLS_MTSBU)*100,2),0) END as BDGT_WGE_PCT_MTSBU from 
(select lc.rgn_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no]]> 
 </BudgetWagePercentage>
 
 <BudgetWagePercentageTotal>
<![CDATA[select wge.div_no,
CASE WHEN NVL(wge.BDGT_WGE_TOT_MTSBU,0) = 0 AND NVL(sls.BDGT_SLS_TOT_MTSBU,0) = 0 THEN 0
WHEN NVL(wge.BDGT_WGE_TOT_MTSBU,0) = 0 THEN 0 WHEN NVL(sls.BDGT_SLS_TOT_MTSBU,0) = 0 THEN 0
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_MTSBU / sls.BDGT_SLS_TOT_MTSBU)*100,2),0) END as BDGT_WGE_PCT_TOT_MTSBU from 
(select lc.div_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.div_no=bdgt.div_no
group by lc.div_no order by lc.div_no) wge,
(select lc.div_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.div_no=bdgt.div_no
group by lc.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no]]> 
 </BudgetWagePercentageTotal>
 
 <ForecastWagePercentage>
<![CDATA[select wge.rgn_no,
CASE WHEN NVL(wge.FCST_WGE_MTSBU,0) = 0 AND NVL(sls.FCST_SLS_MTSBU,0) = 0 THEN 0
WHEN NVL(wge.FCST_WGE_MTSBU,0) = 0 THEN 0 WHEN NVL(sls.FCST_SLS_MTSBU,0) = 0 THEN 0
ELSE NVL(ROUND((wge.FCST_WGE_MTSBU / sls.FCST_SLS_MTSBU)*100,2),0) END as FCST_WGE_PCT_MTSBU from 
(select lc.rgn_no,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.rgn_no=fcst.rgn_no
group by lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.rgn_no=fcst.rgn_no
group by lc.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no]]> 
 </ForecastWagePercentage>
 
 <ForecastWagePercentageTotal>
<![CDATA[select wge.div_no,
CASE WHEN NVL(wge.FCST_WGE_TOT_MTSBU,0) = 0 AND NVL(sls.FCST_SLS_TOT_MTSBU,0) = 0 THEN 0
WHEN NVL(wge.FCST_WGE_TOT_MTSBU,0) = 0 THEN 0 WHEN NVL(sls.FCST_SLS_TOT_MTSBU,0) = 0 THEN 0
ELSE NVL(ROUND((wge.FCST_WGE_TOT_MTSBU / sls.FCST_SLS_TOT_MTSBU)*100,2),0) END as FCST_WGE_PCT_TOT_MTSBU from 
(select lc.div_no,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.div_no=fcst.div_no
group by lc.div_no order by lc.div_no) wge,
(select lc.div_no,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.div_no=fcst.div_no
group by lc.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no]]> 
 </ForecastWagePercentageTotal>
 
 <PlannedWages>
<![CDATA[select z.rgn_no,NVL(ROUND(y.PLN_WAGE_MTSBU,0),0) as PLN_WGE_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) z
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_MTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) y
on z.rgn_no=y.rgn_no order by z.rgn_no]]> 
 </PlannedWages>
 
 <PlannedWagesTotal>
<![CDATA[select lc.div_no,NVL(ROUND(wge.PLN_WAGE_MTSBU,0),0) as PLN_WGE_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_MTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no]]> 
 </PlannedWagesTotal>
 
 <PlannedWagesPercentage>
<![CDATA[select wge.rgn_no,
CASE WHEN NVL(wge.PLN_WGE_MTSBU,0) = 0 AND NVL(sls.PLN_SLS_MTSBU,0) = 0 THEN 0
WHEN NVL(wge.PLN_WGE_MTSBU,0) = 0 THEN 0 WHEN NVL(sls.PLN_SLS_MTSBU,0) = 0 THEN 0
ELSE NVL(ROUND((wge.PLN_WGE_MTSBU / sls.PLN_SLS_MTSBU)*100,2),0) END as PLN_WGE_PRCNT_MTSBU from
(select z.rgn_no,NVL(y.PLN_WAGE_MTSBU,0) as PLN_WGE_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) z
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_MTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) y
on z.rgn_no=y.rgn_no order by z.rgn_no) wge,
(select z.rgn_no,NVL(y.PLN_SLS_MTSBU,0) as PLN_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) z
LEFT OUTER JOIN
(select h.rgn_no,sum(h.PLN_SLS_MTSBU) as PLN_SLS_MTSBU from 
(/*select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_MTSBU,sum(e.refcst_itm_cnt) as PLN_ITM_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk 
order by e.zone_no,e.rgn_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_MTSBU,sum(e.mgr_pln_itm_cnt) as PLN_ITM_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' )*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk 
order by e.zone_no,e.rgn_no,e.day_of_wk) f
/*UNION
select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_MTSBU,sum(e.gnrt_itm) as GEN_ITM_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' )
/*and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk 
order by e.zone_no,e.rgn_no,e.day_of_wk) g*/) sec_prty) h 
group by h.rgn_no order by h.rgn_no) y
on z.rgn_no=y.rgn_no order by z.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no]]> 
 </PlannedWagesPercentage>
 
 <PlannedWagesPercentageTotal>
<![CDATA[select wge.div_no,
CASE WHEN NVL(wge.PLN_WGE_TOT_MTSBU,0) = 0 AND NVL(sls.PLN_SLS_TOT_MTSBU,0) = 0 THEN 0
WHEN NVL(wge.PLN_WGE_TOT_MTSBU,0) = 0 THEN 0 WHEN NVL(sls.PLN_SLS_TOT_MTSBU,0) = 0 THEN 0
ELSE NVL(ROUND((wge.PLN_WGE_TOT_MTSBU / sls.PLN_SLS_TOT_MTSBU)*100,2),0) END as PLN_WGE_PRCNT_TOT_MTSBU from
(select lc.div_no,sum(wge.PLN_WAGE_MTSBU) as PLN_WGE_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,e.dply_seq,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_MTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no,e.div_no,e.dply_seq 
order by e.rgn_no,e.div_no,e.dply_seq) wge
on wge.div_no=lc.div_no 
group by lc.div_no order by lc.div_no) wge,
(select lc.div_no,NVL(sls.PLN_SLS_MTSBU,0) as PLN_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.PLN_SLS_MTSBU) as PLN_SLS_MTSBU from 
(/*select * from 
(select e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_MTSBU,sum(e.refcst_itm_cnt) as PLN_ITM_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_MTSBU,sum(e.mgr_pln_itm_cnt) as PLN_ITM_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' )*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_MTSBU,sum(e.gnrt_itm) as GEN_ITM_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' )
/*and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no) sls
where wge.div_no=sls.div_no]]> 
 </PlannedWagesPercentageTotal>
 
 <PlannedCPH>
<![CDATA[select lc.rgn_no,
CASE WHEN NVL(wge.PLN_WAGE_MTSBU,0) = 0 AND NVL(wge.PLN_HOURS_MTSBU,0) = 0 THEN 0
WHEN NVL(wge.PLN_WAGE_MTSBU,0) = 0 THEN 0 WHEN NVL(wge.PLN_HOURS_MTSBU,0) = 0 THEN 0
ELSE NVL(ROUND((wge.PLN_WAGE_MTSBU / wge.PLN_HOURS_MTSBU),2),0) END as PLN_CPH_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_MTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on lc.rgn_no=wge.rgn_no order by lc.rgn_no]]> 
 </PlannedCPH>
 
 <PlannedCPHTotal>
<![CDATA[select lc.div_no,
CASE WHEN NVL(wge.PLN_WAGE_TOT_MTSBU,0) = 0 AND NVL(wge.PLN_HOURS_TOT_MTSBU,0) = 0 THEN 0
WHEN NVL(wge.PLN_WAGE_TOT_MTSBU,0) = 0 THEN 0 WHEN NVL(wge.PLN_HOURS_TOT_MTSBU,0) = 0 THEN 0
ELSE NVL(ROUND((wge.PLN_WAGE_TOT_MTSBU / wge.PLN_HOURS_TOT_MTSBU),2),0) END as PLN_CPH_TOT_MTSBU from
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_MTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no]]> 
 </PlannedCPHTotal>
 
 <ActualCPH>
<![CDATA[select lc.rgn_no,
CASE WHEN NVL(wge.ACTL_WAGE_MTSBU,0) = 0 AND NVL(wge.ACTL_HOURS_MTSBU,0) = 0 THEN 0
WHEN NVL(wge.ACTL_WAGE_MTSBU,0) = 0 THEN 0 WHEN NVL(wge.ACTL_HOURS_MTSBU,0) = 0 THEN 0
ELSE NVL(ROUND((wge.ACTL_WAGE_MTSBU / wge.ACTL_HOURS_MTSBU),2),0) END as ACTL_CPH_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WAGE_MTSBU,sum(e.actl_hrs) as ACTL_HOURS_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no]]> 
 </ActualCPH>
 
 <ActualCPHTotal>
<![CDATA[select lc.div_no,
CASE WHEN NVL(wge.ACTL_WAGE_TOT_MTSBU,0) = 0 AND NVL(wge.ACTL_HOURS_TOT_MTSBU,0) = 0 THEN 0
WHEN NVL(wge.ACTL_WAGE_TOT_MTSBU,0) = 0 THEN 0 WHEN NVL(wge.ACTL_HOURS_TOT_MTSBU,0) = 0 THEN 0
ELSE NVL(ROUND((wge.ACTL_WAGE_TOT_MTSBU / wge.ACTL_HOURS_TOT_MTSBU),2),0) END as ACTL_CPH_TOT_MTSBU from
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.actl_wage_amt) as ACTL_WAGE_TOT_MTSBU,sum(e.actl_hrs) as ACTL_HOURS_TOT_MTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no]]> 
 </ActualCPHTotal>
 
 <VarWages>
<![CDATA[select pln.rgn_no,ROUND((actl.ACTL_WGE_PCT_MTSBU - pln.BDGT_WGE_PCT_MTSBU),2) as VAR_WGE_PCT_MTSBU from 
(select nume_den.rgn_no,
CASE WHEN NVL(nume_den.ACTL_WGE_MTSBU,0) = 0 AND NVL(nume_den.ACTL_SLS_MTSBU,0) = 0 THEN 0
WHEN NVL(nume_den.ACTL_WGE_MTSBU,0) = 0 THEN 0 WHEN NVL(nume_den.ACTL_SLS_MTSBU,0) = 0 THEN 0
ELSE ((nume_den.ACTL_WGE_MTSBU / nume_den.ACTL_SLS_MTSBU)*100) END as ACTL_WGE_PCT_MTSBU from 
(select nume.rgn_no,NVL(nume.ACTL_WGE_MTSBU,0) as ACTL_WGE_MTSBU,NVL(den.ACTL_SLS_MTSBU,0) as ACTL_SLS_MTSBU from 
(select lc.rgn_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) hrs
on hrs.rgn_no=lc.rgn_no order by lc.rgn_no) nume,
(select lc.rgn_no,NVL(sls.ACTL_SLS_MTSBU,0) as ACTL_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_MTSBU from 
(select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) f
UNION
select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.rgn_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) den 
where nume.rgn_no=den.rgn_no) nume_den) actl,
(select wge.rgn_no,
CASE WHEN NVL(wge.BDGT_WGE_MTSBU,0) = 0 AND NVL(sls.BDGT_SLS_MTSBU,0) = 0 THEN 0
WHEN NVL(wge.BDGT_WGE_MTSBU,0) = 0 THEN 0 WHEN NVL(sls.BDGT_SLS_MTSBU,0) = 0 THEN 0
ELSE NVL((wge.BDGT_WGE_MTSBU / sls.BDGT_SLS_MTSBU)*100,0) END as BDGT_WGE_PCT_MTSBU from 
(select lc.rgn_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no) pln
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]> 
 </VarWages>
 
 <VarWagesTotal>
<![CDATA[select pln.div_no,ROUND((actl.ACTL_WGE_PCT_TOT_MTSBU - pln.BDGT_WGE_PCT_TOT_MTSBU),2) as VAR_WGE_TOT_MTSBU from 
(select nume_den.div_no,
CASE WHEN NVL(nume_den.ACTL_WGE_TOT_MTSBU,0) = 0 AND NVL(nume_den.ACTL_SLS_TOT_MTSBU,0) = 0 THEN 0
WHEN NVL(nume_den.ACTL_WGE_TOT_MTSBU,0) = 0 THEN 0 WHEN NVL(nume_den.ACTL_SLS_TOT_MTSBU,0) = 0 THEN 0
ELSE ((nume_den.ACTL_WGE_TOT_MTSBU / nume_den.ACTL_SLS_TOT_MTSBU)*100) END as ACTL_WGE_PCT_TOT_MTSBU from 
(select nume.div_no,NVL(nume.ACTL_WGE_TOT_MTSBU,0) as ACTL_WGE_TOT_MTSBU,NVL(den.ACTL_SLS_TOT_MTSBU,0) as ACTL_SLS_TOT_MTSBU from 
(select lc.div_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) hrs
on hrs.div_no=lc.div_no order by lc.div_no) nume,
(select lc.div_no,NVL(sls.ACTL_SLS_TOT_MTSBU,0) as ACTL_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSBU from 
(select * from 
(select e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.div_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.div_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.div_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no order by lc.div_no) den 
where nume.div_no=den.div_no) nume_den) actl,
(select wge.div_no,
CASE WHEN NVL(wge.BDGT_WGE_TOT_MTSBU,0) = 0 AND NVL(sls.BDGT_SLS_TOT_MTSBU,0) = 0 THEN 0
WHEN NVL(wge.BDGT_WGE_TOT_MTSBU,0) = 0 THEN 0 WHEN NVL(sls.BDGT_SLS_TOT_MTSBU,0) = 0 THEN 0
ELSE NVL((wge.BDGT_WGE_TOT_MTSBU / sls.BDGT_SLS_TOT_MTSBU)*100,0) END as BDGT_WGE_PCT_TOT_MTSBU from 
(select lc.div_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.div_no=bdgt.div_no
group by lc.div_no order by lc.div_no) wge,
(select lc.div_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.div_no=bdgt.div_no
group by lc.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no) pln
where pln.div_no=actl.div_no]]> 
 </VarWagesTotal>
 
 <VarFcstWages>
<![CDATA[select pln.rgn_no,ROUND((actl.ACTL_WGE_PCT_MTSBU - pln.FCST_WGE_PCT_MTSBU),2) as VAR_FCST_WGE_MTSBU from 
(select nume_den.rgn_no,
CASE WHEN NVL(nume_den.ACTL_WGE_MTSBU,0) = 0 AND NVL(nume_den.ACTL_SLS_MTSBU,0) = 0 THEN 0
WHEN NVL(nume_den.ACTL_WGE_MTSBU,0) = 0 THEN 0 WHEN NVL(nume_den.ACTL_SLS_MTSBU,0) = 0 THEN 0
ELSE ((nume_den.ACTL_WGE_MTSBU / nume_den.ACTL_SLS_MTSBU)*100) END as ACTL_WGE_PCT_MTSBU from 
(select nume.rgn_no,NVL(nume.ACTL_WGE_MTSBU,0) as ACTL_WGE_MTSBU,NVL(den.ACTL_SLS_MTSBU,0) as ACTL_SLS_MTSBU from 
(select lc.rgn_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) hrs
on hrs.rgn_no=lc.rgn_no order by lc.rgn_no) nume,
(select lc.rgn_no,NVL(sls.ACTL_SLS_MTSBU,0) as ACTL_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_MTSBU from 
(select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) f
UNION
select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.ar_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.zone_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.zone_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) den 
where nume.rgn_no=den.rgn_no) nume_den) actl,
(select wge.rgn_no,
CASE WHEN NVL(wge.FCST_WGE_MTSBU,0) = 0 AND NVL(sls.FCST_SLS_MTSBU,0) = 0 THEN 0
WHEN NVL(wge.FCST_WGE_MTSBU,0) = 0 THEN 0 WHEN NVL(sls.FCST_SLS_MTSBU,0) = 0 THEN 0
ELSE NVL((wge.FCST_WGE_MTSBU / sls.FCST_SLS_MTSBU)*100,0) END as FCST_WGE_PCT_MTSBU from 
(select lc.rgn_no,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.rgn_no=fcst.rgn_no
group by lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.rgn_no=fcst.rgn_no
group by lc.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no) pln
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]> 
 </VarFcstWages>
 
 <VarFcstWagesTotal>
<![CDATA[select pln.div_no,ROUND((actl.ACTL_WGE_PCT_TOT_MTSBU - pln.FCST_WGE_PCT_TOT_MTSBU),2) as VAR_FCST_WGE_TOT_MTSBU from 
(select nume_den.div_no,
CASE WHEN NVL(nume_den.ACTL_WGE_TOT_MTSBU,0) = 0 AND NVL(nume_den.ACTL_SLS_TOT_MTSBU,0) = 0 THEN 0
WHEN NVL(nume_den.ACTL_WGE_TOT_MTSBU,0) = 0 THEN 0 WHEN NVL(nume_den.ACTL_SLS_TOT_MTSBU,0) = 0 THEN 0
ELSE ((nume_den.ACTL_WGE_TOT_MTSBU / nume_den.ACTL_SLS_TOT_MTSBU)*100) END as ACTL_WGE_PCT_TOT_MTSBU from 
(select nume.div_no,NVL(nume.ACTL_WGE_TOT_MTSBU,0) as ACTL_WGE_TOT_MTSBU,NVL(den.ACTL_SLS_TOT_MTSBU,0) as ACTL_SLS_TOT_MTSBU from 
(select lc.div_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) hrs
on hrs.div_no=lc.div_no order by lc.div_no) nume,
(select lc.div_no,NVL(sls.ACTL_SLS_TOT_MTSBU,0) as ACTL_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSBU from 
(select * from 
(select e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.div_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.div_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.div_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.div_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no order by lc.div_no) den 
where nume.div_no=den.div_no) nume_den) actl,
(select wge.div_no,
CASE WHEN NVL(wge.FCST_WGE_TOT_MTSBU,0) = 0 AND NVL(sls.FCST_SLS_TOT_MTSBU,0) = 0 THEN 0
WHEN NVL(wge.FCST_WGE_TOT_MTSBU,0) = 0 THEN 0 WHEN NVL(sls.FCST_SLS_TOT_MTSBU,0) = 0 THEN 0
ELSE NVL(((wge.FCST_WGE_TOT_MTSBU / sls.FCST_SLS_TOT_MTSBU)*100),0) END as FCST_WGE_PCT_TOT_MTSBU from 
(select lc.div_no,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.div_no=fcst.div_no
group by lc.div_no order by lc.div_no) wge,
(select lc.div_no,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.div_no=fcst.div_no
group by lc.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no) pln
where pln.div_no=actl.div_no]]> 
 </VarFcstWagesTotal>
 <AllowedWages>
<![CDATA[select src.rgn_no,
case 
when src.ACTL_SLS_MTSBU > src.BDGT_SLS_MTSBU 
	then NVL(ROUND((((BDGT_WGE_PCT_MTSBU * BDGT_SLS_MTSBU) + ((ACTL_SLS_MTSBU - BDGT_SLS_MTSBU) * (PST_FACTOR_MTSBU * BDGT_WGE_PCT_MTSBU)))/100),0),0)
When src.ACTL_SLS_MTSBU < src.BDGT_SLS_MTSBU 
	then NVL(ROUND((((BDGT_WGE_PCT_MTSBU * BDGT_SLS_MTSBU) + ((ACTL_SLS_MTSBU - BDGT_SLS_MTSBU) * (NGT_FACTOR_MTSBU * BDGT_WGE_PCT_MTSBU)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_MTSBU * ACTL_SLS_MTSBU)/100),0),0) end as ALWD_WGE_MTSBU from 

(select actl_sls.rgn_no,rte_fct.wk_id,actl_sls.ACTL_SLS_MTSBU,rte_fct.PST_FACTOR_MTSBU,rte_fct.NGT_FACTOR_MTSBU,
bdgt_wge_pct.BDGT_WGE_PCT_MTSBU,bdgt_wge_pct.BDGT_WGE_MTSBU,bdgt_wge_pct.BDGT_SLS_MTSBU from

(select lc.rgn_no,NVL(ROUND(sls.ACTL_SLS_MTSBU,0),0) as ACTL_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.wlp_live_ind in ('Y','N') order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_MTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_MTSBU,NVL(src.ngt_factor,1) as NGT_FACTOR_MTSBU from 
(select perd_desc,wk_id from wk where wk_id between 'WeekStart' and 'WeekStart') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id between 'WeekStart' and 'WeekStart') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select wge.rgn_no,NVL(ROUND(wge.BDGT_WGE_MTSBU,0),0) as BDGT_WGE_MTSBU, NVL(ROUND(sls.BDGT_SLS_MTSBU,0),0) as BDGT_SLS_MTSBU,
CASE When NVL(wge.BDGT_WGE_MTSBU,0)=0 and NVL(sls.BDGT_SLS_MTSBU,0)=0 Then 0
When NVL(wge.BDGT_WGE_MTSBU,0)=0 Then 0 When NVL(sls.BDGT_SLS_MTSBU,0)=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_MTSBU / sls.BDGT_SLS_MTSBU)*100,5),0) END as BDGT_WGE_PCT_MTSBU from 
(select lc.rgn_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.wlp_live_ind in ('Y','N') order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_MTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no) bdgt_wge_pct

where actl_sls.rgn_no=bdgt_wge_pct.rgn_no order by actl_sls.rgn_no,rte_fct.wk_id) src order by src.rgn_no ]]> 
 </AllowedWages>
 <AllowedWagesTotal>
<![CDATA[select src.div_no,
case 
when src.ACTL_SLS_TOT_MTSBU > src.BDGT_SLS_TOT_MTSBU 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_MTSBU * BDGT_SLS_TOT_MTSBU) + ((ACTL_SLS_TOT_MTSBU - BDGT_SLS_TOT_MTSBU) * (PST_FACTOR_TOT_MTSBU * BDGT_WGE_PCT_TOT_MTSBU)))/100),0),0)
When src.ACTL_SLS_TOT_MTSBU < src.BDGT_SLS_TOT_MTSBU 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_MTSBU * BDGT_SLS_TOT_MTSBU) + ((ACTL_SLS_TOT_MTSBU - BDGT_SLS_TOT_MTSBU) * (NGT_FACTOR_TOT_MTSBU * BDGT_WGE_PCT_TOT_MTSBU)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_TOT_MTSBU * ACTL_SLS_TOT_MTSBU)/100),0),0) end as ALWD_WGE_TOT_MTSBU from 

(select actl_sls.div_no,rte_fct.wk_id,actl_sls.ACTL_SLS_TOT_MTSBU,rte_fct.PST_FACTOR_TOT_MTSBU,rte_fct.NGT_FACTOR_TOT_MTSBU,
bdgt_wge_pct.BDGT_WGE_PCT_TOT_MTSBU,bdgt_wge_pct.BDGT_WGE_TOT_MTSBU,bdgt_wge_pct.BDGT_SLS_TOT_MTSBU from

(select lc.div_no,NVL(ROUND(sls.ACTL_SLS_TOT_MTSBU,0),0) as ACTL_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no order by lc.div_no) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_TOT_MTSBU,NVL(src.ngt_factor,1) as NGT_FACTOR_TOT_MTSBU from 
(select perd_desc,wk_id from wk where wk_id between 'WeekStart' and 'WeekStart') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id between 'WeekStart' and 'WeekStart') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select wge.div_no,NVL(ROUND(wge.BDGT_WGE_TOT_MTSBU,0),0) as BDGT_WGE_TOT_MTSBU, NVL(ROUND(sls.BDGT_SLS_TOT_MTSBU,0),0) as BDGT_SLS_TOT_MTSBU,
CASE When NVL(wge.BDGT_WGE_TOT_MTSBU,0)=0 and NVL(sls.BDGT_SLS_TOT_MTSBU,0)=0 Then 0
When NVL(wge.BDGT_WGE_TOT_MTSBU,0)=0 Then 0 When NVL(sls.BDGT_SLS_TOT_MTSBU,0)=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_MTSBU / sls.BDGT_SLS_TOT_MTSBU)*100,5),0) END as BDGT_WGE_PCT_TOT_MTSBU from 
(select lc.div_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.div_no=bdgt.div_no
group by lc.div_no order by lc.div_no) wge,
(select lc.div_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_MTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.div_no=bdgt.div_no
group by lc.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no) bdgt_wge_pct

where actl_sls.div_no=bdgt_wge_pct.div_no order by actl_sls.div_no,rte_fct.wk_id) src order by src.div_no ]]> 
 </AllowedWagesTotal>
 </TCName>


</configuration>