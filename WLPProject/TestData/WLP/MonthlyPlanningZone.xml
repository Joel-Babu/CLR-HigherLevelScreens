<?xml version="1.0" encoding="UTF-8"?>

<configuration>

<TCName name = "SalesHistoryFirstMonth" >
	<SalesHistory>
	<![CDATA[select J.ar_no,NVL(ROUND(sum(J.ACTL_SLS_MPG),0),0) as ACTL_SLS_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,
	loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from
	(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and 
	b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
	group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
	on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.ar_no order by J.ar_no]]>
	</SalesHistory>
	<SalesHistoryTotal>
	<![CDATA[select K.zone_no,NVL(ROUND(sum(K.ACTL_SLS_MPZ),0),0) as ACTL_SLS_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES from
	(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.
	DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' 
	and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,
	s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
	group by k.zone_no order by zone_no]]>
	</SalesHistoryTotal>
</TCName>

<TCName name = "SalesHistorySecondMonth" >
<SalesHistory>
	<![CDATA[select J.ar_no,NVL(ROUND(sum(J.ACTL_SLS_MPG),0),0) as ACTL_SLS_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,
	loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from
	(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and 
	b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
	group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
	on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.ar_no order by J.ar_no]]>
	</SalesHistory>
	<SalesHistoryTotal>
	<![CDATA[select K.zone_no,NVL(ROUND(sum(K.ACTL_SLS_MPZ),0),0) as ACTL_SLS_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES from
	(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.
	DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' 
	and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,
	s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
	group by k.zone_no order by zone_no]]>
	</SalesHistoryTotal>
</TCName>

<TCName name = "SalesHistoryThirdMonth" >
	<SalesHistory>
	<![CDATA[select J.ar_no,NVL(ROUND(sum(J.ACTL_SLS_MPG),0),0) as ACTL_SLS_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,
	loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from
	(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and 
	b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
	group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
	on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.ar_no order by J.ar_no]]>
	</SalesHistory>
	<SalesHistoryTotal>
	<![CDATA[select K.zone_no,NVL(ROUND(sum(K.ACTL_SLS_MPZ),0),0) as ACTL_SLS_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES from
	(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.
	DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' 
	and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,
	s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
	group by k.zone_no order by zone_no]]>
	</SalesHistoryTotal>
</TCName>

<TCName name = "SalesHistoryFourthMonth" >
	<SalesHistory>
	<![CDATA[select J.ar_no,NVL(ROUND(sum(J.ACTL_SLS_MPG),0),0) as ACTL_SLS_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,
	loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from
	(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and 
	b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
	group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
	on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.ar_no order by J.ar_no]]>
	</SalesHistory>
	<SalesHistoryTotal>
	<![CDATA[select K.zone_no,NVL(ROUND(sum(K.ACTL_SLS_MPZ),0),0) as ACTL_SLS_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES from
	(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.
	DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' 
	and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,
	s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
	group by k.zone_no order by zone_no]]>
	</SalesHistoryTotal>
</TCName>

<TCName name = "WagesHistoryFirsthMonth" >
	<WagesHistory>
	<![CDATA[select V.ar_no,NVL(ROUND(sum(V.ACTL_WAGE_MPG),0),0) as ACTL_WAGE_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,
	ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.
	rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d
	where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N')
	and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.ar_no) V
	group by V.ar_no order by V.ar_no]]>
	</WagesHistory>
	<WagesHistoryTotal>
	<![CDATA[select x.zone_no,NVL(ROUND(sum(x.ACTL_WAGE_MPZ),0),0) as ACTL_WAGE_TOT_MPZ from (select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' 
	and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as 
	ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as 
	ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month'))
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,
	b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm 
	order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
	group by x.zone_no order by x.zone_no]]>
	</WagesHistoryTotal>
</TCName>

<TCName name = "WagesHistorySecondMonth" >
	<WagesHistory>
	<![CDATA[select V.ar_no,NVL(ROUND(sum(V.ACTL_WAGE_MPG),0),0) as ACTL_WAGE_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,
	ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.
	rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d
	where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N')
	and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.ar_no) V
	group by V.ar_no order by V.ar_no]]>
	</WagesHistory>
	<WagesHistoryTotal>
	<![CDATA[select x.zone_no,NVL(ROUND(sum(x.ACTL_WAGE_MPZ),0),0) as ACTL_WAGE_TOT_MPZ from (select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' 
	and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as 
	ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as 
	ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month'))
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,
	b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm 
	order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
	group by x.zone_no order by x.zone_no]]>
	</WagesHistoryTotal>
</TCName>

<TCName name = "WagesHistoryThirdMonth" >
	<WagesHistory>
	<![CDATA[select V.ar_no,NVL(ROUND(sum(V.ACTL_WAGE_MPG),0),0) as ACTL_WAGE_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,
	ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.
	rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d
	where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N')
	and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.ar_no) V
	group by V.ar_no order by V.ar_no]]>
	</WagesHistory>
	<WagesHistoryTotal>
	<![CDATA[select x.zone_no,NVL(ROUND(sum(x.ACTL_WAGE_MPZ),0),0) as ACTL_WAGE_TOT_MPZ from (select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' 
	and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as 
	ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as 
	ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month'))
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,
	b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm 
	order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
	group by x.zone_no order by x.zone_no]]>
	</WagesHistoryTotal>
</TCName>

<TCName name = "WagesHistoryFourthMonth" >
	<WagesHistory>
	<![CDATA[select V.ar_no,NVL(ROUND(sum(V.ACTL_WAGE_MPG),0),0) as ACTL_WAGE_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,
	ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.
	rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d
	where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N')
	and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.ar_no) V
	group by V.ar_no order by V.ar_no]]>
	</WagesHistory>
	<WagesHistoryTotal>
	<![CDATA[select x.zone_no,NVL(ROUND(sum(x.ACTL_WAGE_MPZ),0),0) as ACTL_WAGE_TOT_MPZ from (select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' 
	and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as 
	ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as 
	ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month'))
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,
	b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm 
	order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
	group by x.zone_no order by x.zone_no]]>
	</WagesHistoryTotal>
</TCName>

<TCName name = "ItemsHistoryFirsthMonth" >
	<ItemsHistory>
	<![CDATA[select J.ar_no,NVL(ROUND(sum(J.ACTL_ITM_MPG),0),0) as ACTL_ITM_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from (select div_no,rgn_no,
	zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_ITEMS from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_ITEM) as ACTL_ITEMS from (select a.loc_no,c.loc_nm,
	b.perd_desc, b.wk_id,sum(a.actl_itm_cnt) as ACTL_ITEM from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END
	and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
	group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
	on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.ar_no order by J.ar_no]]>
	</ItemsHistory>
	<ItemsHistoryTotal>
	<![CDATA[select K.zone_no,NVL(ROUND(sum(K.ACTL_ITM_MPZ),0),0) as ACTL_ITM_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_ITEMS from
	(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_ITEM) as ACTL_ITEMS from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_itm_cnt) as ACTL_ITEM from 
	WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no
	and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,
	b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J
	group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K group by k.zone_no order by zone_no]]>
	</ItemsHistoryTotal>
</TCName>

<TCName name = "ItemsHistorySecondMonth" >
	<ItemsHistory>
	<![CDATA[select J.ar_no,NVL(ROUND(sum(J.ACTL_ITM_MPG),0),0) as ACTL_ITM_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from (select div_no,rgn_no,
	zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_ITEMS from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_ITEM) as ACTL_ITEMS from (select a.loc_no,c.loc_nm,
	b.perd_desc, b.wk_id,sum(a.actl_itm_cnt) as ACTL_ITEM from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END
	and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
	group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
	on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.ar_no order by J.ar_no]]>
	</ItemsHistory>
	<ItemsHistoryTotal>
	<![CDATA[select K.zone_no,NVL(ROUND(sum(K.ACTL_ITM_MPZ),0),0) as ACTL_ITM_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_ITEMS from
	(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_ITEM) as ACTL_ITEMS from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_itm_cnt) as ACTL_ITEM from 
	WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no
	and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,
	b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J
	group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K group by k.zone_no order by zone_no]]>
	</ItemsHistoryTotal>
</TCName>

<TCName name = "ItemsHistoryThirdMonth" >
	<ItemsHistory>
	<![CDATA[select J.ar_no,NVL(ROUND(sum(J.ACTL_ITM_MPG),0),0) as ACTL_ITM_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from (select div_no,rgn_no,
	zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_ITEMS from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_ITEM) as ACTL_ITEMS from (select a.loc_no,c.loc_nm,
	b.perd_desc, b.wk_id,sum(a.actl_itm_cnt) as ACTL_ITEM from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END
	and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
	group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
	on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.ar_no order by J.ar_no]]>
	</ItemsHistory>
	<ItemsHistoryTotal>
	<![CDATA[select K.zone_no,NVL(ROUND(sum(K.ACTL_ITM_MPZ),0),0) as ACTL_ITM_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_ITEMS from
	(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_ITEM) as ACTL_ITEMS from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_itm_cnt) as ACTL_ITEM from 
	WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no
	and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,
	b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J
	group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K group by k.zone_no order by zone_no]]>
	</ItemsHistoryTotal>
</TCName>

<TCName name = "ItemsHistoryFourthMonth" >
	<ItemsHistory>
	<![CDATA[select J.ar_no,NVL(ROUND(sum(J.ACTL_ITM_MPG),0),0) as ACTL_ITM_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from (select div_no,rgn_no,
	zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_ITEMS from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_ITEM) as ACTL_ITEMS from (select a.loc_no,c.loc_nm,
	b.perd_desc, b.wk_id,sum(a.actl_itm_cnt) as ACTL_ITEM from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END
	and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
	group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
	on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.ar_no order by J.ar_no]]>
	</ItemsHistory>
	<ItemsHistoryTotal>
	<![CDATA[select K.zone_no,NVL(ROUND(sum(K.ACTL_ITM_MPZ),0),0) as ACTL_ITM_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_ITEMS from
	(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_ITEM) as ACTL_ITEMS from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_itm_cnt) as ACTL_ITEM from 
	WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no
	and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,
	b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J
	group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K group by k.zone_no order by zone_no]]>
	</ItemsHistoryTotal>
</TCName>

<TCName name = "CustomersHistoryFirsthMonth" >
		<CustomerHistory>
	<![CDATA[select J.ar_no,NVL(ROUND(sum(J.ACTL_CUST_MPG),0),0) as ACTL_CUST_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_CUSTS,0) as ACTL_CUST_MPG from
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,
	ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_CUSTS from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_CUST) as ACTL_CUSTS from
	(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_cust_cnt) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and 
	b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no IN (90)
	group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
	on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.ar_no order by J.ar_no]]>
	</CustomerHistory>
	<CustomerHistoryTotal>
	<![CDATA[select K.zone_no,NVL(ROUND(sum(K.ACTL_CUST_MPZ),0),0) as ACTL_CUST_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_CUST_MPG),0) as ACTL_CUST_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_CUSTS,0) as ACTL_CUST_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_CUSTS from
	(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_CUST) as ACTL_CUSTS from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_cust_cnt) as ACTL_CUST from WW_WLP.
	DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.
	rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no IN (90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,
	s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
	group by k.zone_no order by zone_no]]>
	</CustomerHistoryTotal>
</TCName>

<TCName name = "CustomersHistorySecondMonth" >
	<CustomerHistory>
	<![CDATA[select J.ar_no,NVL(ROUND(sum(J.ACTL_CUST_MPG),0),0) as ACTL_CUST_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_CUSTS,0) as ACTL_CUST_MPG from
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,
	ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_CUSTS from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_CUST) as ACTL_CUSTS from
	(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_cust_cnt) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and 
	b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no IN (90)
	group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
	on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.ar_no order by J.ar_no]]>
	</CustomerHistory>
	<CustomerHistoryTotal>
	<![CDATA[select K.zone_no,NVL(ROUND(sum(K.ACTL_CUST_MPZ),0),0) as ACTL_CUST_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_CUST_MPG),0) as ACTL_CUST_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_CUSTS,0) as ACTL_CUST_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_CUSTS from
	(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_CUST) as ACTL_CUSTS from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_cust_cnt) as ACTL_CUST from WW_WLP.
	DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.
	rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no IN (90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,
	s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
	group by k.zone_no order by zone_no]]>
	</CustomerHistoryTotal>
</TCName>

<TCName name = "CustomersHistoryThirdMonth" >
	<CustomerHistory>
	<![CDATA[select J.ar_no,NVL(ROUND(sum(J.ACTL_CUST_MPG),0),0) as ACTL_CUST_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_CUSTS,0) as ACTL_CUST_MPG from
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,
	ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_CUSTS from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_CUST) as ACTL_CUSTS from
	(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_cust_cnt) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and 
	b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no IN (90)
	group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
	on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.ar_no order by J.ar_no]]>
	</CustomerHistory>
	<CustomerHistoryTotal>
	<![CDATA[select K.zone_no,NVL(ROUND(sum(K.ACTL_CUST_MPZ),0),0) as ACTL_CUST_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_CUST_MPG),0) as ACTL_CUST_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_CUSTS,0) as ACTL_CUST_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_CUSTS from
	(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_CUST) as ACTL_CUSTS from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_cust_cnt) as ACTL_CUST from WW_WLP.
	DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.
	rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no IN (90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,
	s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
	group by k.zone_no order by zone_no]]>
	</CustomerHistoryTotal>
</TCName>

<TCName name = "CustomersHistoryFourthMonth" >
	<CustomerHistory>
	<![CDATA[select J.ar_no,NVL(ROUND(sum(J.ACTL_CUST_MPG),0),0) as ACTL_CUST_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_CUSTS,0) as ACTL_CUST_MPG from
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,
	ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_CUSTS from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_CUST) as ACTL_CUSTS from
	(select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_cust_cnt) as ACTL_CUST from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and 
	b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no IN (90)
	group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U
	on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.ar_no order by J.ar_no]]>
	</CustomerHistory>
	<CustomerHistoryTotal>
	<![CDATA[select K.zone_no,NVL(ROUND(sum(K.ACTL_CUST_MPZ),0),0) as ACTL_CUST_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_CUST_MPG),0) as ACTL_CUST_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_CUSTS,0) as ACTL_CUST_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_CUSTS from
	(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_CUST) as ACTL_CUSTS from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_cust_cnt) as ACTL_CUST from WW_WLP.
	DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.
	rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no IN (90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,
	s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) J group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
	group by k.zone_no order by zone_no]]>
	</CustomerHistoryTotal>
</TCName>

<TCName name = "PaidHoursHistoryFirsthMonth" >
	<PaidHoursHistory>
	<![CDATA[select V.ar_no,NVL(ROUND(((ROUND(((sum(V.ACTL_HRS_MPG)*100)/25),0)*25)/100),2),0) as ACTL_HRS_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from (select div_no,rgn_no,zone_no
	,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,
	loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and 
	b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,
	b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.ar_no) V
	group by V.ar_no order by V.ar_no]]>
	</PaidHoursHistory>
	<PaidHoursHistoryTotal>
	<![CDATA[select x.zone_no,NVL(sum(ROUND(((ROUND((((x.ACTL_HRS_MPZ)*100)/25),0)*25)/100),2)),0) as ACTL_HRS_TOT_MPZ from (select V.zone_no,V.ar_no,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' 
	and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as 
	ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as 
	ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month'))
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,
	b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm 
	order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
	group by x.zone_no order by x.zone_no]]>
	</PaidHoursHistoryTotal>
</TCName>

<TCName name = "PaidHoursHistorySecondMonth" >
	<PaidHoursHistory>
	<![CDATA[select V.ar_no,NVL(ROUND(((ROUND(((sum(V.ACTL_HRS_MPG)*100)/25),0)*25)/100),2),0) as ACTL_HRS_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from (select div_no,rgn_no,zone_no
	,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,
	loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and 
	b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,
	b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.ar_no) V
	group by V.ar_no order by V.ar_no]]>
	</PaidHoursHistory>
	<PaidHoursHistoryTotal>
	<![CDATA[select x.zone_no,NVL(sum(ROUND(((ROUND((((x.ACTL_HRS_MPZ)*100)/25),0)*25)/100),2)),0) as ACTL_HRS_TOT_MPZ from (select V.zone_no,V.ar_no,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' 
	and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as 
	ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as 
	ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month'))
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,
	b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm 
	order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
	group by x.zone_no order by x.zone_no]]>
	</PaidHoursHistoryTotal>
</TCName>

<TCName name = "PaidHoursHistoryThirdMonth" >
	<PaidHoursHistory>
	<![CDATA[select V.ar_no,NVL(ROUND(((ROUND(((sum(V.ACTL_HRS_MPG)*100)/25),0)*25)/100),2),0) as ACTL_HRS_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from (select div_no,rgn_no,zone_no
	,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,
	loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and 
	b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,
	b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.ar_no) V
	group by V.ar_no order by V.ar_no]]>
	</PaidHoursHistory>
	<PaidHoursHistoryTotal>
	<![CDATA[select x.zone_no,NVL(sum(ROUND(((ROUND((((x.ACTL_HRS_MPZ)*100)/25),0)*25)/100),2)),0) as ACTL_HRS_TOT_MPZ from (select V.zone_no,V.ar_no,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' 
	and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as 
	ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as 
	ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month'))
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,
	b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm 
	order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
	group by x.zone_no order by x.zone_no]]>
	</PaidHoursHistoryTotal>
</TCName>

<TCName name = "PaidHoursHistoryFourthMonth" >
	<PaidHoursHistory>
	<![CDATA[select V.ar_no,NVL(ROUND(((ROUND(((sum(V.ACTL_HRS_MPG)*100)/25),0)*25)/100),2),0) as ACTL_HRS_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from (select div_no,rgn_no,zone_no
	,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,
	loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and 
	b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,
	b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.ar_no) V
	group by V.ar_no order by V.ar_no]]>
	</PaidHoursHistory>
	<PaidHoursHistoryTotal>
	<![CDATA[select x.zone_no,NVL(sum(ROUND(((ROUND((((x.ACTL_HRS_MPZ)*100)/25),0)*25)/100),2)),0) as ACTL_HRS_TOT_MPZ from (select V.zone_no,V.ar_no,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' 
	and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as 
	ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as 
	ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month'))
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,
	b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm 
	order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x
	group by x.zone_no order by x.zone_no]]>
	</PaidHoursHistoryTotal>
</TCName>

<TCName name = "CPHFirsthMonth" >
		<CPHHistory>
	<![CDATA[select x.ar_no,
	case when NVL(x.ACTL_WAGE_MPZ,0)=0 and NVL(x.ACTL_HRS_MPZ,0)=0 then 0 
	when NVL(x.ACTL_WAGE_MPZ,0)=0 then 0 when NVL(x.ACTL_HRS_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_WAGE_MPZ / x.ACTL_HRS_MPZ),2) end as ACTL_CPH_MPZ from (select V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as 
	ACTL_HRS_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from (select div_no,rgn_no,zone_no,
	ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,
	b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d
	where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and 
	b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no
	,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.ar_no) V
	group by V.ar_no order by V.ar_no) x order by x.ar_no]]>
	</CPHHistory>
	<CPHHistoryTotal>
	<![CDATA[select x.zone_no,
	case when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(x.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(x.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_WAGE_TOT_MPZ / x.ACTL_HRS_TOT_MPZ),2) end as ACTL_CPH_TOT_MPZ from (select W.zone_no,sum(w.ACTL_WAGE_MPZ) as ACTL_WAGE_TOT_MPZ,
	sum(w.ACTL_HRS_MPZ) as ACTL_HRS_TOT_MPZ from (select V.zone_no,V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from (select div_no,rgn_no,zone_no,ar_no,
	loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,
	b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
	where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N')
	and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) V
	group by V.zone_no,V.ar_no order by V.ar_no,V.ar_no) W group by W.zone_no order by W.zone_no) x order by x.zone_no ]]>
	</CPHHistoryTotal>
</TCName>

<TCName name = "CPHHistorySecondMonth" >
		<CPHHistory>
	<![CDATA[select x.ar_no,
	case when NVL(x.ACTL_WAGE_MPZ,0)=0 and NVL(x.ACTL_HRS_MPZ,0)=0 then 0 
	when NVL(x.ACTL_WAGE_MPZ,0)=0 then 0 when NVL(x.ACTL_HRS_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_WAGE_MPZ / x.ACTL_HRS_MPZ),2) end as ACTL_CPH_MPZ from (select V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as 
	ACTL_HRS_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from (select div_no,rgn_no,zone_no,
	ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,
	b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d
	where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and 
	b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no
	,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.ar_no) V
	group by V.ar_no order by V.ar_no) x order by x.ar_no]]>
	</CPHHistory>
	<CPHHistoryTotal>
	<![CDATA[select x.zone_no,
	case when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(x.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(x.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_WAGE_TOT_MPZ / x.ACTL_HRS_TOT_MPZ),2) end as ACTL_CPH_TOT_MPZ from (select W.zone_no,sum(w.ACTL_WAGE_MPZ) as ACTL_WAGE_TOT_MPZ,
	sum(w.ACTL_HRS_MPZ) as ACTL_HRS_TOT_MPZ from (select V.zone_no,V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from (select div_no,rgn_no,zone_no,ar_no,
	loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,
	b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
	where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N')
	and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) V
	group by V.zone_no,V.ar_no order by V.ar_no,V.ar_no) W group by W.zone_no order by W.zone_no) x order by x.zone_no ]]>
	</CPHHistoryTotal>
	
	</TCName>

<TCName name = "CPHHistoryThirdMonth" >
		<CPHHistory>
	<![CDATA[select x.ar_no,
	case when NVL(x.ACTL_WAGE_MPZ,0)=0 and NVL(x.ACTL_HRS_MPZ,0)=0 then 0 
	when NVL(x.ACTL_WAGE_MPZ,0)=0 then 0 when NVL(x.ACTL_HRS_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_WAGE_MPZ / x.ACTL_HRS_MPZ),2) end as ACTL_CPH_MPZ from (select V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as 
	ACTL_HRS_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from (select div_no,rgn_no,zone_no,
	ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,
	b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d
	where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and 
	b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no
	,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.ar_no) V
	group by V.ar_no order by V.ar_no) x order by x.ar_no]]>
	</CPHHistory>
	<CPHHistoryTotal>
	<![CDATA[select x.zone_no,
	case when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(x.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(x.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_WAGE_TOT_MPZ / x.ACTL_HRS_TOT_MPZ),2) end as ACTL_CPH_TOT_MPZ from (select W.zone_no,sum(w.ACTL_WAGE_MPZ) as ACTL_WAGE_TOT_MPZ,
	sum(w.ACTL_HRS_MPZ) as ACTL_HRS_TOT_MPZ from (select V.zone_no,V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from (select div_no,rgn_no,zone_no,ar_no,
	loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,
	b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
	where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N')
	and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) V
	group by V.zone_no,V.ar_no order by V.ar_no,V.ar_no) W group by W.zone_no order by W.zone_no) x order by x.zone_no ]]>
	</CPHHistoryTotal>
</TCName>

<TCName name = "CPHHistoryFourthMonth" >
		<CPHHistory>
	<![CDATA[select x.ar_no,
	case when NVL(x.ACTL_WAGE_MPZ,0)=0 and NVL(x.ACTL_HRS_MPZ,0)=0 then 0 
	when NVL(x.ACTL_WAGE_MPZ,0)=0 then 0 when NVL(x.ACTL_HRS_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_WAGE_MPZ / x.ACTL_HRS_MPZ),2) end as ACTL_CPH_MPZ from (select V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as 
	ACTL_HRS_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from (select div_no,rgn_no,zone_no,
	ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,
	b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d
	where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and 
	b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no
	,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.ar_no) V
	group by V.ar_no order by V.ar_no) x order by x.ar_no]]>
	</CPHHistory>
	<CPHHistoryTotal>
	<![CDATA[select x.zone_no,
	case when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(x.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(x.ACTL_HRS_TOT_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_WAGE_TOT_MPZ / x.ACTL_HRS_TOT_MPZ),2) end as ACTL_CPH_TOT_MPZ from (select W.zone_no,sum(w.ACTL_WAGE_MPZ) as ACTL_WAGE_TOT_MPZ,
	sum(w.ACTL_HRS_MPZ) as ACTL_HRS_TOT_MPZ from (select V.zone_no,V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
	(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from (select div_no,rgn_no,zone_no,ar_no,
	loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,
	b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
	where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N')
	and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) V
	group by V.zone_no,V.ar_no order by V.ar_no,V.ar_no) W group by W.zone_no order by W.zone_no) x order by x.zone_no ]]>
	</CPHHistoryTotal>
</TCName>

<TCName name = "WagePercentageHistoryFirsthMonth" >
	<WagePercentageHistory>
	<![CDATA[select x.ar_no,
	case when NVL(x.ACTL_WAGE_MPZ,0)=0 and NVL(y.ACTL_SLS_MPZ,0)=0 then 0 
	when NVL(x.ACTL_WAGE_MPZ,0)=0 then 0 when NVL(y.ACTL_SLS_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_WAGE_MPZ / y.ACTL_SLS_MPZ)*100,2) end as ACTL_WGE_PRCNT_MPZ from (select V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from
	(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as 
	ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as 
	ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month'))
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,
	b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by 
	C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.ar_no) V group by V.ar_no order by V.ar_no) x, (select J.ar_no,ROUND(sum
	(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from 
	ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN
	(select J.loc_nm,j.perd_desc,J.ACTL_SALES from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from (select a.loc_no,c.loc_nm,b.perd_desc, 
	b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') 
	and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id 
	order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
	group by J.ar_no order by J.ar_no) y where x.ar_no=y.ar_no order by x.ar_no]]>
	</WagePercentageHistory>
	<WagePercentageHistoryTotal>
	<![CDATA[select x.zone_no,
	case when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(y.ACTL_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(y.ACTL_SLS_TOT_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_WAGE_TOT_MPZ / y.ACTL_SLS_TOT_MPZ)*100,2) end as ACTL_WGE_PRCNT_TOT_MPZ from (select x.zone_no,ROUND(sum(x.ACTL_WAGE_MPZ),0) as 
	ACTL_WAGE_TOT_MPZ from (select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from (select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as 
	ACTL_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum
	(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) 
	as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' 
	and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.
	perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
	on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x group by x.zone_no order by x.zone_no) x,
	(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from (select T.zone_no,
	T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and 
	zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES from
	(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from 
	WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no
	and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,
	b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.zone_no,J.ar_no order by 
	J.zone_no,J.ar_no) K group by k.zone_no order by zone_no) y where x.zone_no=y.zone_no order by x.zone_no]]>
	</WagePercentageHistoryTotal>
</TCName>

<TCName name = "WagePercentageHistorySecondMonth" >
	<WagePercentageHistory>
	<![CDATA[select x.ar_no,
	case when NVL(x.ACTL_WAGE_MPZ,0)=0 and NVL(y.ACTL_SLS_MPZ,0)=0 then 0 
	when NVL(x.ACTL_WAGE_MPZ,0)=0 then 0 when NVL(y.ACTL_SLS_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_WAGE_MPZ / y.ACTL_SLS_MPZ)*100,2) end as ACTL_WGE_PRCNT_MPZ from (select V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from
	(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as 
	ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as 
	ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month'))
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,
	b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by 
	C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.ar_no) V group by V.ar_no order by V.ar_no) x, (select J.ar_no,ROUND(sum
	(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from 
	ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN
	(select J.loc_nm,j.perd_desc,J.ACTL_SALES from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from (select a.loc_no,c.loc_nm,b.perd_desc, 
	b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') 
	and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id 
	order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
	group by J.ar_no order by J.ar_no) y where x.ar_no=y.ar_no order by x.ar_no]]>
	</WagePercentageHistory>
	<WagePercentageHistoryTotal>
	<![CDATA[select x.zone_no,
	case when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(y.ACTL_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(y.ACTL_SLS_TOT_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_WAGE_TOT_MPZ / y.ACTL_SLS_TOT_MPZ)*100,2) end as ACTL_WGE_PRCNT_TOT_MPZ from (select x.zone_no,ROUND(sum(x.ACTL_WAGE_MPZ),0) as 
	ACTL_WAGE_TOT_MPZ from (select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from (select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as 
	ACTL_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum
	(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) 
	as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' 
	and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.
	perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
	on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x group by x.zone_no order by x.zone_no) x,
	(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from (select T.zone_no,
	T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and 
	zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES from
	(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from 
	WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no
	and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,
	b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.zone_no,J.ar_no order by 
	J.zone_no,J.ar_no) K group by k.zone_no order by zone_no) y where x.zone_no=y.zone_no order by x.zone_no]]>
	</WagePercentageHistoryTotal>
</TCName>

<TCName name = "WagePercentageHistoryThirdMonth" >
	<WagePercentageHistory>
	<![CDATA[select x.ar_no,
	case when NVL(x.ACTL_WAGE_MPZ,0)=0 and NVL(y.ACTL_SLS_MPZ,0)=0 then 0 
	when NVL(x.ACTL_WAGE_MPZ,0)=0 then 0 when NVL(y.ACTL_SLS_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_WAGE_MPZ / y.ACTL_SLS_MPZ)*100,2) end as ACTL_WGE_PRCNT_MPZ from (select V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from
	(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as 
	ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as 
	ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month'))
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,
	b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by 
	C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.ar_no) V group by V.ar_no order by V.ar_no) x, (select J.ar_no,ROUND(sum
	(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from 
	ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN
	(select J.loc_nm,j.perd_desc,J.ACTL_SALES from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from (select a.loc_no,c.loc_nm,b.perd_desc, 
	b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') 
	and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id 
	order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
	group by J.ar_no order by J.ar_no) y where x.ar_no=y.ar_no order by x.ar_no]]>
	</WagePercentageHistory>
	<WagePercentageHistoryTotal>
	<![CDATA[select x.zone_no,
	case when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(y.ACTL_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(y.ACTL_SLS_TOT_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_WAGE_TOT_MPZ / y.ACTL_SLS_TOT_MPZ)*100,2) end as ACTL_WGE_PRCNT_TOT_MPZ from (select x.zone_no,ROUND(sum(x.ACTL_WAGE_MPZ),0) as 
	ACTL_WAGE_TOT_MPZ from (select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from (select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as 
	ACTL_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum
	(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) 
	as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' 
	and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.
	perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
	on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x group by x.zone_no order by x.zone_no) x,
	(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from (select T.zone_no,
	T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and 
	zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES from
	(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from 
	WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no
	and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,
	b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.zone_no,J.ar_no order by 
	J.zone_no,J.ar_no) K group by k.zone_no order by zone_no) y where x.zone_no=y.zone_no order by x.zone_no]]>
	</WagePercentageHistoryTotal>
</TCName>

<TCName name = "WagePercentageHistoryFourthMonth" >
	<WagePercentageHistory>
	<![CDATA[select x.ar_no,
	case when NVL(x.ACTL_WAGE_MPZ,0)=0 and NVL(y.ACTL_SLS_MPZ,0)=0 then 0 
	when NVL(x.ACTL_WAGE_MPZ,0)=0 then 0 when NVL(y.ACTL_SLS_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_WAGE_MPZ / y.ACTL_SLS_MPZ)*100,2) end as ACTL_WGE_PRCNT_MPZ from (select V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from
	(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as 
	ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as 
	ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month'))
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,
	b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by 
	C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.ar_no) V group by V.ar_no order by V.ar_no) x, (select J.ar_no,ROUND(sum
	(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from 
	ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN
	(select J.loc_nm,j.perd_desc,J.ACTL_SALES from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from (select a.loc_no,c.loc_nm,b.perd_desc, 
	b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') 
	and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id 
	order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J
	group by J.ar_no order by J.ar_no) y where x.ar_no=y.ar_no order by x.ar_no]]>
	</WagePercentageHistory>
	<WagePercentageHistoryTotal>
	<![CDATA[select x.zone_no,
	case when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(y.ACTL_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(y.ACTL_SLS_TOT_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_WAGE_TOT_MPZ / y.ACTL_SLS_TOT_MPZ)*100,2) end as ACTL_WGE_PRCNT_TOT_MPZ from (select x.zone_no,ROUND(sum(x.ACTL_WAGE_MPZ),0) as 
	ACTL_WAGE_TOT_MPZ from (select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from (select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as 
	ACTL_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum
	(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) 
	as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' 
	and b.rgn_no='Region' and b.zone_no='Zone' and b.WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.
	perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
	on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x group by x.zone_no order by x.zone_no) x,
	(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as ACTL_SLS_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from (select T.zone_no,
	T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and 
	zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES from
	(select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from 
	WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no
	and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,
	b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.zone_no,J.ar_no order by 
	J.zone_no,J.ar_no) K group by k.zone_no order by zone_no) y where x.zone_no=y.zone_no order by x.zone_no]]>
	</WagePercentageHistoryTotal>
</TCName>

<TCName name = "ItemPriceHistoryFirsthMonth" >
<ItemPriceHistory>
	<![CDATA[select x.ar_no,
	case when NVL(x.ACTL_SLS_MPZ,0)=0 and NVL(x.ACTL_ITM_MPZ,0)=0 then 0 
	when NVL(x.ACTL_SLS_MPZ,0)=0 then 0 when NVL(x.ACTL_ITM_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_SLS_MPZ / x.ACTL_ITM_MPZ),2) end as ACTL_ITM_PRZ_MPZ from (select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum
	(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from (select div_no,rgn_no,
	zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as 
	ACTL_ITEMS from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, 
	ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
	and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm 
	order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.ar_no order by J.ar_no) x order by x.ar_no]]>
	</ItemPriceHistory>
	<ItemPriceHistoryTotal>
	<![CDATA[select x.zone_no,
	case when NVL(x.ACTL_SLS_TOT_MPZ,0)=0 and NVL(x.ACTL_ITM_TOT_MPZ,0)=0 then 0 
	when NVL(x.ACTL_SLS_TOT_MPZ,0)=0 then 0 when NVL(x.ACTL_ITM_TOT_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_SLS_TOT_MPZ / x.ACTL_ITM_TOT_MPZ),2) end as ACTL_ITM_PRZ_TOT_MPZ from (select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as 
	ACTL_SLS_TOT_MPZ,ROUND(sum(K.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),
	0) as ACTL_ITM_MPZ from (select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from (select div_no,rgn_no,zone_no,
	ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as 
	ACTL_ITEMS from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, 
	ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
	and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm 
	order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
	group by k.zone_no order by zone_no) x]]>
	</ItemPriceHistoryTotal>
</TCName>

<TCName name = "ItemPriceHistorySecondMonth" >
	<ItemPriceHistory>
	<![CDATA[select x.ar_no,
	case when NVL(x.ACTL_SLS_MPZ,0)=0 and NVL(x.ACTL_ITM_MPZ,0)=0 then 0 
	when NVL(x.ACTL_SLS_MPZ,0)=0 then 0 when NVL(x.ACTL_ITM_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_SLS_MPZ / x.ACTL_ITM_MPZ),2) end as ACTL_ITM_PRZ_MPZ from (select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum
	(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from (select div_no,rgn_no,
	zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as 
	ACTL_ITEMS from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, 
	ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
	and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm 
	order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.ar_no order by J.ar_no) x order by x.ar_no]]>
	</ItemPriceHistory>
	<ItemPriceHistoryTotal>
	<![CDATA[select x.zone_no,
	case when NVL(x.ACTL_SLS_TOT_MPZ,0)=0 and NVL(x.ACTL_ITM_TOT_MPZ,0)=0 then 0 
	when NVL(x.ACTL_SLS_TOT_MPZ,0)=0 then 0 when NVL(x.ACTL_ITM_TOT_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_SLS_TOT_MPZ / x.ACTL_ITM_TOT_MPZ),2) end as ACTL_ITM_PRZ_TOT_MPZ from (select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as 
	ACTL_SLS_TOT_MPZ,ROUND(sum(K.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),
	0) as ACTL_ITM_MPZ from (select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from (select div_no,rgn_no,zone_no,
	ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as 
	ACTL_ITEMS from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, 
	ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
	and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm 
	order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
	group by k.zone_no order by zone_no) x]]>
	</ItemPriceHistoryTotal>
</TCName>

<TCName name = "ItemPriceHistoryThirdMonth" >
	<ItemPriceHistory>
	<![CDATA[select x.ar_no,
	case when NVL(x.ACTL_SLS_MPZ,0)=0 and NVL(x.ACTL_ITM_MPZ,0)=0 then 0 
	when NVL(x.ACTL_SLS_MPZ,0)=0 then 0 when NVL(x.ACTL_ITM_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_SLS_MPZ / x.ACTL_ITM_MPZ),2) end as ACTL_ITM_PRZ_MPZ from (select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum
	(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from (select div_no,rgn_no,
	zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as 
	ACTL_ITEMS from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, 
	ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
	and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm 
	order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.ar_no order by J.ar_no) x order by x.ar_no]]>
	</ItemPriceHistory>
	<ItemPriceHistoryTotal>
	<![CDATA[select x.zone_no,
	case when NVL(x.ACTL_SLS_TOT_MPZ,0)=0 and NVL(x.ACTL_ITM_TOT_MPZ,0)=0 then 0 
	when NVL(x.ACTL_SLS_TOT_MPZ,0)=0 then 0 when NVL(x.ACTL_ITM_TOT_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_SLS_TOT_MPZ / x.ACTL_ITM_TOT_MPZ),2) end as ACTL_ITM_PRZ_TOT_MPZ from (select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as 
	ACTL_SLS_TOT_MPZ,ROUND(sum(K.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),
	0) as ACTL_ITM_MPZ from (select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from (select div_no,rgn_no,zone_no,
	ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as 
	ACTL_ITEMS from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, 
	ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
	and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm 
	order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
	group by k.zone_no order by zone_no) x]]>
	</ItemPriceHistoryTotal>
</TCName>

<TCName name = "ItemPriceHistoryFourthMonth" >
	<ItemPriceHistory>
	<![CDATA[select x.ar_no,
	case when NVL(x.ACTL_SLS_MPZ,0)=0 and NVL(x.ACTL_ITM_MPZ,0)=0 then 0 
	when NVL(x.ACTL_SLS_MPZ,0)=0 then 0 when NVL(x.ACTL_ITM_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_SLS_MPZ / x.ACTL_ITM_MPZ),2) end as ACTL_ITM_PRZ_MPZ from (select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum
	(J.ACTL_ITM_MPG),0) as ACTL_ITM_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from (select div_no,rgn_no,
	zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as 
	ACTL_ITEMS from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, 
	ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
	and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm 
	order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.ar_no order by J.ar_no) x order by x.ar_no]]>
	</ItemPriceHistory>
	<ItemPriceHistoryTotal>
	<![CDATA[select x.zone_no,
	case when NVL(x.ACTL_SLS_TOT_MPZ,0)=0 and NVL(x.ACTL_ITM_TOT_MPZ,0)=0 then 0 
	when NVL(x.ACTL_SLS_TOT_MPZ,0)=0 then 0 when NVL(x.ACTL_ITM_TOT_MPZ,0)=0 then 0 
	else ROUND((x.ACTL_SLS_TOT_MPZ / x.ACTL_ITM_TOT_MPZ),2) end as ACTL_ITM_PRZ_TOT_MPZ from (select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as 
	ACTL_SLS_TOT_MPZ,ROUND(sum(K.ACTL_ITM_MPZ),0) as ACTL_ITM_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as ACTL_SLS_MPZ,ROUND(sum(J.ACTL_ITM_MPG),
	0) as ACTL_ITM_MPZ from (select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG,NVL(U.ACTL_ITEMS,0) as ACTL_ITM_MPG from (select div_no,rgn_no,zone_no,
	ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
	LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES,J.ACTL_ITEMS from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES,sum(S.ACTL_ITEMS) as 
	ACTL_ITEMS from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES,sum(a.actl_itm_cnt) as ACTL_ITEMS from WW_WLP.DLY_SLS a,WW_WLP.WK b, 
	ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
	and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm 
	order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
	group by k.zone_no order by zone_no) x]]>
	</ItemPriceHistoryTotal>
</TCName>

<TCName name = "BudgetSales_CurrentMonth">
	<BudgetSales>
	<![CDATA[select x.ar_no,NVL(ROUND(sum(x.BDGT_SLS_MPG),0),0) as BDGT_SLS_MPZ from (select f.ar_no,f.loc_nm,NVL(g.BDGT_SALES_MPG,0) as BDGT_SLS_MPG from (select div_no,rgn_no,
	zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
	LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_SALES) as BDGT_SALES_MPG from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,
	a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc 
	in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
	group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id)  
	C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g on f.loc_nm=g.loc_nm) x group by x.ar_no order by x.ar_no]]>
	</BudgetSales>
	<BudgetSalesTotal>
	<![CDATA[select y.zone_no,NVL(ROUND(sum(y.BDGT_SLS_MPZ),0),0) as BDGT_SLS_TOT_MPZ from (select x.zone_no,x.ar_no,ROUND(sum(x.BDGT_SLS_MPG),0) as BDGT_SLS_MPZ from 
	(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.BDGT_SALES_MPG,0) as BDGT_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_SALES) as 
	BDGT_SALES_MPG from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
	from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' 
	and b.zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,
	a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
	on f.loc_nm=g.loc_nm order by f.zone_no,f.ar_no) x group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no ) y group by y.zone_no order by y.zone_no]]>
	</BudgetSalesTotal>
	<ForecastSales>
	<![CDATA[select x.ar_no,NVL(ROUND(sum(x.FCST_SLS_MPG),0),0) as FCST_SLS_MPZ from (select f.ar_no,f.loc_nm,NVL(g.FCST_SALES_MPG,0) as FCST_SLS_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,
	rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(FCST_SALES) as FCST_SALES_MPG from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(frcst_sls) as FCST_SALES, sum(frcst_wage_amt) as FCST_WAGE from WW_WLP.mnth_fcst a,loc b, wk d 
	where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in 
	('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
	on f.loc_nm=g.loc_nm) x group by x.ar_no order by x.ar_no]]>
	</ForecastSales>
	<ForecastSalesTotal>
	<![CDATA[select y.zone_no,NVL(ROUND(sum(y.FCST_SLS_MPZ),0),0) as FCST_SLS_TOT_MPZ from (select x.zone_no,x.ar_no,ROUND(sum(x.FCST_SLS_MPG),0) as FCST_SLS_MPZ from 
	(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.FCST_SALES_MPG,0) as FCST_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' 
	and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,
	sum(FCST_SALES) as FCST_SALES_MPG from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(frcst_sls) as FCST_SALES, sum
	(frcst_wage_amt) as FCST_WAGE from WW_WLP.mnth_fcst a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) 
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
	group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) 
	C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g on f.loc_nm=g.loc_nm order by f.zone_no,f.ar_no) x group by x.zone_no,x.ar_no order by x.zone_no,
	x.ar_no ) y group by y.zone_no order by y.zone_no]]>
	</ForecastSalesTotal>
</TCName>

<TCName name = "PlannedSales_CurrentMonth">
	<PlannedSales>
	<![CDATA[select g.ar_no,NVL(ROUND(sum(g.PLN_SLS_MPG),0),0) as PLN_SLS_MPZ from (select f.ar_no,f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES),0),0) as PLN_SLS_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,
	rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) 
	as PLAN_SALES from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and 
	c.rgn_no='Region' and c.zone_no='Zone' group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.
	loc_no,c.loc_nm,b.perd_desc,a.wk_id) c UNION select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(gnrt_sls) as 
	GEN_SALES from ww_wlp.fcst a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and c.div_no='Division' 
	and c.rgn_no='Region' and c.zone_no='Zone' and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, 
	ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') group by c.div_no,c.rgn_no,
	c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e
	on f.loc_nm=e.loc_nm group by f.ar_no,f.loc_nm order by f.ar_no) g group by g.ar_no order by g.ar_no]]>
	</PlannedSales>
	<PlannedSalesTotal>
	<![CDATA[select y.zone_no,NVL(ROUND(sum(y.PLN_SLS_MPZ),0),0) as PLN_SLS_TOT_MPZ from (select g.zone_no,g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from (select f.
	zone_no,f.ar_no,f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES),0),0) as PLN_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as PLAN_SALES from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc 
	c where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,
	a.loc_no,c.loc_nm,b.perd_desc,a.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id) c UNION select * from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(gnrt_sls) as GEN_SALES from ww_wlp.fcst a,ww_wlp.wk b, ww_wlp.loc c where 
	a.loc_no=c.loc_no and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
	and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
	and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	b.perd_desc,b.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e on f.loc_nm=e.loc_nm group by f.zone_no,f.ar_no,f.loc_nm 
	order by f.zone_no,f.ar_no) g group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y group by y.zone_no order by y.zone_no]]>
	</PlannedSalesTotal>
</TCName>

<TCName name = "GeneratedSales_CurrentMonth">
	<GeneratedSales>
	<![CDATA[select f.ar_no,NVL(ROUND(sum(GEN_SLS_MPG),0),0) as GEN_SLS_MPZ from (select e.ar_no,e.loc_nm,NVL(d.GEN_SALES_MPG,0) as GEN_SLS_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,
	zone_no,ar_no,loc_no) e LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,a.loc_no,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_MPG from WW_WLP.fcst a,
	WW_WLP.WK b, ww_wlp.loc c where a.fcst_dte between b.WK_STRT and b.WK_END and b.PERD_DESC in ('Month') and a.loc_no=c.loc_no and c.div_no='Division' and rgn_no='Region' and 
	zone_no='Zone' and c.WLP_LIVE_IND IN ('Y','N') and a.Dept_no NOT IN (0,20,90) group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm order by c.div_no,c.rgn_no,c.zone_no,
	c.ar_no,a.loc_no,c.loc_nm) d on d.loc_nm=e.loc_nm) f group by f.ar_no order by f.ar_no]]>
	</GeneratedSales>
	<GeneratedSalesTotal>
	<![CDATA[select y.zone_no,NVL(ROUND(sum(y.GEN_SLS_MPZ),0),0) as GEN_SLS_TOT_MPZ from (select f.zone_no,f.ar_no,ROUND(sum(GEN_SLS_MPG),0) as GEN_SLS_MPZ from 
	(select e.zone_no,e.ar_no,e.loc_nm,NVL(d.GEN_SALES_MPG,0) as GEN_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) e LEFT OUTER JOIN (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,
	a.loc_no,ROUND(sum(a.gnrt_sls),0) as GEN_SALES_MPG from WW_WLP.fcst a,WW_WLP.WK b, ww_wlp.loc c where a.fcst_dte between b.WK_STRT and b.WK_END and b.PERD_DESC in 
	('Month') and a.loc_no=c.loc_no and c.div_no='Division' and rgn_no='Region' and zone_no='Zone' and c.WLP_LIVE_IND IN ('Y','N') and a.Dept_no NOT IN (0,20,90) group by c.div_no,c.rgn_no,
	c.zone_no,c.ar_no,a.loc_no,c.loc_nm order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm) d on d.loc_nm=e.loc_nm) f group by f.zone_no,f.ar_no order by 
	f.zone_no,f.ar_no) y group by y.zone_no order by y.zone_no]]>
	</GeneratedSalesTotal>
</TCName>

<TCName name = "BudgetWages_CurrentMonth">
	<BudgetWages>
	<![CDATA[select x.ar_no,NVL(ROUND(sum(x.BDGT_WGE_MPG),0),0) as BDGT_WGE_MPZ from (select f.ar_no,f.loc_nm,NVL(g.BDGT_WAGE_MPG,0) as BDGT_WGE_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,
	ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_WAGE) as BDGT_WAGE_MPG from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,
	d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where 
	perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (20)
	group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) 
	C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g on f.loc_nm=g.loc_nm ) x group by x.ar_no order by x.ar_no]]>
	</BudgetWages>
	<BudgetWagesTotal>
	<![CDATA[select y.zone_no,NVL(ROUND(sum(y.BDGT_WGE_MPZ),0),0) as BDGT_WGE_TOT_MPZ from (select x.zone_no,x.ar_no,ROUND(sum(x.BDGT_WGE_MPG),0) as BDGT_WGE_MPZ from 
	(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.BDGT_WAGE_MPG,0) as BDGT_WGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_WAGE) as 
	BDGT_WAGE_MPG from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
	from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.
	rgn_no='Region' and b.zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (20) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.
	perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) 
	g on f.loc_nm=g.loc_nm ) x group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no) y group by y.zone_no order by y.zone_no]]>
	</BudgetWagesTotal>
	<ForecastWages>
	<![CDATA[select x.ar_no,NVL(ROUND(sum(x.FCST_WGE_MPG),0),0) as FCST_WGE_MPZ from (select f.ar_no,f.loc_nm,NVL(g.FCST_WAGE_MPG,0) as FCST_WGE_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,
	zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(FCST_WAGE) as FCST_WAGE_MPG from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
	b.loc_nm,d.perd_desc,a.wk_id,sum(frcst_sls) as FCST_SALES, sum(frcst_wage_amt) as FCST_WAGE from WW_WLP.mnth_fcst a,loc b, wk d 
	where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind 
	in ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (20) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
	on f.loc_nm=g.loc_nm ) x group by x.ar_no order by x.ar_no]]>
	</ForecastWages>
	<ForecastWagesTotal>
	<![CDATA[select y.zone_no,NVL(ROUND(sum(y.FCST_WGE_MPZ),0),0) as FCST_WGE_TOT_MPZ from (select x.zone_no,x.ar_no,ROUND(sum(x.FCST_WGE_MPG),0) as FCST_WGE_MPZ from 
	(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.FCST_WAGE_MPG,0) as FCST_WGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(FCST_WAGE) 
	as FCST_WAGE_MPG from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(frcst_sls) as FCST_SALES, sum(frcst_wage_amt) as FCST_WAGE 
	from WW_WLP.mnth_FCST a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.
	rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (20) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,
	d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) 
	g on f.loc_nm=g.loc_nm ) x group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no) y group by y.zone_no order by y.zone_no]]>
	</ForecastWagesTotal>
</TCName>

<TCName name = "BaseCostWages_CurrentMonth">
	<BaseCost>
	<![CDATA[select g.ar_no,NVL(ROUND(sum(g.BASE_COST_MPG),0),0) as BASE_COST_MPZ from (select f.ar_no,f.loc_nm,NVL(e.BASE_COST_MNTH_PLN_STR,0) as BASE_COST_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,
	zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as BASE_COST_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, ww_wlp.wk b, 
	ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')
	and DEPT_NO NOT IN (20)) d group by d.loc_no,d.loc_nm order by d.loc_no) e on e.loc_nm=f.loc_nm) g group by g.ar_no order by g.ar_no]]>
	</BaseCost>
	<BaseCostTotal>
	<![CDATA[select y.zone_no,NVL(ROUND(sum(y.BASE_COST_MPZ),0),0) as BASE_COST_TOT_MPZ from (select g.zone_no,g.ar_no,ROUND(sum(g.BASE_COST_MPG),0) as BASE_COST_MPZ from 
	(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.BASE_COST_MNTH_PLN_STR,0) as BASE_COST_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where 
	div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN
	(select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as BASE_COST_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and 
	c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d group by d.loc_no,d.loc_nm order by d.loc_no) e on e.loc_nm=
	f.loc_nm) g group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y group by y.zone_no order by y.zone_no]]>
	</BaseCostTotal>
</TCName>

<TCName name = "PlannedWages_CurrentMonth">
	<PlannedWages>
	<![CDATA[select g.ar_no,NVL(ROUND(sum(g.PLN_WAGE_MPG),0),0) as PLN_WAGE_MPZ from (select f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,
	rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select d.loc_no,d.loc_nm,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.loc_no,d.loc_nm order 
	by d.loc_no) UNION select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as BASE_COST_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, ww_wlp.wk b, 
	ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d 
	where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and 
	c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g
	group by g.ar_no order by g.ar_no]]>
	</PlannedWages>
	<PlannedWagesTotal>
	<![CDATA[select y.zone_no,NVL(ROUND(sum(y.PLN_WAGE_MPZ),0),0) as PLN_WAGE_TOT_MPZ from (select g.zone_no,g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_MPZ from (select 
	f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select d.loc_no,d.loc_nm,
	ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE
	from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in 
	('Month')) d group by d.loc_no,d.loc_nm order by d.loc_no) UNION select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as 
	BASE_COST_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in 
	('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.
	div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm 
	order by f.zone_no,f.ar_no,f.loc_no) g group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y group by y.zone_no order by y.zone_no]]>
	</PlannedWagesTotal>
</TCName>

<TCName name = "BudgetWagesPercentage_CurrentMonth">
	<BudgetWagesPercentage>
	<![CDATA[select bdgt_wge.ar_no,
	case when NVL(bdgt_wge.BDGT_WGE_MPZ,0)=0 and NVL(bdgt_sls.BDGT_SLS_MPZ,0)=0 then 0 
	when NVL(bdgt_wge.BDGT_WGE_MPZ,0)=0 then 0 when NVL(bdgt_sls.BDGT_SLS_MPZ,0)=0 then 0 
	else ROUND((bdgt_wge.BDGT_WGE_MPZ / bdgt_sls.BDGT_SLS_MPZ)*100,2) end as BDGT_WGE_PRCNT_MPZ from (select x.ar_no,ROUND(sum(x.BDGT_WGE_MPG),0) as 
	BDGT_WGE_MPZ from (select f.ar_no,f.loc_nm,NVL(g.BDGT_WAGE_MPG,0) as BDGT_WGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' 
	and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,
	sum(BDGT_WAGE) as BDGT_WAGE_MPG from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) 
	as BDGT_WAGE from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and 
	b.rgn_no='Region' and b.zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (20) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,
	d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) 
	g on f.loc_nm=g.loc_nm ) x group by x.ar_no order by x.ar_no) bdgt_wge,(select x.ar_no,ROUND(sum(x.BDGT_SLS_MPG),0) as BDGT_SLS_MPZ from 
	(select f.ar_no,f.loc_nm,NVL(g.BDGT_SALES_MPG,0) as BDGT_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_SALES) as 
	BDGT_SALES_MPG from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
	from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.
	rgn_no='Region' and b.zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,
	d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) 
	g on f.loc_nm=g.loc_nm ) x group by x.ar_no order by x.ar_no) bdgt_sls where bdgt_wge.ar_no=bdgt_sls.ar_no order by bdgt_wge.ar_no]]>
	</BudgetWagesPercentage>
	<BudgetWagesPercentageTotal>
	<![CDATA[select bdgt_wge.zone_no,
	case when NVL(bdgt_wge.BDGT_WGE_TOT_MPZ,0)=0 and NVL(bdgt_sls.BDGT_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(bdgt_wge.BDGT_WGE_TOT_MPZ,0)=0 then 0 when NVL(bdgt_sls.BDGT_SLS_TOT_MPZ,0)=0 then 0 
	else ROUND((bdgt_wge.BDGT_WGE_TOT_MPZ / bdgt_sls.BDGT_SLS_TOT_MPZ)*100,2) end as BDGT_WGE_PRCNT_TOT_MPZ from (select y.zone_no,ROUND(sum
	(y.BDGT_WGE_MPZ),0) as BDGT_WGE_TOT_MPZ from (select x.zone_no,x.ar_no,ROUND(sum(x.BDGT_WGE_MPG),0) as BDGT_WGE_MPZ from (select f.zone_no,f.ar_no,f.loc_nm,NVL
	(g.BDGT_WAGE_MPG,0) as BDGT_WGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_WAGE) as BDGT_WAGE_MPG from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
	from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.
	rgn_no='Region' and b.zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (20) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,
	d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) 
	g on f.loc_nm=g.loc_nm ) x group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no) y group by y.zone_no order by y.zone_no) bdgt_wge,(select y.zone_no,ROUND(sum
	(y.BDGT_SLS_MPZ),0) as BDGT_SLS_TOT_MPZ from (select x.zone_no,x.ar_no,ROUND(sum(x.BDGT_SLS_MPG),0) as BDGT_SLS_MPZ from (select f.zone_no,f.ar_no,f.loc_nm,NVL
	(g.BDGT_SALES_MPG,0) as BDGT_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_SALES) as BDGT_SALES_MPG from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
	from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and 
	b.rgn_no='Region' and b.zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,
	d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) 
	g on f.loc_nm=g.loc_nm ) x group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no) y
	group by y.zone_no order by y.zone_no) bdgt_sls where bdgt_wge.zone_no=bdgt_sls.zone_no order by bdgt_wge.zone_no]]>
	</BudgetWagesPercentageTotal>
	<ForecastWagesPercentage>
	<![CDATA[select bdgt_wge.ar_no,
	case when NVL(bdgt_wge.FCST_WGE_MPZ,0)=0 and NVL(bdgt_sls.FCST_SLS_MPZ,0)=0 then 0 
	when NVL(bdgt_wge.FCST_WGE_MPZ,0)=0 then 0 when NVL(bdgt_sls.FCST_SLS_MPZ,0)=0 then 0 
	else ROUND((bdgt_wge.FCST_WGE_MPZ / bdgt_sls.FCST_SLS_MPZ)*100,2) end as FCST_WGE_PRCNT_MPZ from (select x.ar_no,ROUND(sum(x.FCST_WGE_MPG),0) 
	as FCST_WGE_MPZ from (select f.ar_no,f.loc_nm,NVL(g.FCST_WAGE_MPG,0) as FCST_WGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where 
	div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN
	(select C.ar_no,C.loc_no,C.loc_nm,sum(FCST_WAGE) as FCST_WAGE_MPG from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(frcst_sls) 
	as FCST_SALES, sum(frcst_wage_amt) as FCST_WAGE from WW_WLP.mnth_fcst a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) 
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (20)
	group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) 
	C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g on f.loc_nm=g.loc_nm ) x group by x.ar_no order by x.ar_no) bdgt_wge,
	(select x.ar_no,ROUND(sum(x.FCST_SLS_MPG),0) as FCST_SLS_MPZ from (select f.ar_no,f.loc_nm,NVL(g.FCST_SALES_MPG,0) as FCST_SLS_MPG from (select div_no,rgn_no,zone_no,
	ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
	LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(FCST_SALES) as FCST_SALES_MPG from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,
	a.wk_id,sum(frcst_sls) as FCST_SALES, sum(frcst_wage_amt) as FCST_WAGE from WW_WLP.mnth_fcst a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where 
	perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT 
	IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.
	perd_desc,a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g on f.loc_nm=g.loc_nm ) x
	group by x.ar_no order by x.ar_no) bdgt_sls where bdgt_wge.ar_no=bdgt_sls.ar_no order by bdgt_wge.ar_no]]>
	</ForecastWagesPercentage>
	<ForecastWagesPercentageTotal>
	<![CDATA[select bdgt_wge.zone_no,
	case when NVL(bdgt_wge.FCST_WGE_TOT_MPZ,0)=0 and NVL(bdgt_sls.FCST_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(bdgt_wge.FCST_WGE_TOT_MPZ,0)=0 then 0 when NVL(bdgt_sls.FCST_SLS_TOT_MPZ,0)=0 then 0 
	else ROUND((bdgt_wge.FCST_WGE_TOT_MPZ / bdgt_sls.FCST_SLS_TOT_MPZ)*100,2) end as FCST_WGE_PRCNT_TOT_MPZ from (select y.zone_no,ROUND(sum
	(y.FCST_WGE_MPZ),0) as FCST_WGE_TOT_MPZ from (select x.zone_no,x.ar_no,ROUND(sum(x.FCST_WGE_MPG),0) as FCST_WGE_MPZ from (select f.zone_no,f.ar_no,f.loc_nm,NVL
	(g.FCST_WAGE_MPG,0) as FCST_WGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(FCST_WAGE) as FCST_WAGE_MPG from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(frcst_sls) as FCST_SALES, sum(frcst_wage_amt) as FCST_WAGE 
	from WW_WLP.mnth_fcst a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.
	rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (20) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.
	loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,
	C.loc_no) g on f.loc_nm=g.loc_nm ) x group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no) y group by y.zone_no order by y.zone_no) bdgt_wge,
	(select y.zone_no,ROUND(sum(y.FCST_SLS_MPZ),0) as FCST_SLS_TOT_MPZ from (select x.zone_no,x.ar_no,ROUND(sum(x.FCST_SLS_MPG),0) as FCST_SLS_MPZ from 
	(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.FCST_SALES_MPG,0) as FCST_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(FCST_SALES) 
	as FCST_SALES_MPG from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(frcst_sls) as FCST_SALES, sum(frcst_wage_amt) as 
	FCST_WAGE from WW_WLP.mnth_fcst a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and 
	b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
	b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,
	C.loc_no) g on f.loc_nm=g.loc_nm ) x group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no) y group by y.zone_no order by y.zone_no) bdgt_sls where bdgt_wge.zone_no=
	bdgt_sls.zone_no order by bdgt_wge.zone_no]]>
	</ForecastWagesPercentageTotal>
</TCName>

<TCName name = "PlannedWagesPercentage_CurrentMonth">
	<PlannedWagesPercentage>
	<![CDATA[select x.ar_no, 
	case when NVL(x.PLN_WAGE_MPZ,0)=0 and NVL(y.PLN_SLS_MPZ,0)=0 then 0 
	when NVL(x.PLN_WAGE_MPZ,0)=0 then 0 when NVL(y.PLN_SLS_MPZ,0)=0 then 0 
	else ROUND((x.PLN_WAGE_MPZ / y.PLN_SLS_MPZ)*100,2) end as PLN_WGE_PRCNT_MPZ from (select g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_MPZ from 
	(select f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select d.loc_no,d.loc_nm,
	ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE
	from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in 
	('Month')) d group by d.loc_no,d.loc_nm order by d.loc_no) UNION select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as 
	BASE_COST_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in 
	('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.
	div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.
	loc_nm order by f.loc_no) g group by g.ar_no order by g.ar_no) x,(select g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from (select f.ar_no,f.loc_nm,
	NVL(ROUND(sum(e.PLAN_SALES),0),0) as PLN_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as PLAN_SALES from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id 
	and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
	order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id) c UNION select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	b.perd_desc,b.wk_id,sum(gnrt_sls) as GEN_SALES from ww_wlp.fcst a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.fcst_dte between b.wk_strt and b.wk_end and 
	b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id from 
	ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' )
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) 
	d) e on f.loc_nm=e.loc_nm group by f.ar_no,f.loc_nm order by f.ar_no) g group by g.ar_no order by g.ar_no) y where x.ar_no=y.ar_no]]>
	</PlannedWagesPercentage>
	<PlannedWagesPercentageTotal>
	<![CDATA[select x.zone_no, 
	case when NVL(x.PLN_WAGE_TOT_MPZ,0)=0 and NVL(y.PLN_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(x.PLN_WAGE_TOT_MPZ,0)=0 then 0 when NVL(y.PLN_SLS_TOT_MPZ,0)=0 then 0 
	else ROUND((x.PLN_WAGE_TOT_MPZ / y.PLN_SLS_TOT_MPZ)*100,2) end as PLN_TOT_WGE_PRCNT_MPZ from (select y.zone_no,ROUND(sum(y.PLN_WAGE_MPZ),0) as 
	PLN_WAGE_TOT_MPZ from (select g.zone_no,g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_MPZ from (select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as 
	PLN_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') 
	order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select d.loc_no,d.loc_nm,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.loc_no,d.loc_nm order by 
	d.loc_no) UNION select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as BASE_COST_MNTH_PLN_STR from (select c.div_no,c.rgn_no,
	c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) 
	NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=
	b.wk_id and b.perd_desc in ('Month')) group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
	group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y group by y.zone_no order by y.zone_no) x,(select y.zone_no,ROUND(sum(y.PLN_SLS_MPZ),0) as PLN_SLS_TOT_MPZ 
	from (select g.zone_no,g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from (select f.zone_no,f.ar_no,f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES),0),0) as PLN_SLS_MPG 
	from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,
	rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as 
	PLAN_SALES from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' 
	and c.zone_no='Zone' group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	b.perd_desc,a.wk_id) c UNION select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(gnrt_sls) as GEN_SALES 
	from ww_wlp.fcst a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and c.div_no='Division' and 
	c.rgn_no='Region' and c.zone_no='Zone' and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') group by c.div_no,c.rgn_no,c.zone_no,c.
	ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e on f.loc_nm=e.loc_nm group by 
	f.zone_no,f.ar_no,f.loc_nm order by f.zone_no,f.ar_no) g group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
	group by y.zone_no order by y.zone_no) y where x.zone_no=y.zone_no ]]>
	</PlannedWagesPercentageTotal>
</TCName>

<TCName name = "LYWagesPercentage_CurrentMonth">
	<LYWagesPercentage>
	<![CDATA[select actl_wge_ly.ar_no,
	case when NVL(actl_wge_ly.ACTL_WAGE_LY_MPZ,0)=0 and NVL(actl_sls_ly.ACTL_SLS_LY_MPZ,0)=0 then 0 
	when NVL(actl_wge_ly.ACTL_WAGE_LY_MPZ,0)=0 then 0 when NVL(actl_sls_ly.ACTL_SLS_LY_MPZ,0)=0 then 0 
	else ROUND((actl_wge_ly.ACTL_WAGE_LY_MPZ / actl_sls_ly.ACTL_SLS_LY_MPZ)*100,2) end as LY_WAGE_PRCNT_MPZ from 
	(select T.ar_no,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_LY_MPZ from 
	(select distinct ar_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	and wlp_live_ind in ('Y','N') order by ar_no) T 
	LEFT OUTER JOIN 
	(select c.zone_no,c.ar_no,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from 
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) 
	as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('LYMnth')) 
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20
	group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.wk_id) C
	group by c.zone_no,c.ar_no order by c.zone_no,c.ar_no) U on T.ar_no=U.ar_no) actl_wge_ly,
	(select T.ar_no,NVL(U.ACTL_SALES,0) as ACTL_SLS_LY_MPZ from 
	(select distinct ar_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	and wlp_live_ind in ('Y','N') order by ar_no) T 
	LEFT OUTER JOIN 
	(select J.ar_no,j.perd_desc,J.ACTL_SALES from 
	(select S.perd_desc,s.ar_no,ROUND(sum(S.ACTL_SALES),0) as ACTL_SALES from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('LYMnth') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
	and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) 
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc, b.wk_id 
	order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,b.wk_id) S 
	group by S.perd_desc,s.ar_no order by s.ar_no) J) U 
	on T.ar_no=U.ar_no order by T.ar_no) actl_sls_ly where actl_wge_ly.ar_no=actl_sls_ly.ar_no]]>
	</LYWagesPercentage>
	<LYWagesPercentageTotal>
	<![CDATA[select actl_wge_ly.zone_no,
	case when NVL(actl_wge_ly.ACTL_WAGE_LY_TOT_MPZ,0)=0 and NVL(actl_sls_ly.ACTL_SLS_LY_TOT_MPZ,0)=0 then 0 
	when NVL(actl_wge_ly.ACTL_WAGE_LY_TOT_MPZ,0)=0 then 0 when NVL(actl_sls_ly.ACTL_SLS_LY_TOT_MPZ,0)=0 then 0 
	else ROUND((actl_wge_ly.ACTL_WAGE_LY_TOT_MPZ / actl_sls_ly.ACTL_SLS_LY_TOT_MPZ)*100,2) end as LY_WAGE_PRCNT_TOT_MPZ from 
	(select V.zone_no,sum(V.ACTL_WAGE_MPZ) as ACTL_WAGE_LY_TOT_MPZ from 
	(select T.zone_no,T.ar_no,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPZ from 
	(select distinct zone_no,ar_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' 
	and wlp_live_ind in ('Y','N') order by zone_no,ar_no) T 
	LEFT OUTER JOIN 
	(select c.zone_no,c.ar_no,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
	from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
	where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('LYMnth')) 
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' 
	and b.wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,
	a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.wk_id) C 
	group by c.zone_no,c.ar_no order by c.zone_no,c.ar_no) U
	on T.ar_no=U.ar_no order by T.ar_no) V 
	group by V.zone_no order by V.zone_no) actl_wge_ly,
	(select J.zone_no,SUM(J.ACTL_SLS_MPZ) as ACTL_SLS_LY_TOT_MPZ from 
	(select T.zone_no,T.ar_no,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPZ from 
	(select distinct zone_no,ar_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' 
	and wlp_live_ind in ('Y','N') order by zone_no,ar_no) T 
	LEFT OUTER JOIN 
	(select J.ar_no,j.perd_desc,J.ACTL_SALES from 
	(select S.perd_desc,s.ar_no,ROUND(sum(S.ACTL_SALES),0) as ACTL_SALES from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,
	sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c 
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('LYMnth') and a.loc_no=c.loc_no
	and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) 
	group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id
	order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,b.wk_id) S 
	group by S.perd_desc,s.ar_no order by s.ar_no) J) U 
	on T.ar_no=U.ar_no order by T.ar_no) J
	group by J.zone_no order by zone_no) actl_sls_ly 
	where actl_wge_ly.zone_no=actl_sls_ly.zone_no order by actl_wge_ly.zone_no]]>
	</LYWagesPercentageTotal>
</TCName>

<TCName name = "SMSHours_CurrentMonth">
	<SMSHours>
	<![CDATA[select g.ar_no,NVL(ROUND(((ROUND(((sum(g.SMS_HRS_MPG)*100)/25),0)*25)/100),2),0) as SMS_HRS_MPZ from (select x.ar_no,x.loc_nm,NVL(y.SMS_HOURS_MPS,0) as SMS_HRS_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order 
	by div_no,rgn_no,zone_no,ar_no,loc_no) x LEFT OUTER JOIN (select C.loc_no,C.loc_nm,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPS 
	from (select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from (select c.div_no,c.rgn_no,
	c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
	from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
	and d.dept_no!=20 and b.perd_desc in ('Month') and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') A group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order 
	by A.loc_no,A.wk_id,A.dept_no) C group by C.loc_no,C.loc_nm order by c.loc_no) y on x.loc_nm=y.loc_nm order by x.loc_no) g
	group by g.ar_no order by g.ar_no]]>
	</SMSHours>
	<SMSHoursTotal>
	<![CDATA[select y.zone_no,NVL(SUM(ROUND(((ROUND(((y.SMS_HRS_MPZ*100)/25),0)*25)/100),2)),0) as SMS_HRS_TOT_MPZ from (select g.zone_no,g.ar_no,sum(g.SMS_HRS_MPG) as SMS_HRS_MPZ from
	(select x.zone_no,x.ar_no,x.loc_nm,NVL(y.SMS_HOURS_MPS,0) as SMS_HRS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc 
	where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) x LEFT OUTER JOIN
	(select C.loc_no,C.loc_nm,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPS from (select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,
	sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,
	a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d 
	where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no and d.dept_no!=20 and b.perd_desc in ('Month') and c.div_no='Division' and c.rgn_no='Region'
	and c.zone_no='Zone') A group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C group by C.loc_no,C.loc_nm order by c.loc_no) y
	on x.loc_nm=y.loc_nm order by x.zone_no,x.ar_no,x.loc_no) g group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
	group by y.zone_no order by y.zone_no]]>
	</SMSHoursTotal>
</TCName>

<TCName name = "BaseHours_CurrentMonth">
	<Basehours>
	<![CDATA[select g.ar_no,NVL(ROUND(sum(g.BASE_HRS_MPG),0),0) as BASE_HRS_MPZ from (select f.ar_no,f.loc_nm,NVL(e.BASE_HOURS_MNTH_PLN_STR,0) as BASE_HRS_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,
	zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as BASE_HOURS_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, 
	ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')
	and DEPT_NO NOT IN (20)) d group by d.loc_no,d.loc_nm order by d.loc_no) e on e.loc_nm=f.loc_nm) g group by g.ar_no order by g.ar_no]]>
	</Basehours>
	<BasehoursTotal>
	<![CDATA[select y.zone_no,NVL(ROUND(sum(y.BASE_HRS_MPZ),0),0) as BASE_HRS_TOT_MPZ from (select g.zone_no,g.ar_no,ROUND(sum(g.BASE_HRS_MPG),0) as BASE_HRS_MPZ from 
	(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.BASE_HOURS_MNTH_PLN_STR,0) as BASE_HRS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where 
	div_no='Division' and rgn_no='Region' and zone_no='Zone' and WLP_LIVE_IND IN ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN
	(select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and 
	c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d group by d.loc_no,d.loc_nm order by d.loc_no) e on 
	e.loc_nm=f.loc_nm) g group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y group by y.zone_no order by y.zone_no]]>
	</BasehoursTotal>
</TCName>

<TCName name = "PlannedHours_CurrentMonth">
	<PlannedHours>
	<![CDATA[select g.ar_no,NVL(ROUND(sum(g.PLN_HRS_MPG),0),0) as PLN_HRS_MPZ from (select f.ar_no,f.loc_nm,NVL(e.PLN_HRS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,
	rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.loc_no,d.loc_nm order by 
	d.loc_no) UNION select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,
	c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) 
	NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and a.wk_id=b.wk_id and b.
	perd_desc in ('Month')) group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g group by g.ar_no order by g.ar_no ]]>
	</PlannedHours>
	<PlannedHoursTotal>
	<![CDATA[select y.zone_no,NVL(ROUND(sum(y.PLN_HRS_MPZ),0),0) as PLN_HRS_TOT_MPZ from (select g.zone_no,g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
	(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_HRS_MNTH_PLN_STR,0) as PLN_HRS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' 
	and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select d.loc_no,d.loc_nm,
	sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
	from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in 
	('Month')) d group by d.loc_no,d.loc_nm order by d.loc_no) UNION select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as 
	BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in 
	('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.
	div_no='Division' and c.rgn_no='Region' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,
	f.ar_no,f.loc_no) g group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y group by y.zone_no order by y.zone_no]]>
	</PlannedHoursTotal>
</TCName>

<TCName name = "VarToBUDSales_CurrentMonth">
	<VartoBUD>
	<![CDATA[select R.ar_no,NVL((R.PLN_SLS_MPZ - S.BDGT_SLS_MPZ),0) as VAR_TO_BDGT_SLS_MPZ from (select g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from 
	(select f.ar_no,f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES),0),0) as PLN_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as PLAN_SALES from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc 
	c where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' group by c.div_no,c.rgn_no,c.zone_no,
	c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id) c UNION
	select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(gnrt_sls) as GEN_SALES from ww_wlp.fcst a,ww_wlp.wk b, ww_wlp.loc 
	c where a.loc_no=c.loc_no and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
	and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and 
	a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	b.perd_desc,b.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e on f.loc_nm=e.loc_nm group by f.ar_no,f.loc_nm order by 
	f.ar_no) g group by g.ar_no order by g.ar_no) R,(select x.ar_no,ROUND(sum(x.BDGT_SLS_MPG),0) as BDGT_SLS_MPZ from (select f.ar_no,f.loc_nm,NVL(g.BDGT_SALES_MPG,0) as 
	BDGT_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') 
	order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_SALES) as BDGT_SALES_MPG from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
	from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no=
	'Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
	b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,
	C.loc_no) g on f.loc_nm=g.loc_nm) x group by x.ar_no order by x.ar_no) S where R.ar_no=S.ar_no order by R.ar_no]]>
	</VartoBUD>
	<VartoBUDTotal>
	<![CDATA[select R.zone_no,NVL((R.PLN_SLS_TOT_MPZ - S.BDGT_SLS_TOT_MPZ),0) as VAR_TO_BDGT_SLS_TOT_MPZ from (select y.zone_no,ROUND(sum(y.PLN_SLS_MPZ),0) as PLN_SLS_TOT_MPZ 
	from (select g.zone_no,g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from (select f.zone_no,f.ar_no,f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES),0),0) as PLN_SLS_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,
	rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as 
	PLAN_SALES from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' 
	and c.zone_no='Zone' group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	b.perd_desc,a.wk_id) c UNION select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(gnrt_sls) as GEN_SALES 
	from ww_wlp.fcst a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no
	='Region' and c.zone_no='Zone' and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') group by c.div_no,c.rgn_no,c.zone_no,
	c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e on f.loc_nm=e.loc_nm group by 
	f.zone_no,f.ar_no,f.loc_nm order by f.zone_no,f.ar_no) g group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y group by y.zone_no order by y.zone_no) R,
	(select y.zone_no,ROUND(sum(y.BDGT_SLS_MPZ),0) as BDGT_SLS_TOT_MPZ from (select x.zone_no,x.ar_no,ROUND(sum(x.BDGT_SLS_MPG),0) as BDGT_SLS_MPZ from 
	(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.BDGT_SALES_MPG,0) as BDGT_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN
	(select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_SALES) as BDGT_SALES_MPG from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum
	(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) 
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90)
	group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
	group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g on f.loc_nm=g.loc_nm order by f.zone_no,f.ar_no) x group by x.zone_no,x.ar_no order by x.zone_no,x.
	ar_no ) y group by y.zone_no order by y.zone_no) S where R.zone_no=S.zone_no order by R.zone_no]]>
	</VartoBUDTotal>
	<VartoFCST>
	<![CDATA[select R.ar_no,NVL((R.PLN_SLS_MPZ - S.FCST_SLS_MPZ),0) as VAR_TO_FCST_SLS_MPZ from (select g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from 
	(select f.ar_no,f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES),0),0) as PLN_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as PLAN_SALES from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' group by c.div_no,c.rgn_no,c.zone_no,
	c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id) c UNION select * from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(gnrt_sls) as GEN_SALES from ww_wlp.fcst a,ww_wlp.wk b, ww_wlp.loc c where a.
	loc_no=c.loc_no and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
	and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and 
	a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.
	perd_desc,b.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e on f.loc_nm=e.loc_nm group by f.ar_no,f.loc_nm order by f.
	ar_no) g group by g.ar_no order by g.ar_no) R,(select x.ar_no,ROUND(sum(x.FCST_SLS_MPG),0) as FCST_SLS_MPZ from (select f.ar_no,f.loc_nm,NVL(g.FCST_SALES_MPG,0) as 
	FCST_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(FCST_SALES) as FCST_SALES_MPG from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(frcst_sls) as FCST_SALES, sum(frcst_wage_amt) as FCST_WAGE 
	from WW_WLP.mnth_fcst a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no=
	'Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
	b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,
	C.loc_no) g on f.loc_nm=g.loc_nm) x group by x.ar_no order by x.ar_no) S where R.ar_no=S.ar_no order by R.ar_no]]>
	</VartoFCST>
	<VartoFCSTTotal>
	<![CDATA[select R.zone_no,NVL((R.PLN_SLS_TOT_MPZ - S.FCST_SLS_TOT_MPZ),0)as VAR_TO_FCST_SLS_TOT_MPZ from (select y.zone_no,ROUND(sum(y.PLN_SLS_MPZ),0) as PLN_SLS_TOT_MPZ 
	from (select g.zone_no,g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from (select f.zone_no,f.ar_no,f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES),0),0) as PLN_SLS_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,
	rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as 
	PLAN_SALES from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' 
	and c.zone_no='Zone' group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	b.perd_desc,a.wk_id) c UNION select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(gnrt_sls) as GEN_SALES 
	from ww_wlp.fcst a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no=
	'Region' and c.zone_no='Zone' and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' ) group by c.div_no,c.rgn_no,c.zone_no,
	c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e on f.loc_nm=e.loc_nm group by 
	f.zone_no,f.ar_no,f.loc_nm order by f.zone_no,f.ar_no) g group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y group by y.zone_no order by y.zone_no) R,
	(select y.zone_no,ROUND(sum(y.FCST_SLS_MPZ),0) as FCST_SLS_TOT_MPZ from (select x.zone_no,x.ar_no,ROUND(sum(x.FCST_SLS_MPG),0) as FCST_SLS_MPZ from 
	(select f.zone_no,f.ar_no,f.loc_nm,NVL(g.FCST_SALES_MPG,0) as FCST_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum
	(FCST_SALES) as FCST_SALES_MPG from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(frcst_sls) as FCST_SALES, sum(frcst_wage_amt) 
	as FCST_WAGE from WW_WLP.mnth_fcst a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and 
	b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,
	a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order 
	by C.ar_no,C.loc_no) g on f.loc_nm=g.loc_nm order by f.zone_no,f.ar_no) x group by x.zone_no,x.ar_no order by x.zone_no,x.ar_no ) y
	group by y.zone_no order by y.zone_no) S where R.zone_no=S.zone_no order by R.zone_no]]>
	</VartoFCSTTotal>
</TCName>

<TCName name = "LYPercentageSales_CurrentMonth" >
	<LYPercentageSales>
	<![CDATA[select pln_sls.ar_no,
	case when NVL(pln_sls.PLN_SLS_MPZ,0)=0 and NVL(actl_sls.LY_ACTL_SLS_MPZ,0)=0 then 0 
	when NVL(pln_sls.PLN_SLS_MPZ,0)=0 then -100 when NVL(actl_sls.LY_ACTL_SLS_MPZ,0)=0 then 0 
	else ROUND(((pln_sls.PLN_SLS_MPZ / actl_sls.LY_ACTL_SLS_MPZ)-1)*100,2) end as LY_PRCNT_SLS_MPZ from (select g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as 
	PLN_SLS_MPZ from (select f.ar_no,f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES),0),0) as PLN_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where 
	div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN
	(select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as PLAN_SALES from ww_wlp.mgr_wky_pln a,ww_wlp.wk 
	b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' group by c.div_no,c.
	rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id) c UNION
	select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(gnrt_sls) as GEN_SALES from ww_wlp.fcst a,ww_wlp.wk b, ww_wlp.loc 
	c where a.loc_no=c.loc_no and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
	and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and 
	a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.
	perd_desc,b.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e on f.loc_nm=e.loc_nm group by f.ar_no,f.loc_nm order by 
	f.ar_no) g group by g.ar_no order by g.ar_no) pln_sls,(select J.ar_no,ROUND(sum(J.ACTL_SLS_MPG),0) as LY_ACTL_SLS_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) 
	as ACTL_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in 
	('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select J.loc_nm,j.perd_desc,J.ACTL_SALES from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.
	ACTL_SALES) as ACTL_SALES from (select a.loc_no,c.loc_nm,b.perd_desc, b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c
	where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('LYMnth') and a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
	and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90) group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm 
	order by s.loc_no) J) U on T.loc_nm=U.loc_nm order by T.ar_no,T.loc_no) J group by J.ar_no order by J.ar_no) actl_sls where pln_sls.ar_no=actl_sls.ar_no]]>
	</LYPercentageSales>
	<LYPercentageSalesTotal>
	<![CDATA[select pln_sls.zone_no,
	case when NVL(pln_sls.PLN_SLS_TOT_MPZ,0)=0 and NVL(actl_sls.LY_ACTL_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(pln_sls.PLN_SLS_TOT_MPZ,0)=0 then -100 when NVL(actl_sls.LY_ACTL_SLS_TOT_MPZ,0)=0 then 0 
	else ROUND(((pln_sls.PLN_SLS_TOT_MPZ / actl_sls.LY_ACTL_SLS_TOT_MPZ)-1)*100,2) end as LY_PRCNT_TOT_SLS_MPZ from (select y.zone_no,ROUND(sum(y.
	PLN_SLS_MPZ),0) as PLN_SLS_TOT_MPZ from (select g.zone_no,g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from (select f.zone_no,f.ar_no,f.loc_nm,NVL(ROUND(sum(e.
	PLAN_SALES),0),0) as PLN_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.
	loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as PLAN_SALES from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id 
	and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
	order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id) c UNION select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.
	loc_nm,b.perd_desc,b.wk_id,sum(gnrt_sls) as GEN_SALES from ww_wlp.fcst a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.fcst_dte between b.wk_strt and b.
	wk_end and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,
	a.wk_id from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' 
	and c.zone_no='Zone') group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	b.perd_desc,b.wk_id) d) e on f.loc_nm=e.loc_nm group by f.zone_no,f.ar_no,f.loc_nm order by f.zone_no,f.ar_no) g group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) 
	y group by y.zone_no order by y.zone_no) pln_sls,(select K.zone_no,ROUND(sum(K.ACTL_SLS_MPZ),0) as LY_ACTL_SLS_TOT_MPZ from (select J.zone_no,J.ar_no,ROUND(sum(J.
	ACTL_SLS_MPG),0) as ACTL_SLS_MPZ from (select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_SALES,0) as ACTL_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm 
	from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN
	(select J.loc_nm,j.perd_desc,J.ACTL_SALES from (select S.perd_desc,s.loc_no,s.loc_nm,sum(S.ACTL_SALES) as ACTL_SALES from (select a.loc_no,c.loc_nm,b.perd_desc, 
	b.wk_id,sum(a.actl_sls) as ACTL_SALES from WW_WLP.DLY_SLS a,WW_WLP.WK b, ww_wlp.loc c where a.TXN_DTE between b.WK_STRT and b.WK_END and b.PERD_DESC in ('LYMnth') and 
	a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.div_no = 'Division' and a.Dept_no NOT IN (0,20,90)
	group by a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by a.loc_no,b.wk_id) S group by S.perd_desc,s.loc_no,s.loc_nm order by s.loc_no) J) U on T.loc_nm=U.loc_nm order 
	by T.ar_no,T.loc_no) J group by J.zone_no,J.ar_no order by J.zone_no,J.ar_no) K
	group by k.zone_no order by zone_no) actl_sls where pln_sls.zone_no=actl_sls.zone_no order by pln_sls.zone_no]]>
	</LYPercentageSalesTotal>
</TCName>

<TCName name = "BudgetPercentageSales_CurrentMonth" >
	<BUDPercentageSales>
	<![CDATA[select pln_sls.ar_no,
	case when NVL(pln_sls.PLN_SLS_MPZ,0)=0 and NVL(bdgt_sls.BDGT_SLS_MPZ,0)=0 then 0 
	when NVL(pln_sls.PLN_SLS_MPZ,0)=0 then -100 when NVL(bdgt_sls.BDGT_SLS_MPZ,0)=0 then 0 
	else ROUND(((pln_sls.PLN_SLS_MPZ / bdgt_sls.BDGT_SLS_MPZ)-1)*100,2) end as BDGT_PRCNT_SLS_MPZ from (select g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as 
	PLN_SLS_MPZ from (select f.ar_no,f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES),0),0) as PLN_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where 
	div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as PLAN_SALES from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' group by c.div_no,c.rgn_no,c.zone_no,
	c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id) c UNION select * from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(gnrt_sls) as GEN_SALES from ww_wlp.fcst a,ww_wlp.wk b, ww_wlp.loc c where 
	a.loc_no=c.loc_no and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
	and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and 
	a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	b.perd_desc,b.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e on f.loc_nm=e.loc_nm group by f.ar_no,f.loc_nm order by 
	f.ar_no) g group by g.ar_no order by g.ar_no) pln_sls,(select x.ar_no,ROUND(sum(x.BDGT_SLS_MPG),0) as BDGT_SLS_MPZ from (select f.ar_no,f.loc_nm,NVL(g.BDGT_SALES_MPG,0) 
	as BDGT_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_SALES) as BDGT_SALES_MPG from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE from WW_WLP.wky_bdgt a,
	loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' 
	and wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
	on f.loc_nm=g.loc_nm) x group by x.ar_no order by x.ar_no) bdgt_sls where pln_sls.ar_no=bdgt_sls.ar_no]]>
	</BUDPercentageSales>
	<BUDPercentageSalesTotal>
	<![CDATA[select pln_sls.zone_no,
	case when NVL(pln_sls.PLN_SLS_TOT_MPZ,0)=0 and NVL(bdgt_sls.BDGT_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(pln_sls.PLN_SLS_TOT_MPZ,0)=0 then -100 when NVL(bdgt_sls.BDGT_SLS_TOT_MPZ,0)=0 then 0 
	else ROUND(((pln_sls.PLN_SLS_TOT_MPZ / bdgt_sls.BDGT_SLS_TOT_MPZ)-1)*100,2) end as BDGT_PRCNT_SLS_TOT_MPZ from (select y.zone_no,ROUND(sum
	(y.PLN_SLS_MPZ),0) as PLN_SLS_TOT_MPZ from (select g.zone_no,g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from (select f.zone_no,f.ar_no,f.loc_nm,NVL(ROUND
	(sum(e.PLAN_SALES),0),0) as PLN_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as PLAN_SALES from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id 
	and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
	order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id) c UNION select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	b.perd_desc,b.wk_id,sum(gnrt_sls) as GEN_SALES from ww_wlp.fcst a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.fcst_dte between b.wk_strt and b.wk_end and 
	b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id 
	from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.
	zone_no='Zone') group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.
	perd_desc,b.wk_id) d) e on f.loc_nm=e.loc_nm group by f.zone_no,f.ar_no,f.loc_nm order by f.zone_no,f.ar_no) g group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
	group by y.zone_no order by y.zone_no) pln_sls,(select y.zone_no,ROUND(sum(y.BDGT_SLS_MPZ),0) as BDGT_SLS_TOT_MPZ from (select x.zone_no,x.ar_no,ROUND(sum
	(x.BDGT_SLS_MPG),0) as BDGT_SLS_MPZ from (select f.zone_no,f.ar_no,f.loc_nm,NVL(g.BDGT_SALES_MPG,0) as BDGT_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,
	loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
	LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(BDGT_SALES) as BDGT_SALES_MPG from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,
	a.wk_id,sum(bdgt_sls) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE from WW_WLP.wky_bdgt a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc 
	in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN 
	(0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,
	a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g on f.loc_nm=g.loc_nm order by f.zone_no,f.ar_no) x group by x.zone_no,x.ar_no order by 
	x.zone_no,x.ar_no ) y group by y.zone_no order by y.zone_no) bdgt_sls where pln_sls.zone_no=bdgt_sls.zone_no order by pln_sls.zone_no]]>
	</BUDPercentageSalesTotal>
	<FCSTPercentageSales>
	<![CDATA[select pln_sls.ar_no,
	case when NVL(pln_sls.PLN_SLS_MPZ,0)=0 and NVL(fcst_sls.FCST_SLS_MPZ,0)=0 then 0 
	when NVL(pln_sls.PLN_SLS_MPZ,0)=0 then -100 when NVL(fcst_sls.FCST_SLS_MPZ,0)=0 then 0 
	else ROUND(((pln_sls.PLN_SLS_MPZ / fcst_sls.FCST_SLS_MPZ)-1)*100,2) end as FCST_PRCNT_SLS_MPZ from (select g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as 
	PLN_SLS_MPZ from (select f.ar_no,f.loc_nm,NVL(ROUND(sum(e.PLAN_SALES),0),0) as PLN_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where 
	div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as PLAN_SALES from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' group by c.div_no,c.rgn_no,c.zone_no,
	c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id) c UNION select * from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,sum(gnrt_sls) as GEN_SALES from ww_wlp.fcst a,ww_wlp.wk b, ww_wlp.loc c where 
	a.loc_no=c.loc_no and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'
	and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and 
	a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	b.perd_desc,b.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id) d) e on f.loc_nm=e.loc_nm group by f.ar_no,f.loc_nm order by 
	f.ar_no) g group by g.ar_no order by g.ar_no) pln_sls,(select x.ar_no,ROUND(sum(x.FCST_SLS_MPG),0) as FCST_SLS_MPZ from (select f.ar_no,f.loc_nm,NVL(g.FCST_SALES_MPG,0) 
	as FCST_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(FCST_SALES) as FCST_SALES_MPG from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(frcst_sls) as FCST_SALES, sum(frcst_wage_amt) as FCST_WAGE from WW_WLP.mnth_fcst a,
	loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' 
	and wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
	on f.loc_nm=g.loc_nm) x group by x.ar_no order by x.ar_no) fcst_sls where pln_sls.ar_no=fcst_sls.ar_no]]>
	</FCSTPercentageSales>
	<FCSTPercentageSalesTotal>
	<![CDATA[select pln_sls.zone_no,
	case when NVL(pln_sls.PLN_SLS_TOT_MPZ,0)=0 and NVL(fcst_sls.FCST_SLS_TOT_MPZ,0)=0 then 0 
	when NVL(pln_sls.PLN_SLS_TOT_MPZ,0)=0 then -100 when NVL(fcst_sls.FCST_SLS_TOT_MPZ,0)=0 then 0 
	ELSE ROUND(((pln_sls.PLN_SLS_TOT_MPZ / fcst_sls.FCST_SLS_TOT_MPZ)-1)*100,2) end as FCST_PRCNT_SLS_TOT_MPZ from (select y.zone_no,ROUND(sum
	(y.PLN_SLS_MPZ),0) as PLN_SLS_TOT_MPZ from (select g.zone_no,g.ar_no,ROUND(sum(g.PLN_SLS_MPG),0) as PLN_SLS_MPZ from (select f.zone_no,f.ar_no,f.loc_nm,NVL(ROUND(sum
	(e.PLAN_SALES),0),0) as PLN_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	c.loc_nm,b.perd_desc,a.wk_id,sum(a.mgr_wky_sls) as PLAN_SALES from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id 
	and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
	order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id) c UNION select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	b.perd_desc,b.wk_id,sum(gnrt_sls) as GEN_SALES from ww_wlp.fcst a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.fcst_dte between b.wk_strt and b.wk_end and 
	b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.dept_no NOT IN (0,90,20) and (a.loc_no,b.wk_id) NOT IN (select a.loc_no,a.wk_id 
	from ww_wlp.mgr_wky_pln a,ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and a.wk_id=b.wk_id and b.perd_desc='Month' and c.div_no='Division' and c.rgn_no='Region' and 
	c.zone_no='Zone') group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,
	b.perd_desc,b.wk_id) d) e on f.loc_nm=e.loc_nm group by f.zone_no,f.ar_no,f.loc_nm order by f.zone_no,f.ar_no) g group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) 
	y group by y.zone_no order by y.zone_no) pln_sls,(select y.zone_no,ROUND(sum(y.FCST_SLS_MPZ),0) as FCST_SLS_TOT_MPZ from (select x.zone_no,x.ar_no,ROUND(sum
	(x.FCST_SLS_MPG),0) as FCST_SLS_MPZ from (select f.zone_no,f.ar_no,f.loc_nm,NVL(g.FCST_SALES_MPG,0) as FCST_SLS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,
	loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
	LEFT OUTER JOIN (select C.ar_no,C.loc_no,C.loc_nm,sum(FCST_SALES) as FCST_SALES_MPG from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,
	a.wk_id,sum(frcst_sls) as FCST_SALES, sum(frcst_wage_amt) as FCST_WAGE from WW_WLP.mnth_fcst a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc 
	in ('Month')) and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no NOT IN 
	(0,20,90) group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,
	a.wk_id) C group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g on f.loc_nm=g.loc_nm order by f.zone_no,f.ar_no) x group by x.zone_no,x.ar_no order by 
	x.zone_no,x.ar_no ) y group by y.zone_no order by y.zone_no) fcst_sls where pln_sls.zone_no=fcst_sls.zone_no order by pln_sls.zone_no]]>
	</FCSTPercentageSalesTotal>
</TCName>

<TCName name = "LYPercentageWages_CurrentMonth" >
	<LYPercentageWages>
	<![CDATA[select pln_wge_cy.ar_no,
	case when NVL(pln_wge_cy.PLN_WAGE_CY_MPZ,0)=0 and NVL(actl_wge_ly.ACTL_WAGE_LY_MPZ,0)=0 then 0 
	when NVL(pln_wge_cy.PLN_WAGE_CY_MPZ,0)=0 then -100 when NVL(actl_wge_ly.ACTL_WAGE_LY_MPZ,0)=0 then 0 
	else ROUND(((pln_wge_cy.PLN_WAGE_CY_MPZ / actl_wge_ly.ACTL_WAGE_LY_MPZ)-1)*100,2) end as LY_PRCNT_WAGE_MPZ from (select g.ar_no,ROUND(sum
	(g.PLN_WAGE_MPG),0) as PLN_WAGE_CY_MPZ from (select f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,
	loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
	LEFT OUTER JOIN (select * from (select d.loc_no,d.loc_nm,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,
	a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' 
	and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.loc_no,d.loc_nm order by d.loc_no) UNION select * from (select d.loc_no,d.loc_nm,
	(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as BASE_COST_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,
	a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and 
	c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, 
	ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
	group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g group by g.ar_no order by g.ar_no) pln_wge_cy,
	(select V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_LY_MPZ from (select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,
	rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
	(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
	from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('LYMnth')) and a.loc_no=b.loc_no and b.div_no='Division' and 
	b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20 group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,
	b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,
	c.loc_no) U on T.loc_nm=U.loc_nm order by T.ar_no) V group by V.ar_no order by V.ar_no) actl_wge_ly where pln_wge_cy.ar_no=actl_wge_ly.ar_no]]>
	</LYPercentageWages>
	<LYPercentageWagesTotal>
	<![CDATA[Select pln_wge_cy.zone_no,
	CASE WHEN NVL(pln_wge_cy.PLN_WAGE_CY_TOT_MPZ,0)=0 and NVL(actl_wge_ly.ACTL_WAGE_LY_TOT_MPZ,0)=0 then 0 
	when NVL(pln_wge_cy.PLN_WAGE_CY_TOT_MPZ,0)=0 then -100 when NVL(actl_wge_ly.ACTL_WAGE_LY_TOT_MPZ,0)=0 then 0 
	ELSE ROUND(((pln_wge_cy.PLN_WAGE_CY_TOT_MPZ / actl_wge_ly.ACTL_WAGE_LY_TOT_MPZ)-1)*100,2) END as LY_PRCNT_WAGE_TOT_MPZ from 
	(select y.zone_no,ROUND(sum(y.PLN_WAGE_MPZ),0) as PLN_WAGE_CY_TOT_MPZ from (select g.zone_no,g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_MPZ from (select f.zone_no,f.ar_no,f.loc_nm,
	NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no=
	'Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select d.loc_no,d.loc_nm,ROUND(sum(d.MGR_WKY_WGE) ,
	0) as PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, 
	ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d
	group by d.loc_no,d.loc_nm order by d.loc_no) UNION select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as BASE_COST_MNTH_PLN_STR 
	from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, ww_wlp.wk b, 
	ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')
	and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and 
	c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by 
	f.zone_no,f.ar_no,f.loc_no) g group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y group by y.zone_no order by y.zone_no) pln_wge_cy,(select x.zone_no,ROUND(sum
	(x.ACTL_WAGE_MPZ),0) as ACTL_WAGE_LY_TOT_MPZ from (select V.zone_no,V.ar_no,ROUND(sum(V.ACTL_WAGE_MPG),0) as ACTL_WAGE_MPZ from (select T.zone_no,T.ar_no,T.loc_nm,
	NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no=
	'Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T LEFT OUTER JOIN (select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as 
	ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from (select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as 
	ACTL_WAGE,sum(actl_hrs) as ACTL_HRS from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('LYMnth')) 
	and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N') and a.wk_id=d.wk_id and a.dept_no!=20
	group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) 
	C group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V group by V.zone_no,V.ar_no order by V.zone_no,
	V.ar_no) x group by x.zone_no order by x.zone_no) actl_wge_ly where pln_wge_cy.zone_no=actl_wge_ly.zone_no order by pln_wge_cy.zone_no]]>
	</LYPercentageWagesTotal>
</TCName>

<TCName name = "LYPercentageHours_CurrentMonth" >
	<LYHours>
	<![CDATA[select pln_hrs_cy.ar_no,
	case when NVL(pln_hrs_cy.PLN_HRS_CY_MPZ,0)=0 and NVL(actl_hrs_ly.ACTL_HRS_LY_MPZ,0)=0 then 0 
	when NVL(pln_hrs_cy.PLN_HRS_CY_MPZ,0)=0 then -100 when NVL(actl_hrs_ly.ACTL_HRS_LY_MPZ,0)=0 then 0 
	else ROUND(((pln_hrs_cy.PLN_HRS_CY_MPZ / actl_hrs_ly.ACTL_HRS_LY_MPZ)-1)*100,2) end as LY_PRCNT_HRS_MPZ from 
(select g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_CY_MPZ from 
(select f.ar_no,f.loc_nm,NVL(e.PLN_HRS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')
and DEPT_NO NOT IN (20)) d /*where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and c.ar_no=104 and a.wk_id=b.wk_id and b.perd_desc in ('Month'))*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g
group by g.ar_no order by g.ar_no) pln_hrs_cy,
(select V.ar_no,sum(V.ACTL_HRS_MPG) as ACTL_HRS_LY_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('LYMnth')) 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no) actl_hrs_ly 
where pln_hrs_cy.ar_no=actl_hrs_ly.ar_no]]>
	</LYHours>
	<LYHoursTotal>
	<![CDATA[select pln_hrs_cy.zone_no,
	case when NVL(pln_hrs_cy.PLN_HRS_CY_TOT_MPZ,0)=0 and NVL(actl_hrs_ly.ACTL_HRS_LY_TOT_MPZ,0)=0 then 0 
	when NVL(pln_hrs_cy.PLN_HRS_CY_TOT_MPZ,0)=0 then -100 when NVL(actl_hrs_ly.ACTL_HRS_LY_TOT_MPZ,0)=0 then 0 
	else ROUND(((pln_hrs_cy.PLN_HRS_CY_TOT_MPZ / actl_hrs_ly.ACTL_HRS_LY_TOT_MPZ)-1)*100,2) end as LY_PRCNT_HRS_TOT_MPZ from 
(select y.zone_no,ROUND(sum(y.PLN_HRS_MPZ),0) as PLN_HRS_CY_TOT_MPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_HRS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(/*select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION*/
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')
and DEPT_NO NOT IN (20)) d /*where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month'))*/
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) pln_hrs_cy,
(select x.zone_no,sum(x.ACTL_HRS_MPZ) as ACTL_HRS_LY_TOT_MPZ from 
(select V.zone_no,V.ar_no,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,sum(ACTL_WAGE) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('LYMnth')) 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no) V
group by V.zone_no,V.ar_no order by V.zone_no,V.ar_no) x 
group by x.zone_no order by x.zone_no) actl_hrs_ly 
where pln_hrs_cy.zone_no=actl_hrs_ly.zone_no order by pln_hrs_cy.zone_no]]>
	</LYHoursTotal>
</TCName>

<TCName name = "PlannedOR_CurrentMonth" >
	<PlannedOR>
	<![CDATA[select sms_hrs.ar_no,
	case when NVL(sms_hrs.SMS_HRS_MPZ,0)=0 and NVL(pln_hrs.PLN_HRS_MPZ,0)=0 then 0 
	when NVL(sms_hrs.SMS_HRS_MPZ,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_MPZ,0)=0 then 0 
	else ROUND((sms_hrs.SMS_HRS_MPZ / pln_hrs.PLN_HRS_MPZ)*100,1) end as PLN_OR_MPZ from 
	(select g.ar_no,NVL(ROUND(((ROUND(((sum(g.SMS_HRS_MPG)*100)/25),0)*25)/100),2),0) as SMS_HRS_MPZ from
	(select x.ar_no,x.loc_nm,NVL(y.SMS_HOURS_MPS,0) as SMS_HRS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' 
	and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) x LEFT OUTER JOIN (select C.loc_no,C.loc_nm,(sum(C.FIX_HRS_DEPT_TOT) + 
	sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPS from (select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
	from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
	and d.dept_no!=20 and b.perd_desc in ('Month') and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') A group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order by 
	A.loc_no,A.wk_id,A.dept_no) C group by C.loc_no,C.loc_nm order by c.loc_no) y on x.loc_nm=y.loc_nm order by x.loc_no) g group by g.ar_no order by g.ar_no) sms_hrs,
	(select g.ar_no,NVL(ROUND(((ROUND(((sum(g.PLN_HRS_MPG)*100)/25),0)*25)/100),2),0) as PLN_HRS_MPZ from 
	(select f.ar_no,f.loc_nm,NVL(e.PLN_HRS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,
	rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,
	c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and 
	c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.loc_no,d.loc_nm order by d.loc_no) UNION
	select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and 
	c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from 
	ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in 
	('Month')) group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g group by g.ar_no order by g.ar_no) pln_hrs where sms_hrs.ar_no=
	pln_hrs.ar_no]]>
	</PlannedOR>
	<PlannedORTotal>
	<![CDATA[select sms_hrs.zone_no,
	case when NVL(sms_hrs.SMS_HRS_TOT_MPZ,0)=0 and NVL(pln_hrs.PLN_HRS_TOT_MPZ,0)=0 then 0 
	when NVL(sms_hrs.SMS_HRS_TOT_MPZ,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_TOT_MPZ,0)=0 then 0 
	else ROUND((sms_hrs.SMS_HRS_TOT_MPZ / pln_hrs.PLN_HRS_TOT_MPZ)*100,1) end as PLN_OR_TOT_MPZ from 
	(select y.zone_no,NVL(SUM(ROUND(((ROUND(((y.SMS_HRS_MPZ*100)/25),0)*25)/100),2)),0) as SMS_HRS_TOT_MPZ from 
	(select g.zone_no,g.ar_no,sum(g.SMS_HRS_MPG) as SMS_HRS_MPZ from (select x.zone_no,x.ar_no,x.loc_nm,NVL(y.SMS_HOURS_MPS,0) as SMS_HRS_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,
	rgn_no,zone_no,ar_no,loc_no) x LEFT OUTER JOIN (select C.loc_no,C.loc_nm,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPS from 
	(select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, 
	ww_wlp.task d where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no and d.dept_no!=20 and b.perd_desc in ('Month') and c.div_no='Division' and c.rgn_no='Region' 
	and c.zone_no='Zone') A group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C group by C.loc_no,C.loc_nm order by c.loc_no) y
	on x.loc_nm=y.loc_nm order by x.zone_no,x.ar_no,x.loc_no) g group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y group by y.zone_no order by y.zone_no) sms_hrs,
	(select y.zone_no,NVL(SUM(ROUND(((ROUND(((y.PLN_HRS_MPZ*100)/25),0)*25)/100),2)),0) as PLN_HRS_TOT_MPZ from (select g.zone_no,g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
	(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_HRS_MNTH_PLN_STR,0) as PLN_HRS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' 
	and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select d.loc_no,
	d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
	from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and 
	b.perd_desc in ('Month')) d group by d.loc_no,d.loc_nm order by d.loc_no) UNION select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as 
	BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and 
	b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_no,d.loc_nm order 
	by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
	group by y.zone_no order by y.zone_no) pln_hrs where sms_hrs.zone_no=pln_hrs.zone_no order by sms_hrs.zone_no]]>
	</PlannedORTotal>
</TCName>

<TCName name = "PlannedCPH_CurrentMonth" >
	<PlannedCPH>
	<![CDATA[select pln_wge.ar_no,
	case when NVL(pln_wge.PLN_WAGE_MPZ,0)=0 and NVL(pln_hrs.PLN_HRS_MPZ,0)=0 then 0 
	when NVL(pln_wge.PLN_WAGE_MPZ,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_MPZ,0)=0 then 0 
	else ROUND((pln_wge.PLN_WAGE_MPZ / pln_hrs.PLN_HRS_MPZ),2) end as PLN_CPH_MPZ from (select g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_MPZ 
	from (select f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and 
	rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select d.loc_no,d.loc_nm,
	ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE
	from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in 
	('Month')) d group by d.loc_no,d.loc_nm order by d.loc_no) UNION select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as 
	BASE_COST_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in 
	('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division'
	and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by 
	f.loc_no) g group by g.ar_no order by g.ar_no) pln_wge,(select g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from (select f.ar_no,f.loc_nm,NVL(e.
	PLN_HRS_MNTH_PLN_STR,0) as PLN_HRS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
	and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as 
	PLN_HRS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, 
	ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.loc_no,d.loc_nm 
	order by d.loc_no) UNION select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,
	c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT 
	IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and 
	b.perd_desc in ('Month')) group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g
	group by g.ar_no order by g.ar_no) pln_hrs where pln_wge.ar_no=pln_hrs.ar_no]]>
	</PlannedCPH>
	<PlannedCPHTotal>
	<![CDATA[select pln_wge.zone_no,
	case when NVL(pln_wge.PLN_WAGE_TOT_MPZ,0)=0 and NVL(pln_hrs.PLN_HRS_TOT_MPZ,0)=0 then 0 
	when NVL(pln_wge.PLN_WAGE_TOT_MPZ,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_TOT_MPZ,0)=0 then 0 
	else ROUND((pln_wge.PLN_WAGE_TOT_MPZ / pln_hrs.PLN_HRS_TOT_MPZ),2) end as PLN_CPH_TOT_MPZ from (select y.zone_no,ROUND(sum(y.PLN_WAGE_MPZ),0) as 
	PLN_WAGE_TOT_MPZ from (select g.zone_no,g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_MPZ from (select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as 
	PLN_WAGE_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') 
	order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select d.loc_no,d.loc_nm,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.loc_no,d.loc_nm order 
	by d.loc_no) UNION select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as BASE_COST_MNTH_PLN_STR from (select c.div_no,c.rgn_no,
	c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where 
	(d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' 
	and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
	group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y group by y.zone_no order by y.zone_no) pln_wge,(select y.zone_no,ROUND(sum(y.PLN_HRS_MPZ),0) as 
	PLN_HRS_TOT_MPZ from (select g.zone_no,g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from (select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_HRS_MNTH_PLN_STR,0) as 
	PLN_HRS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' and wlp_live_ind in ('Y','N') 
	order by div_no,rgn_no,zone_no,ar_no,loc_no) f LEFT OUTER JOIN (select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d group by d.loc_no,d.loc_nm order 
	by d.loc_no) UNION select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as BASE_HOURS_MNTH_PLN_STR from (select c.div_no,c.rgn_no,
	c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d where 
	(d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' 
	and a.wk_id=b.wk_id and b.perd_desc in ('Month')) group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
	group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y group by y.zone_no order by y.zone_no) pln_hrs where pln_wge.zone_no=pln_hrs.zone_no order by pln_wge.zone_no]]>
	</PlannedCPHTotal>
</TCName>

<TCName name = "GrowthLYCPH_CurrentMonth" >
	<GrowthLYCPH>
	<![CDATA[select pln_cph_cy.ar_no,
	case when NVL(pln_cph_cy.PLN_CPH_CY_MPZ,0)=0 and NVL(actl_cph_ly.ACTL_CPH_LY_MPZ,0)=0 then 0 
	when NVL(pln_cph_cy.PLN_CPH_CY_MPZ,0)=0 then -100 when NVL(actl_cph_ly.ACTL_CPH_LY_MPZ,0)=0 then 0 
	else ROUND(((pln_cph_cy.PLN_CPH_CY_MPZ / actl_cph_ly.ACTL_CPH_LY_MPZ)-1)*100,2) end as GROWTH_LY_CPH_MPZ from 
(select pln_wge.ar_no,
case when NVL(pln_wge.PLN_WAGE_MPZ,0)=0 and NVL(pln_hrs.PLN_HRS_MPZ,0)=0 then 0 
when NVL(pln_wge.PLN_WAGE_MPZ,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_MPZ,0)=0 then 0 
else ROUND((pln_wge.PLN_WAGE_MPZ / pln_hrs.PLN_HRS_MPZ),2) end as PLN_CPH_CY_MPZ from 
(select g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_MPZ from 
(select f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select * from (select d.loc_no,d.loc_nm,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as BASE_COST_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')
and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g
group by g.ar_no order by g.ar_no) pln_wge,
(select g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
(select f.ar_no,f.loc_nm,NVL(e.PLN_HRS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as BASE_HOURS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')
and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.loc_no) g
group by g.ar_no order by g.ar_no) pln_hrs where pln_wge.ar_no=pln_hrs.ar_no) pln_cph_cy,
(select x.ar_no,
case when NVL(x.ACTL_WAGE_MPZ,0)=0 and NVL(x.ACTL_HRS_MPZ,0)=0 then 0 
when NVL(x.ACTL_WAGE_MPZ,0)=0 then 0 when NVL(x.ACTL_HRS_MPZ,0)=0 then 0 
else ROUND((x.ACTL_WAGE_MPZ / x.ACTL_HRS_MPZ),2) end as ACTL_CPH_LY_MPZ from 
(select V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('LYMnth')) 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.ar_no) V
group by V.ar_no order by V.ar_no) x order by x.ar_no) actl_cph_ly where pln_cph_cy.ar_no=actl_cph_ly.ar_no
]]>
	</GrowthLYCPH>
	<GrowthLYCPHTotal>
	<![CDATA[select pln_cph_cy.zone_no,
	case when NVL(pln_cph_cy.PLN_CPH_CY_TOT_MPZ,0)=0 and NVL(actl_cph_ly.ACTL_CPH_LY_TOT_MPZ,0)=0 then 0 
	when NVL(pln_cph_cy.PLN_CPH_CY_TOT_MPZ,0)=0 then -100 when NVL(actl_cph_ly.ACTL_CPH_LY_TOT_MPZ,0)=0 then 0 
	else ROUND(((pln_cph_cy.PLN_CPH_CY_TOT_MPZ / actl_cph_ly.ACTL_CPH_LY_TOT_MPZ)-1)*100,2) end as GROWTH_LY_CPH_TOT_MPZ from 
(select pln_wge.zone_no,
case when NVL(pln_wge.PLN_WAGE_TOT_MPZ,0)=0 and NVL(pln_hrs.PLN_HRS_TOT_MPZ,0)=0 then 0 
when NVL(pln_wge.PLN_WAGE_TOT_MPZ,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_TOT_MPZ,0)=0 then 0 
else ROUND((pln_wge.PLN_WAGE_TOT_MPZ / pln_hrs.PLN_HRS_TOT_MPZ),2) end as PLN_CPH_CY_TOT_MPZ from 
(select y.zone_no,ROUND(sum(y.PLN_WAGE_MPZ),0) as PLN_WAGE_TOT_MPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_WAGE_MPG),0) as PLN_WAGE_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WAGE_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select * from (select d.loc_no,d.loc_nm,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)) as BASE_COST_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')
and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) pln_wge,
(select y.zone_no,ROUND(sum(y.PLN_HRS_MPZ),0) as PLN_HRS_TOT_MPZ from 
(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_HRS_MPG),0) as PLN_HRS_MPZ from 
(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_HRS_MNTH_PLN_STR,0) as PLN_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) f
LEFT OUTER JOIN
(select * from (select d.loc_no,d.loc_nm,sum(d.MGR_WKY_HRS) as PLN_HRS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d
group by d.loc_no,d.loc_nm order by d.loc_no)
UNION
select * from (select d.loc_no,d.loc_nm,(sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)) as BASE_HOURS_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month')
and DEPT_NO NOT IN (20)) d where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone'  and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
group by d.loc_no,d.loc_nm order by d.loc_no)) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g
group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
group by y.zone_no order by y.zone_no) pln_hrs where pln_wge.zone_no=pln_hrs.zone_no order by pln_wge.zone_no) pln_cph_cy,
(select x.zone_no,
case when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 and NVL(x.ACTL_HRS_TOT_MPZ,0)=0 then 0 
when NVL(x.ACTL_WAGE_TOT_MPZ,0)=0 then 0 when NVL(x.ACTL_HRS_TOT_MPZ,0)=0 then 0 
else ROUND((x.ACTL_WAGE_TOT_MPZ / x.ACTL_HRS_TOT_MPZ),2) end as ACTL_CPH_LY_TOT_MPZ from 
(select W.zone_no,sum(w.ACTL_WAGE_MPZ) as ACTL_WAGE_TOT_MPZ,sum(w.ACTL_HRS_MPZ) as ACTL_HRS_TOT_MPZ from 
(select V.zone_no,V.ar_no,sum(V.ACTL_WAGE_MPG) as ACTL_WAGE_MPZ,sum(V.ACTL_HRS_MPG) as ACTL_HRS_MPZ from 
(select T.zone_no,T.ar_no,T.loc_nm,NVL(U.ACTL_WAGE_MNTH_STR,0) as ACTL_WAGE_MPG,NVL(U.ACTL_HRS_MNTH_STR,0) as ACTL_HRS_MPG from 
(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no,zone_no,ar_no,loc_no) T
LEFT OUTER JOIN
(select c.ar_no,c.loc_no,c.loc_nm,ROUND(sum(ACTL_WAGE),0) as ACTL_WAGE_MNTH_STR,sum(ACTL_HRS) as ACTL_HRS_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,sum(actl_wage_amt) as ACTL_WAGE,sum(actl_hrs) as ACTL_HRS 
from WW_WLP.ACTL_WKY_WAGE a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('LYMnth')) 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.wlp_live_ind in ('Y','N')
and a.wk_id=d.wk_id and a.dept_no!=20
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,c.loc_no,c.loc_nm order by c.ar_no,c.loc_no) U
on T.loc_nm=U.loc_nm order by T.zone_no,T.ar_no,T.loc_no) V
group by V.zone_no,V.ar_no order by V.ar_no,V.ar_no) W 
group by W.zone_no order by W.zone_no) x order by x.zone_no) actl_cph_ly where pln_cph_cy.zone_no=actl_cph_ly.zone_no order by pln_cph_cy.zone_no]]>
	</GrowthLYCPHTotal>
</TCName>

<TCName name = "BGDT_FCST_OR_CurrentMonth" >
	<BudgetOR>
	<![CDATA[select x.ar_no,
	case when NVL(x.BDGT_SMS_MPZ,0)=0 and NVL(x.BDGT_HRS_MPZ,0)=0 then 0 
	when NVL(x.BDGT_SMS_MPZ,0)=0 then 0 when NVL(x.BDGT_HRS_MPZ,0)=0 then 0 
	else NVL(ROUND((x.BDGT_SMS_MPZ / x.BDGT_HRS_MPZ) * 100,2),0) end as BDGT_OR_MPZ from 
(select f.ar_no,sum(g.BDGT_SMS_WPG) as BDGT_SMS_MPZ,sum(g.BDGT_HRS_WPG) as BDGT_HRS_MPZ from 
(select distinct ar_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'order by ar_no) f
LEFT OUTER JOIN
(select C.ar_no,C.loc_no,C.loc_nm,sum(bdgt_sms_hrs) as BDGT_SMS_WPG,sum(bdgt_hrs) as BDGT_HRS_WPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,nvl(bdgt_sms_hrs,0) as bdgt_sms_hrs, nvl(bdgt_hrs,0) as bdgt_hrs 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' 
and a.wk_id=d.wk_id and a.dept_no NOT IN (20)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.ar_no,C.loc_no,C.loc_nm order by C.ar_no,C.loc_no) g
on f.ar_no=g.ar_no group by f.ar_no order by f.ar_no) x
order by x.ar_no]]>
	</BudgetOR>
	<BudgetORTotal>
	<![CDATA[select x.zone_no,
	case when NVL(x.BDGT_SMS_TOT_MPZ,0)=0 and NVL(x.BDGT_HRS_TOT_MPZ,0)=0 then 0 
	when NVL(x.BDGT_SMS_TOT_MPZ,0)=0 then 0 when NVL(x.BDGT_HRS_TOT_MPZ,0)=0 then 0 
	else NVL(ROUND((x.BDGT_SMS_TOT_MPZ / x.BDGT_HRS_TOT_MPZ) * 100,2),0) end as BDGT_OR_TOT_MPZ from 
(select f.zone_no,sum(g.BDGT_SMS_WPG) as BDGT_SMS_TOT_MPZ,sum(g.BDGT_HRS_WPG) as BDGT_HRS_TOT_MPZ from 
(select distinct zone_no from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone'order by zone_no) f
LEFT OUTER JOIN
(select C.zone_no,C.ar_no,sum(bdgt_sms_hrs) as BDGT_SMS_WPG,sum(bdgt_hrs) as BDGT_HRS_WPG from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,nvl(bdgt_sms_hrs,0) as bdgt_sms_hrs, nvl(bdgt_hrs,0) as bdgt_hrs 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') 
and a.loc_no=b.loc_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' 
and a.wk_id=d.wk_id and a.dept_no NOT IN (20)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id) C
group by C.zone_no,C.ar_no order by C.zone_no,C.ar_no) g
on f.zone_no=g.zone_no group by f.zone_no order by f.zone_no) x
order by x.zone_no]]>
	</BudgetORTotal>
	
	<ForecastOR>
	<![CDATA[select sms_hrs.ar_no,
	case when NVL(sms_hrs.SMS_HRS_MPZ,0)=0 and NVL(pln_hrs.PLN_HRS_MPZ,0)=0 then 0 
	when NVL(sms_hrs.SMS_HRS_MPZ,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_MPZ,0)=0 then 0 
	else ROUND((sms_hrs.SMS_HRS_MPZ / pln_hrs.PLN_HRS_MPZ)*100,2) end as PLN_OR_MPZ from 
	(select g.ar_no,NVL(ROUND(((ROUND(((sum(g.SMS_HRS_MPG)*100)/25),2)*25)/100),2),0) as SMS_HRS_MPZ from
	(select x.ar_no,x.loc_nm,NVL(y.SMS_HOURS_MPS,0) as SMS_HRS_MPG from (select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' 
	and zone_no='Zone' order by div_no,rgn_no,zone_no,ar_no,loc_no) x LEFT OUTER JOIN (select C.loc_no,C.loc_nm,(sum(C.FIX_HRS_DEPT_TOT) + 
	sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPS from (select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
	from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
	and d.dept_no!=20 and b.perd_desc in ('Month') and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone') A group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order by 
	A.loc_no,A.wk_id,A.dept_no) C group by C.loc_no,C.loc_nm order by c.loc_no) y on x.loc_nm=y.loc_nm order by x.loc_no) g group by g.ar_no order by g.ar_no) sms_hrs,
	(select g.ar_no,NVL(ROUND(((ROUND(((sum(g.PLN_HRS_MPG)*100)/25),2)*25)/100),2),0) as PLN_HRS_MPZ from 
	(select f.ar_no,f.loc_nm,NVL(e.PLN_HOURS_MPS,0) as PLN_HRS_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' 
	order by div_no,rgn_no,zone_no,ar_no,loc_no) f 
	LEFT OUTER JOIN 
	(select d.loc_no,d.loc_nm,sum(d.plan_paid_hours) as PLN_HOURS_MPS from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,nvl(a.plan_paid_hours,0) as plan_paid_hours 
	from ww_wlp.mnth_fcst a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d group by d.loc_no,d.loc_nm order by d.loc_no) e on e.loc_nm=f.loc_nm order by f.loc_no) g group by g.ar_no order by g.ar_no) pln_hrs where sms_hrs.ar_no=
	pln_hrs.ar_no]]>
	</ForecastOR>
	<ForecastORTotal>
	<![CDATA[select sms_hrs.zone_no,
	case when NVL(sms_hrs.SMS_HRS_TOT_MPZ,0)=0 and NVL(pln_hrs.PLN_HRS_TOT_MPZ,0)=0 then 0 
	when NVL(sms_hrs.SMS_HRS_TOT_MPZ,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_TOT_MPZ,0)=0 then 0 
	else ROUND((sms_hrs.SMS_HRS_TOT_MPZ / pln_hrs.PLN_HRS_TOT_MPZ)*100,2) end as PLN_OR_TOT_MPZ from 
	(select y.zone_no,NVL(SUM(ROUND(((ROUND(((y.SMS_HRS_MPZ*100)/25),2)*25)/100),2)),0) as SMS_HRS_TOT_MPZ from 
	(select g.zone_no,g.ar_no,sum(g.SMS_HRS_MPG) as SMS_HRS_MPZ from (select x.zone_no,x.ar_no,x.loc_nm,NVL(y.SMS_HOURS_MPS,0) as SMS_HRS_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' order by div_no,
	rgn_no,zone_no,ar_no,loc_no) x LEFT OUTER JOIN (select C.loc_no,C.loc_nm,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_MPS from 
	(select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,
	c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, 
	ww_wlp.task d where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no and d.dept_no!=20 and b.perd_desc in ('Month') and c.div_no='Division' and c.rgn_no='Region' 
	and c.zone_no='Zone') A group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C group by C.loc_no,C.loc_nm order by c.loc_no) y
	on x.loc_nm=y.loc_nm order by x.zone_no,x.ar_no,x.loc_no) g group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y group by y.zone_no order by y.zone_no) sms_hrs,
	(select y.zone_no,NVL(SUM(ROUND(((ROUND(((y.PLN_HRS_MPZ*100)/25),2)*25)/100),2)),0) as PLN_HRS_TOT_MPZ from 
	(select g.zone_no,g.ar_no,ROUND(sum(g.PLN_HRS_MPG),2) as PLN_HRS_MPZ from 
	(select f.zone_no,f.ar_no,f.loc_nm,NVL(e.PLN_HOURS_MPS,0) as PLN_HRS_MPG from 
	(select div_no,rgn_no,zone_no,ar_no,loc_no,loc_nm from ww_wlp.loc where div_no='Division' and rgn_no='Region' and zone_no='Zone' 
	order by div_no,rgn_no,zone_no,ar_no,loc_no) f 
	LEFT OUTER JOIN 
	(select d.loc_no,d.loc_nm,sum(d.plan_paid_hours) as PLN_HOURS_MPS from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,nvl(a.plan_paid_hours,0) as plan_paid_hours 
	from ww_wlp.mnth_fcst a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.div_no='Division' and c.rgn_no='Region' and c.zone_no='Zone' and a.wk_id=b.wk_id and 
	b.perd_desc in ('Month') and DEPT_NO NOT IN (20)) d  group by d.loc_no,d.loc_nm order 
	by d.loc_no) e on e.loc_nm=f.loc_nm order by f.zone_no,f.ar_no,f.loc_no) g group by g.zone_no,g.ar_no order by g.zone_no,g.ar_no) y
	group by y.zone_no order by y.zone_no) pln_hrs where sms_hrs.zone_no=pln_hrs.zone_no order by sms_hrs.zone_no]]>
	</ForecastORTotal>
</TCName>
<TCName name = "PlannedBDGTRateandFCSTRateCurrentMonth" >
	<PlannedBudgetRate>
	<![CDATA[select rslt.ar_no,NVL(ROUND(sum(rslt.OVERSPENT_BDGT_RATE_MPS),0),0) as OVERSPENT_BDGT_RATE_MPZ from 
(select src.div_no,src.rgn_no,src.zone_no,src.ar_no,src.loc_nm,src.wk_id,
case 
when src.PLN_SLS_MPS > src.BDGT_SLS_MPS 
then NVL(ROUND((src.PLN_WGE_MPS - ((((src.PST_FACTOR_MPS * (src.BDGT_WGE_PCT_MPS/100)) * (src.PLN_SLS_MPS - src.BDGT_SLS_MPS)) + src.BDGT_WGE_MPS))),0),0)
When src.PLN_SLS_MPS < src.BDGT_SLS_MPS 
then NVL(ROUND((src.PLN_WGE_MPS - ((((src.NGT_FACTOR_MPS * (src.BDGT_WGE_PCT_MPS/100)) * (src.PLN_SLS_MPS - src.BDGT_SLS_MPS)) + src.BDGT_WGE_MPS))),0),0)
else NVL(ROUND((src.PLN_WGE_MPS - src.BDGT_WGE_MPS),0),0)
end as OVERSPENT_BDGT_RATE_MPS from 

(select a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.wk_id, 
a.PLN_WGE_MPS,b.pst_factor_MPS,b.ngt_factor_MPS,c.bdgt_wge_pct_MPS,d.PLN_SLS_MPS,c.BDGT_WGE_MPS,C.BDGT_SLS_MPS from

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,pln_wge.wk_id,pln_wge.PLN_WGE_MPS from 
(select div_no,rgn_no,zone_no,ar_no,loc_nm from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')
order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc 
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WGE_MPS from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f
LEFT OUTER JOIN 
(select * from (select d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
group by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id 
order by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id) 
UNION 
select * from (select d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month')
and DEPT_NO NOT IN (20)) d 
where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and c.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
group by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id 
order by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id)) e 
on e.wk_id=f.wk_id 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id) pln_wge
on lc.div_no=pln_wge.div_no and lc.rgn_no=pln_wge.rgn_no and lc.zone_no=pln_wge.zone_no and lc.ar_no=pln_wge.ar_no and lc.loc_nm=pln_wge.loc_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,pln_wge.wk_id) a,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_MPS,NVL(src.ngt_factor,1) as NGT_FACTOR_MPS from 
(select perd_desc,wk_id from wk where perd_desc in ('Month')) lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where perd_desc in ('Month')) and rgn_no in (99,'Region') group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) b,

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,bdgt_wge_pct.wk_id,
bdgt_wge_pct.BDGT_WGE_MPS,bdgt_wge_pct.BDGT_SLS_MPS,bdgt_wge_pct.BDGT_WGE_PCT_MPS from 
(select div_no,rgn_no,zone_no,ar_no,loc_nm from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')
order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc 
LEFT OUTER JOIN
(select h.div_no,h.rgn_no,h.zone_no,h.ar_no,h.loc_nm,h.wk_id,
NVL(ROUND(h.bdgt_wage_mnth_str,0),0) as BDGT_WGE_MPS,NVL(ROUND(i.bdgt_sls_mnth_str,0),0) as BDGT_SLS_MPS,
case when NVL(h.bdgt_wage_mnth_str,0)=0 and NVL(i.bdgt_sls_mnth_str,0)=0 then 0 
when NVL(h.bdgt_wage_mnth_str,0)=0 then 0 when NVL(i.bdgt_sls_mnth_str,0)=0 then 0 
else ROUND((h.bdgt_wage_mnth_str / i.bdgt_sls_mnth_str)*100,2) end as BDGT_WGE_PCT_MPS from 
(select g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.perd_desc,f.wk_id,NVL(g.bdgt_wages_mnth_str,0) as bdgt_wage_mnth_str from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f 
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(BDGT_WAGE),0) as BDGT_WAGES_MNTH_STR from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,
ROUND(sum(bdgt_sls),0) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) and a.loc_no=b.loc_no 
and a.wk_id=d.wk_id and a.dept_no NOT IN (20) 
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,d.perd_desc,a.wk_id) C 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_no,c.loc_nm,c.perd_desc,C.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,c.wk_id) g 
on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id 
order by g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.wk_id) h
INNER JOIN 
(select g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.perd_desc,f.wk_id,NVL(g.BDGT_SALES_MNTH_STR,0) as BDGT_SLS_MNTH_STR from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f 
LEFT OUTER JOIN 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(BDGT_SALES),0) as BDGT_SALES_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,
ROUND(sum(bdgt_sls),0) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) 
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,d.perd_desc,a.wk_id) C 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_no,c.loc_nm,c.perd_desc,C.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,c.wk_id) g
on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id 
order by g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.wk_id) i 
on h.div_no=i.div_no and h.rgn_no=i.rgn_no and h.zone_no=i.zone_no and h.ar_no=i.ar_no and h.loc_nm=i.loc_nm 
and h.perd_desc=i.perd_desc and h.wk_id=i.wk_id 
order by h.div_no,h.rgn_no,h.zone_no,h.ar_no,h.loc_nm,h.wk_id) bdgt_wge_pct
on lc.div_no=bdgt_wge_pct.div_no and lc.rgn_no=bdgt_wge_pct.rgn_no and lc.zone_no=bdgt_wge_pct.zone_no 
and lc.ar_no=bdgt_wge_pct.ar_no and lc.loc_nm=bdgt_wge_pct.loc_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,bdgt_wge_pct.wk_id) c,

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,pln_sls.wk_id,pln_sls.PLN_SLS_MPS from 
(select div_no,rgn_no,zone_no,ar_no,loc_nm from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')
order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc 
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id,NVL(e.PLAN_SALES,0) as PLN_SLS_MPS from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
LEFT OUTER JOIN 
(select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES 
from ww_wlp.mgr_wky_pln a,wk b, loc c 
where a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,b.perd_desc,a.wk_id) c 
UNION 
select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES 
from ww_wlp.fcst a,wk b, loc c 
where a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.dept_no NOT IN (0,20,90) 
and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
and (a.loc_no,b.wk_id) NOT IN (select loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' 
and loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone'))
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,b.perd_desc,b.wk_id) d) e 
on f.perd_desc=e.perd_desc and f.wk_id=e.wk_id 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id) pln_sls
on lc.div_no=pln_sls.div_no and lc.rgn_no=pln_sls.rgn_no and lc.zone_no=pln_sls.zone_no and lc.ar_no=pln_sls.ar_no and lc.loc_nm=pln_sls.loc_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,pln_sls.wk_id) d

where a.div_no=c.div_no and a.div_no=d.div_no and c.div_no=d.div_no
and a.rgn_no=c.rgn_no and a.rgn_no=d.rgn_no and c.rgn_no=d.rgn_no-- and a.rgn_no=b.rgn_no 
and a.zone_no=c.zone_no and a.zone_no=d.zone_no and c.zone_no=d.zone_no
and a.ar_no=c.ar_no and a.ar_no=d.ar_no and c.ar_no=d.ar_no
and a.loc_nm=c.loc_nm and a.loc_nm=d.loc_nm and c.loc_nm=d.loc_nm
and a.wk_id=c.wk_id and a.wk_id=d.wk_id and c.wk_id=d.wk_id and a.wk_id=b.wk_id
order by a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.wk_id) src
order by src.div_no,src.rgn_no,src.zone_no,src.ar_no,src.loc_nm,src.wk_id) rslt
group by rslt.ar_no order by rslt.ar_no]]>
	</PlannedBudgetRate>
	<PlannedBudgetRateTotal>
	<![CDATA[select rslt.zone_no,NVL(ROUND(sum(rslt.OVERSPENT_BDGT_RATE_MPS),0),0) as OVERSPENT_BDGT_RATE_TOT_MPZ from 
(select src.div_no,src.rgn_no,src.zone_no,src.ar_no,src.loc_nm,src.wk_id,
case 
when src.PLN_SLS_MPS > src.BDGT_SLS_MPS 
then NVL(ROUND((src.PLN_WGE_MPS - ((((src.PST_FACTOR_MPS * (src.BDGT_WGE_PCT_MPS/100)) * (src.PLN_SLS_MPS - src.BDGT_SLS_MPS)) + src.BDGT_WGE_MPS))),0),0)
When src.PLN_SLS_MPS < src.BDGT_SLS_MPS 
then NVL(ROUND((src.PLN_WGE_MPS - ((((src.NGT_FACTOR_MPS * (src.BDGT_WGE_PCT_MPS/100)) * (src.PLN_SLS_MPS - src.BDGT_SLS_MPS)) + src.BDGT_WGE_MPS))),0),0)
else NVL(ROUND((src.PLN_WGE_MPS - src.BDGT_WGE_MPS),0),0)
end as OVERSPENT_BDGT_RATE_MPS from 

(select a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.wk_id, 
a.PLN_WGE_MPS,b.pst_factor_MPS,b.ngt_factor_MPS,c.bdgt_wge_pct_MPS,d.PLN_SLS_MPS,c.BDGT_WGE_MPS,C.BDGT_SLS_MPS from

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,pln_wge.wk_id,pln_wge.PLN_WGE_MPS from 
(select div_no,rgn_no,zone_no,ar_no,loc_nm from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')
order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc 
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WGE_MPS from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f
LEFT OUTER JOIN 
(select * from (select d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
group by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id 
order by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id) 
UNION 
select * from (select d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month')
and DEPT_NO NOT IN (20)) d 
where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and c.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
group by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id 
order by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id)) e 
on e.wk_id=f.wk_id 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id) pln_wge
on lc.div_no=pln_wge.div_no and lc.rgn_no=pln_wge.rgn_no and lc.zone_no=pln_wge.zone_no and lc.ar_no=pln_wge.ar_no and lc.loc_nm=pln_wge.loc_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,pln_wge.wk_id) a,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_MPS,NVL(src.ngt_factor,1) as NGT_FACTOR_MPS from 
(select perd_desc,wk_id from wk where perd_desc in ('Month')) lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where perd_desc in ('Month')) and rgn_no in (99,'Region') group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) b,

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,bdgt_wge_pct.wk_id,
bdgt_wge_pct.BDGT_WGE_MPS,bdgt_wge_pct.BDGT_SLS_MPS,bdgt_wge_pct.BDGT_WGE_PCT_MPS from 
(select div_no,rgn_no,zone_no,ar_no,loc_nm from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')
order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc 
LEFT OUTER JOIN
(select h.div_no,h.rgn_no,h.zone_no,h.ar_no,h.loc_nm,h.wk_id,
NVL(ROUND(h.bdgt_wage_mnth_str,0),0) as BDGT_WGE_MPS,NVL(ROUND(i.bdgt_sls_mnth_str,0),0) as BDGT_SLS_MPS,
case when NVL(h.bdgt_wage_mnth_str,0)=0 and NVL(i.bdgt_sls_mnth_str,0)=0 then 0 
when NVL(h.bdgt_wage_mnth_str,0)=0 then 0 when NVL(i.bdgt_sls_mnth_str,0)=0 then 0 
else ROUND((h.bdgt_wage_mnth_str / i.bdgt_sls_mnth_str)*100,2) end as BDGT_WGE_PCT_MPS from 
(select g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.perd_desc,f.wk_id,NVL(g.bdgt_wages_mnth_str,0) as bdgt_wage_mnth_str from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f 
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(BDGT_WAGE),0) as BDGT_WAGES_MNTH_STR from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,
ROUND(sum(bdgt_sls),0) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) and a.loc_no=b.loc_no 
and a.wk_id=d.wk_id and a.dept_no NOT IN (20) 
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,d.perd_desc,a.wk_id) C 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_no,c.loc_nm,c.perd_desc,C.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,c.wk_id) g 
on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id 
order by g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.wk_id) h
INNER JOIN 
(select g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.perd_desc,f.wk_id,NVL(g.BDGT_SALES_MNTH_STR,0) as BDGT_SLS_MNTH_STR from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f 
LEFT OUTER JOIN 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(BDGT_SALES),0) as BDGT_SALES_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,
ROUND(sum(bdgt_sls),0) as BDGT_SALES, sum(bdgt_wage_amt) as BDGT_WAGE 
from WW_WLP.wky_bdgt a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) 
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,d.perd_desc,a.wk_id) C 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_no,c.loc_nm,c.perd_desc,C.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,c.wk_id) g
on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id 
order by g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.wk_id) i 
on h.div_no=i.div_no and h.rgn_no=i.rgn_no and h.zone_no=i.zone_no and h.ar_no=i.ar_no and h.loc_nm=i.loc_nm 
and h.perd_desc=i.perd_desc and h.wk_id=i.wk_id 
order by h.div_no,h.rgn_no,h.zone_no,h.ar_no,h.loc_nm,h.wk_id) bdgt_wge_pct
on lc.div_no=bdgt_wge_pct.div_no and lc.rgn_no=bdgt_wge_pct.rgn_no and lc.zone_no=bdgt_wge_pct.zone_no 
and lc.ar_no=bdgt_wge_pct.ar_no and lc.loc_nm=bdgt_wge_pct.loc_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,bdgt_wge_pct.wk_id) c,

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,pln_sls.wk_id,pln_sls.PLN_SLS_MPS from 
(select div_no,rgn_no,zone_no,ar_no,loc_nm from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')
order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc 
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id,NVL(e.PLAN_SALES,0) as PLN_SLS_MPS from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
LEFT OUTER JOIN 
(select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES 
from ww_wlp.mgr_wky_pln a,wk b, loc c 
where a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,b.perd_desc,a.wk_id) c 
UNION 
select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES 
from ww_wlp.fcst a,wk b, loc c 
where a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.dept_no NOT IN (0,20,90) 
and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
and (a.loc_no,b.wk_id) NOT IN (select loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' 
and loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone'))
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,b.perd_desc,b.wk_id) d) e 
on f.perd_desc=e.perd_desc and f.wk_id=e.wk_id 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id) pln_sls
on lc.div_no=pln_sls.div_no and lc.rgn_no=pln_sls.rgn_no and lc.zone_no=pln_sls.zone_no and lc.ar_no=pln_sls.ar_no and lc.loc_nm=pln_sls.loc_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,pln_sls.wk_id) d

where a.div_no=c.div_no and a.div_no=d.div_no and c.div_no=d.div_no
and a.rgn_no=c.rgn_no and a.rgn_no=d.rgn_no and c.rgn_no=d.rgn_no-- and a.rgn_no=b.rgn_no 
and a.zone_no=c.zone_no and a.zone_no=d.zone_no and c.zone_no=d.zone_no
and a.ar_no=c.ar_no and a.ar_no=d.ar_no and c.ar_no=d.ar_no
and a.loc_nm=c.loc_nm and a.loc_nm=d.loc_nm and c.loc_nm=d.loc_nm
and a.wk_id=c.wk_id and a.wk_id=d.wk_id and c.wk_id=d.wk_id and a.wk_id=b.wk_id
order by a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.wk_id) src
order by src.div_no,src.rgn_no,src.zone_no,src.ar_no,src.loc_nm,src.wk_id) rslt
group by rslt.zone_no order by rslt.zone_no]]>
	</PlannedBudgetRateTotal>
	<PlannedForecsatRate>
	<![CDATA[select rslt.ar_no,NVL(ROUND(sum(rslt.OVERSPENT_FRCST_RATE_MPS),0),0) as OVERSPENT_FRCST_RATE_MPZ from 
(select src.div_no,src.rgn_no,src.zone_no,src.ar_no,src.loc_nm,src.wk_id,
case 
when src.PLN_SLS_MPS > src.FRCST_SLS_MPS 
then NVL(ROUND((src.PLN_WGE_MPS - ((((src.PST_FACTOR_MPS * (src.FRCST_WGE_PCT_MPS/100)) * (src.PLN_SLS_MPS - src.FRCST_SLS_MPS)) + src.FRCST_WGE_MPS))),0),0)
When src.PLN_SLS_MPS < src.FRCST_SLS_MPS 
then NVL(ROUND((src.PLN_WGE_MPS - ((((src.NGT_FACTOR_MPS * (src.FRCST_WGE_PCT_MPS/100)) * (src.PLN_SLS_MPS - src.FRCST_SLS_MPS)) + src.FRCST_WGE_MPS))),0),0)
else NVL(ROUND((src.PLN_WGE_MPS - src.FRCST_WGE_MPS),0),0)
end as OVERSPENT_FRCST_RATE_MPS from 

(select a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.wk_id, 
a.PLN_WGE_MPS,b.pst_factor_MPS,b.ngt_factor_MPS,c.FRCST_wge_pct_MPS,d.PLN_SLS_MPS,c.FRCST_WGE_MPS,C.FRCST_SLS_MPS from

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,pln_wge.wk_id,pln_wge.PLN_WGE_MPS from 
(select div_no,rgn_no,zone_no,ar_no,loc_nm from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')
order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc 
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WGE_MPS from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f
LEFT OUTER JOIN 
(select * from (select d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
group by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id 
order by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id) 
UNION 
select * from (select d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month')
and DEPT_NO NOT IN (20)) d 
where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and c.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
group by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id 
order by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id)) e 
on e.wk_id=f.wk_id 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id) pln_wge
on lc.div_no=pln_wge.div_no and lc.rgn_no=pln_wge.rgn_no and lc.zone_no=pln_wge.zone_no and lc.ar_no=pln_wge.ar_no and lc.loc_nm=pln_wge.loc_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,pln_wge.wk_id) a,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_MPS,NVL(src.ngt_factor,1) as NGT_FACTOR_MPS from 
(select perd_desc,wk_id from wk where perd_desc in ('Month')) lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where perd_desc in ('Month')) and rgn_no in (99,'Region') group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) b,

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,FRCST_wge_pct.wk_id,
FRCST_wge_pct.FRCST_WGE_MPS,FRCST_wge_pct.FRCST_SLS_MPS,FRCST_wge_pct.FRCST_WGE_PCT_MPS from 
(select div_no,rgn_no,zone_no,ar_no,loc_nm from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')
order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc 
LEFT OUTER JOIN
(select h.div_no,h.rgn_no,h.zone_no,h.ar_no,h.loc_nm,h.wk_id,
NVL(ROUND(h.FRCST_wage_mnth_str,0),0) as FRCST_WGE_MPS,NVL(ROUND(i.FRCST_sls_mnth_str,0),0) as FRCST_SLS_MPS,
case when NVL(h.FRCST_wage_mnth_str,0)=0 and NVL(i.FRCST_sls_mnth_str,0)=0 then 0 
when NVL(h.FRCST_wage_mnth_str,0)=0 then 0 when NVL(i.FRCST_sls_mnth_str,0)=0 then 0 
else ROUND((h.FRCST_wage_mnth_str / i.FRCST_sls_mnth_str)*100,2) end as FRCST_WGE_PCT_MPS from 
(select g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.perd_desc,f.wk_id,NVL(g.FRCST_wages_mnth_str,0) as FRCST_wage_mnth_str from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f 
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(FRCST_WAGE),0) as FRCST_WAGES_MNTH_STR from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,
ROUND(sum(FRCST_sls),0) as FRCST_SALES, sum(FRCST_wage_amt) as FRCST_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) and a.loc_no=b.loc_no 
and a.wk_id=d.wk_id and a.dept_no NOT IN (20) 
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,d.perd_desc,a.wk_id) C 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_no,c.loc_nm,c.perd_desc,C.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,c.wk_id) g 
on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id 
order by g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.wk_id) h
INNER JOIN 
(select g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.perd_desc,f.wk_id,NVL(g.FRCST_SALES_MNTH_STR,0) as FRCST_SLS_MNTH_STR from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f 
LEFT OUTER JOIN 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(FRCST_SALES),0) as FRCST_SALES_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,
ROUND(sum(FRCST_sls),0) as FRCST_SALES, sum(FRCST_wage_amt) as FRCST_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) 
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,d.perd_desc,a.wk_id) C 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_no,c.loc_nm,c.perd_desc,C.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,c.wk_id) g
on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id 
order by g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.wk_id) i 
on h.div_no=i.div_no and h.rgn_no=i.rgn_no and h.zone_no=i.zone_no and h.ar_no=i.ar_no and h.loc_nm=i.loc_nm 
and h.perd_desc=i.perd_desc and h.wk_id=i.wk_id 
order by h.div_no,h.rgn_no,h.zone_no,h.ar_no,h.loc_nm,h.wk_id) FRCST_wge_pct
on lc.div_no=FRCST_wge_pct.div_no and lc.rgn_no=FRCST_wge_pct.rgn_no and lc.zone_no=FRCST_wge_pct.zone_no 
and lc.ar_no=FRCST_wge_pct.ar_no and lc.loc_nm=FRCST_wge_pct.loc_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,FRCST_wge_pct.wk_id) c,

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,pln_sls.wk_id,pln_sls.PLN_SLS_MPS from 
(select div_no,rgn_no,zone_no,ar_no,loc_nm from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')
order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc 
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id,NVL(e.PLAN_SALES,0) as PLN_SLS_MPS from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
LEFT OUTER JOIN 
(select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES 
from ww_wlp.mgr_wky_pln a,wk b, loc c 
where a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,b.perd_desc,a.wk_id) c 
UNION 
select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES 
from ww_wlp.fcst a,wk b, loc c 
where a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.dept_no NOT IN (0,20,90) 
and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
and (a.loc_no,b.wk_id) NOT IN (select loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' 
and loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone'))
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,b.perd_desc,b.wk_id) d) e 
on f.perd_desc=e.perd_desc and f.wk_id=e.wk_id 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id) pln_sls
on lc.div_no=pln_sls.div_no and lc.rgn_no=pln_sls.rgn_no and lc.zone_no=pln_sls.zone_no and lc.ar_no=pln_sls.ar_no and lc.loc_nm=pln_sls.loc_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,pln_sls.wk_id) d

where a.div_no=c.div_no and a.div_no=d.div_no and c.div_no=d.div_no
and a.rgn_no=c.rgn_no and a.rgn_no=d.rgn_no and c.rgn_no=d.rgn_no-- and a.rgn_no=b.rgn_no 
and a.zone_no=c.zone_no and a.zone_no=d.zone_no and c.zone_no=d.zone_no
and a.ar_no=c.ar_no and a.ar_no=d.ar_no and c.ar_no=d.ar_no
and a.loc_nm=c.loc_nm and a.loc_nm=d.loc_nm and c.loc_nm=d.loc_nm
and a.wk_id=c.wk_id and a.wk_id=d.wk_id and c.wk_id=d.wk_id and a.wk_id=b.wk_id
order by a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.wk_id) src
order by src.div_no,src.rgn_no,src.zone_no,src.ar_no,src.loc_nm,src.wk_id) rslt
group by rslt.ar_no order by rslt.ar_no]]>
	</PlannedForecsatRate>
	<PlannedForecsatRateTotal>
	<![CDATA[select rslt.zone_no,NVL(ROUND(sum(rslt.OVERSPENT_FRCST_RATE_MPS),0),0) as OVERSPENT_FRCST_RATE_TOT_MPZ from 
(select src.div_no,src.rgn_no,src.zone_no,src.ar_no,src.loc_nm,src.wk_id,
case 
when src.PLN_SLS_MPS > src.FRCST_SLS_MPS 
then NVL(ROUND((src.PLN_WGE_MPS - ((((src.PST_FACTOR_MPS * (src.FRCST_WGE_PCT_MPS/100)) * (src.PLN_SLS_MPS - src.FRCST_SLS_MPS)) + src.FRCST_WGE_MPS))),0),0)
When src.PLN_SLS_MPS < src.FRCST_SLS_MPS 
then NVL(ROUND((src.PLN_WGE_MPS - ((((src.NGT_FACTOR_MPS * (src.FRCST_WGE_PCT_MPS/100)) * (src.PLN_SLS_MPS - src.FRCST_SLS_MPS)) + src.FRCST_WGE_MPS))),0),0)
else NVL(ROUND((src.PLN_WGE_MPS - src.FRCST_WGE_MPS),0),0)
end as OVERSPENT_FRCST_RATE_MPS from 

(select a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.wk_id, 
a.PLN_WGE_MPS,b.pst_factor_MPS,b.ngt_factor_MPS,c.FRCST_wge_pct_MPS,d.PLN_SLS_MPS,c.FRCST_WGE_MPS,C.FRCST_SLS_MPS from

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,pln_wge.wk_id,pln_wge.PLN_WGE_MPS from 
(select div_no,rgn_no,zone_no,ar_no,loc_nm from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')
order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc 
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id,NVL(e.PLN_WAGE_MNTH_PLN_STR,0) as PLN_WGE_MPS from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc in ('Month')) f
LEFT OUTER JOIN 
(select * from (select d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
group by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id 
order by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id) 
UNION 
select * from (select d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MNTH_PLN_STR from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c 
where a.loc_no=c.loc_no and c.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month')
and DEPT_NO NOT IN (20)) d 
where (d.loc_no,d.wk_id) NOT IN (select a.loc_no,a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no 
and c.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
group by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id 
order by d.div_no,d.rgn_no,d.zone_no,d.ar_no,d.loc_nm,d.wk_id)) e 
on e.wk_id=f.wk_id 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id) pln_wge
on lc.div_no=pln_wge.div_no and lc.rgn_no=pln_wge.rgn_no and lc.zone_no=pln_wge.zone_no and lc.ar_no=pln_wge.ar_no and lc.loc_nm=pln_wge.loc_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,pln_wge.wk_id) a,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_MPS,NVL(src.ngt_factor,1) as NGT_FACTOR_MPS from 
(select perd_desc,wk_id from wk where perd_desc in ('Month')) lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where perd_desc in ('Month')) and rgn_no in (99,'Region') group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) b,

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,FRCST_wge_pct.wk_id,
FRCST_wge_pct.FRCST_WGE_MPS,FRCST_wge_pct.FRCST_SLS_MPS,FRCST_wge_pct.FRCST_WGE_PCT_MPS from 
(select div_no,rgn_no,zone_no,ar_no,loc_nm from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')
order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc 
LEFT OUTER JOIN
(select h.div_no,h.rgn_no,h.zone_no,h.ar_no,h.loc_nm,h.wk_id,
NVL(ROUND(h.FRCST_wage_mnth_str,0),0) as FRCST_WGE_MPS,NVL(ROUND(i.FRCST_sls_mnth_str,0),0) as FRCST_SLS_MPS,
case when NVL(h.FRCST_wage_mnth_str,0)=0 and NVL(i.FRCST_sls_mnth_str,0)=0 then 0 
when NVL(h.FRCST_wage_mnth_str,0)=0 then 0 when NVL(i.FRCST_sls_mnth_str,0)=0 then 0 
else ROUND((h.FRCST_wage_mnth_str / i.FRCST_sls_mnth_str)*100,2) end as FRCST_WGE_PCT_MPS from 
(select g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.perd_desc,f.wk_id,NVL(g.FRCST_wages_mnth_str,0) as FRCST_wage_mnth_str from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f 
LEFT OUTER JOIN
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(FRCST_WAGE),0) as FRCST_WAGES_MNTH_STR from 
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,
ROUND(sum(FRCST_sls),0) as FRCST_SALES, sum(FRCST_wage_amt) as FRCST_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) and a.loc_no=b.loc_no 
and a.wk_id=d.wk_id and a.dept_no NOT IN (20) 
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,d.perd_desc,a.wk_id) C 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_no,c.loc_nm,c.perd_desc,C.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,c.wk_id) g 
on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id 
order by g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.wk_id) h
INNER JOIN 
(select g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.perd_desc,f.wk_id,NVL(g.FRCST_SALES_MNTH_STR,0) as FRCST_SLS_MNTH_STR from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f 
LEFT OUTER JOIN 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,C.loc_no,c.loc_nm,C.perd_desc,c.wk_id,ROUND(sum(FRCST_SALES),0) as FRCST_SALES_MNTH_STR from
(select a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id,
ROUND(sum(FRCST_sls),0) as FRCST_SALES, sum(FRCST_wage_amt) as FRCST_WAGE 
from WW_WLP.mnth_fcst a,loc b, wk d 
where a.wk_id in (select wk_id from ww_wlp.wk where perd_desc in ('Month')) 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.loc_no=b.loc_no and a.wk_id=d.wk_id and a.dept_no NOT IN (0,20,90) 
group by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.perd_desc,a.wk_id 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,d.perd_desc,a.wk_id) C 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_no,c.loc_nm,c.perd_desc,C.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,c.wk_id) g
on f.perd_desc=g.perd_desc and f.wk_id=g.wk_id 
order by g.div_no,g.rgn_no,g.zone_no,g.ar_no,g.loc_nm,f.wk_id) i 
on h.div_no=i.div_no and h.rgn_no=i.rgn_no and h.zone_no=i.zone_no and h.ar_no=i.ar_no and h.loc_nm=i.loc_nm 
and h.perd_desc=i.perd_desc and h.wk_id=i.wk_id 
order by h.div_no,h.rgn_no,h.zone_no,h.ar_no,h.loc_nm,h.wk_id) FRCST_wge_pct
on lc.div_no=FRCST_wge_pct.div_no and lc.rgn_no=FRCST_wge_pct.rgn_no and lc.zone_no=FRCST_wge_pct.zone_no 
and lc.ar_no=FRCST_wge_pct.ar_no and lc.loc_nm=FRCST_wge_pct.loc_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,FRCST_wge_pct.wk_id) c,

(select lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,pln_sls.wk_id,pln_sls.PLN_SLS_MPS from 
(select div_no,rgn_no,zone_no,ar_no,loc_nm from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')
order by div_no,rgn_no,zone_no,ar_no,loc_nm) lc 
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id,NVL(e.PLAN_SALES,0) as PLN_SLS_MPS from 
(select perd_desc,wk_id from ww_wlp.wk where perd_desc='Month') f
LEFT OUTER JOIN 
(select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES 
from ww_wlp.mgr_wky_pln a,wk b, loc c 
where a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,b.perd_desc,a.wk_id) c 
UNION 
select * from (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES 
from ww_wlp.fcst a,wk b, loc c 
where a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' 
and a.loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone')) 
and a.dept_no NOT IN (0,20,90) 
and a.fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' 
and (a.loc_no,b.wk_id) NOT IN (select loc_no,wk_id from ww_wlp.mgr_wky_pln where div_no='Division' 
and loc_no in (select loc_no from loc where div_no='Division' and rgn_no in ('Region') and zone_no in ('Zone'))
and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id 
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,c.loc_nm,b.perd_desc,b.wk_id) d) e 
on f.perd_desc=e.perd_desc and f.wk_id=e.wk_id 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,f.wk_id) pln_sls
on lc.div_no=pln_sls.div_no and lc.rgn_no=pln_sls.rgn_no and lc.zone_no=pln_sls.zone_no and lc.ar_no=pln_sls.ar_no and lc.loc_nm=pln_sls.loc_nm
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,lc.loc_nm,pln_sls.wk_id) d

where a.div_no=c.div_no and a.div_no=d.div_no and c.div_no=d.div_no
and a.rgn_no=c.rgn_no and a.rgn_no=d.rgn_no and c.rgn_no=d.rgn_no-- and a.rgn_no=b.rgn_no 
and a.zone_no=c.zone_no and a.zone_no=d.zone_no and c.zone_no=d.zone_no
and a.ar_no=c.ar_no and a.ar_no=d.ar_no and c.ar_no=d.ar_no
and a.loc_nm=c.loc_nm and a.loc_nm=d.loc_nm and c.loc_nm=d.loc_nm
and a.wk_id=c.wk_id and a.wk_id=d.wk_id and c.wk_id=d.wk_id and a.wk_id=b.wk_id
order by a.div_no,a.rgn_no,a.zone_no,a.ar_no,a.loc_nm,a.wk_id) src
order by src.div_no,src.rgn_no,src.zone_no,src.ar_no,src.loc_nm,src.wk_id) rslt
group by rslt.zone_no order by rslt.zone_no]]>
	</PlannedForecsatRateTotal>
</TCName>
<TCName name = "PlannedBDGTRate_CurrentMonth" >
	<PositiveFactorTotal>
	<![CDATA[select PST_FACTOR_MPS from 
(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_MPS,NVL(src.ngt_factor,1) as NGT_FACTOR_MPS from 
(select perd_desc,wk_id from wk where perd_desc in ('Month')) lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where perd_desc in ('Month')) and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) order by wk_id]]>
	</PositiveFactorTotal>
<NegativeFactorTotal>
	<![CDATA[select NGT_FACTOR_MPS from 
(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_MPS,NVL(src.ngt_factor,1) as NGT_FACTOR_MPS from 
(select perd_desc,wk_id from wk where perd_desc in ('Month')) lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where perd_desc in ('Month')) and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) order by wk_id]]>
	</NegativeFactorTotal>	
</TCName>

<TCName name = "SalesHistoryFirstMonth_WeekData" >
	<SalesHistoryWeekData>
	<![CDATA[]]>
	</SalesHistoryWeekData>
	
</TCName>

<TCName name = "SalesHistorySecondMonth_WeekData" >
	<SalesHistoryWeekData>
	<![CDATA[]]>
	</SalesHistoryWeekData>
	
</TCName>

<TCName name = "SalesHistoryThirdMonth_WeekData" >
	<SalesHistoryWeekData>
	<![CDATA[]]>
	</SalesHistoryWeekData>
	
</TCName>

<TCName name = "SalesHistoryFourthMonth_WeekData" >
	<SalesHistoryWeekData>
	<![CDATA[]]>
	</SalesHistoryWeekData>
	
</TCName>

<TCName name = "WagesHistoryFirsthMonth_WeekData" >
	<WagesHistoryWeekData>
	<![CDATA[]]>
	</WagesHistoryWeekData>
	
</TCName>

<TCName name = "WagesHistorySecondMonth_WeekData" >
	<WagesHistoryWeekData>
	<![CDATA[]]>
	</WagesHistoryWeekData>
	
</TCName>

<TCName name = "WagesHistoryThirdMonth_WeekData" >
	<WagesHistoryWeekData>
	<![CDATA[]]>
	</WagesHistoryWeekData>
	
</TCName>

<TCName name = "WagesHistoryFourthMonth_WeekData" >
	<WagesHistoryWeekData>
	<![CDATA[]]>
	</WagesHistoryWeekData>
	
</TCName>

<TCName name = "ItemsHistoryFirsthMonth_WeekData" >
	<ItemsHistoryWeekData>
	<![CDATA[]]>
	</ItemsHistoryWeekData>
	
</TCName>

<TCName name = "ItemsHistorySecondMonth_WeekData" >
	<ItemsHistoryWeekData>
	<![CDATA[]]>
	</ItemsHistoryWeekData>
	
</TCName>

<TCName name = "ItemsHistoryThirdMonth_WeekData" >
	<ItemsHistoryWeekData>
	<![CDATA[]]>
	</ItemsHistoryWeekData>
	
</TCName>

<TCName name = "ItemsHistoryFourthMonth_WeekData" >
	<ItemsHistoryWeekData>
	<![CDATA[]]>
	</ItemsHistoryWeekData>
	
</TCName>

<TCName name = "CustomersHistoryFirsthMonth_WeekData" >
	<CustomerHistoryWeekData>
	<![CDATA[]]>
	</CustomerHistoryWeekData>
	
</TCName>

<TCName name = "CustomersHistorySecondMonth_WeekData" >
	<CustomerHistoryWeekData>
	<![CDATA[]]>
	</CustomerHistoryWeekData>
	
</TCName>

<TCName name = "CustomersHistoryThirdMonth_WeekData" >
	<CustomerHistoryWeekData>
	<![CDATA[]]>
	</CustomerHistoryWeekData>
	
</TCName>

<TCName name = "CustomersHistoryFourthMonth_WeekData" >
	<CustomerHistoryWeekData>
	<![CDATA[]]>
	</CustomerHistoryWeekData>
	
</TCName>

<TCName name = "PaidHoursHistoryFirsthMonth_WeekData" >
	<PaidHoursHistoryWeekData>
	<![CDATA[]]>
	</PaidHoursHistoryWeekData>
	
</TCName>

<TCName name = "PaidHoursHistorySecondMonth_WeekData" >
	<PaidHoursHistoryWeekData>
	<![CDATA[]]>
	</PaidHoursHistoryWeekData>
	
</TCName>

<TCName name = "PaidHoursHistoryThirdMonth_WeekData" >
	<PaidHoursHistoryWeekData>
	<![CDATA[]]>
	</PaidHoursHistoryWeekData>
	
</TCName>

<TCName name = "PaidHoursHistoryFourthMonth_WeekData" >
	<PaidHoursHistoryWeekData>
	<![CDATA[]]>
	</PaidHoursHistoryWeekData>
	
</TCName>

<TCName name = "CPHFirsthMonth_WeekData" >
	<CPHHistoryWeekData>
	<![CDATA[]]>
	</CPHHistoryWeekData>
	
</TCName>

<TCName name = "CPHHistorySecondMonth_WeekData" >
	<CPHHistoryWeekData>
	<![CDATA[]]>
	</CPHHistoryWeekData>
	
</TCName>

<TCName name = "CPHHistoryThirdMonth_WeekData" >
	<CPHHistoryWeekData>
	<![CDATA[]]>
	</CPHHistoryWeekData>
	
</TCName>

<TCName name = "CPHHistoryFourthMonth_WeekData" >
	<CPHHistoryWeekData>
	<![CDATA[]]>
	</CPHHistoryWeekData>
	
</TCName>

<TCName name = "WagePercentageHistoryFirsthMonth_WeekData" >
<WagePercentageHistoryWeekData>
	<![CDATA[]]>
	</WagePercentageHistoryWeekData>
	
</TCName>

<TCName name = "WagePercentageHistorySecondMonth_WeekData" >
<WagePercentageHistoryWeekData>
	<![CDATA[]]>
	</WagePercentageHistoryWeekData>
	
</TCName>

<TCName name = "WagePercentageHistoryThirdMonth_WeekData" >
<WagePercentageHistoryWeekData>
	<![CDATA[]]>
	</WagePercentageHistoryWeekData>
	
</TCName>

<TCName name = "WagePercentageHistoryFourthMonth_WeekData" >
	<WagePercentageHistoryWeekData>
	<![CDATA[]]>
	</WagePercentageHistoryWeekData>
	
</TCName>

<TCName name = "ItemPriceHistoryFirsthMonth_WeekData" >
<ItemPriceHistoryWeekData>
	<![CDATA[]]>
	</ItemPriceHistoryWeekData>
	
</TCName>

<TCName name = "ItemPriceHistorySecondMonth_WeekData" >
	<ItemPriceHistoryWeekData>
	<![CDATA[]]>
	</ItemPriceHistoryWeekData>
	
</TCName>

<TCName name = "ItemPriceHistoryThirdMonth_WeekData" >
	<ItemPriceHistoryWeekData>
	<![CDATA[]]>
	</ItemPriceHistoryWeekData>
	
</TCName>

<TCName name = "ItemPriceHistoryFourthMonth_WeekData" >
	<ItemPriceHistoryWeekData>
	<![CDATA[]]>
	</ItemPriceHistoryWeekData>
	
</TCName>

<TCName name = "BudgetSales_CurrentMonth_WeekData">
	<BudgetSalesWeekData>
	<![CDATA[]]>
	</BudgetSalesWeekData>
	
	<ForecastSalesWeekData>
	<![CDATA[]]>
	</ForecastSalesWeekData>
	
</TCName>

<TCName name = "PlannedSales_CurrentMonth_WeekData">
	<PlannedSalesWeekData>
	<![CDATA[]]>
	</PlannedSalesWeekData>
	
</TCName>

<TCName name = "GeneratedSales_CurrentMonth_WeekData">
	<GeneratedSalesWeekData>
	<![CDATA[]]>
	</GeneratedSalesWeekData>
	
</TCName>

<TCName name = "VarToBUDSales_CurrentMonth_WeekData">
	<VartoBUDWeekData>
	<![CDATA[]]>
	</VartoBUDWeekData>
	
	<VartoFCSTWeekData>
	<![CDATA[]]>
	</VartoFCSTWeekData>
	
</TCName>

<TCName name = "BudgetWages_CurrentMonth_WeekData">
	<BudgetWagesWeekData>
	<![CDATA[]]>
	</BudgetWagesWeekData>
	
	<ForecastWagesWeekData>
	<![CDATA[]]>
	</ForecastWagesWeekData>
	
</TCName>

<TCName name = "BaseCostWages_CurrentMonth_WeekData">
	<BaseCostWeekData>
	<![CDATA[]]>
	</BaseCostWeekData>
	
</TCName>

<TCName name = "PlannedWages_CurrentMonth_WeekData">
	<PlannedWagesWeekDataWeekData>
	<![CDATA[]]>
	</PlannedWagesWeekDataWeekData>
	
</TCName>

<TCName name = "BudgetWagesPercentage_CurrentMonth_WeekData">
	<BudgetWagesPercentageWeekData>
	<![CDATA[ ]]>
	</BudgetWagesPercentageWeekData>
	
	<ForecastWagesPercentageWeekData>
	<![CDATA[]]>
	</ForecastWagesPercentageWeekData>
	
</TCName>

<TCName name = "PlannedWagesPercentage_CurrentMonth_WeekData">
	<PlannedWagesPercentageWeekData>
	<![CDATA[]]>
	</PlannedWagesPercentageWeekData>
	
</TCName>

<TCName name = "SMSHours_CurrentMonth_WeekData">
	<SMSHoursWeekData>
	<![CDATA[]]>
	</SMSHoursWeekData>
	
</TCName>

<TCName name = "BaseHours_CurrentMonth_WeekData">
	<BasehoursWeekData>
	<![CDATA[ ]]>
	</BasehoursWeekData>
	
</TCName>

<TCName name = "PlannedHours_CurrentMonth_WeekData">
	<PlannedHoursWeekData>
	<![CDATA[]]>
	</PlannedHoursWeekData>
	
</TCName>

<TCName name = "LYPercentageSales_CurrentMonth_WeekData">
	<LYPercentageSalesWeekData>
	<![CDATA[]]>
	</LYPercentageSalesWeekData>
	
</TCName>

<TCName name = "BudgetPercentageSales_CurrentMonth_WeekData">
	<BUDPercentageSalesWeekData>
	<![CDATA[]]>
	</BUDPercentageSalesWeekData>
	
	<FCSTPercentageSalesWeekData>
	<![CDATA[]]>
	</FCSTPercentageSalesWeekData>
	
</TCName>

<TCName name = "LYPercentageWages_CurrentMonth_WeekData">
	<LYPercentageWagesWeekData>
	<![CDATA[]]>
	</LYPercentageWagesWeekData>
	
</TCName>

<TCName name = "LYWagesPercentage_CurrentMonth_WeekData">
	<LYWagesPercentageWeekData>
	<![CDATA[]]>
	</LYWagesPercentageWeekData>
	
</TCName>

<TCName name = "LYPercentageHours_CurrentMonth_WeekData">
	<LYHoursWeekData>
	<![CDATA[]]>
	</LYHoursWeekData>
	
</TCName>

<TCName name = "PlannedCPH_CurrentMonth_WeekData">
	<PlannedCPHWeekData>
	<![CDATA[]]>
	</PlannedCPHWeekData>

</TCName>

<TCName name = "GrowthLYCPH_CurrentMonth_WeekData">
	<GrowthLYCPHWeekData>
	<![CDATA[]]>
	</GrowthLYCPHWeekData>
	
</TCName>

<TCName name = "PlannedOR_CurrentMonth_WeekData" >
	<PlannedORWeekData>
	<![CDATA[]]>
	</PlannedORWeekData>
	
</TCName>

<TCName name = "BGDT_FCST_OR_CurrentMonth_WeekData" >
	<BudgetORWeekData>
	<![CDATA[]]>
	</BudgetORWeekData>
	
	
	<ForecastORWeekData>
	<![CDATA[]]>
	</ForecastORWeekData>
	
</TCName>
<TCName name = "PlannedBDGTRateandFCSTRateCurrentMonth_WeekData" >
	<PlannedBudgetRateWeekData>
	<![CDATA[]]>
	</PlannedBudgetRateWeekData>
	
	<PlannedForecsatRateWeekData>
	<![CDATA[]]>
	</PlannedForecsatRateWeekData>
	
</TCName>

</configuration>