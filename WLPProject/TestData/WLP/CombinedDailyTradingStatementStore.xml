<?xml version="1.0" encoding="UTF-8"?>

<configuration>

<TCName name = "SalesColumnValidation" >
	<PlannedSalesTotal>
	<![CDATA[select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no]]>
	</PlannedSalesTotal>
	
	<ActualSalesTotal>
	<![CDATA[select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_SLS_DTS),0) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no]]>
	</ActualSalesTotal>
	
	<LYSalesTotal>
	<![CDATA[select actl_cy.loc_nm,
CASE WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
     WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
     WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
     WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
     WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
     WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
     WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
     WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_SLS_DTS),0) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl_cy,
(select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_SLS_DTS),0) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl_ly
where actl_cy.loc_nm=actl_ly.loc_nm]]>
	</LYSalesTotal>
	
	<PlannedSalesWkToDtTotal>
	<![CDATA[select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no]]>
	</PlannedSalesWkToDtTotal>
	
	<ActualSalesWkToDtTotal>
	<![CDATA[select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no]]>
	</ActualSalesWkToDtTotal>
		
	<LYSalesWkToDtTotal>
	<![CDATA[select lc.loc_nm,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100
     WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_TOT_DTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select cy_val.loc_nm,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) cy_val
LEFT OUTER JOIN
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) ly_val
on cy_val.loc_nm=ly_val.loc_nm 
group by cy_val.loc_nm) cyly_wtd
on cyly_wtd.loc_nm=lc.loc_nm]]>
	</LYSalesWkToDtTotal>
	
	<VarSalesWkToDtTotal>
	<![CDATA[select pln.loc_nm,ROUND((actl.wtd - pln.wtd),0) as VAR_SLS_WTD_DTSS from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) pln,
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl
where pln.loc_nm=actl.loc_nm]]>
	</VarSalesWkToDtTotal>
</TCName>

<TCName name = "SMSColumnValidation" >
	<PlannedSMSTotal>
	<![CDATA[select lc.loc_nm,sms.mon,sms.tue,sms.wed,sms.thu,sms.fri,sms.sat,sms.sun from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_TOT_DTSS from 
(select e.loc_no,e.dply_seq,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z ) sms
on sms.loc_no=lc.loc_no]]>
	</PlannedSMSTotal>	

	<ActualSMSTotal>
	<![CDATA[select 'Longlife' as stor_tot,
NVL(ROUND(xy.Monday,2),0) as mon,NVL(ROUND(xy.Tuesday,2),0) as tue,NVL(ROUND(xy.Wednesday,2),0) as wed,NVL(ROUND(xy.Thursday,2),0) as thu,
NVL(ROUND(xy.Friday,2),0) as fri,NVL(ROUND(xy.Saturday,2),0) as sat,NVL(ROUND(xy.Sunday,2),0) as sun from 
(select distinct loc_no,loc_nm from loc where loc_no='store' order by loc_no) lc
LEFT OUTER JOIN
(select xyz.loc_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select  loc_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSS )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSS )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSS )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSS )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSS )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSS )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSS )),0) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSS
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' 
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where src.dept_no IN (15,5,10)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no order by loc_no) xy
UNION 
select * from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no NOT IN (20,85,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (a.loc_no,tsk.dept_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.loc_no,src.dept_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
and A.day_of_wk in (0,1,2,3,4,5,6)
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
where e.dept_no IN (15,5,10)
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no)) xyz 
group by xyz.loc_no order by xyz.loc_no) xy
on lc.loc_no=xy.loc_no order by lc.loc_no]]>
	</ActualSMSTotal>
	
	<ActualSMSTotalSF>
	<![CDATA[select 'SeaDeli' as stor_tot,
NVL(ROUND(xy.Monday,2),0) as mon,NVL(ROUND(xy.Tuesday,2),0) as tue,NVL(ROUND(xy.Wednesday,2),0) as wed,NVL(ROUND(xy.Thursday,2),0) as thu,
NVL(ROUND(xy.Friday,2),0) as fri,NVL(ROUND(xy.Saturday,2),0) as sat,NVL(ROUND(xy.Sunday,2),0) as sun from 
(select distinct loc_no,loc_nm from loc where loc_no='store' order by loc_no) lc
LEFT OUTER JOIN
(select xyz.loc_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select  loc_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSS )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSS )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSS )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSS )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSS )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSS )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSS )),0) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSS
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' 
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where src.dept_no IN (40,55)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no order by loc_no) xy
UNION 
select * from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no NOT IN (20,85,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (a.loc_no,tsk.dept_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.loc_no,src.dept_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
and A.day_of_wk in (0,1,2,3,4,5,6)
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
where e.dept_no IN (40,55)
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no)) xyz 
group by xyz.loc_no order by xyz.loc_no) xy
on lc.loc_no=xy.loc_no order by lc.loc_no]]>
	</ActualSMSTotalSF>
	
	<PlannedSMSWkToDtTotal>
	<![CDATA[select lc.loc_nm,sms.wtd from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_TOT_DTSS from 
(select e.loc_no,e.dply_seq,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z ) sms
on sms.loc_no=lc.loc_no]]>
	</PlannedSMSWkToDtTotal>
	
	<ActualSMSWkToDtTotal>
	<![CDATA[select 'Longlife' as stor_tot,NVL(ROUND(xy.ACTL_SMS_DTSS,2),0) as wtd from 
(select distinct loc_no,loc_nm from loc where loc_no='store' order by loc_no) lc
LEFT OUTER JOIN
(select xyz.loc_no,sum(xyz.ACTL_SMS_DTSS) as ACTL_SMS_DTSS from 
(select * from 
(select  loc_no,Sum(ACTL_SMS_DTSS) as ACTL_SMS_DTSS from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSS
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN (15,5,10)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no order by loc_no) xy
UNION
select * from 
(select h.loc_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no NOT IN (20,85,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (a.loc_no,tsk.dept_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.loc_no,src.dept_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
where e.dept_no IN (15,5,10)
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no order by h.loc_no)) xyz
group by xyz.loc_no order by xyz.loc_no) xy
on lc.loc_no=xy.loc_no order by lc.loc_no]]>
	</ActualSMSWkToDtTotal>	
	
	<ActualSMSWkToDtTotalSF>
	<![CDATA[select 'SeaDeli' as stor_tot,NVL(ROUND(xy.ACTL_SMS_DTSS,2),0) as wtd from 
(select distinct loc_no,loc_nm from loc where loc_no='store' order by loc_no) lc
LEFT OUTER JOIN
(select xyz.loc_no,sum(xyz.ACTL_SMS_DTSS) as ACTL_SMS_DTSS from 
(select * from 
(select  loc_no,Sum(ACTL_SMS_DTSS) as ACTL_SMS_DTSS from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSS
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN (40,55)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no order by loc_no) xy
UNION
select * from 
(select h.loc_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no NOT IN (20,85,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (a.loc_no,tsk.dept_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.loc_no,src.dept_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) src where dept_no NOT IN (20,85,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
where e.dept_no IN (40,55)
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no order by h.loc_no)) xyz
group by xyz.loc_no order by xyz.loc_no) xy
on lc.loc_no=xy.loc_no order by lc.loc_no]]>
	</ActualSMSWkToDtTotalSF>	
</TCName>

<TCName name = "HoursColumnValidation" >
	<PlannedHoursTotal>
	<![CDATA[select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_HRS_DTSS),2) as PLN_HRS_TOT_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no]]>
	</PlannedHoursTotal>
	
	<PlannedHoursWkToDtTotal>
	<![CDATA[select lc.loc_nm,NVL(sum(wge.PLN_HOURS_DTSS),0) as PLN_HRS_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm]]>
	</PlannedHoursWkToDtTotal>
	
	<ActualHoursTotal>
	<![CDATA[select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTSS),2) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTSS,sum(e.actl_hrs) as ACTL_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end*/ and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and (a.loc_no,d.dply_seq,dy.day_of_wk) NOT IN 
(select distinct a.loc_no,d.dply_seq,dy.day_of_wk from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no]]>
	</ActualHoursTotal>	

	<ActualHoursWkToDtTotal>
	<![CDATA[select lc.loc_nm,NVL(ROUND(wge.ACTL_HRS_TOT_DTSS,2),0) as WTD from 
(select loc_no,loc_nm,'store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_HRS_TOT_DTSS) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,sum(e.actl_amt) as ACTL_WGE_TOT_DTSS,sum(e.actl_hrs) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no order by e.loc_no) f
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (d.dply_seq) NOT IN 
(select distinct d.dply_seq from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) g) h
group by h.loc_no order by h.loc_no) wge
on wge.loc_no=lc.loc_no]]>
	</ActualHoursWkToDtTotal>
	
	<CurrentActualHoursWkToDtTotal>
	<![CDATA[select lc.loc_nm,NVL(ROUND(y.ACTL_HRS_TOT_DTSS,2),0) as ACTL_HRS_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,sum(z.ACTL_HOURS_TOT_DTSS) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (d.dply_seq) NOT IN 
(select distinct d.dply_seq from ww_wlp.dly_wage a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) x ) z
group by z.loc_no order by z.loc_no ) y
on lc.loc_no=y.loc_no order by lc.loc_no]]>
	</CurrentActualHoursWkToDtTotal>	

	<VarHoursWkToDtTotal>
	<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_HRS_TOT_DTSS - pln.PLN_HRS_TOT_DTSS),2) as VAR_HRS_WTD_DTSS from 
(select lc.loc_nm,NVL(sum(wge.PLN_HOURS_DTSS),0) as PLN_HRS_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm) pln,
(select lc.loc_nm,NVL(ROUND(wge.ACTL_HRS_TOT_DTSS,2),0) as ACTL_HRS_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_HRS_TOT_DTSS) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,sum(e.actl_amt) as ACTL_WGE_TOT_DTSS,sum(e.actl_hrs) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no order by e.loc_no) f
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (d.dply_seq) NOT IN 
(select distinct d.dply_seq from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) g) h
group by h.loc_no order by h.loc_no ) wge
on wge.loc_no=lc.loc_no) actl
where pln.loc_nm=actl.loc_nm]]>
	</VarHoursWkToDtTotal>
	
	<CurrentVarHoursWkToDtTotal>
	<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_HRS_TOT_DTSS - pln.PLN_HRS_TOT_DTSS),2) as VAR_HRS_WTD_DTSS from 
(select lc.loc_nm,NVL(sum(wge.PLN_HOURS_DTSS),0) as PLN_HRS_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm) pln,
(select lc.loc_nm,NVL(ROUND(y.ACTL_HRS_TOT_DTSS,2),0) as ACTL_HRS_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,sum(z.ACTL_HOURS_TOT_DTSS) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (d.dply_seq) NOT IN 
(select distinct d.dply_seq from ww_wlp.dly_wage a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) x ) z 
group by z.loc_no order by z.loc_no ) y
on lc.loc_no=y.loc_no order by lc.loc_no) actl
where pln.loc_nm=actl.loc_nm ]]>
	</CurrentVarHoursWkToDtTotal>
</TCName>

<TCName name = "ItemsColumnValidation" >

	<PlannedItemsTotal>
	<![CDATA[select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no]]>
	</PlannedItemsTotal>	

	<ActualItemsTotal>
	<![CDATA[select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_ITM_DTS),0) as ACTL_ITM_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no]]>
	</ActualItemsTotal>	
	
	<LYItemsTotal>
	<![CDATA[select actl_cy.loc_nm,
CASE WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
     WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
     WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
     WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
     WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
     WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
     WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
     WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_ITM_DTS),0) as ACTL_ITM_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl_cy,
(select lc.loc_nm,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_ITM_DTS),0) as ACTL_ITM_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl_ly
where actl_cy.loc_nm=actl_ly.loc_nm]]>
	</LYItemsTotal>
	
	<PlannedItemsWkToDtTotal>
	<![CDATA[select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no]]>
	</PlannedItemsWkToDtTotal>	
	
	<ActualItemsWkToDtTotal>
	<![CDATA[select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no]]>
	</ActualItemsWkToDtTotal>	
	

	<LYItemsWkToDtTotal>
	<![CDATA[select lc.loc_nm,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100
     WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_TOT_DTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select cy_val.loc_nm,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) cy_val
LEFT OUTER JOIN
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) ly_val
on cy_val.loc_nm=ly_val.loc_nm 
group by cy_val.loc_nm) cyly_wtd
on cyly_wtd.loc_nm=lc.loc_nm]]>
	</LYItemsWkToDtTotal>
	

	<VarItemsWkToDtTotal>
	<![CDATA[select pln.loc_nm,ROUND((actl.wtd - pln.wtd),0) as VAR_SLS_WTD_DTSS from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) pln,
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl
where pln.loc_nm=actl.loc_nm]]>
	</VarItemsWkToDtTotal>
</TCName>

<TCName name = "BudgetColumnValidation" >
	
	<BudgetSalesTotal>
	<![CDATA[select lc.loc_nm,NVL(bdgt.BDGT_SALES_TOT_DTSS,0) as BDGT_SLS_TOT_DTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_TOT_DTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no]]>
	</BudgetSalesTotal>
	
	<ForecastSalesTotal>
	<![CDATA[select lc.loc_nm,NVL(bdgt.FCST_SALES_TOT_DTSS,0) as FCST_SLS_TOT_DTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,ROUND(sum(e.frcst_sls),0) as FCST_SALES_TOT_DTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no]]>
	</ForecastSalesTotal>
	
	<BudgetWagePercentageTotal>
	<![CDATA[select wge.loc_nm,NVL(ROUND((wge.BDGT_WGE_WTD_TOT_DTSS / sls.BDGT_SLS_WTD_TOT_DTSS)*100,2),0) as BDGT_WGE_PCT_WTD_TOT_DTSS from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm]]>
	</BudgetWagePercentageTotal>
	
	<ForecastWagePercentageTotal>
	<![CDATA[select wge.loc_nm,NVL(ROUND((wge.FCST_WGE_WTD_TOT_DTSS / sls.FCST_SLS_WTD_TOT_DTSS)*100,2),0) as FCST_WGE_PCT_WTD_TOT_DTSS from 
(select lc.loc_nm,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,sum(fcst.frcst_sls) as FCST_SLS_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm]]>
	</ForecastWagePercentageTotal>
	

	<AllowedWagesTotal>
	<![CDATA[select estd_fcst_sls.loc_nm,NVL(ROUND(NVL((estd_fcst_sls.ESTD_FCST_SLS_TOT_DTSS * bdgt_wge_pct.BDGT_WGE_PCT_TOT_DTSS),0)/100,0),0) as ALWD_WGE_TOT_DTSS from 
(select lc.loc_nm,sls.ESTD_FCST_SLS_TOT_DTSS from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no=3 and b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.ESTD_FCST_SLS_TOT_DTSS from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as ESTD_FCST_SLS_TOT_DTSS from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTSS) as ACTL_SLS_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTSS,sum(e.actl_itm_cnt) as ACTL_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls where (pln_sls.dply_seq,pln_sls.dept_nm,pln_sls.day_of_wk) NOT IN 
(select e.dply_seq,e.dept_nm,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/) e)) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) estd_fcst_sls,
(select wge.loc_nm,(wge.BDGT_WGE_WTD_TOT_DTSS / sls.BDGT_SLS_WTD_TOT_DTSS)*100 as BDGT_WGE_PCT_TOT_DTSS from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) bdgt_wge_pct
where estd_fcst_sls.loc_nm=bdgt_wge_pct.loc_nm]]>
	</AllowedWagesTotal>
	
	<CurrentAllowedWagesTotal>
	<![CDATA[]]>
	</CurrentAllowedWagesTotal>

	<ForecastAllowedWagesTotal>
	<![CDATA[select estd_fcst_sls.loc_nm,NVL(ROUND(NVL((estd_fcst_sls.ESTD_FCST_SLS_TOT_DTSS * bdgt_wge_pct.FCST_WGE_PCT_WTD_TOT_DTSS),0)/100,0),0) as ALWD_WGE_TOT_DTSS from 
(select lc.loc_nm,sls.ESTD_FCST_SLS_TOT_DTSS from 
(select distinct b.loc_no,b.loc_nm from ww_wlp.loc b where b.div_no=3 and b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.ESTD_FCST_SLS_TOT_DTSS from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as ESTD_FCST_SLS_TOT_DTSS from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTSS) as ACTL_SLS_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTSS,sum(e.actl_itm_cnt) as ACTL_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls where (pln_sls.dply_seq,pln_sls.dept_nm,pln_sls.day_of_wk) NOT IN 
(select e.dply_seq,e.dept_nm,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/) e)) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) estd_fcst_sls,
(select wge.loc_nm,NVL((wge.FCST_WGE_WTD_TOT_DTSS / sls.FCST_SLS_WTD_TOT_DTSS)*100,0) as FCST_WGE_PCT_WTD_TOT_DTSS from 
(select lc.loc_nm,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,sum(fcst.frcst_sls) as FCST_SLS_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) bdgt_wge_pct
where estd_fcst_sls.loc_nm=bdgt_wge_pct.loc_nm]]>
	</ForecastAllowedWagesTotal>
	

	<EstimatedFcstSalesTotal>
	<![CDATA[select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no]]>
	</EstimatedFcstSalesTotal>
	

	<EstimatedFcstWageTotal>
	<![CDATA[select lc.loc_nm,NVL(ROUND(wge.ACTL_WGE_TOT_DTSS,0),0) as WTD from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select * from 
(select e.loc_no,sum(e.actl_amt) as ACTL_WGE_TOT_DTSS,sum(e.actl_hrs) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no order by e.loc_no) f
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) g) wge
on wge.loc_no=lc.loc_no]]>
	</EstimatedFcstWageTotal>

	<CurrentEstimatedFcstWageTotal>
	<![CDATA[select lc.loc_nm,NVL(ROUND(y.ACTL_WAGE_TOT_DTSS,0),0) as ACTL_WGE_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select * from 
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) x ) y
on lc.loc_no=y.loc_no order by lc.loc_no]]>
	</CurrentEstimatedFcstWageTotal>
	

	<EstimatedFcstWagePrcntTotal>
	<![CDATA[select wge.loc_nm,NVL(ROUND((wge.ACTL_WGE_TOT_DTSS / sls.ACTL_SLS_TOT_DTSS)*100,2),0) as ACTL_WGE_PRCNT_TOT_DTSS from
(select lc.loc_nm,wge.ACTL_WGE_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select * from 
(select e.loc_no,sum(e.actl_amt) as ACTL_WGE_TOT_DTSS,sum(e.actl_hrs) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no order by e.loc_no) f
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) g) wge
on wge.loc_no=lc.loc_no order by lc.loc_no) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as ACTL_SLS_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTSS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTSS,sum(e.actl_itm_cnt) as ACTL_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls where (pln_sls.dply_seq,pln_sls.dept_nm,pln_sls.day_of_wk) NOT IN 
(select e.dply_seq,e.dept_nm,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e)) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm]]>
	</EstimatedFcstWagePrcntTotal>	

	<CurrentEstimatedFcstWagePrcntTotal>
	<![CDATA[select wge.loc_nm,NVL(ROUND((wge.ACTL_WGE_TOT_DTSS / sls.ACTL_SLS_TOT_DTSS)*100,2),0) as ACTL_WGE_PRCNT_TOT_DTSS from
(select lc.loc_nm,wge.ACTL_WGE_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select * from 
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) x ) wge
on wge.loc_no=lc.loc_no order by lc.loc_no) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as ACTL_SLS_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTSS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTSS,sum(e.actl_itm_cnt) as ACTL_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls where (pln_sls.dply_seq,pln_sls.dept_nm,pln_sls.day_of_wk) NOT IN 
(select e.dply_seq,e.dept_nm,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/) e)) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm]]>
	</CurrentEstimatedFcstWagePrcntTotal>
	

	<VarSalesTotal>
	<![CDATA[select bdgt.loc_nm,NVL(ROUND(estd.wtd - bdgt.wtd,0),0) as BDGT_VAR_SLS_WTD_DTSS from 
(select lc.loc_nm,NVL(bdgt.BDGT_SALES_TOT_DTSS,0) as wtd from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.bdgt_sls) as BDGT_SALES_TOT_DTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no) bdgt,
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) estd
where bdgt.loc_nm=estd.loc_nm]]>
	</VarSalesTotal>
	

	<ForecastVarSalesTotal>
	<![CDATA[select fcst.loc_nm,NVL(ROUND(estd.wtd - fcst.wtd,0),0) as BDGT_VAR_SLS_WTD_DTSS from 
(select lc.loc_nm,NVL(bdgt.FCST_SALES_TOT_DTSS,0) as wtd from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.frcst_sls) as FCST_SALES_TOT_DTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no) fcst,
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no=store order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) estd
where fcst.loc_nm=estd.loc_nm]]>
	</ForecastVarSalesTotal>
	
	<VarWagesPrecentageTotal>
	<![CDATA[select bdgt.loc_nm,ROUND((estd.wtd - bdgt.wtd),2) as BDGT_VAR_WGE_PCT_WTD_TOT_DTSS from 
(select wge.loc_nm,NVL((wge.BDGT_WGE_WTD_TOT_DTSS / sls.BDGT_SLS_WTD_TOT_DTSS)*100,0) as wtd from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) bdgt,
(select wge.loc_nm,NVL((wge.ACTL_WGE_TOT_DTSS / sls.ACTL_SLS_TOT_DTSS)*100,0) as wtd from
(select lc.loc_nm,wge.ACTL_WGE_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select * from 
(select e.loc_no,sum(e.actl_amt) as ACTL_WGE_TOT_DTSS,sum(e.actl_hrs) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no order by e.loc_no) f
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) g) wge
on wge.loc_no=lc.loc_no order by lc.loc_no) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as ACTL_SLS_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTSS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTSS,sum(e.actl_itm_cnt) as ACTL_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls where (pln_sls.dply_seq,pln_sls.dept_nm,pln_sls.day_of_wk) NOT IN 
(select e.dply_seq,e.dept_nm,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/) e)) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm) estd
where bdgt.loc_nm=estd.loc_nm]]>
	</VarWagesPrecentageTotal>
	
	<CurrentVarWagesPrecentageTotal>
	<![CDATA[select bdgt.loc_nm,ROUND((estd.wtd - bdgt.wtd),2) as BDGT_VAR_WGE_PCT_WTD_TOT_DTSS from 
(select wge.loc_nm,NVL((wge.BDGT_WGE_WTD_TOT_DTSS / sls.BDGT_SLS_WTD_TOT_DTSS)*100,0) as wtd from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) bdgt,
(select wge.loc_nm,NVL((wge.ACTL_WGE_TOT_DTSS / sls.ACTL_SLS_TOT_DTSS)*100,0) as wtd from
(select lc.loc_nm,wge.ACTL_WGE_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select * from 
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) x ) wge
on wge.loc_no=lc.loc_no order by lc.loc_no) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as ACTL_SLS_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTSS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTSS,sum(e.actl_itm_cnt) as ACTL_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls where (pln_sls.dply_seq,pln_sls.dept_nm,pln_sls.day_of_wk) NOT IN 
(select e.dply_seq,e.dept_nm,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/) e)) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm) estd
where bdgt.loc_nm=estd.loc_nm]]>
	</CurrentVarWagesPrecentageTotal>

	<ForecastVarWagesPrecentageTotal>
	<![CDATA[select fcst.loc_nm,ROUND((estd.wtd - fcst.wtd),2) as BDGT_VAR_WGE_PCT_WTD_TOT_DTSS from 
(select wge.loc_nm,NVL((wge.FCST_WGE_WTD_TOT_DTSS / sls.FCST_SLS_WTD_TOT_DTSS)*100,0) as wtd from 
(select lc.loc_nm,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,sum(fcst.frcst_sls) as FCST_SLS_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) fcst,
(select wge.loc_nm,NVL((wge.ACTL_WGE_TOT_DTSS / sls.ACTL_SLS_TOT_DTSS)*100,0) as wtd from
(select lc.loc_nm,wge.ACTL_WGE_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select * from 
(select e.loc_no,sum(e.actl_amt) as ACTL_WGE_TOT_DTSS,sum(e.actl_hrs) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no order by e.loc_no) f
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) g) wge
on wge.loc_no=lc.loc_no order by lc.loc_no) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as ACTL_SLS_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTSS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTSS,sum(e.actl_itm_cnt) as ACTL_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls where (pln_sls.dply_seq,pln_sls.dept_nm,pln_sls.day_of_wk) NOT IN 
(select e.dply_seq,e.dept_nm,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/) e)) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm) estd
where fcst.loc_nm=estd.loc_nm]]>
	</ForecastVarWagesPrecentageTotal>
	<CurrentForecastVarWagesPrecentageTotal>
	<![CDATA[select fcst.loc_nm,NVL(ROUND((estd.wtd - fcst.wtd),2),0) as FCST_VAR_WGE_PCT_WTD_DTSS from 
(select wge.loc_nm,NVL((wge.FCST_WGE_WTD_TOT_DTSS / sls.FCST_SLS_WTD_TOT_DTSS)*100,0) as wtd from 
(select lc.loc_nm,sum(fcst.frcst_wage_amt) as FCST_WGE_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,sum(fcst.frcst_sls) as FCST_SLS_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) fcst,
(select wge.loc_nm,ROUND((wge.ACTL_WGE_TOT_DTSS / sls.ACTL_SLS_TOT_DTSS)*100,2) as wtd from
(select lc.loc_nm,wge.ACTL_WGE_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select * from 
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) x ) wge
on wge.loc_no=lc.loc_no order by lc.loc_no) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as ACTL_SLS_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTSS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTSS,sum(e.actl_itm_cnt) as ACTL_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls where (pln_sls.dply_seq,pln_sls.dept_nm,pln_sls.day_of_wk) NOT IN 
(select e.dply_seq,e.dept_nm,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/) e)) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm) estd
where fcst.loc_nm=estd.loc_nm]]>
	</CurrentForecastVarWagesPrecentageTotal>
	

	<VarWagesTotal>
	<![CDATA[select estd_fcst.loc_nm,ROUND((estd_fcst.ESTD_FCST_WGE_WTD_TOT_DTS - alwd_wge.ALWD_WGE_WTD_TOT_DTS),0) as BDGT_VAR_WGE_WTD_TOT_DTS from 
(select lc.loc_nm,NVL(ROUND(wge.ACTL_WGE_TOT_DTSS,0),0) as ESTD_FCST_WGE_WTD_TOT_DTS from 
(select loc_no,loc_nm,'store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select * from 
(select e.loc_no,sum(e.actl_amt) as ACTL_WGE_TOT_DTSS,sum(e.actl_hrs) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no order by e.loc_no) f
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) g) wge
on wge.loc_no=lc.loc_no) estd_fcst,
(select estd_fcst_sls.loc_nm,(estd_fcst_sls.ESTD_FCST_SLS_WTD_TOT_DTS * bdgt_wge_pct.BDGT_WGE_PCT_WTD_TOT_DTS)/100 as ALWD_WGE_WTD_TOT_DTS from 
(select lc.loc_nm,NVL(sls.wtd,0) as ESTD_FCST_SLS_WTD_TOT_DTS from 
(select loc_nm,'store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_nm,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTS)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTS from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) g) pln_sls where (pln_sls.dply_seq,pln_sls.dept_nm,pln_sls.day_of_wk) NOT IN 
(select e.dply_seq,e.dept_nm,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e)) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) sls
on lc.loc_nm=sls.loc_nm) estd_fcst_sls,
(select wge.loc_nm,NVL((wge.BDGT_WGE_WTD_TOT_DTS / sls.BDGT_SLS_WTD_TOT_DTS)*100,0) as BDGT_WGE_PCT_WTD_TOT_DTS from 
(select lc.loc_nm,sum(bdgt.bdgt_wage_amt) as BDGT_WGE_WTD_TOT_DTS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,sum(bdgt.bdgt_sls) as BDGT_SLS_WTD_TOT_DTS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) bdgt_wge_pct
where estd_fcst_sls.loc_nm=bdgt_wge_pct.loc_nm) alwd_wge
where estd_fcst.loc_nm=alwd_wge.loc_nm]]>
	</VarWagesTotal>
	

	<CurrentVarWagesTotal>
	<![CDATA[select estd_fcst.loc_nm,ROUND((estd_fcst.ESTD_FCST_WGE_WTD_TOT_DTS - alwd_wge.ALWD_WGE_WTD_TOT_DTS),0) as BDGT_VAR_WGE_WTD_TOT_DTS from 
(select lc.loc_nm,NVL(y.ACTL_WAGE_TOT_DTSS,0) as ESTD_FCST_WGE_WTD_TOT_DTS from 
(select loc_no,loc_nm,'store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select * from 
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) x ) y
on lc.loc_no=y.loc_no order by lc.loc_no) estd_fcst,
(select estd_fcst_sls.loc_nm,(estd_fcst_sls.ESTD_FCST_SLS_WTD_TOT_DTS * bdgt_wge_pct.BDGT_WGE_PCT_WTD_TOT_DTS)/100 as ALWD_WGE_WTD_TOT_DTS from 
(select lc.loc_nm,NVL(sls.wtd,0) as ESTD_FCST_SLS_WTD_TOT_DTS from 
(select loc_nm,'store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_nm,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTS)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTS from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) g) pln_sls where (pln_sls.dply_seq,pln_sls.dept_nm,pln_sls.day_of_wk) NOT IN 
(select e.dply_seq,e.dept_nm,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e)) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) sls
on lc.loc_nm=sls.loc_nm) estd_fcst_sls,
(select wge.loc_nm,NVL((wge.BDGT_WGE_WTD_TOT_DTS / sls.BDGT_SLS_WTD_TOT_DTS)*100,0) as BDGT_WGE_PCT_WTD_TOT_DTS from 
(select lc.loc_nm,sum(bdgt.bdgt_wage_amt) as BDGT_WGE_WTD_TOT_DTS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,sum(bdgt.bdgt_sls) as BDGT_SLS_WTD_TOT_DTS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) bdgt_wge_pct
where estd_fcst_sls.loc_nm=bdgt_wge_pct.loc_nm) alwd_wge
where estd_fcst.loc_nm=alwd_wge.loc_nm]]>
	</CurrentVarWagesTotal>
	

	<ForecastVarWagesTotal>
	<![CDATA[select estd_fcst.loc_nm,ROUND((estd_fcst.ESTD_FCST_WGE_WTD_TOT_DTS - alwd_wge.ALWD_WGE_WTD_TOT_DTS),0) as BDGT_VAR_WGE_WTD_TOT_DTS from 
(select lc.loc_nm,NVL(ROUND(wge.ACTL_WGE_TOT_DTSS,0),0) as ESTD_FCST_WGE_WTD_TOT_DTS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select * from 
(select e.loc_no,sum(e.actl_amt) as ACTL_WGE_TOT_DTSS,sum(e.actl_hrs) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no order by e.loc_no) f
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) g) wge
on wge.loc_no=lc.loc_no) estd_fcst,
(select estd_fcst_sls.loc_nm,(estd_fcst_sls.ESTD_FCST_SLS_WTD_TOT_DTS * bdgt_wge_pct.BDGT_WGE_PCT_WTD_TOT_DTS)/100 as ALWD_WGE_WTD_TOT_DTS from 
(select lc.loc_nm,NVL(sls.wtd,0) as ESTD_FCST_SLS_WTD_TOT_DTS from 
(select loc_nm,'store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_nm,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,'store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTS)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTS from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) g) pln_sls where (pln_sls.dply_seq,pln_sls.dept_nm,pln_sls.day_of_wk) NOT IN 
(select e.dply_seq,e.dept_nm,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e)) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) z) sls
on lc.loc_nm=sls.loc_nm) estd_fcst_sls,
(select wge.loc_nm,NVL((wge.FCST_WGE_WTD_TOT_DTSS / sls.FCST_SLS_WTD_TOT_DTSS)*100,0) as BDGT_WGE_PCT_WTD_TOT_DTS from 
(select lc.loc_nm,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,sum(fcst.frcst_sls) as FCST_SLS_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) bdgt_wge_pct
where estd_fcst_sls.loc_nm=bdgt_wge_pct.loc_nm) alwd_wge
where estd_fcst.loc_nm=alwd_wge.loc_nm]]>
	</ForecastVarWagesTotal>

	<CurrentForecastVarWagesTotal>
	<![CDATA[select estd_fcst.loc_nm,NVL(ROUND((estd_fcst.wtd - alwd_wge.wtd),0),0) as BDGT_VAR_WGE_WTD_TOT_DTS from 
(select lc.loc_nm,NVL(sum(wge.ACTL_WAGE_DTS),0) as wtd from 
(select loc_nm,'store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
group by a.loc_no,a.dept_no,a.div_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_nm,e.dply_seq,e.dept_nm order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm) estd_fcst,
(select estd_fcst_sls.loc_nm,NVL(ROUND((estd_fcst_sls.ESTD_FCST_SLS_WTD_TOT_DTS * fcst_wge_pct.FCST_WGE_PCT_WTD_TOT_DTSS)/100,0),0) as wtd from 
(select lc.loc_nm,sls.wtd as ESTD_FCST_SLS_WTD_TOT_DTS from 
(select loc_no,loc_nm,'store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTSS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTSS,sum(e.actl_itm_cnt) as ACTL_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
a.actl_sls as actl_sls,a.actl_itm_cnt as actl_itm_cnt,a.actl_cust_cnt as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
a.refcst_sls as refcst_sls,a.refcst_itm_cnt as refcst_itm_cnt,a.refcst_cust_cnt as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
a.mgr_pln_sls as mgr_pln_sls,a.mgr_pln_itm_cnt as mgr_pln_itm_cnt,a.mgr_pln_cust_cnt as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
a.gnrt_sls as gnrt_sls,a.gnrt_itm as gnrt_itm,a.gnrt_cust as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls where (pln_sls.dply_seq,pln_sls.dept_nm,pln_sls.day_of_wk) NOT IN 
(select e.dply_seq,e.dept_nm,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
a.actl_sls as actl_sls,a.actl_itm_cnt as actl_itm_cnt,a.actl_cust_cnt as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/) e)) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) estd_fcst_sls,
(select wge.loc_nm,(wge.FCST_WGE_WTD_TOT_DTSS / sls.FCST_SLS_WTD_TOT_DTSS)*100 as FCST_WGE_PCT_WTD_TOT_DTSS from 
(select lc.loc_nm,sum(fcst.frcst_wage_amt) as FCST_WGE_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,sum(fcst.frcst_sls) as FCST_SLS_WTD_TOT_DTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no=3 and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN (Department)
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) fcst_wge_pct
where estd_fcst_sls.loc_nm=fcst_wge_pct.loc_nm) alwd_wge
where estd_fcst.loc_nm=alwd_wge.loc_nm]]>
	</CurrentForecastVarWagesTotal>
	
</TCName>

<TCName name = "WagesPercentageColumnValidation" >
	
	<PlannedWagesPercentageTotal>
	<![CDATA[select wge.loc_nm,NVL(ROUND((wge.mon / sls.mon)*100,2),0) as Mon,NVL(ROUND((wge.tue / sls.tue)*100,2),0) as Tue,NVL(ROUND((wge.wed / sls.wed)*100,2),0) as Wed,
NVL(ROUND((wge.thu / sls.thu)*100,2),0) as Thu,NVL(ROUND((wge.fri / sls.fri)*100,2),0) as Fri,NVL(ROUND((wge.sat / sls.sat)*100,2),0) as Sat,
NVL(ROUND((wge.sun / sls.sun)*100,2),0) as Sun from
(select lc.loc_nm,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_WGE_DTSS) as PLN_WGE_TOT_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no) wge,
(select lc.loc_nm,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTSS) as PLN_SLS_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm]]>
	</PlannedWagesPercentageTotal>
	
	
	<ActualWagesPercentageTotal>
	<![CDATA[select wge.loc_nm,NVL(ROUND((wge.mon / sls.mon)*100,2),0) as Mon,NVL(ROUND((wge.tue / sls.tue)*100,2),0) as Tue,NVL(ROUND((wge.wed / sls.wed)*100,2),0) as Wed,
NVL(ROUND((wge.thu / sls.thu)*100,2),0) as Thu,NVL(ROUND((wge.fri / sls.fri)*100,2),0) as Fri,NVL(ROUND((wge.sat / sls.sat)*100,2),0) as Sat,
NVL(ROUND((wge.sun / sls.sun)*100,2),0) as Sun from
(select lc.loc_nm,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTSS) as ACTL_WGE_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTSS,sum(e.actl_hrs) as ACTL_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end*/ and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and (a.loc_no,d.dply_seq,dy.day_of_wk) NOT IN 
(select distinct a.loc_no,d.dply_seq,dy.day_of_wk from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no) wge,
(select lc.loc_nm,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTSS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTSS,sum(e.actl_itm_cnt) as ACTL_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls where (pln_sls.dply_seq,pln_sls.dept_nm,pln_sls.day_of_wk) NOT IN 
(select e.dply_seq,e.dept_nm,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/) e)) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm]]>
	</ActualWagesPercentageTotal>
	

	<PlannedWagesPercentageWkToDtTotal>
	<![CDATA[select wge.loc_nm,NVL(ROUND((wge.PLN_WGE_TOT_DTSS / sls.PLN_SLS_TOT_DTSS)*100,2),0) as PLN_WGE_PRCNT_TOT_DTSS from
(select lc.loc_nm,sum(wge.PLN_WAGE_DTSS) as PLN_WGE_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as PLN_SLS_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTSS) as PLN_SLS_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm]]>
	</PlannedWagesPercentageWkToDtTotal>
		

	<ActualWagesPercentageWkToDtTotal>
	<![CDATA[select wge.loc_nm,NVL(ROUND((wge.ACTL_WGE_TOT_DTSS / sls.ACTL_SLS_TOT_DTSS)*100,2),0) as ACTL_WGE_PRCNT_TOT_DTSS from
(select lc.loc_nm,wge.ACTL_WGE_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select * from 
(select e.loc_no,sum(e.actl_amt) as ACTL_WGE_TOT_DTSS,sum(e.actl_hrs) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no order by e.loc_no) f
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) g) wge
on wge.loc_no=lc.loc_no order by lc.loc_no) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as ACTL_SLS_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTSS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTSS,sum(e.actl_itm_cnt) as ACTL_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls where (pln_sls.dply_seq,pln_sls.dept_nm,pln_sls.day_of_wk) NOT IN 
(select e.dply_seq,e.dept_nm,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/) e)) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm ]]>
	</ActualWagesPercentageWkToDtTotal>	
	

	<CurrentActualWagesPercentageWkToDtTotal>
	<![CDATA[select wge.loc_nm,NVL(ROUND((wge.ACTL_WGE_TOT_DTSS / sls.ACTL_SLS_TOT_DTSS)*100,2),0) as ACTL_WGE_PRCNT_TOT_DTSS from
(select lc.loc_nm,wge.ACTL_WGE_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select * from 
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) x ) wge
on wge.loc_no=lc.loc_no order by lc.loc_no) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as ACTL_SLS_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTSS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTSS,sum(e.actl_itm_cnt) as ACTL_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls where (pln_sls.dply_seq,pln_sls.dept_nm,pln_sls.day_of_wk) NOT IN 
(select e.dply_seq,e.dept_nm,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/) e)) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm]]>
	</CurrentActualWagesPercentageWkToDtTotal>	
	

	<VarWagesPercentageWkToDtTotal>
	<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_WGE_PRCNT_TOT_DTSS - pln.PLN_WGE_PRCNT_TOT_DTSS),2) as VAR_WGE_PCT_WTD_TOT_DTSS from 
(select wge.loc_nm,NVL(ROUND((wge.PLN_WGE_TOT_DTSS / sls.PLN_SLS_TOT_DTSS)*100,2),0) as PLN_WGE_PRCNT_TOT_DTSS from
(select lc.loc_nm,sum(wge.PLN_WAGE_DTSS) as PLN_WGE_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as PLN_SLS_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTSS) as PLN_SLS_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm) pln,
(select wge.loc_nm,NVL(ROUND((wge.ACTL_WGE_TOT_DTSS / sls.ACTL_SLS_TOT_DTSS)*100,2),0) as ACTL_WGE_PRCNT_TOT_DTSS from
(select lc.loc_nm,wge.ACTL_WGE_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select * from 
(select e.loc_no,sum(e.actl_amt) as ACTL_WGE_TOT_DTSS,sum(e.actl_hrs) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no order by e.loc_no) f
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) g) wge
on wge.loc_no=lc.loc_no order by lc.loc_no) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as ACTL_SLS_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTSS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTSS,sum(e.actl_itm_cnt) as ACTL_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls where (pln_sls.dply_seq,pln_sls.dept_nm,pln_sls.day_of_wk) NOT IN 
(select e.dply_seq,e.dept_nm,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/) e)) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm) actl
where pln.loc_nm=actl.loc_nm]]>
	</VarWagesPercentageWkToDtTotal>

	<CurrentVarWagesPercentageWkToDtTotal>
	<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_WGE_PRCNT_TOT_DTSS - pln.PLN_WGE_PRCNT_TOT_DTSS),2) as VAR_WGE_PCT_WTD_TOT_DTSS from 
(select wge.loc_nm,NVL(ROUND((wge.PLN_WGE_TOT_DTSS / sls.PLN_SLS_TOT_DTSS)*100,2),0) as PLN_WGE_PRCNT_TOT_DTSS from
(select lc.loc_nm,sum(wge.PLN_WAGE_DTSS) as PLN_WGE_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as PLN_SLS_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTSS) as PLN_SLS_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm) pln,
(select wge.loc_nm,NVL(ROUND((wge.ACTL_WGE_TOT_DTSS / sls.ACTL_SLS_TOT_DTSS)*100,2),0) as ACTL_WGE_PRCNT_TOT_DTSS from
(select lc.loc_nm,wge.ACTL_WGE_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select * from 
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no) NOT IN 
(select distinct a.loc_no from ww_wlp.dly_wage a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) x ) wge
on wge.loc_no=lc.loc_no order by lc.loc_no) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as ACTL_SLS_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTSS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTSS,sum(e.actl_itm_cnt) as ACTL_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTSS,sum(e.refcst_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTSS,sum(e.gnrt_itm) as GEN_ITM_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls where (pln_sls.dply_seq,pln_sls.dept_nm,pln_sls.day_of_wk) NOT IN 
(select e.dply_seq,e.dept_nm,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
/*and a.actl_sls is NOT NULL and a.actl_sls!=0*/) e)) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm) actl
where pln.loc_nm=actl.loc_nm]]>
	</CurrentVarWagesPercentageWkToDtTotal>
</TCName>

<TCName name = "WagesColumnValidation" >

	<PlannedWagesTotal>
	<![CDATA[select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTSS),0) as PLN_WGE_TOT_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no]]>
	</PlannedWagesTotal>
	

	<ActualWagesTotal>
	<![CDATA[select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_WGE_DTSS),0) as ACTL_WGE_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTSS,sum(e.actl_hrs) as ACTL_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end*/ and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and (a.loc_no,d.dply_seq,dy.day_of_wk) NOT IN 
(select distinct a.loc_no,d.dply_seq,dy.day_of_wk from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no]]>
	</ActualWagesTotal>
	
	<PlannedWagesWkToDtTotal>
	<![CDATA[select lc.loc_nm,NVL(ROUND(sum(wge.PLN_WAGE_DTSS),0),0) as PLN_WGE_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm]]>
	</PlannedWagesWkToDtTotal>	
	
	<ActualWagesWkToDtTotal>
	<![CDATA[select lc.loc_nm,NVL(ROUND(wge.ACTL_WGE_TOT_DTSS,0),0) as WTD from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_WGE_TOT_DTSS) as ACTL_WGE_TOT_DTSS from 
(select * from 
(select e.loc_no,sum(e.actl_amt) as ACTL_WGE_TOT_DTSS,sum(e.actl_hrs) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no order by e.loc_no) f
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (d.dply_seq) NOT IN 
(select distinct d.dply_seq from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) g ) h
group by h.loc_no order by h.loc_no) wge
on wge.loc_no=lc.loc_no]]>
	</ActualWagesWkToDtTotal>	
	<CurrentActualWagesWkToDtTotal>
	<![CDATA[select lc.loc_nm,NVL(ROUND(y.ACTL_WAGE_TOT_DTSS,0),0) as ACTL_WGE_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,sum(z.ACTL_WAGE_TOT_DTSS) as ACTL_WAGE_TOT_DTSS from 
(select * from 
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (d.dply_seq) NOT IN 
(select distinct d.dply_seq from ww_wlp.dly_wage a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) x ) z
group by z.loc_no order by z.loc_no) y
on lc.loc_no=y.loc_no order by lc.loc_no]]>
	</CurrentActualWagesWkToDtTotal>
	
	<LYWagesTotal>
	<![CDATA[select actl_cy.loc_nm,
CASE WHEN NVL(actl_cy.Mon,0) = 0 and NVL(actl_ly.Mon,0) = 0 THEN 0
WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.Tue,0) = 0 and NVL(actl_ly.Tue,0) = 0 THEN 0
WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.Wed,0) = 0 and NVL(actl_ly.Wed,0) = 0 THEN 0
WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.Thu,0) = 0 and NVL(actl_ly.Thu,0) = 0 THEN 0
WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.Fri,0) = 0 and NVL(actl_ly.Fri,0) = 0 THEN 0
WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.Sat,0) = 0 and NVL(actl_ly.Sat,0) = 0 THEN 0
WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.Sun,0) = 0 and NVL(actl_ly.Sun,0) = 0 THEN 0
WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select z.loc_nm,y.mon,y.tue,y.wed,y.thu,y.fri,y.sat,y.sun from 
(select loc_nm,'store Total' as STR_TOT from loc where loc_no='store') z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTS)) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTS from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end*/ and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and (d.dply_seq,dy.day_of_wk) NOT IN 
(select d.dply_seq,dy.day_of_wk from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) y
on z.loc_nm=y.loc_nm order by z.loc_nm) actl_cy,
(select z.loc_nm,y.mon,y.tue,y.wed,y.thu,y.fri,y.sat,y.sun from 
(select loc_nm,'store Total' as STR_TOT from loc where loc_no='store') z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_nm,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTS)) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTS from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt 'and c.wk_end' and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and (d.dply_seq,dy.day_of_wk) NOT IN 
(select d.dply_seq,dy.day_of_wk from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) g*/) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) y
on z.loc_nm=y.loc_nm order by z.loc_nm) actl_ly
where actl_cy.loc_nm=actl_ly.loc_nm]]>
	</LYWagesTotal>
	
	<LYWagesWkToDtTotal>
	<![CDATA[select actl_cy.loc_nm,
CASE WHEN NVL(actl_cy.cy_wtd,0) = 0 THEN -100 WHEN NVL(actl_ly.ly_wtd,0) = 0 THEN 100
ELSE ROUND(((actl_cy.cy_wtd / actl_ly.ly_wtd)-1)*100,2) END as ACTL_LY_PRCNT_DTSS from 
(select z.loc_nm,y.mon,y.tue,y.wed,y.thu,y.fri,y.sat,y.sun,y.wtd as cy_wtd from 
(select loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') z
LEFT OUTER JOIN
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.loc_nm,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTS)),0) Sun from 
(select h.loc_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTS from 
(select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and sysdate-1*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and (d.dply_seq,dy.day_of_wk) NOT IN 
(select d.dply_seq,dy.day_of_wk from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_nm,h.day_of_wk order by h.loc_nm,h.day_of_wk) b
group by b.loc_nm order by b.loc_nm) x ) y
on z.loc_nm=y.loc_nm order by z.loc_nm) actl_cy,
(select lc.loc_nm,ROUND(wge.ACTL_WGE_LY_DTS,0) as ly_wtd from 
(select loc_nm,loc_no from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_LY_DTS,sum(e.actl_hrs) as ACTL_HRS_LY_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_no) actl_ly
where actl_cy.loc_nm=actl_ly.loc_nm]]>
	</LYWagesWkToDtTotal>

	<CurrentLYWagesWkToDtTotal>
	<![CDATA[select cyly_wtd.loc_nm,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 and NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PRCNT_DTSS from 
(select lc.loc_nm,cy_per_ly.cy_wtd,cy_per_ly.ly_wtd from 
(select loc_no,loc_nm,'store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select cy_val.loc_no,sum(cy_val.actl_wge_CY_TOT_DTS) as cy_wtd,sum(ly_val.actl_wge_LY_TOT_DTS) as ly_wtd from 
(select actl_pln.loc_no,sum(actl_pln.ACTL_WAGE_DTSG) as actl_wge_CY_TOT_DTS from 
(select * from 
(select h.loc_no,h.dply_seq,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSG,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSG from 
(select e.loc_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no NOT IN (20,85) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) h
group by h.loc_no,h.dply_seq order by h.loc_no,h.dply_seq) f
UNION
select * from 
(select e.loc_no,e.dply_seq,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no NOT IN (20,85) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no) NOT IN 
(select distinct a.dept_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no NOT IN (20,85) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no,e.dply_seq order by e.loc_no,e.dply_seq) g ) actl_pln
group by actl_pln.loc_no order by actl_pln.loc_no) cy_val
INNER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WGE_LY_TOT_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HRS_LY_TOT_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
group by a.loc_no,a.dept_no,a.div_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no,e.dply_seq,e.dept_nm order by e.loc_no,e.dply_seq) ly_val
on cy_val.loc_no=ly_val.loc_no 
group by cy_val.loc_no order by cy_val.loc_no) cy_per_ly
on lc.loc_no=cy_per_ly.loc_no order by lc.loc_no) cyly_wtd 
]]>
	</CurrentLYWagesWkToDtTotal>
	

	<VarWagesWkToDtTotal>
	<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_WGE_TOT_DTSS - pln.PLN_WGE_TOT_DTSS),0) as VAR_WGE_WTD_DTSS from 
(select lc.loc_nm,NVL(ROUND(sum(wge.PLN_WAGE_DTSS),0),0) as PLN_WGE_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm) pln,
(select lc.loc_nm,NVL(ROUND(wge.ACTL_WGE_TOT_DTSS,0),0) as ACTL_WGE_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_WGE_TOT_DTSS) as ACTL_WGE_TOT_DTSS from 
(select * from 
(select e.loc_no,sum(e.actl_amt) as ACTL_WGE_TOT_DTSS,sum(e.actl_hrs) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no order by e.loc_no) f
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (d.dply_seq) NOT IN 
(select distinct d.dply_seq from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) g ) h 
group by h.loc_no order by h.loc_no ) wge
on wge.loc_no=lc.loc_no) actl
where pln.loc_nm=actl.loc_nm]]>
	</VarWagesWkToDtTotal>
	

	<CurrentVarWagesWkToDtTotal>
	<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_WGE_TOT_DTSS - pln.PLN_WGE_TOT_DTSS),0) as VAR_WGE_WTD_DTSS from 
(select lc.loc_nm,NVL(ROUND(sum(wge.PLN_WAGE_DTSS),0),0) as PLN_WGE_TOT_DTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm) pln,
(select lc.loc_nm,NVL(ROUND(y.ACTL_WAGE_TOT_DTSS,0),0) as ACTL_WGE_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,sum(ACTL_WAGE_TOT_DTSS) as ACTL_WAGE_TOT_DTSS from 
(select * from 
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (d.dply_seq) NOT IN 
(select distinct d.dply_seq from ww_wlp.dly_wage a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) x ) z
group by z.loc_no order by z.loc_no ) y
on lc.loc_no=y.loc_no order by lc.loc_no) actl
where pln.loc_nm=actl.loc_nm]]>
	</CurrentVarWagesWkToDtTotal>
</TCName>

<TCName name = "ORColumnValidation" >
	
	<PlannedORTotal>
	<![CDATA[select sms_hrs.loc_nm,NVL(ROUND((sms_hrs.mon / pln_hrs.mon)*100,1),0) as Mon,NVL(ROUND((sms_hrs.tue / pln_hrs.tue)*100,1),0) as Tue,
NVL(ROUND((sms_hrs.wed / pln_hrs.wed)*100,1),0) as Wed,NVL(ROUND((sms_hrs.Thu / pln_hrs.Thu)*100,1),0) as Thu,
NVL(ROUND((sms_hrs.fri / pln_hrs.fri)*100,1),0) as Fri,NVL(ROUND((sms_hrs.sat / pln_hrs.sat)*100,1),0) as Sat,
NVL(ROUND((sms_hrs.sun / pln_hrs.sun)*100,1),0) as Sun from  
(select lc.loc_nm,sms.mon,sms.tue,sms.wed,sms.thu,sms.fri,sms.sat,sms.sun from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_TOT_DTSS from 
(select e.loc_no,e.dply_seq,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z ) sms
on sms.loc_no=lc.loc_no) sms_hrs,
(select lc.loc_nm,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DTSS)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DTSS)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DTSS)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DTSS)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DTSS)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DTSS)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DTSS)) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_HRS_DTS) as PLN_HRS_TOT_DTSS from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no) pln_hrs 
where sms_hrs.loc_nm=pln_hrs.loc_nm]]>
	</PlannedORTotal>
	
	<ActualORTotal>
	<![CDATA[select sms.loc_nm,
case when NVL(sms.mon,0)=0 and NVL(krn.mon,0)=0 then 0 when NVL(sms.mon,0)=0 then 0 when NVL(krn.mon,0)=0 then 0
else ROUND((sms.mon / krn.mon)*100,1) end as MON,
case when NVL(sms.tue,0)=0 and NVL(krn.tue,0)=0 then 0 when NVL(sms.tue,0)=0 then 0 when NVL(krn.tue,0)=0 then 0
else ROUND((sms.tue / krn.tue)*100,1) end as TUE,
case when NVL(sms.wed,0)=0 and NVL(krn.wed,0)=0 then 0 when NVL(sms.wed,0)=0 then 0 when NVL(krn.wed,0)=0 then 0
else ROUND((sms.wed / krn.wed)*100,1) end as WED,
case when NVL(sms.thu,0)=0 and NVL(krn.thu,0)=0 then 0 when NVL(sms.thu,0)=0 then 0 when NVL(krn.thu,0)=0 then 0
else ROUND((sms.thu / krn.thu)*100,1) end as THU,
case when NVL(sms.fri,0)=0 and NVL(krn.fri,0)=0 then 0 when NVL(sms.fri,0)=0 then 0 when NVL(krn.fri,0)=0 then 0
else ROUND((sms.fri / krn.fri)*100,1) end as FRI,
case when NVL(sms.sat,0)=0 and NVL(krn.sat,0)=0 then 0 when NVL(sms.sat,0)=0 then 0 when NVL(krn.sat,0)=0 then 0
else ROUND((sms.sat / krn.sat)*100,1) end as SAT,
case when NVL(sms.sun,0)=0 and NVL(krn.sun,0)=0 then 0 when NVL(sms.sun,0)=0 then 0 when NVL(krn.sun,0)=0 then 0
else ROUND((sms.sun / krn.sun)*100,1) end as SUN from 
(select lc.loc_nm,
NVL(xy.Monday,0) as mon,NVL(xy.Tuesday,0) as tue,NVL(xy.Wednesday,0) as wed,NVL(xy.Thursday,0) as thu,
NVL(xy.Friday,0) as fri,NVL(xy.Saturday,0) as sat,NVL(xy.Sunday,0) as sun from 
(select distinct loc_no,loc_nm from loc where loc_no='store' order by loc_no) lc
LEFT OUTER JOIN
(select xyz.loc_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select  loc_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSS )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSS )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSS )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSS )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSS )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSS )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSS )),0) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSS
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' 
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where src.dept_no IN (15,5,10)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no order by loc_no) xy
UNION 
select * from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no NOT IN (20,85,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (a.loc_no,tsk.dept_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.loc_no,src.dept_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
and A.day_of_wk in (0,1,2,3,4,5,6)
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
where e.dept_no IN (15,5,10)
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no)) xyz 
group by xyz.loc_no order by xyz.loc_no) xy
on lc.loc_no=xy.loc_no order by lc.loc_no) sms,
(select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTSS) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTSS,sum(e.actl_hrs) as ACTL_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end*/ and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and (a.loc_no,d.dply_seq,dy.day_of_wk) NOT IN 
(select distinct a.loc_no,d.dply_seq,dy.day_of_wk from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no) krn
where sms.loc_nm=krn.loc_nm]]>
	</ActualORTotal>
	
	<ActualORTotalSF>
	<![CDATA[select 'Seafood and deli' as Total,case when actl_sms.mon=0 and actl_hrs.mon=0 then 0 when actl_sms.mon=0 then 0 when actl_hrs.mon=0 then 0
else NVL(ROUND((actl_sms.mon / actl_hrs.mon)*100,1),0) end as Mon,
case when actl_sms.tue=0 and actl_hrs.tue=0 then 0 when actl_sms.tue=0 then 0 when actl_hrs.tue=0 then 0
else NVL(ROUND((actl_sms.tue / actl_hrs.tue)*100,1),0) end as tue,
case when actl_sms.wed=0 and actl_hrs.wed=0 then 0 when actl_sms.wed=0 then 0 when actl_hrs.wed=0 then 0
else NVL(ROUND((actl_sms.wed / actl_hrs.wed)*100,1),0) end as wed,
case when actl_sms.thu=0 and actl_hrs.thu=0 then 0 when actl_sms.thu=0 then 0 when actl_hrs.thu=0 then 0
else NVL(ROUND((actl_sms.thu / actl_hrs.thu)*100,1),0) end as thu,
case when actl_sms.fri=0 and actl_hrs.fri=0 then 0 when actl_sms.fri=0 then 0 when actl_hrs.fri=0 then 0
else NVL(ROUND((actl_sms.fri / actl_hrs.fri)*100,1),0) end as fri,
case when actl_sms.sat=0 and actl_hrs.sat=0 then 0 when actl_sms.sat=0 then 0 when actl_hrs.sat=0 then 0
else NVL(ROUND((actl_sms.sat / actl_hrs.sat)*100,1),0) end as sat,
case when actl_sms.sun=0 and actl_hrs.sun=0 then 0 when actl_sms.sun=0 then 0 when actl_hrs.sun=0 then 0
else NVL(ROUND((actl_sms.sun / actl_hrs.sun)*100,1),0) end as sun from 
(select 'Seafood and deli' as Store,sum(Monday) as Mon,sum(Tuesday) as Tue,sum(Wednesday) as Wed,sum(Thursday) as Thu,sum(Friday) as Fri,sum(Saturday) as Sat,sum(Sunday) as Sun
from
(select  dept_nm,dept_no,NVL(round(Sum(decode(day_of_wk, 0 , NVL(plan_sms_hrs,0) )),2),0) Monday ,
NVL(round(sum(decode(day_of_wk, 1 , NVL(plan_sms_hrs,0) )),2),0) Tuesday ,
NVL(round(sum(decode(day_of_wk, 2 , NVL(plan_sms_hrs,0) )),2),0) Wednesday ,
NVL(round(sum(decode(day_of_wk, 3 , NVL(plan_sms_hrs,0) )),2),0) Thursday ,
NVL(round(sum(decode(day_of_wk, 4 , NVL(plan_sms_hrs,0) )),2),0) Friday ,
NVL(round(sum(decode(day_of_wk, 5 , NVL(plan_sms_hrs,0) )),2),0) Saturday ,
NVL(round(sum(decode(day_of_wk, 6 , NVL(plan_sms_hrs,0) )),2),0) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
where dept_no in (55,40)
group by dept_nm , dept_no ))actl_sms,
(select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTSS),2) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTSS,sum(e.actl_hrs) as ACTL_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end*/ and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and (a.loc_no,d.dply_seq,dy.day_of_wk) NOT IN 
(select distinct a.loc_no,d.dply_seq,dy.day_of_wk from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no)actl_hrs]]>
	</ActualORTotalSF>
	
	<PlannedORWkToDtTotal>
	<![CDATA[select sms_hrs.loc_nm,NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) as WTD from  
(select lc.loc_nm,sms.wtd from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_TOT_DTSS from 
(select e.loc_no,e.dply_seq,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z ) sms
on sms.loc_no=lc.loc_no) sms_hrs,
(select lc.loc_nm,wge.PLN_HOURS_DTS as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (Department) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_no) pln_hrs 
where sms_hrs.loc_nm=pln_hrs.loc_nm]]>
	</PlannedORWkToDtTotal>	
	
	<ActualORWkToDtTotal>
	<![CDATA[select sms.loc_nm,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as WTD from 
(select lc.loc_nm,NVL(xy.ACTL_SMS_DTSS,0) as wtd from 
(select distinct loc_no,loc_nm from loc where loc_no='store' order by loc_no) lc
LEFT OUTER JOIN
(select xyz.loc_no,sum(xyz.ACTL_SMS_DTSS) as ACTL_SMS_DTSS from 
(select * from 
(select  loc_no,Sum(ACTL_SMS_DTSS) as ACTL_SMS_DTSS from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSS
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN (15,5,10)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no order by loc_no) xy
UNION
select * from 
(select h.loc_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no NOT IN (20,85,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (a.loc_no,tsk.dept_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.loc_no,src.dept_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
where e.dept_no IN (15,5,10)
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no order by h.loc_no)) xyz
group by xyz.loc_no order by xyz.loc_no) xy
on lc.loc_no=xy.loc_no order by lc.loc_no) sms,
(select lc.loc_nm,NVL(y.ACTL_HRS_TOT_DTSS,0) as wtd from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,sum(z.ACTL_HOURS_TOT_DTSS) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (d.dply_seq) NOT IN 
(select distinct d.dply_seq from ww_wlp.dly_wage a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) x ) z
group by z.loc_no order by z.loc_no ) y
on lc.loc_no=y.loc_no order by lc.loc_no) krn
where sms.loc_nm=krn.loc_nm]]>
	</ActualORWkToDtTotal>	
	
	<ActualORWkToDtTotalSF>
	<![CDATA[select sms.loc_nm,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as WTD from 
(select lc.loc_nm,NVL(xy.ACTL_SMS_DTSS,0) as wtd from 
(select distinct loc_no,loc_nm from loc where loc_no='store' order by loc_no) lc
LEFT OUTER JOIN
(select xyz.loc_no,sum(xyz.ACTL_SMS_DTSS) as ACTL_SMS_DTSS from 
(select * from 
(select  loc_no,Sum(ACTL_SMS_DTSS) as ACTL_SMS_DTSS from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSS
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN (40,55)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no order by loc_no) xy
UNION
select * from 
(select h.loc_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no NOT IN (20,85,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (a.loc_no,tsk.dept_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.loc_no,src.dept_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) src where dept_no NOT IN (20,85,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
where e.dept_no IN (40,55)
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no order by h.loc_no)) xyz
group by xyz.loc_no order by xyz.loc_no) xy
on lc.loc_no=xy.loc_no order by lc.loc_no) sms,
(select lc.loc_nm,NVL(y.ACTL_HRS_TOT_DTSS,0) as wtd from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,sum(z.ACTL_HOURS_TOT_DTSS) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (d.dply_seq) NOT IN 
(select distinct d.dply_seq from ww_wlp.dly_wage a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) x ) z
group by z.loc_no order by z.loc_no ) y
on lc.loc_no=y.loc_no order by lc.loc_no) krn
where sms.loc_nm=krn.loc_nm]]>
	</ActualORWkToDtTotalSF>	
</TCName>

<TCName name = "BeforePayRoleAdjustmentValidation" >

<ActualSMSLL>
<![CDATA[select 'Longlife' as stor_tot,
NVL(ROUND(xy.Monday,2),0) as mon,NVL(ROUND(xy.Tuesday,2),0) as tue,NVL(ROUND(xy.Wednesday,2),0) as wed,NVL(ROUND(xy.Thursday,2),0) as thu,
NVL(ROUND(xy.Friday,2),0) as fri,NVL(ROUND(xy.Saturday,2),0) as sat,NVL(ROUND(xy.Sunday,2),0) as sun from 
(select distinct loc_no,loc_nm from loc where loc_no='store' order by loc_no) lc
LEFT OUTER JOIN
(select xyz.loc_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select  loc_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSS )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSS )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSS )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSS )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSS )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSS )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSS )),0) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSS
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' 
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where src.dept_no IN (15,5,10)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no order by loc_no) xy
UNION 
select * from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no NOT IN (20,85,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (a.loc_no,tsk.dept_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.loc_no,src.dept_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
and A.day_of_wk in (0,1,2,3,4,5,6)
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
where e.dept_no IN (15,5,10)
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no)) xyz 
group by xyz.loc_no order by xyz.loc_no) xy
on lc.loc_no=xy.loc_no order by lc.loc_no]]>
</ActualSMSLL>

<ActualSMSSD>
<![CDATA[select 'SeaDeli' as stor_tot,
NVL(ROUND(xy.Monday,2),0) as mon,NVL(ROUND(xy.Tuesday,2),0) as tue,NVL(ROUND(xy.Wednesday,2),0) as wed,NVL(ROUND(xy.Thursday,2),0) as thu,
NVL(ROUND(xy.Friday,2),0) as fri,NVL(ROUND(xy.Saturday,2),0) as sat,NVL(ROUND(xy.Sunday,2),0) as sun from 
(select distinct loc_no,loc_nm from loc where loc_no='store' order by loc_no) lc
LEFT OUTER JOIN
(select xyz.loc_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select  loc_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSS )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSS )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSS )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSS )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSS )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSS )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSS )),0) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSS
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' 
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where src.dept_no IN (40,55)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no order by loc_no) xy
UNION 
select * from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no NOT IN (20,85,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (a.loc_no,tsk.dept_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.loc_no,src.dept_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
and A.day_of_wk in (0,1,2,3,4,5,6)
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
where e.dept_no IN (40,55)
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no)) xyz 
group by xyz.loc_no order by xyz.loc_no) xy
on lc.loc_no=xy.loc_no order by lc.loc_no]]>
	</ActualSMSSD>

<ActualSMSWkToDtSD>
	<![CDATA[select 'SeaDeli' as stor_tot,NVL(ROUND(xy.ACTL_SMS_DTSS,2),0) as wtd from 
(select distinct loc_no,loc_nm from loc where loc_no='store' order by loc_no) lc
LEFT OUTER JOIN
(select xyz.loc_no,sum(xyz.ACTL_SMS_DTSS) as ACTL_SMS_DTSS from 
(select * from 
(select  loc_no,Sum(ACTL_SMS_DTSS) as ACTL_SMS_DTSS from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSS
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN (40,55)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no order by loc_no) xy
UNION
select * from 
(select h.loc_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no NOT IN (20,85,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (a.loc_no,tsk.dept_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.loc_no,src.dept_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) src where dept_no NOT IN (20,85,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
where e.dept_no IN (40,55)
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no order by h.loc_no)) xyz
group by xyz.loc_no order by xyz.loc_no) xy
on lc.loc_no=xy.loc_no order by lc.loc_no]]>
</ActualSMSWkToDtSD>

<ActualSMSWkToDtLL>
	<![CDATA[select 'Longlife' as stor_tot,NVL(ROUND(xy.ACTL_SMS_DTSS,2),0) as wtd from 
(select distinct loc_no,loc_nm from loc where loc_no='store' order by loc_no) lc
LEFT OUTER JOIN
(select xyz.loc_no,sum(xyz.ACTL_SMS_DTSS) as ACTL_SMS_DTSS from 
(select * from 
(select  loc_no,Sum(ACTL_SMS_DTSS) as ACTL_SMS_DTSS from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSS
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN (15,5,10)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no order by loc_no) xy
UNION
select * from 
(select h.loc_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no NOT IN (20,85,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (a.loc_no,tsk.dept_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.loc_no,src.dept_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
where e.dept_no IN (15,5,10)
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no order by h.loc_no)) xyz
group by xyz.loc_no order by xyz.loc_no) xy
on lc.loc_no=xy.loc_no order by lc.loc_no]]>
</ActualSMSWkToDtLL>

		<ActualORLL>
	<![CDATA[select sms.loc_nm,
case when NVL(sms.mon,0)=0 and NVL(krn.mon,0)=0 then 0 when NVL(sms.mon,0)=0 then 0 when NVL(krn.mon,0)=0 then 0
else ROUND((sms.mon / krn.mon)*100,1) end as MON,
case when NVL(sms.tue,0)=0 and NVL(krn.tue,0)=0 then 0 when NVL(sms.tue,0)=0 then 0 when NVL(krn.tue,0)=0 then 0
else ROUND((sms.tue / krn.tue)*100,1) end as TUE,
case when NVL(sms.wed,0)=0 and NVL(krn.wed,0)=0 then 0 when NVL(sms.wed,0)=0 then 0 when NVL(krn.wed,0)=0 then 0
else ROUND((sms.wed / krn.wed)*100,1) end as WED,
case when NVL(sms.thu,0)=0 and NVL(krn.thu,0)=0 then 0 when NVL(sms.thu,0)=0 then 0 when NVL(krn.thu,0)=0 then 0
else ROUND((sms.thu / krn.thu)*100,1) end as THU,
case when NVL(sms.fri,0)=0 and NVL(krn.fri,0)=0 then 0 when NVL(sms.fri,0)=0 then 0 when NVL(krn.fri,0)=0 then 0
else ROUND((sms.fri / krn.fri)*100,1) end as FRI,
case when NVL(sms.sat,0)=0 and NVL(krn.sat,0)=0 then 0 when NVL(sms.sat,0)=0 then 0 when NVL(krn.sat,0)=0 then 0
else ROUND((sms.sat / krn.sat)*100,1) end as SAT,
case when NVL(sms.sun,0)=0 and NVL(krn.sun,0)=0 then 0 when NVL(sms.sun,0)=0 then 0 when NVL(krn.sun,0)=0 then 0
else ROUND((sms.sun / krn.sun)*100,1) end as SUN from 
(select lc.loc_nm,
NVL(xy.Monday,0) as mon,NVL(xy.Tuesday,0) as tue,NVL(xy.Wednesday,0) as wed,NVL(xy.Thursday,0) as thu,
NVL(xy.Friday,0) as fri,NVL(xy.Saturday,0) as sat,NVL(xy.Sunday,0) as sun from 
(select distinct loc_no,loc_nm from loc where loc_no='store' order by loc_no) lc
LEFT OUTER JOIN
(select xyz.loc_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select  loc_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSS )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSS )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSS )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSS )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSS )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSS )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSS )),0) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSS
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' 
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where src.dept_no IN (15,5,10)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no order by loc_no) xy
UNION 
select * from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no NOT IN (20,85,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (a.loc_no,tsk.dept_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.loc_no,src.dept_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
and A.day_of_wk in (0,1,2,3,4,5,6)
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
where e.dept_no IN (15,5,10)
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no)) xyz 
group by xyz.loc_no order by xyz.loc_no) xy
on lc.loc_no=xy.loc_no order by lc.loc_no) sms,
(select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTSS) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTSS,sum(e.actl_hrs) as ACTL_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end*/ and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and (a.loc_no,d.dply_seq,dy.day_of_wk) NOT IN 
(select distinct a.loc_no,d.dply_seq,dy.day_of_wk from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no) krn
where sms.loc_nm=krn.loc_nm]]>
</ActualORLL>

<ActualORSD>
<![CDATA[select sms.loc_nm,
case when NVL(sms.mon,0)=0 and NVL(krn.mon,0)=0 then 0 when NVL(sms.mon,0)=0 then 0 when NVL(krn.mon,0)=0 then 0
else ROUND((sms.mon / krn.mon)*100,1) end as MON,
case when NVL(sms.tue,0)=0 and NVL(krn.tue,0)=0 then 0 when NVL(sms.tue,0)=0 then 0 when NVL(krn.tue,0)=0 then 0
else ROUND((sms.tue / krn.tue)*100,1) end as TUE,
case when NVL(sms.wed,0)=0 and NVL(krn.wed,0)=0 then 0 when NVL(sms.wed,0)=0 then 0 when NVL(krn.wed,0)=0 then 0
else ROUND((sms.wed / krn.wed)*100,1) end as WED,
case when NVL(sms.thu,0)=0 and NVL(krn.thu,0)=0 then 0 when NVL(sms.thu,0)=0 then 0 when NVL(krn.thu,0)=0 then 0
else ROUND((sms.thu / krn.thu)*100,1) end as THU,
case when NVL(sms.fri,0)=0 and NVL(krn.fri,0)=0 then 0 when NVL(sms.fri,0)=0 then 0 when NVL(krn.fri,0)=0 then 0
else ROUND((sms.fri / krn.fri)*100,1) end as FRI,
case when NVL(sms.sat,0)=0 and NVL(krn.sat,0)=0 then 0 when NVL(sms.sat,0)=0 then 0 when NVL(krn.sat,0)=0 then 0
else ROUND((sms.sat / krn.sat)*100,1) end as SAT,
case when NVL(sms.sun,0)=0 and NVL(krn.sun,0)=0 then 0 when NVL(sms.sun,0)=0 then 0 when NVL(krn.sun,0)=0 then 0
else ROUND((sms.sun / krn.sun)*100,1) end as SUN from 
(select lc.loc_nm,
NVL(xy.Monday,0) as mon,NVL(xy.Tuesday,0) as tue,NVL(xy.Wednesday,0) as wed,NVL(xy.Thursday,0) as thu,
NVL(xy.Friday,0) as fri,NVL(xy.Saturday,0) as sat,NVL(xy.Sunday,0) as sun from 
(select distinct loc_no,loc_nm from loc where loc_no='store' order by loc_no) lc
LEFT OUTER JOIN
(select xyz.loc_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select  loc_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSS )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSS )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSS )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSS )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSS )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSS )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSS )),0) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSS
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' 
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where src.dept_no IN (40,55)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no order by loc_no) xy
UNION 
select * from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no NOT IN (20,85,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (a.loc_no,tsk.dept_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.loc_no,src.dept_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
and A.day_of_wk in (0,1,2,3,4,5,6)
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
where e.dept_no IN (40,55)
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no)) xyz 
group by xyz.loc_no order by xyz.loc_no) xy
on lc.loc_no=xy.loc_no order by lc.loc_no) sms,
(select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTSS) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTSS,sum(e.actl_hrs) as ACTL_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end*/ and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and (a.loc_no,d.dply_seq,dy.day_of_wk) NOT IN 
(select distinct a.loc_no,d.dply_seq,dy.day_of_wk from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no) krn
where sms.loc_nm=krn.loc_nm]]>
	</ActualORSD>

<ActualORWkToDtLL>
<![CDATA[select sms.loc_nm,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as WTD from 
(select lc.loc_nm,NVL(xy.ACTL_SMS_DTSS,0) as wtd from 
(select distinct loc_no,loc_nm from loc where loc_no='store' order by loc_no) lc
LEFT OUTER JOIN
(select xyz.loc_no,sum(xyz.ACTL_SMS_DTSS) as ACTL_SMS_DTSS from 
(select * from 
(select  loc_no,Sum(ACTL_SMS_DTSS) as ACTL_SMS_DTSS from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSS
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN (15,5,10)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no order by loc_no) xy
UNION
select * from 
(select h.loc_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no NOT IN (20,85,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (a.loc_no,tsk.dept_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.loc_no,src.dept_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
where e.dept_no IN (15,5,10)
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no order by h.loc_no)) xyz
group by xyz.loc_no order by xyz.loc_no) xy
on lc.loc_no=xy.loc_no order by lc.loc_no) sms,
(select lc.loc_nm,NVL(y.ACTL_HRS_TOT_DTSS,0) as wtd from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,sum(z.ACTL_HOURS_TOT_DTSS) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (d.dply_seq) NOT IN 
(select distinct d.dply_seq from ww_wlp.dly_wage a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) x ) z
group by z.loc_no order by z.loc_no ) y
on lc.loc_no=y.loc_no order by lc.loc_no) krn
where sms.loc_nm=krn.loc_nm]]>
</ActualORWkToDtLL>

<ActualORWkToDtSD>
<![CDATA[select sms.loc_nm,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as WTD from 
(select lc.loc_nm,NVL(xy.ACTL_SMS_DTSS,0) as wtd from 
(select distinct loc_no,loc_nm from loc where loc_no='store' order by loc_no) lc
LEFT OUTER JOIN
(select xyz.loc_no,sum(xyz.ACTL_SMS_DTSS) as ACTL_SMS_DTSS from 
(select * from 
(select  loc_no,Sum(ACTL_SMS_DTSS) as ACTL_SMS_DTSS from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSS
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no IN (40,55)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no order by loc_no) xy
UNION
select * from 
(select h.loc_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSS from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no=3 and b.loc_no='store' and tsk.dept_no NOT IN (20,85,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (a.loc_no,tsk.dept_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.loc_no,src.dept_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no=3 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store'
order by A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) src where dept_no NOT IN (20,85,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
where e.dept_no IN (40,55)
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) h 
group by h.loc_no order by h.loc_no)) xyz
group by xyz.loc_no order by xyz.loc_no) xy
on lc.loc_no=xy.loc_no order by lc.loc_no) sms,
(select lc.loc_nm,NVL(y.ACTL_HRS_TOT_DTSS,0) as wtd from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,sum(z.ACTL_HOURS_TOT_DTSS) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (d.dply_seq) NOT IN 
(select distinct d.dply_seq from ww_wlp.dly_wage a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) x ) z
group by z.loc_no order by z.loc_no ) y
on lc.loc_no=y.loc_no order by lc.loc_no) krn
where sms.loc_nm=krn.loc_nm]]>
	</ActualORWkToDtSD>
	
	<ActualHoursSD>
	<![CDATA[select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTSS),2) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTSS,sum(e.actl_hrs) as ACTL_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTSS,sum(e.ta_pln_adj_hrs) as PLN_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_adj_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end*/ and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and (a.loc_no,d.dply_seq,dy.day_of_wk) NOT IN 
(select distinct a.loc_no,d.dply_seq,dy.day_of_wk from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no]]>
	</ActualHoursSD>
	<ActualHoursTotalSD>
	<![CDATA[select lc.loc_nm,NVL(ROUND(wge.ACTL_HRS_TOT_DTSS,2),0) as WTD from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_HRS_TOT_DTSS) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,sum(e.actl_amt) as ACTL_WGE_TOT_DTSS,sum(e.actl_hrs) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no order by e.loc_no) f
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_adj_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_adj_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (d.dply_seq) NOT IN 
(select distinct d.dply_seq from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (40,55) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) g) h
group by h.loc_no order by h.loc_no) wge
on wge.loc_no=lc.loc_no]]>
	</ActualHoursTotalSD>
	
	<ActualHoursLL>
	<![CDATA[select lc.loc_nm,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTSS),2) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTSS,sum(e.actl_hrs) as ACTL_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTSS,sum(e.ta_pln_adj_hrs) as PLN_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_adj_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end*/ and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and (a.loc_no,d.dply_seq,dy.day_of_wk) NOT IN 
(select distinct a.loc_no,d.dply_seq,dy.day_of_wk from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) wge
on wge.loc_no=lc.loc_no]]>
	</ActualHoursLL>
	<ActualHoursTotalLL>
	<![CDATA[select lc.loc_nm,NVL(ROUND(wge.ACTL_HRS_TOT_DTSS,2),0) as WTD from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_HRS_TOT_DTSS) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,sum(e.actl_amt) as ACTL_WGE_TOT_DTSS,sum(e.actl_hrs) as ACTL_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no order by e.loc_no) f
UNION
select * from 
(select e.loc_no,sum(e.ta_pln_wage_amt) as PLN_WGE_TOT_DTSS,sum(e.ta_pln_adj_hrs) as PLN_HRS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_adj_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (d.dply_seq) NOT IN 
(select distinct d.dply_seq from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=3 and b.loc_no='store' and a.dept_no IN (5,10,15) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) g) h
group by h.loc_no order by h.loc_no) wge
on wge.loc_no=lc.loc_no]]>
	</ActualHoursTotalLL>	
</TCName>
</configuration>