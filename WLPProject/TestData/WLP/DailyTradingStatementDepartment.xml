<?xml version="1.0" encoding="UTF-8" ?> 

<configuration>
<TCName name="SalesColumnValidation_DTSDepartment">
<PlannedSales>
<![CDATA[select lc.days,NVL(rslt.PLN_SLS_DTSD,0) as PLN_SLS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
    LEFT OUTER JOIN 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DTSD from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) rslt
on lc.day_of_wk=rslt.dte_of_wk order by lc.day_of_wk]]> 
  </PlannedSales>
  
  <PlannedSalesTotal>
<![CDATA[select lc.dept_nm,NVL(rslt.PLN_SLS_TOT_DTSD,0) as PLN_SLS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
    LEFT OUTER JOIN 
(select h.dply_seq,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_TOT_DTSD from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.dply_seq order by h.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq]]> 
  </PlannedSalesTotal>
  
  <ActualSales>
<![CDATA[select lc.days,NVL(rslt.ACTL_SLS_DTS,0) as ACTL_SLS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_itm_cnt),0) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk]]> 
  </ActualSales>
  
  <ActualSalesTotal>
<![CDATA[select lc.dept_nm,NVL(rslt.ACTL_SLS_DTS,0) as ACTL_SLS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_itm_cnt),0) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq]]> 
  </ActualSalesTotal>
  
  <VARSales>
<![CDATA[select pln.days,(actl.ACTL_SLS_DTSD - pln.PLN_SLS_DTSD) as VAR_SLS_DTSD from 
(select lc.days,NVL(rslt.PLN_SLS_DTSS,0) as PLN_SLS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
    LEFT OUTER JOIN 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) rslt
on lc.day_of_wk=rslt.dte_of_wk order by lc.day_of_wk)pln
LEFT OUTER JOIN
(select lc.days,NVL(rslt.ACTL_SLS_DTS,0) as ACTL_SLS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_itm_cnt),0) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk)actl
on pln.days=actl.days]]> 
  </VARSales>
  
<VARSalesTotal>
<![CDATA[select pln.dept_nm,(actl.ACTL_SLS_TOT_DTSD - pln.PLN_SLS_TOT_DTSD) as VAR_SLS_TOT_DTSD from 
(select lc.dept_nm,NVL(rslt.PLN_SLS_TOT_DTSD,0) as PLN_SLS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
    LEFT OUTER JOIN 
(select h.dply_seq,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_TOT_DTSD from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.dply_seq order by h.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq)pln,
(select lc.dept_nm,NVL(rslt.ACTL_SLS_DTS,0) as ACTL_SLS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_itm_cnt),0) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq) actl
where pln.dept_nm=actl.dept_nm]]> 
  </VARSalesTotal>
  
  <LYSales>
<![CDATA[select actl_cy.days,
CASE WHEN NVL(actl_cy.ACTL_SLS_DTSD,0) = 0 AND  NVL(actl_ly.ACTL_SLS_DTSD,0) = 0 THEN 100
WHEN NVL(actl_cy.ACTL_SLS_DTSD,0) = 0 THEN -100 WHEN NVL(actl_ly.ACTL_SLS_DTSD,0) = 0 THEN 0
ELSE ROUND(((actl_cy.ACTL_SLS_DTSD / actl_ly.ACTL_SLS_DTSD)-1)*100,2) END as ACTL_SLS_DTSD from 
(select lc.days,NVL(rslt.ACTL_SLS_DTS,0) as ACTL_SLS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_itm_cnt),0) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk) actl_cy
LEFT OUTER JOIN
(select lc.days,NVL(rslt.ACTL_SLS_DTS,0) as ACTL_SLS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_itm_cnt),0) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk) actl_ly
on actl_cy.Days=actl_ly.Days ]]> 
  </LYSales>
    
  <LYSalesTotal>
<![CDATA[select actl_cy.dept_nm,
CASE WHEN NVL(actl_cy.ACTL_SLS_TOT_DTSD,0) = 0 AND NVL(actl_ly.ACTL_SLS_TOT_DTSD,0) = 0 THEN 100  
WHEN NVL(actl_cy.ACTL_SLS_TOT_DTSD,0) = 0 THEN -100 WHEN NVL(actl_ly.ACTL_SLS_TOT_DTSD,0) = 0 THEN 0
ELSE ROUND(((actl_cy.ACTL_SLS_TOT_DTSD / actl_ly.ACTL_SLS_TOT_DTSD)-1)*100,2) END as ACTL_SLS_TOT_DTSD from 
(select lc.dept_nm,NVL(rslt.ACTL_SLS_DTS,0) as ACTL_SLS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_itm_cnt),0) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq) actl_cy
LEFT OUTER JOIN
(select lc.dept_nm,NVL(rslt.ACTL_SLS_DTS,0) as ACTL_SLS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_itm_cnt),0) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq) actl_ly
on actl_cy.dept_nm=actl_ly.dept_nm ]]> 
  </LYSalesTotal>
  
  
  <DailyMixSales>
<![CDATA[select lc.days,NVL(ROUND((rslt.actl_sls / rslt.str_dly_sls)*100,2),0) as DLY_MIX_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk) lc
LEFT OUTER JOIN
(select act_sls.day_of_wk,act_sls.actl_sls,str_ly_sls.str_dly_sls from 
(select day_Num.day_of_wk,ds.txn_dte,ds.loc_no,ds.dept_no,ds.div_no,ds.actl_sls,ds.actl_cust_cnt,ds.actl_itm_cnt
from(select txn_dte,loc_no,dept_no,div_no,actl_sls,actl_cust_cnt,actl_itm_cnt from dly_sls where loc_no = 'store' and dept_no = 'DepartmentToView'
and div_no = 'Division' and txn_dte between (select wk_strt from wk  where wk_id= 'Week') and (select wk_end from wk  where wk_id= 'Week' ) )ds
join (select day_of_wk,day_dte from day where wk_id = 'Week') day_Num on ds.txn_dte = day_Num.day_dte) act_sls,
(select ds.txn_dte, d.day_of_wk,sum(actl_sls) str_dly_sls from dly_sls ds,day d where d.day_dte= ds.txn_dte and d.wk_id='Week'
and ds.loc_no='store' and ds.dept_no  in ('DepartmentToView') group by ds.loc_no, ds.txn_dte, d.day_of_wk) str_ly_sls
where act_sls.day_of_wk=str_ly_sls.day_of_wk order by act_sls.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk]]> 
  </DailyMixSales>
  
  <DailyMixSalesTotal>
<![CDATA[select rslt.STR_TOT,NVL(ROUND((rslt.actl_sls / rslt.str_dly_sls)*100,2),0) as DLY_MIX_TOT_DTSD from 
(select 'Store Total' as STR_TOT,sum(act_sls.actl_sls) as actl_sls,sum(str_ly_sls.str_dly_sls) as str_dly_sls from 
(select day_Num.day_of_wk,ds.txn_dte,ds.loc_no,ds.dept_no,ds.div_no,ds.actl_sls,ds.actl_cust_cnt,ds.actl_itm_cnt
from(select txn_dte,loc_no,dept_no,div_no,actl_sls,actl_cust_cnt,actl_itm_cnt from dly_sls where loc_no = 'store' and dept_no = 'DepartmentToView'
and div_no = 'Division' and txn_dte between (select wk_strt from wk  where wk_id= 'Week') and (select wk_end from wk  where wk_id= 'Week' ) )ds
join (select day_of_wk,day_dte from day where wk_id = 'Week') day_Num on ds.txn_dte = day_Num.day_dte) act_sls,
(select ds.txn_dte, d.day_of_wk,sum(actl_sls) str_dly_sls from dly_sls ds,day d where d.day_dte= ds.txn_dte and d.wk_id='Week'
and ds.loc_no='store' and ds.dept_no  in ('DepartmentToView')  group by ds.loc_no, ds.txn_dte, d.day_of_wk) str_ly_sls
where act_sls.day_of_wk=str_ly_sls.day_of_wk order by act_sls.day_of_wk) rslt]]> 
  </DailyMixSalesTotal>
  
  <BudgetSalesTotal>
<![CDATA[select lc.dept_nm,NVL(ROUND(bdgt.bdgt_sls,0),0) as BDGT_SLS_TOT_DTSD from 
	(select dply_seq,dept_nm from dept where div_no='Division' and dply_seq is NOT NULL and dept_no IN ('DepartmentToView') order by dply_seq) lc 
	LEFT OUTER JOIN
	(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
	from wky_bdgt a, loc b, wk c, dept d 
	where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
	and a.wk_id=c.wk_id  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no IN ('DepartmentToView') 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
	on lc.dply_seq=bdgt.dply_seq and lc.dept_nm=bdgt.dept_nm
	order by lc.dply_seq]]> 
  </BudgetSalesTotal>
  
  
  <ForecastSalesTotal>
<![CDATA[select lc.dept_nm,NVL(ROUND(fcst.frcst_sls,0),0) as FCST_SLS_TOT_DTSD from 
	(select dply_seq,dept_nm from dept where div_no='Division' and dply_seq is NOT NULL and dept_no IN ('DepartmentToView') order by dply_seq) lc 
	LEFT OUTER JOIN
	(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
	from mnth_fcst a, loc b, wk c, dept d 
	where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
	and a.wk_id=c.wk_id  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no IN ('DepartmentToView') 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
	on lc.dply_seq=fcst.dply_seq and lc.dept_nm=fcst.dept_nm
	order by lc.dply_seq]]> 
  </ForecastSalesTotal>
  
  
  <VartoBudPerSalesTotal>
<![CDATA[select estd_fcst.dept_nm,ROUND((estd_fcst.ESTD_FCST_SLS_TOT_DTSD - bdgt.BDGT_SLS_TOT_DTSD),0) as BDGT_VAR_SLS_TOT_DTSD from 
	(select lc.dept_nm,NVL(y.TOT,0) as ESTD_FCST_SLS_TOT_DTSD from 
	(select dply_seq,dept_nm from dept where div_no='Division' and dply_seq is NOT NULL and dept_no IN ('DepartmentToView') order by dply_seq) lc 
	LEFT OUTER JOIN
	(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as TOT from 
	(select b.dply_seq,b.dept_nm,
	NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTS)),0) Sun from 
	(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.ACTL_SLS_DTS from 
	(select * from 
	(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
	nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
	from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
	and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
	and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
	and a.actl_sls is not NULL and a.actl_sls!=0
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
	group by e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) f) h ) b
	group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x) y
	on lc.dept_nm=y.dept_nm order by lc.dply_seq) estd_fcst,
	(select lc.dept_nm,NVL(bdgt.bdgt_sls,0) as BDGT_SLS_TOT_DTSD from 
	(select dply_seq,dept_nm from dept where div_no='Division' and dply_seq is NOT NULL and dept_no IN ('DepartmentToView') order by dply_seq) lc 
	LEFT OUTER JOIN
	(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
	from wky_bdgt a, loc b, wk c, dept d 
	where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
	and a.wk_id=c.wk_id  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN ('DepartmentToView') 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
	on lc.dply_seq=bdgt.dply_seq and lc.dept_nm=bdgt.dept_nm
	order by lc.dply_seq) bdgt
	where estd_fcst.dept_nm=bdgt.dept_nm]]> 
  </VartoBudPerSalesTotal>
  
  
  <VartoFcstPerSalesTotal>
<![CDATA[select estd_fcst.dept_nm,ROUND((estd_fcst.ESTD_FCST_SLS_TOT_DTSD - fcst.fcst_SLS_TOT_DTSD),0) as fcst_VAR_SLS_TOT_DTSD from 
	(select lc.dept_nm,NVL(y.wtd,0) as ESTD_FCST_SLS_TOT_DTSD from 
	(select dply_seq,dept_nm from dept where div_no='Division' and dply_seq is NOT NULL and dept_no IN ('DepartmentToView') order by dply_seq) lc 
	LEFT OUTER JOIN
	(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
	(select b.dply_seq,b.dept_nm,
	NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTS)),0) Sun from 
	(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.ACTL_SLS_DTS from 
	(select * from 
	(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
	nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
	from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
	and a.txn_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
	and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
	and a.actl_sls is not NULL and a.actl_sls!=0
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
	group by e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) f) h ) b
	group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x) y
	on lc.dept_nm=y.dept_nm order by lc.dply_seq) estd_fcst,
	(select lc.dept_nm,NVL(ROUND(fcst.FRCST_sls,0),0) as fcst_SLS_TOT_DTSD from 
	(select dply_seq,dept_nm from dept where div_no='Division' and dply_seq is NOT NULL and dept_no IN ('DepartmentToView') order by dply_seq) lc 
	LEFT OUTER JOIN
	(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
	from MNTH_FCST a, loc b, wk c, dept d 
	where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
	and a.wk_id=c.wk_id  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no IN ('DepartmentToView') 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
	on lc.dply_seq=fcst.dply_seq and lc.dept_nm=fcst.dept_nm
	order by lc.dply_seq) fcst
	where estd_fcst.dept_nm=fcst.dept_nm]]> 
  </VartoFcstPerSalesTotal>
  
  
  <PertoBudSalesTotal>
<![CDATA[select var.dept_nm,case when Var.BDGT_VAR_SLS_TOT_DTSD=0 then 0 when BudgetSales.BDGT_SLS_TOT_DTSD=0 then 0
else NVL(ROUND(((Var.BDGT_VAR_SLS_TOT_DTSD/BudgetSales.BDGT_SLS_TOT_DTSD)*100),2),0) end as ACTL_SLS_PRCNT_DAY from 
	(select estd_fcst.dept_nm,ROUND((estd_fcst.ESTD_FCST_SLS_TOT_DTSD - bdgt.BDGT_SLS_TOT_DTSD),0) as BDGT_VAR_SLS_TOT_DTSD from 
	(select lc.dept_nm,NVL(y.wtd,0) as ESTD_FCST_SLS_TOT_DTSD from 
	(select dply_seq,dept_nm from dept where div_no='Division' and dply_seq is NOT NULL and dept_no IN ('DepartmentToView') order by dply_seq) lc 
	LEFT OUTER JOIN
	(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
	(select b.dply_seq,b.dept_nm,
	NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTS)),0) Sun from 
	(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.ACTL_SLS_DTS from 
	(select * from 
	(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
	nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
	from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
	and a.txn_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
	and a.actl_sls is not NULL and a.actl_sls!=0
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
	group by e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) f) h ) b
	group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x) y
	on lc.dept_nm=y.dept_nm order by lc.dply_seq) estd_fcst,
	(select lc.dept_nm,NVL(ROUND(bdgt.bdgt_sls,0),0) as BDGT_SLS_TOT_DTSD from 
	(select dply_seq,dept_nm from dept where div_no='Division' and dply_seq is NOT NULL and dept_no IN ('DepartmentToView') order by dply_seq) lc 
	LEFT OUTER JOIN
	(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
	from wky_bdgt a, loc b, wk c, dept d 
	where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
	and a.wk_id=c.wk_id  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN ('DepartmentToView') 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
	on lc.dply_seq=bdgt.dply_seq and lc.dept_nm=bdgt.dept_nm
	order by lc.dply_seq) bdgt
	where estd_fcst.dept_nm=bdgt.dept_nm) Var,
	(select lc.dept_nm,NVL(ROUND(bdgt.bdgt_sls,0),0) as BDGT_SLS_TOT_DTSD from 
	(select dply_seq,dept_nm from dept where div_no='Division' and dply_seq is NOT NULL and dept_no IN ('DepartmentToView') order by dply_seq) lc 
	LEFT OUTER JOIN
	(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
	from wky_bdgt a, loc b, wk c, dept d 
	where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
	and a.wk_id=c.wk_id  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN ('DepartmentToView') 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
	on lc.dply_seq=bdgt.dply_seq and lc.dept_nm=bdgt.dept_nm
	order by lc.dply_seq) BudgetSales
	where Var.dept_nm=BudgetSales.dept_nm]]> 
  </PertoBudSalesTotal>
  
  
  <PertoFcstSalesTotal>
<![CDATA[select var.dept_nm,case when Var.FCST_VAR_SLS_TOT_DTSD=0 then 0 when BudgetSales.fcst_SLS_TOT_DTSD=0 then 0
else NVL(ROUND(((Var.fcst_VAR_SLS_TOT_DTSD/BudgetSales.fcst_SLS_TOT_DTSD)*100),2),0) end as ACTL_SLS_PRCNT_DAY from 
	(select estd_fcst.dept_nm,ROUND((estd_fcst.ESTD_FCST_SLS_TOT_DTSD - fcst.fcst_SLS_TOT_DTSD),9) as fcst_VAR_SLS_TOT_DTSD from 
	(select lc.dept_nm,NVL(y.wtd,0) as ESTD_FCST_SLS_TOT_DTSD from 
	(select dply_seq,dept_nm from dept where div_no='Division' and dply_seq is NOT NULL and dept_no IN ('DepartmentToView') order by dply_seq) lc 
	LEFT OUTER JOIN
	(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),9) as WTD from 
	(select b.dply_seq,b.dept_nm,
	NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTS)),0) Mon,
	NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTS)),0) Tue,
	NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTS)),0) Wed,
	NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTS)),0) Thu,
	NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTS)),0) Fri,
	NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTS)),0) Sat,
	NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTS)),0) Sun from 
	(select h.dply_seq,h.dept_nm,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.ACTL_SLS_DTS from 
	(select * from 
	(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
	nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
	from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
	and a.txn_dte between c.wk_strt and sysdate-1  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
	and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
	and a.actl_sls is not NULL and a.actl_sls!=0
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
	group by e.dply_seq,e.dept_nm,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) f) h ) b
	group by b.dply_seq,b.dept_nm order by b.dply_seq,b.dept_nm) x) y
	on lc.dept_nm=y.dept_nm order by lc.dply_seq) estd_fcst,
	(select lc.dept_nm,NVL(ROUND(fcst.FRCST_sls,9),0) as fcst_SLS_TOT_DTSD from 
	(select dply_seq,dept_nm from dept where div_no='Division' and dply_seq is NOT NULL and dept_no IN ('DepartmentToView') order by dply_seq) lc 
	LEFT OUTER JOIN
	(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
	from MNTH_FCST a, loc b, wk c, dept d 
	where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
	and a.wk_id=c.wk_id  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no IN ('DepartmentToView') 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
	on lc.dply_seq=fcst.dply_seq and lc.dept_nm=fcst.dept_nm
	order by lc.dply_seq) fcst
	where estd_fcst.dept_nm=fcst.dept_nm) Var,
	(select lc.dept_nm,NVL(ROUND(fcst.frcst_sls,9),0) as FCST_SLS_TOT_DTSD from 
	(select dply_seq,dept_nm from dept where div_no='Division' and dply_seq is NOT NULL and dept_no IN ('DepartmentToView') order by dply_seq) lc 
	LEFT OUTER JOIN
	(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
	from mnth_fcst a, loc b, wk c, dept d 
	where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
	and a.wk_id=c.wk_id  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no IN ('DepartmentToView') 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
	on lc.dply_seq=fcst.dply_seq and lc.dept_nm=fcst.dept_nm
	order by lc.dply_seq) BudgetSales
	where Var.dept_nm=BudgetSales.dept_nm]]> 
  </PertoFcstSalesTotal>
  
  </TCName>

  <TCName name="ItemsColumnValidation_DTSDepartment">
  
  <PlannedItems>
<![CDATA[select lc.days,NVL(rslt.PLN_ITM_DTSD,0) as PLN_ITM_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
    LEFT OUTER JOIN 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DTSD from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) rslt
on lc.day_of_wk=rslt.dte_of_wk order by lc.day_of_wk]]> 
  </PlannedItems>
  
  <PlannedItemsTotal>
<![CDATA[select lc.dept_nm,NVL(rslt.PLN_ITM_TOT_DTSD,0) as PLN_ITM_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
    LEFT OUTER JOIN 
(select h.dply_seq,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_TOT_DTSD from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.dply_seq order by h.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq]]> 
  </PlannedItemsTotal>
  
  <ActualItems>
<![CDATA[select lc.days,NVL(rslt.ACTL_ITM_DTS,0) as ACTL_ITM_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_itm_cnt),0) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk]]> 
  </ActualItems>
  
  <ActualItemsTotal>
<![CDATA[select lc.dept_nm,NVL(rslt.ACTL_ITM_DTS,0) as ACTL_ITM_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_itm_cnt),0) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq]]> 
  </ActualItemsTotal>
  
  <VARItems>
<![CDATA[select pln.days,(actl.ACTL_ITM_DTSD - pln.PLN_ITM_DTSD) as VAR_ITM_DTSD from 
(select lc.days,NVL(rslt.PLN_ITM_DTSD,0) as PLN_ITM_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
    LEFT OUTER JOIN 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DTSD from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) rslt
on lc.day_of_wk=rslt.dte_of_wk order by lc.day_of_wk)pln
LEFT OUTER JOIN
(select lc.days,NVL(rslt.ACTL_ITM_DTS,0) as ACTL_ITM_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_itm_cnt),0) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk)actl
on pln.days=actl.days]]> 
  </VARItems>
  
<VARItemsTotal>
<![CDATA[
select pln.dept_nm,(actl.ACTL_ITM_TOT_DTSD - pln.PLN_ITM_TOT_DTSD) as VAR_ITM_TOT_DTSD from 
(select lc.dept_nm,NVL(rslt.PLN_ITM_TOT_DTSD,0) as PLN_ITM_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
    LEFT OUTER JOIN 
(select h.dply_seq,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_TOT_DTSD from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.dply_seq order by h.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq)pln,
(select lc.dept_nm,NVL(rslt.ACTL_ITM_DTS,0) as ACTL_ITM_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_itm_cnt),0) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq) actl
where pln.dept_nm=actl.dept_nm]]> 
  </VARItemsTotal>
  
  </TCName>
  
  <TCName name="CustomerColumnValidation_DTSDepartment">
  
  <PlannedCustomers>
	<![CDATA[select lc.days,NVL(rslt.PLN_CUST_DTSD,0) as PLN_CUST_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
    LEFT OUTER JOIN 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_DTSD from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) rslt
on lc.day_of_wk=rslt.dte_of_wk order by lc.day_of_wk]]> 
  </PlannedCustomers>
  
  <PlannedCustomersTotal>
<![CDATA[select lc.dept_nm,NVL(rslt.PLN_CUST_TOT_DTSD,0) as PLN_CUST_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
    LEFT OUTER JOIN 
(select h.dply_seq,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_TOT_DTSD from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.dply_seq order by h.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq]]> 
  </PlannedCustomersTotal>
  
  <ActualCustomers>
<![CDATA[select lc.days,NVL(rslt.ACTL_CUST_DTS,0) as ACTL_CUST_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_CUST_cnt),0) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk]]> 
  </ActualCustomers>
  
  <ActualCustomersTotal>
<![CDATA[select lc.dept_nm,NVL(rslt.ACTL_CUST_DTS,0) as ACTL_CUST_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_CUST_cnt),0) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq]]> 
  </ActualCustomersTotal>
  
  <VARCustomers>
<![CDATA[select pln.days,(actl.ACTL_CUST_DTSD - pln.PLN_CUST_DTSD) as VAR_CUST_DTSD from 
(select lc.days,NVL(rslt.PLN_CUST_DTSS,0) as PLN_CUST_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
    LEFT OUTER JOIN 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_DTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) rslt
on lc.day_of_wk=rslt.dte_of_wk order by lc.day_of_wk)pln
LEFT OUTER JOIN
(select lc.days,NVL(rslt.ACTL_CUST_DTS,0) as ACTL_CUST_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_CUST_cnt),0) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk)actl
on pln.days=actl.days]]> 
  </VARCustomers>
  
<VARCustomersTotal>
<![CDATA[select pln.dept_nm,(actl.ACTL_CUST_TOT_DTSD - pln.PLN_CUST_TOT_DTSD) as VAR_CUST_TOT_DTSD from 
(select lc.dept_nm,NVL(rslt.PLN_CUST_TOT_DTSD,0) as PLN_CUST_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
    LEFT OUTER JOIN 
(select h.dply_seq,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_TOT_DTSD from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.dply_seq order by h.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq)pln,
(select lc.dept_nm,NVL(rslt.ACTL_CUST_DTS,0) as ACTL_CUST_TOT_DTSD from 
(select distinct dply_seq,dept_no,dept_nm from dept where dply_seq is not null and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_CUST_cnt),0) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq) actl
where pln.dept_nm=actl.dept_nm]]> 
  </VARCustomersTotal>
  
  </TCName>
  
  <TCName name="WagesColumnValidation_DTSDepartment">
<PlanWages>
<![CDATA[select lc.days,NVL(rslt.PLN_WGE_DTS,0) as PLN_WGE_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.ta_pln_wage_amt),2) as PLN_WGE_DTS,ROUND(sum(e.ta_pln_hrs),2) as PLN_HRS_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
	nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
	from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
	and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
	group by e.dply_seq,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk]]> 
  </PlanWages>
    
  <PlanWagesTotal>
<![CDATA[select lc.dept_nm,NVL(rslt.PLN_WGE_DTS,0) as PLN_WGE_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.ta_pln_wage_amt),2) as PLN_WGE_DTS,ROUND(sum(e.ta_pln_hrs),2) as PLN_HRS_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,
	nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
	from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
	and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
	and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte) e
	group by e.dply_seq 
	order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq]]> 
  </PlanWagesTotal>
  
  <ActualWages>
<![CDATA[select lc.days,NVL(rslt.ACTL_WGE_DTS,0) as ACTL_WGE_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.actl_amt),2) as ACTL_WGE_DTS,ROUND(sum(e.actl_hrs),2) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk]]> 
  </ActualWages>
  
  <ActualWagesTotal>
<![CDATA[select z.dept_nm,NVL(ROUND(y.ACTL_WGE_DTSS,2),0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no IN (DepartmentToView)) z
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_amt) as ACTL_WGE_DTSS,sum(e.actl_hrs) as ACTL_HRS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (DepartmentToView) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
/*and a.actl_amt is NOT NULL and a.actl_amt!=0*/
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) y
on z.dply_seq=y.dply_seq order by z.dply_seq]]> 
  </ActualWagesTotal>
  
  <currentActualWagesTotal>
<![CDATA[select lc.loc_nm,NVL(y.ACTL_wge_TOT_DTSS,0) as wtd from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,sum(z.ACTL_WAGE_TOT_DTSS) as ACTL_wge_TOT_DTSS from 
(select * from 
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (DepartmentToView) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y) z
group by z.loc_no order by z.loc_no ) y
on lc.loc_no=y.loc_no order by lc.loc_no]]> 
  </currentActualWagesTotal>
  
  
  <VARPlanVsActualWages>
<![CDATA[select pln.days,(actl.ACTL_WGE_DTSD - pln.PLN_WGE_DTSD) as VAR_WGE_DTSD from 
(select lc.days,NVL(rslt.PLN_WGE_DTS,0) as PLN_WGE_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
    LEFT OUTER JOIN 
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.ta_pln_wage_amt),2) as PLN_WGE_DTS,ROUND(sum(e.ta_pln_hrs),2) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk)pln
LEFT OUTER JOIN
(select lc.days,NVL(rslt.ACTL_WGE_DTS,0) as ACTL_WGE_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.actl_amt),2) as ACTL_WGE_DTS,ROUND(sum(e.actl_hrs),2) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk)actl
on pln.days=actl.days]]> 
  </VARPlanVsActualWages>

  <VARPlanVsActualWagesTotal>
<![CDATA[select pln.dept_nm,(actl.ACTL_WGE_DTSD - pln.PLN_WGE_DTSD) as VAR_WGE_DTSD from 
(select lc.dept_nm,NVL(rslt.PLN_WGE_DTS,0) as PLN_WGE_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN 
(select e.dply_seq,ROUND(sum(e.ta_pln_wage_amt),2) as PLN_WGE_DTS,ROUND(sum(e.ta_pln_hrs),2) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq)pln
LEFT OUTER JOIN
(select lc.dept_nm,NVL(rslt.ACTL_WGE_DTS,0) as ACTL_WGE_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.actl_amt),2) as ACTL_WGE_DTS,ROUND(sum(e.actl_hrs),2) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq)actl
on pln.dept_nm=actl.dept_nm]]> 
  </VARPlanVsActualWagesTotal>
  
  <currentVARPlanVsActualWagesTotal>
<![CDATA[select pln.dept_nm,(actl.ACTL_WGE_DTSD - pln.PLN_WGE_DTSD) as VAR_WGE_DTSD from 
(select lc.dept_nm,NVL(rslt.PLN_WGE_DTS,0) as PLN_WGE_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN 
(select e.dply_seq,ROUND(sum(e.ta_pln_wage_amt),2) as PLN_WGE_DTS,ROUND(sum(e.ta_pln_hrs),2) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq)pln
LEFT OUTER JOIN
(select lc.dept_nm,NVL(y.ACTL_wge_TOT_DTSS,0) as ACTL_WGE_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,sum(z.ACTL_WAGE_TOT_DTSS) as ACTL_wge_TOT_DTSS from 
(select * from 
(select e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.dply_seq order by e.dply_seq) y) z
group by z.dply_seq order by z.dply_seq ) y
on lc.dply_seq=y.dply_seq order by lc.dply_seq)actl
on pln.dept_nm=actl.dept_nm]]> 
  </currentVARPlanVsActualWagesTotal>
  
  <WagesPlanPercentage>
<![CDATA[select wge.days,case when wge.PLN_WGE_DTSD=0 then 0 when sls.PLN_SLS_DTSD=0 then 0 else NVL(ROUND((wge.PLN_WGE_DTSD / sls.PLN_SLS_DTSD)*100,2),0)end  as PLN_PCT_WGE_DTSD from 
(select lc.days,NVL(rslt.PLN_WGE_DTS,0) as PLN_WGE_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
    LEFT OUTER JOIN 
(select e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk) wge
LEFT OUTER JOIN
(select lc.days,NVL(rslt.PLN_SLS_DTSD,0) as PLN_SLS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
    LEFT OUTER JOIN 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DTSD from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) rslt
on lc.day_of_wk=rslt.dte_of_wk order by lc.day_of_wk)sls
on wge.days=sls.days]]> 
  </WagesPlanPercentage>
  
  <WagesPlanPercentageTotal>
<![CDATA[select wge.dept_nm,case when wge.PLN_WGE_TOT_DTSD=0 then 0 
else ROUND((wge.PLN_WGE_TOT_DTSD / sls.PLN_SLS_TOT_DTSD)*100,2) end as PLN_PCT_WGE_TOT_DTSD from 
(select lc.dept_nm,NVL(rslt.PLN_WGE_DTS,0) as PLN_WGE_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN 
(select e.dply_seq,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq) wge
LEFT OUTER JOIN
(select lc.dept_nm,NVL(rslt.PLN_SLS_DTS,0) as PLN_SLS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN 
(select h.dply_seq,sum(h.PLN_SLS_DTS) as PLN_SLS_DTS from 
(select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.dply_seq order by h.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq)sls
on wge.dept_nm=sls.dept_nm]]> 
  </WagesPlanPercentageTotal>
  
  <WagesActualPercentage>
<![CDATA[select wge.days,case when wge.ACTL_WGE_DTSD=0 then 0 when sls.ACTL_SLS_DTSD=0 then 0
else ROUND((wge.ACTL_WGE_DTSD / sls.ACTL_SLS_DTSD)*100,2) end as ACTL_PCT_WGE_DTSD from 
(select lc.days,NVL(rslt.ACTL_WGE_DTS,0) as ACTL_WGE_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
    LEFT OUTER JOIN 
(select e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk) wge
LEFT OUTER JOIN
(select lc.days,NVL(rslt.ACTL_SLS_DTS,0) as ACTL_SLS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
    LEFT OUTER JOIN 
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_itm_cnt),0) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk)sls
on wge.days=sls.days]]> 
  </WagesActualPercentage>
  
  <WagesActualPercentageTotal>
<![CDATA[select wge.dept_nm,case when wge.ACTL_WGE_TOT_DTSD=0 then 0 when sls.ACTL_SLS_TOT_DTSD=0 then 0 
else ROUND((wge.ACTL_WGE_TOT_DTSD / sls.ACTL_SLS_TOT_DTSD)*100,2) end as ACTL_PCT_WGE_TOT_DTSD from 
(select lc.dept_nm,NVL(rslt.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN 
(select e.dply_seq,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq) wge
LEFT OUTER JOIN
(select lc.dept_nm,NVL(rslt.ACTL_SLS_DTS,0) as ACTL_SLS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN 
(select e.dply_seq,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_itm_cnt),0) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq)sls
on wge.dept_nm=sls.dept_nm]]> 
  </WagesActualPercentageTotal>
  
  
  <currentWagesActualPercentageTotal>
<![CDATA[select wge.dept_nm,case when wge.ACTL_WGE_TOT_DTSD=0 then 0 when sls.ACTL_SLS_TOT_DTSD=0 then 0 
else ROUND((wge.ACTL_WGE_TOT_DTSD / sls.ACTL_SLS_TOT_DTSD)*100,2) end as ACTL_PCT_WGE_TOT_DTSD from 
(select lc.dept_nm,NVL(y.ACTL_wge_TOT_DTSS,0) as ACTL_WGE_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no=Division and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,sum(z.ACTL_WAGE_TOT_DTSS) as ACTL_wge_TOT_DTSS from 
(select * from 
(select e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=Division and b.loc_no='store' and a.dept_no IN (DepartmentToView) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.dply_seq order by e.dply_seq) y) z
group by z.dply_seq order by z.dply_seq ) y
on lc.dply_seq=y.dply_seq order by lc.dply_seq) wge
LEFT OUTER JOIN
(select lc.dept_nm,NVL(rslt.ACTL_SLS_DTS,0) as ACTL_SLS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no=Division and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN 
(select e.dply_seq,ROUND(sum(e.actl_sls),0) as ACTL_SLS_DTS,ROUND(sum(e.actl_itm_cnt),0) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no=Division and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no=Division
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq)sls
on wge.dept_nm=sls.dept_nm]]> 
  </currentWagesActualPercentageTotal>
  
  <BudgetWagesTotal>
<![CDATA[select lc.dept_nm,NVL(ROUND(rslt.BDGT_WGE_DTS,0),0) as BDGT_WGE_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN 
(select e.dply_seq,sum(e.bdgt_wage_amt) as BDGT_WGE_DTS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
	from wky_bdgt a, loc b, wk c, dept d 
	where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' and a.wk_id=c.wk_id and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN ('DepartmentToView') 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq]]> 
  </BudgetWagesTotal>
  
  <ForecastWagesTotal>
<![CDATA[select lc.dept_nm,NVL(ROUND(rslt.FCST_WGE_DTS,0),0) as FCST_WGE_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN 
(select e.dply_seq,sum(e.frcst_wage_amt) as FCST_WGE_DTS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
	from mnth_fcst a, loc b, wk c, dept d 
	where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' and a.wk_id=c.wk_id and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN ('DepartmentToView') 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq]]> 
  </ForecastWagesTotal>
  
  <BudgetPercentageTotal>
<![CDATA[select lc.dept_nm,NVL(ROUND((rslt.BDGT_WGE_DTS / rslt.BDGT_SLS_DTS)*100,2),0) as BDGT_WGE_PCT_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN 
(select e.dply_seq,sum(e.bdgt_wage_amt) as BDGT_WGE_DTS,sum(e.bdgt_sls) as BDGT_SLS_DTS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
	from wky_bdgt a, loc b, wk c, dept d 
	where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
	and a.wk_id=c.wk_id and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN ('DepartmentToView') 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq]]> 
  </BudgetPercentageTotal>
  
  <ForecastPercentageTotal>
<![CDATA[select lc.dept_nm,NVL(ROUND((rslt.FCST_WGE_DTS / rslt.FCST_SLS_DTS)*100,2),0) as FCST_WGE_PCT_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN 
(select e.dply_seq,sum(e.frcst_wage_amt) as FCST_WGE_DTS,sum(e.frcst_sls) as FCST_SLS_DTS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
	from mnth_fcst a, loc b, wk c, dept d 
	where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
	and a.wk_id=c.wk_id and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no IN ('DepartmentToView') 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq]]> 
  </ForecastPercentageTotal>
  
  <AllowedWagesBdgtOne>
<![CDATA[select src.loc_nm,
case 
when src.ACTL_SLS_TOT_DTSS > src.BDGT_SLS_TOT_DTSS 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_DTSS * BDGT_SLS_TOT_DTSS) + ((ACTL_SLS_TOT_DTSS - BDGT_SLS_TOT_DTSS) * (PST_FACTOR_TOT_DTSS * BDGT_WGE_PCT_TOT_DTSS)))/100),0),0)
When src.ACTL_SLS_TOT_DTSS < src.BDGT_SLS_TOT_DTSS 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_DTSS * BDGT_SLS_TOT_DTSS) + ((ACTL_SLS_TOT_DTSS - BDGT_SLS_TOT_DTSS) * (NGT_FACTOR_TOT_DTSS * BDGT_WGE_PCT_TOT_DTSS)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_TOT_DTSS * ACTL_SLS_TOT_DTSS)/100),0),0) end as ALWD_WGE_TOT_DTSS from 

(select actl_sls.loc_nm,rte_fct.wk_id,actl_sls.ACTL_SLS_TOT_DTSS,rte_fct.PST_FACTOR_TOT_DTSS,rte_fct.NGT_FACTOR_TOT_DTSS,
bdgt_wge_pct.BDGT_WGE_PCT_TOT_DTSS,bdgt_wge_pct.BDGT_WGE_TOT_DTSS,bdgt_wge_pct.BDGT_SLS_TOT_DTSS from

(select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as ACTL_SLS_TOT_DTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_TOT_DTSS,NVL(src.ngt_factor,1) as NGT_FACTOR_TOT_DTSS from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select wge.loc_nm,NVL(ROUND(wge.BDGT_WGE_TOT_DTSS,0),0) as BDGT_WGE_TOT_DTSS, NVL(ROUND(sls.BDGT_SLS_TOT_DTSS,0),0) as BDGT_SLS_TOT_DTSS,
CASE When NVL(wge.BDGT_WGE_TOT_DTSS,0)=0 and NVL(sls.BDGT_SLS_TOT_DTSS,0)=0 Then 0
When NVL(wge.BDGT_WGE_TOT_DTSS,0)=0 Then 0 When NVL(sls.BDGT_SLS_TOT_DTSS,0)=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_DTSS / sls.BDGT_SLS_TOT_DTSS)*100,5),0) END as BDGT_WGE_PCT_TOT_DTSS from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no IN ('DepartmentToView')  
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN ('DepartmentToView') 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) bdgt_wge_pct

where actl_sls.loc_nm=bdgt_wge_pct.loc_nm) src
order by src.loc_nm]]> 
  </AllowedWagesBdgtOne>
  
  <AllowedWagesBdgtTwo>
<![CDATA[select src.loc_nm,
case 
when src.ACTL_SLS_TOT_DTSS > src.BDGT_SLS_TOT_DTSS 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_DTSS * BDGT_SLS_TOT_DTSS) + ((ACTL_SLS_TOT_DTSS - BDGT_SLS_TOT_DTSS) * (PST_FACTOR_TOT_DTSS * BDGT_WGE_PCT_TOT_DTSS)))/100),0),0)
When src.ACTL_SLS_TOT_DTSS < src.BDGT_SLS_TOT_DTSS 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_DTSS * BDGT_SLS_TOT_DTSS) + ((ACTL_SLS_TOT_DTSS - BDGT_SLS_TOT_DTSS) * (NGT_FACTOR_TOT_DTSS * BDGT_WGE_PCT_TOT_DTSS)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_TOT_DTSS * ACTL_SLS_TOT_DTSS)/100),0),0) end as ALWD_WGE_TOT_DTSS from 

(select actl_sls.loc_nm,rte_fct.wk_id,actl_sls.ACTL_SLS_TOT_DTSS,rte_fct.PST_FACTOR_TOT_DTSS,rte_fct.NGT_FACTOR_TOT_DTSS,
bdgt_wge_pct.BDGT_WGE_PCT_TOT_DTSS,bdgt_wge_pct.BDGT_WGE_TOT_DTSS,bdgt_wge_pct.BDGT_SLS_TOT_DTSS from

(select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as ACTL_SLS_TOT_DTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_TOT_DTSS,NVL(src.ngt_factor,1) as NGT_FACTOR_TOT_DTSS from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select wge.loc_nm,NVL(ROUND(wge.BDGT_WGE_TOT_DTSS,0),0) as BDGT_WGE_TOT_DTSS, NVL(ROUND(sls.BDGT_SLS_TOT_DTSS,0),0) as BDGT_SLS_TOT_DTSS,
CASE When NVL(wge.BDGT_WGE_TOT_DTSS,0)=0 and NVL(sls.BDGT_SLS_TOT_DTSS,0)=0 Then 0
When NVL(wge.BDGT_WGE_TOT_DTSS,0)=0 Then 0 When NVL(sls.BDGT_SLS_TOT_DTSS,0)=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_DTSS / sls.BDGT_SLS_TOT_DTSS)*100,5),0) END as BDGT_WGE_PCT_TOT_DTSS from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no IN ('DepartmentToView')  
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_DTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no  IN ('DepartmentToView') 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) bdgt_wge_pct

where actl_sls.loc_nm=bdgt_wge_pct.loc_nm) src
order by src.loc_nm]]> 
  </AllowedWagesBdgtTwo>
  
  <AllowedWagesFcstOne>
<![CDATA[select fcst_sls.dept_nm,
NVL(ROUND(((fcst_sls.FCST_SLS_WTD_DTS * fcst_wge_pct.FCST_WGE_PCT_WTD_DTS)+((estd_sls.ACTL_SLS_DTS - fcst_sls.FCST_SLS_WTD_DTS)*0.5*fcst_wge_pct.FCST_WGE_PCT_WTD_DTS))/100,0),0)
as ALWD_FCST_WGE_DTSD from 
(select dpt.dept_nm,NVL(ROUND(fcst.frcst_sls,9),0) as FCST_SLS_WTD_DTS from 
	(select dply_seq,dept_nm from dept where dept_no IN ('DepartmentToView') and div_no='Division' and dply_seq is NOT NULL) dpt 
  LEFT OUTER JOIN
	(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
	from mnth_fcst a, loc b, wk c, dept d 
	where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
	and a.wk_id=c.wk_id  and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no IN ('DepartmentToView') 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
	on dpt.dply_seq=fcst.dply_seq and dpt.dept_nm=fcst.dept_nm
	order by dpt.dply_seq) fcst_sls,
(select lc.dept_nm,ROUND(rslt.ACTL_SLS_DTS,9) as ACTL_SLS_DTS from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(round(a.actl_sls,0),0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq) estd_sls,
(select dpt.dept_nm,round((fcst.frcst_wage_amt / fcst.frcst_sls)*100,9) as fcst_WGE_PCT_WTD_DTS from 
	(select dply_seq,dept_nm from dept where dept_no IN ('DepartmentToView') and div_no='Division' and dply_seq is NOT NULL) dpt
	LEFT OUTER JOIN
	(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
	from mnth_fcst a, loc b, wk c, dept d 
	where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
	and a.wk_id=c.wk_id and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no IN ('DepartmentToView') 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
	on dpt.dply_seq=fcst.dply_seq and dpt.dept_nm=fcst.dept_nm
	order by dpt.dply_seq) fcst_wge_pct
  where fcst_sls.dept_nm=estd_sls.dept_nm and fcst_sls.dept_nm=fcst_wge_pct.dept_nm]]> 
  </AllowedWagesFcstOne>
  
  <AllowedWagesFcstTwo>
<![CDATA[select estd_sls.dept_nm,
NVL(ROUND(((estd_sls.ACTL_SLS_DTS * fcst_wge_pct.fcst_WGE_PCT_WTD_DTS))/100,0),0)
as ALWD_FCST_WGE_DTSD from 
(select lc.dept_nm,rslt.ACTL_SLS_DTS as ACTL_SLS_DTS from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.txn_dte between c.wk_strt and c.wk_end  and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq) estd_sls,
(select dpt.dept_nm,(fcst.frcst_wage_amt / fcst.frcst_sls)*100 as fcst_WGE_PCT_WTD_DTS from 
	(select dply_seq,dept_nm from dept where dept_no IN ('DepartmentToView') and div_no='Division' and dply_seq is NOT NULL) dpt
	LEFT OUTER JOIN
	(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
	from mnth_fcst a, loc b, wk c, dept d 
	where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
	and a.wk_id=c.wk_id and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no IN ('DepartmentToView') 
	order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
	on dpt.dply_seq=fcst.dply_seq and dpt.dept_nm=fcst.dept_nm
	order by dpt.dply_seq) fcst_wge_pct
  where estd_sls.dept_nm=fcst_wge_pct.dept_nm]]> 
  </AllowedWagesFcstTwo>
  
  </TCName>
  
  <TCName name="HoursColumnValidation_DTSDepartment">
  
<PlanSMSHours>
<![CDATA[select lc.days,NVL(rslt.PLN_SMS_DTS,0) as PLN_SMS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
    LEFT OUTER JOIN 
(select e.dply_seq,e.day_of_wk,ROUND((sum(e.fix_hrs) + sum(e.vol_hrs)),2) as PLN_SMS_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
	nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
	where a.loc_no=b.loc_no and b.div_no='Division' and a.loc_no='store' and tsk.dept_no IN ('DepartmentToView') 
	and a.wk_id=c.wk_id  and c.wk_id='Week'
	and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
	and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
	group by e.dply_seq,e.day_of_wk	order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk]]> 
  </PlanSMSHours>
  
  <PlanSMSTotal>
<![CDATA[select lc.dept_nm,NVL(rslt.PLN_SMS_DTS,0) as PLN_SMS_TOT_DTSD from 
(select dply_seq,dept_nm from dept where dept_no IN ('DepartmentToView') and div_no='Division' and dply_seq is NOT NULL order by dply_seq) lc
    LEFT OUTER JOIN 
(select e.dply_seq,ROUND((sum(e.fix_hrs) + sum(e.vol_hrs)),2) as PLN_SMS_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
	nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
	where a.loc_no=b.loc_no and b.div_no='Division' and a.loc_no='store' and tsk.dept_no IN ('DepartmentToView') 
	and a.wk_id=c.wk_id  and c.wk_id='Week'
	and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
	and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
	group by e.dply_seq	order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq]]> 
  </PlanSMSTotal>
  
  <KronosScheduledHours>
<![CDATA[select lc.days,NVL(rslt.PLN_HRS_DTS,0) as PLN_HRS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
    LEFT OUTER JOIN 
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.ta_pln_wage_amt),2) as PLN_WGE_DTS,ROUND(sum(e.ta_pln_hrs),2) as PLN_HRS_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
	nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
	from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
	and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
	group by e.dply_seq,e.day_of_wk order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk]]> 
  </KronosScheduledHours>
  
  <KronosScheduledHoursTotal>
<![CDATA[select lc.dept_nm,NVL(rslt.PLN_HRS_DTS,0) as PLN_HRS_TOT_DTSD from 
(select dply_seq,dept_nm from dept where dept_no IN ('DepartmentToView') and div_no='Division' and dply_seq is NOT NULL order by dply_seq) lc
    LEFT OUTER JOIN 
(select e.dply_seq,ROUND(sum(e.ta_pln_wage_amt),2) as PLN_WGE_DTS,ROUND(sum(e.ta_pln_hrs),2) as PLN_HRS_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
	nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
	from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
	and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
	group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq]]> 
  </KronosScheduledHoursTotal>
  
  <VARHours>
<![CDATA[select pln.days,(actl.PLN_HRS_DTSD - pln.PLN_SMS_DTSD) as VAR_HRS_DTSD from 
(select lc.days,NVL(rslt.PLN_SMS_DTS,0) as PLN_SMS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
    LEFT OUTER JOIN 
(select e.dply_seq,e.day_of_wk,ROUND((sum(e.fix_hrs) + sum(e.vol_hrs)),2) as PLN_SMS_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
	nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
	where a.loc_no=b.loc_no and b.div_no='Division' and a.loc_no='store' and tsk.dept_no IN ('DepartmentToView') 
	and a.wk_id=c.wk_id  and c.wk_id='Week'
	and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
	and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
	group by e.dply_seq,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk)pln
LEFT OUTER JOIN
(select lc.days,NVL(rslt.PLN_HRS_DTS,0) as PLN_HRS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.ta_pln_wage_amt),2) as PLN_WGE_DTS,ROUND(sum(e.ta_pln_hrs),2) as PLN_HRS_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
	nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
	from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
	and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
	and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
	group by e.dply_seq,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk)actl
on pln.days=actl.days]]> 
  </VARHours>

  <VARHoursValTotal>
<![CDATA[select pln.dept_nm,(actl.PLN_HRS_TOT_DTSD - pln.PLN_SMS_TOT_DTSD) as VAR_HRS_TOT_DTSD from 
(select lc.dept_nm,NVL(rslt.PLN_SMS_DTS,0) as PLN_SMS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN 
(select e.dply_seq,ROUND((sum(e.fix_hrs) + sum(e.vol_hrs)),2) as PLN_SMS_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
	nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
	where a.loc_no=b.loc_no and b.div_no='Division' and a.loc_no='store' and tsk.dept_no IN ('DepartmentToView') 
	and a.wk_id=c.wk_id  and c.wk_id='Week'
	and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
	and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
	group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq)pln
LEFT OUTER JOIN
(select lc.dept_nm,NVL(rslt.PLN_HRS_DTS,0) as PLN_HRS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.ta_pln_wage_amt),2) as PLN_WGE_DTS,ROUND(sum(e.ta_pln_hrs),2) as PLN_HRS_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
	nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
	from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
	and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
	and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
	group by e.dply_seq	order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq)actl
on pln.dept_nm=actl.dept_nm]]> 
  </VARHoursValTotal>
  
  <OperatingRatioPlannedHours>
<![CDATA[select sms_hrs.days,case when sms_hrs.SMS_HRS_DTSD=0 then 0 when pln_hrs.PLN_HRS_DTSD=0 then 0 else NVL(ROUND((sms_hrs.SMS_HRS_DTSD / pln_hrs.PLN_HRS_DTSD)*100,1),0)end as PLN_HRS_OR_PCT_DTSD from 
(select lc.days,NVL(rslt.SMS_HRS_DTS,0) as SMS_HRS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
    LEFT OUTER JOIN 
(select C.dply_seq,C.day_of_wk,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HRS_DTS from 
	(select A.dply_seq,A.day_of_wk,sum(a.fix_hrs) as FIX_HRS_DEPT_TOT,Sum(a.vol_hrs) as VOL_HRS_DEPT_TOT from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,dpt.dept_nm,dpt.dply_seq,B.perd_desc,a.wk_id,a.day_of_wk,
	 nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
	from lbr_std a, wk b, loc c, task d, day dy, dept dpt 
	where a.task_no=d.task_no and d.dept_no IN ('DepartmentToView') 
	and a.wk_id=b.wk_id and b.wk_id='Week'
	and a.loc_no=c.loc_no and c.div_no='Division' and a.loc_no='store'
	and d.dept_no=dpt.dept_no and dpt.dply_seq is not null and dpt.div_no='Division'
	and a.day_of_wk=dy.day_of_wk and a.wk_id=dy.wk_id
	order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,dpt.dply_seq,a.wk_id,a.day_of_wk) A
	group by A.dply_seq,A.day_of_wk order by A.dply_seq,A.day_of_wk) C
	group by C.dply_seq,C.day_of_wk order by C.dply_seq,C.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk) sms_hrs
LEFT OUTER JOIN
(select lc.days,NVL(rslt.PLN_HRS_DTS,0) as PLN_HRS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
    WHEN 00 THEN 'Monday'
    WHEN 01 THEN 'Tuesday'
    WHEN 02 THEN 'Wednesday'
    WHEN 03 THEN 'Thursday'
    WHEN 04 THEN 'Friday'
    WHEN 05 THEN 'Saturday'
    WHEN 06 THEN 'Sunday'
    END AS DAYS from day order by day_of_wk ) lc
    LEFT OUTER JOIN 
(select e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
	nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
	from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
	and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
	and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
	group by e.dply_seq,e.day_of_wk 
	order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk) pln_hrs
on sms_hrs.days=pln_hrs.days]]> 
  </OperatingRatioPlannedHours>
  
  <OperatingRatioPlannedHoursTotal>
<![CDATA[select sms_hrs.dept_nm,case when  sms_hrs.SMS_HRS_TOT_DTSD=0 then 0 when  pln_hrs.PLN_HRS_TOT_DTSD=0 then 0 else NVL(ROUND((sms_hrs.SMS_HRS_TOT_DTSD / pln_hrs.PLN_HRS_TOT_DTSD)*100,1),0) end as PLN_HRS_OR_PCT_TOT_DTSD from 
(select lc.dept_nm,NVL(rslt.SMS_HRS_DTS,0) as SMS_HRS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN 
(select C.dply_seq,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HRS_DTS from 
	(select A.dply_seq,A.day_of_wk,sum(a.fix_hrs) as FIX_HRS_DEPT_TOT,Sum(a.vol_hrs) as VOL_HRS_DEPT_TOT from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,d.dept_no,dpt.dept_nm,dpt.dply_seq,B.perd_desc,a.wk_id,a.day_of_wk,
	 nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
	from lbr_std a, wk b, loc c, task d, day dy, dept dpt 
	where a.task_no=d.task_no and d.dept_no IN ('DepartmentToView') 
	and a.wk_id=b.wk_id and b.wk_id='Week'
	and a.loc_no=c.loc_no and c.div_no='Division' and a.loc_no='store'
	and d.dept_no=dpt.dept_no and dpt.dply_seq is not null and dpt.div_no='Division'
	and a.day_of_wk=dy.day_of_wk and a.wk_id=dy.wk_id
	order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,dpt.dply_seq,a.wk_id,a.day_of_wk) A
	group by A.dply_seq,A.day_of_wk order by A.dply_seq,A.day_of_wk) C
	group by C.dply_seq order by C.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq) sms_hrs
LEFT OUTER JOIN
(select lc.dept_nm,NVL(rslt.PLN_HRS_DTS,0) as PLN_HRS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN 
(select e.dply_seq,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
	(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
	nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
	from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
	where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
	and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
	and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
	and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
	order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
	group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq) pln_hrs
on sms_hrs.dept_nm=pln_hrs.dept_nm]]> 
  </OperatingRatioPlannedHoursTotal>
  
  </TCName>
  
  <TCName name="ActualHoursColumnValidation_DTSDepartment">

	<ActlSMSHoursLL>
	<![CDATA[select rslt.day,rslt.actl_sms_hrs from 
(select dy.day_of_wk,dy.day,NVL(ROUND(sum(sms_src.actl_sms_hrs),2),0) as actl_sms_hrs from 
(select wk_id,day_of_wk,(case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Day from day where wk_id in (select wk_id from wk where fin_yr='Year' and fin_wk_no='FinWk') 
order by day_of_wk) dy
LEFT OUTER JOIN
(select src.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs),0)
END) as actl_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src
order by src.loc_no,src.dept_no,src.task_no,src.day_of_wk) sms_src
on dy.wk_id=sms_src.wk_id and dy.day_of_wk=sms_src.day_of_wk group by dy.day_of_wk,dy.day) rslt order by rslt.day_of_wk]]> 
  	</ActlSMSHoursLL>
  
  <ActlSMSHoursValTotalLL>
	<![CDATA[select 'STORE TOTAL' as TOTAL ,round(sum(ACTL_SMS_HRS),2) as ACTL_SMS_TOT from
(select (case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Day ,sum(actl_sms_hrs) as ACTL_SMS_HRS
from
(select src.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs),0)
END) as actl_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src
order by src.loc_no,src.dept_no,src.task_no,src.day_of_wk) sms_src
group by day_of_wk order by day_of_wk)]]> 
  </ActlSMSHoursValTotalLL>
  
  <ActlSMSHoursNonLL>
	<![CDATA[
select rslt.day,ROUND(sum(actl_sms_hrs),2) as actl_sms_hrs from 
(select dy.day_of_wk,dy.day,NVL(sms_src.actl_sms_hrs,0) as actl_sms_hrs from 
(select wk_id,day_of_wk,(case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Day from day where wk_id in (select wk_id from wk where fin_yr='Year' and fin_wk_no='FinWk') 
order by day_of_wk) dy
LEFT OUTER JOIN
(select LL.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000))+LL.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000)) * LL.fix_hrs_pct)/100) + LL.fix_hrs),0)
END) as actl_sms_hrs
from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
order by ll.day_of_wk) sms_src
on dy.wk_id=sms_src.wk_id and dy.day_of_wk=sms_src.day_of_wk order by dy.day_of_wk) rslt
group by rslt.day,rslt.day_of_wk order by rslt.day_of_wk]]> 
  	</ActlSMSHoursNonLL>
  
  <ActlSMSHoursValTotalNonLL>
	<![CDATA[select 'STORE TOTAL' as TOTAL ,NVL(round(sum(ACTL_SMS_HRS),2),0) as ACTL_SMS_TOT from
(select (case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Day ,round(sum(actl_sms_hrs),2) as ACTL_SMS_HRS
from
(select LL.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000))+LL.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000)) * LL.fix_hrs_pct)/100) + LL.fix_hrs),0)
END) as actl_sms_hrs
from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
order by ll.day_of_wk) src
group by day_of_wk order by day_of_wk)]]> 
  </ActlSMSHoursValTotalNonLL>
  
  <KronosActlSMSHours>
<![CDATA[select lc.days,/*NVL(rslt.ACTL_HRS_DTS,0)*/
NVL(ROUND(((ROUND(((rslt.ACTL_HRS_DTS * 100)/'25'),0)*'25')/100),2),0) as ACTL_HRS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
WHEN 00 THEN 'Monday'
WHEN 01 THEN 'Tuesday'
WHEN 02 THEN 'Wednesday'
WHEN 03 THEN 'Thursday'
WHEN 04 THEN 'Friday'
WHEN 05 THEN 'Saturday'
WHEN 06 THEN 'Sunday'
END AS DAYS from day order by day_of_wk) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.actl_amt),0) as ACTL_WGE_DTS,ROUND(sum(e.actl_hrs),2) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk]]> 
  </KronosActlSMSHours>
  
<KronosActlSMSHoursTotal>
<![CDATA[select lc.dept_nm,/*NVL(rslt.ACTL_HRS_TOT_DTS,0)*/
NVL(ROUND(((ROUND(((rslt.ACTL_HRS_TOT_DTS * 100)/'25'),0)*'25')/100),2),0) as ACTL_HRS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.actl_amt),0) as ACTL_WGE_DTS,ROUND(sum(e.actl_hrs),2) as ACTL_HRS_TOT_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq]]> 
  </KronosActlSMSHoursTotal>
  
  <CurrentKronosActlSMSHoursTotal>
<![CDATA[select z.dept_nm,NVL(ROUND(y.ACTL_HOURS_DTSS,2),0) as ACTL_HRS_DTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no IN (DepartmentToView)) z
LEFT OUTER JOIN
(select * from 
(select e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (DepartmentToView) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.dply_seq order by e.dply_seq) y) y
on z.dply_seq=y.dply_seq order by z.dply_seq]]> 
  </CurrentKronosActlSMSHoursTotal>
  
<VARActualHours>
<![CDATA[]]> 
  </VARActualHours>
  
<VARActualHoursTotal>
<![CDATA[]]> 
 </VARActualHoursTotal>
  
<ORHoursLL>
<![CDATA[select sms_src.days,
case WHEN nvl(sms_src.ACTL_SMS_HRS,0)=0 and NVL(actl_hrs.ACTL_HRS_DTSD,0)=0 then 0 
when nvl(sms_src.ACTL_SMS_HRS,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_DTSD,0)=0 then 0 
else  NVL(ROUND((sms_src.ACTL_SMS_HRS/actl_hrs.ACTL_HRS_DTSD)*100,1),0)end as ACTL_HRS_OR_PCT_DTSD from
(select lc.days,nvl(sms_hrs.ACTL_SMS_HRS,0) as ACTL_SMS_HRS from 
(select day_of_wk,(case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Days from day where wk_id='Week' order by day_of_wk) lc
LEFT OUTER JOIN
(select day_of_wk,sum(actl_sms_hrs) as ACTL_SMS_HRS
from
(select src.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs),0)
END) as actl_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src
order by src.loc_no,src.dept_no,src.task_no,src.day_of_wk) sms_src
group by day_of_wk order by day_of_wk)sms_hrs
on lc.day_of_wk=sms_hrs.day_of_wk order by lc.day_of_wk) sms_src,
(select lc.days,NVL(((((rslt.ACTL_HRS_DTS * 100)/5)*5)/100),0) as ACTL_HRS_DTSD from 
(select day_of_wk,
(case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Days from day where wk_id='Week' order by day_of_wk) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.actl_amt),0) as ACTL_WGE_DTS,ROUND(sum(e.actl_hrs),2) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk)actl_hrs
WHERE sms_src.days=actl_hrs.days]]> 
</ORHoursLL>
  
<ORHoursTotalLL>
<![CDATA[select  'STORE TOTAL' as TOTAL,case when  sms_hrs.ACTL_SMS_TOT=0 then 0 when actl_hrs.ACTL_HRS_TOT_DTSD=0 then 0 else NVL(ROUND((sms_hrs.ACTL_SMS_TOT / actl_hrs.ACTL_HRS_TOT_DTSD)*100,1),0) end as ACTL_HRS_OR_PCT_TOT_DTSD from 
(select 'STORE TOTAL' as TOTAL ,round(sum(ACTL_SMS_HRS),2) as ACTL_SMS_TOT from
(select (case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Days ,sum(actl_sms_hrs) as ACTL_SMS_HRS
from
(select src.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs),0)
END) as actl_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src
order by src.loc_no,src.dept_no,src.task_no,src.day_of_wk) sms_src
group by day_of_wk order by day_of_wk))sms_hrs,
(select lc.dept_nm,/*NVL(rslt.ACTL_HRS_TOT_DTS,0)*/
NVL(ROUND(((ROUND(((rslt.ACTL_HRS_TOT_DTS * 100)/5),0)*5)/100),2),0) as ACTL_HRS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('5') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.actl_amt),0) as ACTL_WGE_DTS,ROUND(sum(e.actl_hrs),2) as ACTL_HRS_TOT_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq)actl_hrs]]> 
</ORHoursTotalLL>
<CurrentWeekORHoursTotalLL>
<![CDATA[select  'STORE TOTAL' as TOTAL,case when  sms_hrs.ACTL_SMS_TOT=0 then 0 when actl_hrs.ACTL_HRS_TOT_DTSD=0 then 0 else NVL(ROUND((sms_hrs.ACTL_SMS_TOT / actl_hrs.ACTL_HRS_TOT_DTSD)*100,1),0) end as ACTL_HRS_OR_PCT_TOT_DTSD from 
(select 'STORE TOTAL' as TOTAL ,round(sum(ACTL_SMS_HRS),2) as ACTL_SMS_TOT from
(select (case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Days ,sum(actl_sms_hrs) as ACTL_SMS_HRS
from
(select src.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs),0)
END) as actl_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src
order by src.loc_no,src.dept_no,src.task_no,src.day_of_wk) sms_src
group by day_of_wk order by day_of_wk))sms_hrs,
(select z.dept_nm,NVL(ROUND(y.ACTL_HOURS_DTSS,2),0) as ACTL_HRS_TOT_DTSD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no IN (DepartmentToView)) z
LEFT OUTER JOIN
(select * from 
(select e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (DepartmentToView) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.dply_seq order by e.dply_seq) y) y
on z.dply_seq=y.dply_seq order by z.dply_seq)actl_hrs]]> 
</CurrentWeekORHoursTotalLL>
<ORHoursNonLL>
<![CDATA[select sms_hrs.day,case when  sms_hrs.ACTL_SMS_HRS=0 then 0 when actl_hrs.ACTL_HRS_DTSD=0 then 0 else NVL(ROUND((sms_hrs.ACTL_SMS_HRS/actl_hrs.ACTL_HRS_DTSD)*100,1),0) end as ACTL_HRS_OR_PCT_DTSD from
(select rslt.day,ROUND(sum(actl_sms_hrs),2) as actl_sms_hrs from 
(select dy.day_of_wk,dy.day,NVL(sms_src.actl_sms_hrs,0) as actl_sms_hrs from 
(select wk_id,day_of_wk,(case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Day from day where wk_id in (select wk_id from wk where fin_yr='Year' and fin_wk_no='FinWk') 
order by day_of_wk) dy
LEFT OUTER JOIN
(select LL.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000))+LL.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000)) * LL.fix_hrs_pct)/100) + LL.fix_hrs),0)
END) as actl_sms_hrs
from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
order by ll.day_of_wk) sms_src
on dy.wk_id=sms_src.wk_id and dy.day_of_wk=sms_src.day_of_wk order by dy.day_of_wk) rslt
group by rslt.day,rslt.day_of_wk order by rslt.day_of_wk)sms_hrs
LEFT OUTER JOIN
(select lc.days,/*NVL(rslt.ACTL_HRS_DTS,0)*/
NVL(ROUND(((ROUND(((rslt.ACTL_HRS_DTS * 100)/25),0)*25)/100),2),0) as ACTL_HRS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
WHEN 00 THEN 'Monday'
WHEN 01 THEN 'Tuesday'
WHEN 02 THEN 'Wednesday'
WHEN 03 THEN 'Thursday'
WHEN 04 THEN 'Friday'
WHEN 05 THEN 'Saturday'
WHEN 06 THEN 'Sunday'
END AS DAYS from day order by day_of_wk) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.actl_amt),0) as ACTL_WGE_DTS,ROUND(sum(e.actl_hrs),2) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk)actl_hrs
on sms_hrs.day=actl_hrs.days]]> 
 </ORHoursNonLL>
  
<ORHoursTotalNonLL>
<![CDATA[select  'STORE TOTAL' as TOTAL,case when  sms_hrs.ACTL_SMS_TOT=0 then 0 when actl_hrs.ACTL_HRS_TOT_DTSD=0 then 0 else NVL(ROUND((sms_hrs.ACTL_SMS_TOT / actl_hrs.ACTL_HRS_TOT_DTSD)*100,1),0) end as ACTL_HRS_OR_PCT_TOT_DTSD from 
(select 'STORE TOTAL' as TOTAL ,NVL((sum(ACTL_SMS_HRS)),0) as ACTL_SMS_TOT from
(select (case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Day ,(sum(actl_sms_hrs)) as ACTL_SMS_HRS
from
(select LL.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000))+LL.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000)) * LL.fix_hrs_pct)/100) + LL.fix_hrs),0)
END) as actl_sms_hrs
from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
order by ll.day_of_wk) src
group by day_of_wk order by day_of_wk))sms_hrs,
(select lc.dept_nm,/*NVL(rslt.ACTL_HRS_TOT_DTS,0)*/
NVL(ROUND((((((rslt.ACTL_HRS_TOT_DTS * 100)/25))*25)/100),2),0) as ACTL_HRS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.actl_amt),0) as ACTL_WGE_DTS,ROUND(sum(e.actl_hrs),2) as ACTL_HRS_TOT_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq)actl_hrs]]> 
</ORHoursTotalNonLL>

<CurrentORHoursTotalNonLL>
<![CDATA[select  'STORE TOTAL' as TOTAL,case when  sms_hrs.ACTL_SMS_TOT=0 then 0 when actl_hrs.ACTL_HRS_TOT_DTSD=0 then 0 else NVL(ROUND((sms_hrs.ACTL_SMS_TOT / actl_hrs.ACTL_HRS_TOT_DTSD)*100,1),0) end as ACTL_HRS_OR_PCT_TOT_DTSD from 
(select 'STORE TOTAL' as TOTAL ,NVL((sum(ACTL_SMS_HRS)),0) as ACTL_SMS_TOT from
(select (case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Day ,(sum(actl_sms_hrs)) as ACTL_SMS_HRS
from
(select LL.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000))+LL.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000)) * LL.fix_hrs_pct)/100) + LL.fix_hrs),0)
END) as actl_sms_hrs
from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
order by ll.day_of_wk) src
group by day_of_wk order by day_of_wk))sms_hrs,
(select 'STORE TOTAL' as TOTAL,NVL(y.ACTL_HRS_TOT_DTSS,0) as ACTL_HRS_TOT_DTSD from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,sum(z.ACTL_HOURS_TOT_DTSS) as ACTL_HRS_TOT_DTSS from 
(select * from 
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_DTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_DTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView')
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y) z
group by z.loc_no order by z.loc_no ) y
on lc.loc_no=y.loc_no order by lc.loc_no)actl_hrs]]> 
</CurrentORHoursTotalNonLL>

</TCName>

 <TCName name = "BeforePayRoleAdjustmentValidation" >
	<ActlSMSHoursLL>
	<![CDATA[select (case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Day ,round(sum(actl_sms_hrs),2) as ACTL_SMS_HRS
from
(select src.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs),0)
END) as actl_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src
order by src.loc_no,src.dept_no,src.task_no,src.day_of_wk) sms_src
group by day_of_wk order by day_of_wk]]>
	</ActlSMSHoursLL>
	<ActlSMSHoursValTotalLL>
	<![CDATA[select 'STORE TOTAL' as TOTAL ,round(sum(ACTL_SMS_HRS),2) as ACTL_SMS_TOT from
(select (case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Day ,sum(actl_sms_hrs) as ACTL_SMS_HRS
from
(select src.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs),0)
END) as actl_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src
order by src.loc_no,src.dept_no,src.task_no,src.day_of_wk) sms_src
group by day_of_wk order by day_of_wk)]]>
	</ActlSMSHoursValTotalLL>
	
	<ActlSMSHoursNonLL>
	<![CDATA[select (case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Day ,round(sum(actl_sms_hrs),2) as ACTL_SMS_HRS
from
(select LL.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000))+LL.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000)) * LL.fix_hrs_pct)/100) + LL.fix_hrs),0)
END) as actl_sms_hrs
from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
order by ll.day_of_wk) src
group by day_of_wk order by day_of_wk]]>
	</ActlSMSHoursNonLL>
	<ActlSMSHoursValTotalNonLL>
	<![CDATA[select 'STORE TOTAL' as TOTAL ,NVL(round(sum(ACTL_SMS_HRS),2),0) as ACTL_SMS_TOT from
(select (case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Day ,round(sum(actl_sms_hrs),2) as ACTL_SMS_HRS
from
(select LL.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000))+LL.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000)) * LL.fix_hrs_pct)/100) + LL.fix_hrs),0)
END) as actl_sms_hrs
from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
order by ll.day_of_wk) src
group by day_of_wk order by day_of_wk)]]>
	</ActlSMSHoursValTotalNonLL>
	
	<ORHoursLL>
	<![CDATA[select sms_hrs.days,
	case when sms_hrs.ACTL_SMS_HRS=0 then 0 when actl_hrs.ACTL_HRS_DTSD=0 then 0 else ROUND((sms_hrs.ACTL_SMS_HRS/actl_hrs.ACTL_HRS_DTSD)*100,1) end as ACTL_HRS_OR_PCT_DTSD from
(select (case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Days ,sum(actl_sms_hrs) as ACTL_SMS_HRS
from
(select src.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs),0)
END) as actl_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src
order by src.loc_no,src.dept_no,src.task_no,src.day_of_wk) sms_src
group by day_of_wk order by day_of_wk)sms_hrs
LEFT OUTER JOIN
(select lc.days,/*NVL(rslt.ACTL_HRS_DTS,0)*/
NVL(ROUND(((ROUND(((rslt.ACTL_HRS_DTS * 100)/'DepartmentToView'),0)*'DepartmentToView')/100),2),0) as ACTL_HRS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
WHEN 00 THEN 'Monday'
WHEN 01 THEN 'Tuesday'
WHEN 02 THEN 'Wednesday'
WHEN 03 THEN 'Thursday'
WHEN 04 THEN 'Friday'
WHEN 05 THEN 'Saturday'
WHEN 06 THEN 'Sunday'
END AS DAYS from day order by day_of_wk) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.actl_amt),0) as ACTL_WGE_DTS,ROUND(sum(e.actl_hrs),2) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.ACTL_WRK_HRS ,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk)actl_hrs
on sms_hrs.days=actl_hrs.days]]>
	</ORHoursLL>
	<ORHoursTotalLL>
	<![CDATA[select  'Store Total Longlife' as TOTAL,
	case when sms_hrs.ACTL_SMS_TOT=0 then 0 when actl_hrs.ACTL_HRS_TOT_DTSD=0 then 0 else ROUND((sms_hrs.ACTL_SMS_TOT / actl_hrs.ACTL_HRS_TOT_DTSD)*100,1) end as ACTL_HRS_OR_PCT_TOT_DTSD from 
(select 'STORE TOTAL' as TOTAL ,round(sum(ACTL_SMS_HRS),2) as ACTL_SMS_TOT from
(select (case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Days ,sum(actl_sms_hrs) as ACTL_SMS_HRS
from
(select src.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs),0)
END) as actl_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' then (select sum(actl_itm_cnt) from dly_Sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
end  ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src
order by src.loc_no,src.dept_no,src.task_no,src.day_of_wk) sms_src
group by day_of_wk order by day_of_wk))sms_hrs,
(select lc.dept_nm,/*NVL(rslt.ACTL_HRS_TOT_DTS,0)*/
NVL(ROUND(((ROUND(((rslt.ACTL_HRS_TOT_DTS * 100)/'DepartmentToView'),0)*'DepartmentToView')/100),2),0) as ACTL_HRS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.actl_amt),0) as ACTL_WGE_DTS,ROUND(sum(e.actl_hrs),2) as ACTL_HRS_TOT_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.ACTL_WRK_HRS ,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq)actl_hrs]]>
	</ORHoursTotalLL>
	
	<ORHoursNonLL>
	<![CDATA[select sms_hrs.days,
	case when sms_hrs.ACTL_SMS_HRS=0 then 0 when actl_hrs.ACTL_HRS_DTSD=0 then 0 else ROUND((sms_hrs.ACTL_SMS_HRS/actl_hrs.ACTL_HRS_DTSD)*100,1) end as ACTL_HRS_OR_PCT_DTSD from
(select (case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Days ,round(sum(actl_sms_hrs),2) as ACTL_SMS_HRS
from
(select LL.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000))+LL.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000)) * LL.fix_hrs_pct)/100) + LL.fix_hrs),0)
END) as actl_sms_hrs
from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
order by ll.day_of_wk) src
group by day_of_wk order by day_of_wk)sms_hrs
LEFT OUTER JOIN
(select lc.days,/*NVL(rslt.ACTL_HRS_DTS,0)*/
NVL(ROUND(((ROUND(((rslt.ACTL_HRS_DTS * 100)/'DepartmentToView'),0)*'DepartmentToView')/100),0),0) as ACTL_HRS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
WHEN 00 THEN 'Monday'
WHEN 01 THEN 'Tuesday'
WHEN 02 THEN 'Wednesday'
WHEN 03 THEN 'Thursday'
WHEN 04 THEN 'Friday'
WHEN 05 THEN 'Saturday'
WHEN 06 THEN 'Sunday'
END AS DAYS from day order by day_of_wk) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.actl_amt),0) as ACTL_WGE_DTS,ROUND(sum(e.actl_hrs),2) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.ACTL_WRK_HRS ,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk)actl_hrs
on sms_hrs.days=actl_hrs.days]]>
	</ORHoursNonLL>
	<ORHoursTotalNonLL>
	<![CDATA[select  'Store Total Non Longlife' as TOTAL,
	case when sms_hrs.ACTL_SMS_TOT=0 then 0 when actl_hrs.ACTL_HRS_TOT_DTSD=0 then 0 else ROUND((sms_hrs.ACTL_SMS_TOT / actl_hrs.ACTL_HRS_TOT_DTSD)*100,1) end as ACTL_HRS_OR_PCT_TOT_DTSD from 
(select 'STORE TOTAL' as TOTAL ,NVL((sum(ACTL_SMS_HRS)),0) as ACTL_SMS_TOT from
(select (case when day_of_wk='0' then 'Monday' 
when day_of_wk='1' then 'Tuesday' 
when day_of_wk='2' then 'Wednesday' 
when day_of_wk='3' then 'Thursday' 
when day_of_wk='4' then 'Friday' 
when day_of_wk='5' then 'Saturday' 
when day_of_wk='6' then 'Sunday' END)as Day ,(sum(actl_sms_hrs)) as ACTL_SMS_HRS
from
(select LL.*,
(CASE
when task_nm<>'Major Fill' Then NVL(((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000))+LL.fix_hrs),0)
When task_nm='Major Fill' Then NVL(((((((LL.var_per_mtrc_type_cd * NVL(LL.ACTL_ITM_CNT,0))/1000)) * LL.fix_hrs_pct)/100) + LL.fix_hrs),0)
END) as actl_sms_hrs
from
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , ds.actl_itm_cnt,ds.txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and tk.dept_no in ('DepartmentToView') and A.loc_no='store'  and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no  ) Y
inner join ww_wlp.dly_Sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
order by ll.day_of_wk) src
group by day_of_wk order by day_of_wk))sms_hrs,
(select lc.dept_nm,/*NVL(rslt.ACTL_HRS_TOT_DTS,0)*/
NVL(ROUND(((ROUND(((rslt.ACTL_HRS_TOT_DTS * 100)/'DepartmentToView'),0)*'DepartmentToView')/100),0),0) as ACTL_HRS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.actl_amt),0) as ACTL_WGE_DTS,ROUND(sum(e.actl_hrs),2) as ACTL_HRS_TOT_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.ACTL_WRK_HRS ,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq)actl_hrs]]>
	</ORHoursTotalNonLL>

	<KronosActlHours>
	<![CDATA[select lc.days,/*NVL(rslt.ACTL_HRS_DTS,0)*/
NVL(ROUND(((ROUND(((rslt.ACTL_HRS_DTS * 100)/'DepartmentToView'),0)*'DepartmentToView')/100),2),0) as ACTL_HRS_DTSD from 
(select distinct day_of_wk,CASE day_of_wk
WHEN 00 THEN 'Monday'
WHEN 01 THEN 'Tuesday'
WHEN 02 THEN 'Wednesday'
WHEN 03 THEN 'Thursday'
WHEN 04 THEN 'Friday'
WHEN 05 THEN 'Saturday'
WHEN 06 THEN 'Sunday'
END AS DAYS from day order by day_of_wk) lc
LEFT OUTER JOIN
(select e.dply_seq,e.day_of_wk,ROUND(sum(e.actl_amt),0) as ACTL_WGE_DTS,ROUND(sum(e.actl_hrs),2) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.ACTL_WRK_HRS ,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) rslt
on lc.day_of_wk=rslt.day_of_wk order by lc.day_of_wk]]>
	</KronosActlHours>
	<KronosActlHoursTotal>
	<![CDATA[select lc.dept_nm,/*NVL(rslt.ACTL_HRS_TOT_DTS,0)*/
NVL(ROUND(((ROUND(((rslt.ACTL_HRS_TOT_DTS * 100)/'DepartmentToView'),0)*'DepartmentToView')/100),2),0) as ACTL_HRS_TOT_DTSD from 
(select dply_seq,dept_no,dept_nm from dept where dply_seq is not null and div_no='Division' and dept_no IN ('DepartmentToView') order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.actl_amt),0) as ACTL_WGE_DTS,ROUND(sum(e.actl_hrs),2) as ACTL_HRS_TOT_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.ACTL_WRK_HRS ,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN ('DepartmentToView') 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.dply_seq order by e.dply_seq) rslt
on lc.dply_seq=rslt.dply_seq order by lc.dply_seq]]>
	</KronosActlHoursTotal>
	
</TCName>

</configuration>