<?xml version="1.0" encoding="UTF-8" ?> 
<configuration>

<TCName name="SalesColumnValidation">
<PlannedSales>
<![CDATA[select lc.loc_nm,NVL(ROUND(sls.PLN_SLS_WTSG,0),0) as PLN_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSG from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk
order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk
order by e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm]]> 
  </PlannedSales>
  
  <PlannedSalesTotal>
<![CDATA[select lc.ar_no,NVL(ROUND(sls.PLN_SLS_TOT_WTSG,0),0) as PLN_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSG from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no]]> 
  </PlannedSalesTotal>
  
  <ActualSales>
<![CDATA[select lc.loc_nm,NVL(ROUND(sls.ACTL_SLS_WTSG,0),0) as ACTL_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm]]> 
  </ActualSales>
  
  <ActualSalesTotal>
<![CDATA[select lc.ar_no,NVL(ROUND(sls.ACTL_SLS_TOT_WTSG,0),0) as ACTL_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no order by lc.ar_no]]> 
  </ActualSalesTotal>
  
  <VarSales>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_SLS_WTSG - pln.PLN_SLS_WTSG),0) as VAR_SLS_WTD_WTSG from 
(select lc.loc_nm,NVL(sls.PLN_SLS_WTSG,0) as PLN_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSG from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.dply_seq,e.loc_no,e.day_of_wk 
order by e.dply_seq,e.loc_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no) pln,
(select lc.loc_nm,NVL(sls.ACTL_SLS_WTSG,0) as ACTL_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl
where pln.loc_nm=actl.loc_nm order by pln.loc_nm]]> 
  </VarSales>
  
  <VarSalesTotal>
<![CDATA[select pln.ar_no,ROUND((actl.ACTL_SLS_TOT_WTSG - pln.PLN_SLS_TOT_WTSG),0) as VAR_SLS_WTD_WTSG from 
(select lc.ar_no,NVL(sls.PLN_SLS_TOT_WTSG,0) as PLN_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSG from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no) pln,
(select lc.ar_no,NVL(sls.ACTL_SLS_TOT_WTSG,0) as ACTL_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) actl
where pln.ar_no=actl.ar_no]]> 
  </VarSalesTotal>
  
  <LYSales>
<![CDATA[select lc.loc_nm,NVL(ROUND(sls.ACTL_SLS_WTSG,0),0) as ACTL_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no not  in (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm]]> 
  </LYSales>
  
  <LYSalesTotal>
<![CDATA[select lc.ar_no,NVL(ROUND(sls.ACTL_SLS_TOT_WTSG,0),0) as ACTL_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no not in (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no order by lc.ar_no]]> 
  </LYSalesTotal>
  
  <LYSalesPct>
<![CDATA[select lc.loc_nm,
CASE 
     WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
     WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
order by b.loc_no) lc
LEFT OUTER JOIN
(select cy_val.loc_no,sum(cy_val.ACTL_SLS_WTSG) as cy_wtd,sum(ly_val.ACTL_SLS_WTSG) as ly_wtd from 
(select lc.loc_no,NVL(sls.ACTL_SLS_WTSG,0) as ACTL_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) cy_val
LEFT OUTER JOIN
(select lc.loc_no,NVL(sls.ACTL_SLS_WTSG,0) as ACTL_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) ly_val
on cy_val.loc_no=ly_val.loc_no group by cy_val.loc_no) cyly_wtd
on cyly_wtd.loc_no=lc.loc_no order by lc.loc_nm]]> 
  </LYSalesPct>
  
  <LYSalesPctTotal>
<![CDATA[select lc.ar_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
     WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select cy_val.ar_no,sum(cy_val.ACTL_SLS_TOT_WTSG) as cy_wtd,sum(ly_val.ACTL_SLS_TOT_WTSG) as ly_wtd from 
(select lc.ar_no,NVL(sls.ACTL_SLS_TOT_WTSG,0) as ACTL_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) cy_val
LEFT OUTER JOIN
(select lc.ar_no,NVL(sls.ACTL_SLS_TOT_WTSG,0) as ACTL_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) ly_val
on cy_val.ar_no=ly_val.ar_no group by cy_val.ar_no) cyly_wtd
on cyly_wtd.ar_no=lc.ar_no]]> 
  </LYSalesPctTotal>
  
  <BudgetSales>
<![CDATA[select lc.loc_nm,NVL(bdgt.BDGT_SALES_WTSG,0) as BDGT_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_WTSG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_nm]]> 
  </BudgetSales>
  
  <BudgetSalesTotal>
<![CDATA[select lc.ar_no,NVL(bdgt.BDGT_SALES_TOT_WTSG,0) as BDGT_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_TOT_WTSG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.ar_no order by e.ar_no) bdgt
on lc.ar_no=bdgt.ar_no order by lc.ar_no]]> 
  </BudgetSalesTotal>
  
  <ForecastSales>
<![CDATA[select lc.loc_nm,NVL(fcst.FCST_SALES_WTSG,0) as FCST_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,ROUND(sum(e.frcst_sls),0) as FCST_SALES_WTSG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) fcst
on lc.loc_no=fcst.loc_no order by lc.loc_nm]]> 
  </ForecastSales>
  
<ForecastSalesTotal>
<![CDATA[select lc.ar_no,NVL(bdgt.FCST_SALES_TOT_WTSG,0) as FCST_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,ROUND(sum(e.frcst_sls),0) as FCST_SALES_TOT_WTSG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.ar_no order by e.ar_no) bdgt
on lc.ar_no=bdgt.ar_no order by lc.ar_no]]> 
  </ForecastSalesTotal>
  
  <VarBudgetSales>
<![CDATA[select actl.loc_nm,ROUND((actl.ACTL_SLS_WTSG - bdgt.BDGT_SLS_WTSG),0) as VAR_BDGT_SLS_WTSG from 
(select lc.loc_nm,NVL(sls.ACTL_SLS_WTSG,0) as ACTL_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl,
(select lc.loc_nm,NVL(bdgt.BDGT_SALES_WTSG,0) as BDGT_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.bdgt_sls) as BDGT_SALES_WTSG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no) bdgt
where bdgt.loc_nm=actl.loc_nm order by actl.loc_nm]]> 
  </VarBudgetSales>
  
  <VarBudgetSalesTotal>
<![CDATA[select actl.ar_no,ROUND((actl.ACTL_SLS_TOT_WTSG - bdgt.BDGT_SLS_TOT_WTSG),0) as VAR_BDGT_SLS_TOT_WTSG from 
(select lc.ar_no,NVL(sls.ACTL_SLS_TOT_WTSG,0) as ACTL_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) actl,
(select lc.ar_no,NVL(bdgt.BDGT_SALES_TOT_WTSG,0) as BDGT_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,sum(e.bdgt_sls) as BDGT_SALES_TOT_WTSG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.ar_no order by e.ar_no) bdgt
on lc.ar_no=bdgt.ar_no order by lc.ar_no) bdgt
where bdgt.ar_no=actl.ar_no]]> 
  </VarBudgetSalesTotal>
  
  <VarFcstSales>
<![CDATA[select actl.loc_nm,ROUND((actl.ACTL_SLS_WTSG - fcst.FCST_SLS_WTSG),0) as VAR_FCST_SLS_WTSG from 
(select lc.loc_nm,NVL(sls.ACTL_SLS_WTSG,0) as ACTL_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl,
(select lc.loc_nm,NVL(fcst.FCST_SALES_WTSG,0) as FCST_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.frcst_sls) as FCST_SALES_WTSG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) fcst
on lc.loc_no=fcst.loc_no order by lc.loc_no) fcst
where fcst.loc_nm=actl.loc_nm order by actl.loc_nm]]> 
  </VarFcstSales>
  
  <VarFcstSalesTotal>
<![CDATA[select actl.ar_no,ROUND((actl.ACTL_SLS_TOT_WTSG - fcst.FCST_SLS_TOT_WTSG),0) as VAR_FCST_SLS_TOT_WTSG from 
(select lc.ar_no,NVL(sls.ACTL_SLS_TOT_WTSG,0) as ACTL_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.dply_seq,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.dply_seq,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) actl,
(select lc.ar_no,NVL(bdgt.FCST_SALES_TOT_WTSG,0) as FCST_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,sum(e.frcst_sls) as FCST_SALES_TOT_WTSG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.ar_no order by e.ar_no) bdgt
on lc.ar_no=bdgt.ar_no order by lc.ar_no) fcst
where fcst.ar_no=actl.ar_no]]> 
  </VarFcstSalesTotal>
  
      <AvgBasketSales>
<![CDATA[select lc.loc_nm,
CASE WHEN nvl(nume_den.ACTL_SLS_WTSG,0) = 0 THEN 0 WHEN nume_den.ACTL_CUST_WTSG = 0 THEN 100
ELSE ROUND((nume_den.ACTL_SLS_WTSG / nume_den.ACTL_CUST_WTSG),2) END as AVG_BASKET_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,nvl(sum(h.ACTL_SLS_DTS),0) as ACTL_SLS_WTSG,nvl(sum(h.ACTL_CUST_DTS),0) as ACTL_CUST_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) nume_den
on nume_den.loc_no=lc.loc_no order by lc.loc_nm]]> 
  </AvgBasketSales>
  
  <AvgBasketSalesTotal>
<![CDATA[select lc.ar_no,
CASE WHEN nume_den.ACTL_SLS_TOT_WTSG = 0 THEN 0 WHEN nume_den.ACTL_CUST_TOT_WTSG = 0 THEN 100
ELSE nvl(ROUND((nume_den.ACTL_SLS_TOT_WTSG / nume_den.ACTL_CUST_TOT_WTSG),2),0) END as AVG_BASKET_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSG,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct pln_sls.ar_no,pln_sls.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.ar_no order by h.ar_no) nume_den
on nume_den.ar_no=lc.ar_no]]> 
  </AvgBasketSalesTotal>
  
  <WkyMixSales>
<![CDATA[select lc.loc_nm,
CASE WHEN nume_den.ACTL_SLS_WTSG = 0 THEN 0 WHEN NVL(nume_den.ACTL_SLS_TOT_WTSG,0) = 0 THEN 0
     WHEN NVL(nume_den.ACTL_SLS_WTSG,0) = 0 AND NVL(nume_den.ACTL_SLS_TOT_WTSG,0) = 0 THEN 0
ELSE ROUND((nume_den.ACTL_SLS_WTSG / nume_den.ACTL_SLS_TOT_WTSG)*100,2) END as WKY_MIX_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
order by b.loc_no) lc
LEFT OUTER JOIN
(select nume.loc_nm,nume.ACTL_SLS_WTSG,den.ACTL_SLS_TOT_WTSG from 
(select lc.loc_nm,NVL(sls.ACTL_SLS_WTSG,0) as ACTL_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) nume,
(select lc.ar_no,NVL(sls.ACTL_SLS_TOT_WTSG,0) as ACTL_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) den ) nume_den
on nume_den.loc_nm=lc.loc_nm order by lc.loc_nm]]> 
  </WkyMixSales>
  
  <WkyMixSalesTotal>
<![CDATA[select nume_den.ar_no,
CASE WHEN nume_den.ACTL_SLS_TOT_WTSG = 0 THEN 0 
ELSE ROUND((nume_den.ACTL_SLS_TOT_WTSG / nume_den.ACTL_SLS_TOT_WTSG)*100,2) END as WKY_MIX_SLS_TOT_WTSG from 
(select lc.ar_no,NVL(sls.ACTL_SLS_TOT_WTSG,0) as ACTL_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) nume_den]]> 
  </WkyMixSalesTotal>
  
</TCName>
  
<TCName name="ItemsColumnValidation">  
  
  <PlannedItems>
<![CDATA[select lc.loc_nm,NVL(ROUND(itm.PLN_ITM_WTSG,0),0) as PLN_ITM_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.PLN_ITM_DTS) as PLN_ITM_WTSG from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.dply_seq,e.loc_no,e.day_of_wk 
order by e.dply_seq,e.loc_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_nm]]> 
  </PlannedItems>
  
  <PlannedItemsTotal>
<![CDATA[select lc.ar_no,NVL(ROUND(itm.PLN_ITM_TOT_WTSG,0),0) as PLN_ITM_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_WTSG from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.ar_no order by h.ar_no) itm
on lc.ar_no=itm.ar_no]]> 
  </PlannedItemsTotal>
  
  <ActualItems>
<![CDATA[select lc.loc_nm,NVL(ROUND(itm.ACTL_ITM_WTSG,0),0) as ACTL_ITM_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_ITM_DTS) as ACTL_ITM_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.loc_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e )*/ ) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_nm]]> 
  </ActualItems>
  
  <ActualItemsTotal>
<![CDATA[select lc.ar_no,NVL(ROUND(itm.ACTL_ITM_TOT_WTSG,0),0) as ACTL_ITM_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.ar_no,pln_itm.loc_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.ar_no order by h.ar_no) itm
on lc.ar_no=itm.ar_no order by lc.ar_no]]> 
  </ActualItemsTotal>

    <PlannedItemPrice>
<![CDATA[select lc.loc_nm,
case when NVL(sls_itm.PLN_SLS_WTSG,0)=0 and NVL(sls_itm.PLN_ITM_WTSG,0)=0 then 0
when NVL(sls_itm.PLN_SLS_WTSG,0)=0 then 0 when NVL(sls_itm.PLN_ITM_WTSG,0)=0 then 100 
else NVL(ROUND((sls_itm.PLN_SLS_WTSG / sls_itm.PLN_ITM_WTSG),2),0) end as PLN_ITMPRZ_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSG,sum(h.PLN_ITM_DTS) as PLN_ITM_WTSG from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.dply_seq,e.loc_no,e.day_of_wk 
order by e.dply_seq,e.loc_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no order by h.loc_no) sls_itm
on lc.loc_no=sls_itm.loc_no order by lc.loc_nm]]> 
  </PlannedItemPrice>
  
  <PlannedItemPriceTotal>
<![CDATA[select lc.ar_no,
case when NVL(sls_itm.PLN_SLS_TOT_WTSG,0)=0 and NVL(sls_itm.PLN_ITM_TOT_WTSG,0)=0 then 0
when NVL(sls_itm.PLN_SLS_TOT_WTSG,0)=0 then 0 when NVL(sls_itm.PLN_ITM_TOT_WTSG,0)=0 then 100 
else NVL(ROUND((sls_itm.PLN_SLS_TOT_WTSG / sls_itm.PLN_ITM_TOT_WTSG),2),0) end as PLN_ITMPRZ_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSG,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_WTSG from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.ar_no order by h.ar_no) sls_itm
on lc.ar_no=sls_itm.ar_no]]> 
  </PlannedItemPriceTotal>
  
  <ActualItemPrice>
<![CDATA[select lc.loc_nm,NVL(ROUND((sls_itm.ACTL_SLS_WTSG / sls_itm.ACTL_ITM_WTSG),2),0) as ACTL_ITMPRZ_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSG,sum(h.ACTL_ITM_DTS) as ACTL_ITM_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls_itm.loc_no,pln_sls_itm.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e )*/ ) h 
group by h.loc_no order by h.loc_no) sls_itm
on lc.loc_no=sls_itm.loc_no order by lc.loc_nm]]> 
  </ActualItemPrice>
  
  <ActualItemPriceTotal>
<![CDATA[select lc.ar_no,NVL(ROUND((sls_itm.ACTL_SLS_TOT_WTSG / sls_itm.ACTL_ITM_TOT_WTSG),2),0) as ACTL_ITMPRZ_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSG,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls_itm.ar_no,pln_sls_itm.loc_no,pln_sls_itm.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.ar_no order by h.ar_no) sls_itm
on lc.ar_no=sls_itm.ar_no order by lc.ar_no]]> 
  </ActualItemPriceTotal>
  
</TCName>  
  
<TCName name="CustomersColumnValidation">  
  
  <ThisYrActlCustomers>
<![CDATA[select lc.loc_nm,NVL(ROUND(itm.ACTL_CUST_WTSG,0),0) as ACTL_CUST_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.loc_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )*/ ) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_nm]]> 
  </ThisYrActlCustomers>
  
  <ThisYrActlCustomersTotal>
<![CDATA[select lc.ar_no,NVL(ROUND(itm.ACTL_CUST_TOT_WTSG,0),0) as ACTL_CUST_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.ar_no,pln_itm.loc_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.ar_no order by h.ar_no) itm
on lc.ar_no=itm.ar_no order by lc.ar_no]]> 
  </ThisYrActlCustomersTotal>
  
  <PctLastYrCustomers>
<![CDATA[select lc.loc_nm,
CASE  WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
    
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select cy_val.loc_no,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.loc_no,NVL(sls.ACTL_CUST_WTSG,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) cy_val
LEFT OUTER JOIN
(select lc.loc_no,NVL(sls.ACTL_CUST_WTSG,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) ly_val
on cy_val.loc_no=ly_val.loc_no  
group by cy_val.loc_no) cyly_wtd
on cyly_wtd.loc_no=lc.loc_no order by lc.loc_nm]]> 
  </PctLastYrCustomers>
  
  <PctLastYrCustomersTotal>
<![CDATA[select lc.ar_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
     WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select cy_val.ar_no,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.ar_no,NVL(sls.ACTL_CUST_WTSG,0) as WTD from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) cy_val
LEFT OUTER JOIN
(select lc.ar_no,NVL(sls.ACTL_CUST_WTSG,0) as WTD from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id between 'LYWeekStrt' and 'LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) ly_val
on cy_val.ar_no=ly_val.ar_no 
group by cy_val.ar_no ) cyly_wtd
on cyly_wtd.ar_no=lc.ar_no]]> 
  </PctLastYrCustomersTotal>
  
  <DataPenetrationCustomers>
<![CDATA[select nume_den.loc_nm,
CASE When nume_den.ACTL_CUST_WTSG=0 Then 0 when nume_den.ACTL_CUST_TOT_WTSG=0 Then 0
ELSE ROUND((nume_den.ACTL_CUST_WTSG / nume_den.ACTL_CUST_TOT_WTSG)*100,2) END as DATA_PEN_CUST_WTSG from
(select nume.loc_nm,NVL(nume.ACTL_CUST_WTSG,0) as ACTL_CUST_WTSG,NVL(den.ACTL_CUST_TOT_WTSG,0) as ACTL_CUST_TOT_WTSG from 
(select lc.loc_no,lc.loc_nm,itm.ACTL_CUST_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.loc_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )*/ ) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_no) nume,
(select lc.ar_no,itm.ACTL_CUST_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.ar_no,pln_itm.loc_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )*/ ) h 
group by h.ar_no order by h.ar_no) itm
on lc.ar_no=itm.ar_no order by lc.ar_no) den order by nume.loc_no) nume_den order by nume_den.loc_nm]]> 
  </DataPenetrationCustomers>
  
  <DataPenetrationCustomersTotal>
<![CDATA[select nume_den.ar_no,
CASE When nume_den.ACTL_CUST_TOT_WTSG=0 Then 100 
ELSE ROUND((nume_den.ACTL_CUST_TOT_WTSG / nume_den.ACTL_CUST_TOT_WTSG)*100,2) END as DATA_PEN_CUST_TOT_WTSG from 
(select lc.ar_no,NVL(itm.ACTL_CUST_TOT_WTSG,0) as ACTL_CUST_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_itm.ar_no,pln_itm.loc_no,pln_itm.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )*/ ) h 
group by h.ar_no order by h.ar_no) itm
on lc.ar_no=itm.ar_no order by lc.ar_no) nume_den]]> 
  </DataPenetrationCustomersTotal>
  
</TCName>  
  
<TCName name="HoursColumnValidation">  
  
  <ActualHours>
<![CDATA[select lc.loc_nm,NVL(ROUND(hrs.ACTL_HRS_DTS,2),0) as ACTL_HRS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_nm]]> 
  </ActualHours>
  
  <ActualHoursTotal>
<![CDATA[select lc.ar_no,NVL(ROUND(hrs.ACTL_HRS_DTS,2),0) as ACTL_HRS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) hrs
on hrs.ar_no=lc.ar_no order by lc.ar_no]]> 
  </ActualHoursTotal>
  
  <CurrentActualHours>
<![CDATA[select z.loc_nm,NVL(ROUND(y.ACTL_HOURS_WTSG,2),0) as ACTL_HRS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) z
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_WTSG,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on z.loc_no=y.loc_no order by z.loc_nm]]> 
  </CurrentActualHours>
  
  <CurrentActualHoursTotal>
<![CDATA[select lc.ar_no,NVL(ROUND(y.ACTL_HOURS_TOT_WTSG,2),0) as ACTL_HRS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_WTSG,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no order by e.ar_no) y
on lc.ar_no=y.ar_no order by lc.ar_nm]]> 
  </CurrentActualHoursTotal>
  
    <PlannedHours>
<![CDATA[select z.loc_nm,NVL(ROUND(y.PLN_HOURS_WTSG,2),0) as PLN_HRS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) z
LEFT OUTER JOIN
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) y
on z.loc_no=y.loc_no order by z.loc_nm]]> 
  </PlannedHours>
  
  <PlannedHoursTotal>
<![CDATA[select lc.ar_no,NVL(ROUND(hrs.PLN_HOURS_TOT_WTSG,2),0) as PLN_HRS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) hrs
on hrs.ar_no=lc.ar_no order by lc.ar_no]]> 
  </PlannedHoursTotal>
  
  <CurrentPlannedHours>
<![CDATA[select z.loc_nm,NVL(ROUND(y.PLN_HOURS_WTSG,2),0) as PLN_HRS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) z
LEFT OUTER JOIN
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) y
on z.loc_no=y.loc_no order by z.loc_nm]]> 
  </CurrentPlannedHours>
  
  <CurrentPlannedHoursTotal>
<![CDATA[select lc.ar_no,NVL(ROUND(sum(hrs.PLN_HOURS_TOT_WTSG),2),0) as PLN_HRS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) hrs
on hrs.ar_no=lc.ar_no order by lc.ar_no]]> 
  </CurrentPlannedHoursTotal>
  
  <VarHours>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_HRS_WTSG - pln.PLN_HRS_WTSG),2) as VAR_HRS_WTSG from 
(select z.loc_nm,NVL(y.PLN_HOURS_WTSG,0) as PLN_HRS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) z
LEFT OUTER JOIN
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) y
on z.loc_no=y.loc_no order by z.loc_no) pln,
(select lc.loc_nm,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) actl
where pln.loc_nm=actl.loc_nm order by pln.loc_nm]]> 
  </VarHours>
  
  <VarHoursTotal>
<![CDATA[select pln.ar_no,ROUND((actl.ACTL_HRS_TOT_WTSG - pln.PLN_HRS_TOT_WTSG),2) as VAR_HRS_TOT_WTSG from 
(select lc.ar_no,NVL(hrs.PLN_HOURS_TOT_WTSG,0) as PLN_HRS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) hrs
on hrs.ar_no=lc.ar_no order by lc.ar_no) pln,
(select lc.ar_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) hrs
on hrs.ar_no=lc.ar_no order by lc.ar_no) actl
where pln.ar_no=actl.ar_no]]> 
  </VarHoursTotal>
  
  <CurrentVarHours>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_HRS_WTSG - pln.PLN_HRS_WTSG),2) as VAR_HRS_WTSG from 
(select z.loc_nm,NVL(y.PLN_HOURS_WTSG,0) as PLN_HRS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) z
LEFT OUTER JOIN
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) y
on z.loc_no=y.loc_no order by z.loc_no) pln,
(select z.loc_nm,NVL(y.ACTL_HOURS_WTSG,0) as ACTL_HRS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) z
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_WTSG,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on z.loc_no=y.loc_no order by z.loc_no) actl
where pln.loc_nm=actl.loc_nm order by pln.loc_nm]]> 
  </CurrentVarHours>
  
  <CurrentVarHoursTotal>
<![CDATA[select pln.ar_no,ROUND((actl.ACTL_HRS_TOT_WTSG - pln.PLN_HRS_TOT_WTSG),2) as VAR_HRS_TOT_WTSG from 
(select lc.ar_no,NVL(sum(hrs.PLN_HOURS_TOT_WTSG),0) as PLN_HRS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) hrs
on hrs.ar_no=lc.ar_no order by lc.ar_no) pln,
(select lc.ar_no,NVL(sum(hrs.PLN_HOURS_TOT_WTSG),0) as PLN_HRS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no,e.dply_seq order by e.ar_no,e.loc_no,e.dply_seq) hrs
on hrs.ar_no=lc.ar_no group by lc.ar_no) actl
where pln.ar_no=actl.ar_no]]> 
  </CurrentVarHoursTotal>
  
</TCName>

<TCName name = "WagesColumnValidation" >

  <ActualWages>
<![CDATA[select lc.loc_nm,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_nm]]> 
  </ActualWages>
  
  <ActualWagesTotal>
<![CDATA[select lc.ar_no,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) hrs
on hrs.ar_no=lc.ar_no order by lc.ar_no]]> 
  </ActualWagesTotal>
  
  <CurrentActualWages>
<![CDATA[select z.loc_nm,NVL(ROUND(y.ACTL_WAGE_WTSG,0),0) as ACTL_WGE_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) z
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_WTSG,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on z.loc_no=y.loc_no order by z.loc_nm]]> 
  </CurrentActualWages>
  
  <CurrentActualWagesTotal>
<![CDATA[select lc.ar_no,NVL(ROUND(y.ACTL_WAGE_TOT_WTSG,0),0) as ACTL_WGE_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_WTSG,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no order by e.ar_no) y
on lc.ar_no=y.ar_no order by lc.ar_no]]> 
  </CurrentActualWagesTotal>
  
  <ActualWagePercentage>
<![CDATA[select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_WTSG=0 Then 0 when nume_den.ACTL_SLS_WTSG=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_WTSG / nume_den.ACTL_SLS_WTSG)*100,2) END as ACTL_WGE_PCT_WTSG from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_WTSG,0) as ACTL_WGE_WTSG,NVL(den.ACTL_SLS_WTSG,0) as ACTL_SLS_WTSG from 
(select lc.loc_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_WTSG,0) as ACTL_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den order by nume_den.loc_nm]]> 
  </ActualWagePercentage>
  
  <ActualWagePercentageTotal>
<![CDATA[select nume_den.ar_no,
CASE When nume_den.ACTL_WGE_TOT_WTSG=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSG=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_TOT_WTSG / nume_den.ACTL_SLS_TOT_WTSG)*100,2) END as ACTL_WGE_PCT_TOT_WTSG from 
(select nume.ar_no,NVL(nume.ACTL_WGE_TOT_WTSG,0) as ACTL_WGE_TOT_WTSG,NVL(den.ACTL_SLS_TOT_WTSG,0) as ACTL_SLS_TOT_WTSG from 
(select lc.ar_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) hrs
on hrs.ar_no=lc.ar_no order by lc.ar_no) nume,
(select lc.ar_no,NVL(sls.ACTL_SLS_TOT_WTSG,0) as ACTL_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) den 
where nume.ar_no=den.ar_no) nume_den]]> 
  </ActualWagePercentageTotal>
  
    <CurrentActualWagePercentage>
<![CDATA[select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_WTSG=0 Then 0 when nume_den.ACTL_SLS_WTSG=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_WTSG / nume_den.ACTL_SLS_WTSG)*100,2) END as ACTL_WGE_PCT_WTSG from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_WTSG,0) as ACTL_WGE_WTSG,NVL(den.ACTL_SLS_WTSG,0) as ACTL_SLS_WTSG from 
(select z.loc_nm,NVL(y.ACTL_WAGE_WTSG,0) as ACTL_WGE_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) z
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_WTSG,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on z.loc_no=y.loc_no order by z.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_WTSG,0) as ACTL_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den order by nume_den.loc_nm]]> 
  </CurrentActualWagePercentage>
  
  <CurrentActualWagePercentageTotal>
<![CDATA[select nume_den.ar_no,
CASE When nume_den.ACTL_WGE_TOT_WTSG=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSG=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_TOT_WTSG / nume_den.ACTL_SLS_TOT_WTSG)*100,2) END as ACTL_WGE_PCT_TOT_WTSG from 
(select nume.ar_no,NVL(nume.ACTL_WGE_TOT_WTSG,0) as ACTL_WGE_TOT_WTSG,NVL(den.ACTL_SLS_TOT_WTSG,0) as ACTL_SLS_TOT_WTSG from 
(select lc.ar_no,NVL(y.ACTL_WAGE_TOT_WTSG,0) as ACTL_WGE_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_WTSG,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.ar_no order by e.ar_no) y
on lc.ar_no=y.ar_no order by lc.ar_no) nume,
(select lc.ar_no,NVL(sls.ACTL_SLS_TOT_WTSG,0) as ACTL_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) den 
where nume.ar_no=den.ar_no) nume_den]]> 
  </CurrentActualWagePercentageTotal>
  
  <BudgetWages>
<![CDATA[select lc.loc_nm,NVL(ROUND(bdgt.BDGT_WAGE_WTSG,0),0) as BDGT_WGE_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.bdgt_wage_amt) as BDGT_WAGE_WTSG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_nm]]> 
  </BudgetWages>
  
  <BudgetWagesTotal>
<![CDATA[select lc.ar_no,NVL(ROUND(bdgt.BDGT_WAGE_TOT_WTSG,0),0) as BDGT_WGE_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,sum(e.bdgt_wage_amt) as BDGT_WAGE_TOT_WTSG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.ar_no order by e.ar_no) bdgt
on lc.ar_no=bdgt.ar_no order by lc.ar_no]]> 
  </BudgetWagesTotal>
  
  <ForecastWages>
<![CDATA[select lc.loc_nm,NVL(ROUND(fcst.FCST_WAGE_WTSG,0),0) as FCST_WGE_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.frcst_wage_amt) as FCST_WAGE_WTSG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) fcst
on lc.loc_no=fcst.loc_no order by lc.loc_nm]]> 
  </ForecastWages>
  
  <ForecastWagesTotal>
<![CDATA[select lc.ar_no,NVL(ROUND(fcst.FCST_WAGE_TOT_WTSG,0),0) as FCST_WGE_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,sum(e.frcst_wage_amt) as FCST_WAGE_TOT_WTSG from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.ar_no order by e.ar_no) fcst
on lc.ar_no=fcst.ar_no order by lc.ar_no]]> 
  </ForecastWagesTotal>
  
  <BudgetWagePercentage>
<![CDATA[select wge.loc_nm,
CASE When wge.BDGT_WGE_WTSG=0 Then 0 When sls.BDGT_SLS_WTSG=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_WTSG / sls.BDGT_SLS_WTSG)*100,2),0) END as BDGT_WGE_PCT_WTSG from 
(select lc.loc_no,lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no
group by lc.loc_no,lc.loc_nm order by lc.loc_no) wge,
(select lc.loc_no,lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no
group by lc.loc_no,lc.loc_nm order by lc.loc_no) sls
where wge.loc_nm=sls.loc_nm order by wge.loc_nm]]> 
  </BudgetWagePercentage>
  
  <BudgetWagePercentageTotal>
<![CDATA[select wge.ar_no,
CASE When wge.BDGT_WGE_TOT_WTSG=0 Then 0 When sls.BDGT_SLS_TOT_WTSG=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_WTSG / sls.BDGT_SLS_TOT_WTSG)*100,2),0) END as BDGT_WGE_PCT_TOT_WTSG from 
(select lc.ar_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.ar_no=bdgt.ar_no
group by lc.ar_no order by lc.ar_no) wge,
(select lc.ar_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.ar_no=bdgt.ar_no
group by lc.ar_no order by lc.ar_no) sls
where wge.ar_no=sls.ar_no]]> 
  </BudgetWagePercentageTotal>
  
  <ForecastWagePercentage>
<![CDATA[select wge.loc_nm,
CASE When wge.FCST_WGE_WTSG=0 Then 0 When sls.FCST_SLS_WTSG=0 Then 0
ELSE NVL(ROUND((wge.FCST_WGE_WTSG / sls.FCST_SLS_WTSG)*100,2),0) END as FCST_WGE_PCT_WTSG from 
(select lc.loc_no,lc.loc_nm,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no
group by lc.loc_no,lc.loc_nm order by lc.loc_no) wge,
(select lc.loc_no,lc.loc_nm,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no
group by lc.loc_no,lc.loc_nm order by lc.loc_no) sls
where wge.loc_nm=sls.loc_nm order by wge.loc_nm]]> 
  </ForecastWagePercentage>
  
  <ForecastWagePercentageTotal>
<![CDATA[select wge.ar_no,
CASE When wge.FCST_WGE_TOT_WTSG=0 Then 0 When sls.FCST_SLS_TOT_WTSG=0 Then 0
ELSE NVL(ROUND((wge.FCST_WGE_TOT_WTSG / sls.FCST_SLS_TOT_WTSG)*100,2),0) END as FCST_WGE_PCT_TOT_WTSG from 
(select lc.ar_no,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.ar_no=fcst.ar_no
group by lc.ar_no order by lc.ar_no) wge,
(select lc.ar_no,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.ar_no=fcst.ar_no
group by lc.ar_no order by lc.ar_no) sls
where wge.ar_no=sls.ar_no]]> 
  </ForecastWagePercentageTotal>
  
  <PlannedWages>
<![CDATA[select z.loc_nm,NVL(ROUND(y.PLN_WAGE_WTSG,0),0) as PLN_WGE_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) z
LEFT OUTER JOIN
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) y
on z.loc_no=y.loc_no order by z.loc_nm]]> 
  </PlannedWages>
  
  <PlannedWagesTotal>
<![CDATA[select lc.ar_no,NVL(ROUND(wge.PLN_WAGE_WTSG,0),0) as PLN_WGE_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no]]> 
  </PlannedWagesTotal>
  
  <PlannedWagesPercentage>
<![CDATA[select wge.loc_nm,
CASE When wge.PLN_WGE_WTSG=0 Then 0 When sls.PLN_SLS_WTSG=0 Then 0 
ELSE NVL(ROUND((wge.PLN_WGE_WTSG / sls.PLN_SLS_WTSG)*100,2),0) END as PLN_WGE_PRCNT_WTSG from
(select z.loc_nm,NVL(y.PLN_WAGE_WTSG,0) as PLN_WGE_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) z
LEFT OUTER JOIN
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) y
on z.loc_no=y.loc_no order by z.loc_no) wge,
(select z.loc_nm,NVL(y.PLN_SLS_WTSG,0) as PLN_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) z
LEFT OUTER JOIN
(select h.loc_no,sum(h.PLN_SLS_WTSG) as PLN_SLS_WTSG from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_WTSG,sum(e.refcst_itm_cnt) as PLN_ITM_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_WTSG,sum(e.mgr_pln_itm_cnt) as PLN_ITM_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
/*and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_WTSG,sum(e.gnrt_itm) as GEN_ITM_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
/*and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no order by h.loc_no) y
on z.loc_no=y.loc_no order by z.loc_no) sls
where wge.loc_nm=sls.loc_nm order by wge.loc_nm]]> 
  </PlannedWagesPercentage>
  
  <PlannedWagesPercentageTotal>
<![CDATA[select wge.ar_no,NVL(ROUND((wge.PLN_WGE_TOT_WTSG / sls.PLN_SLS_TOT_WTSG)*100,2),0) as PLN_WGE_PRCNT_TOT_WTSG from
(select lc.ar_no,sum(wge.PLN_WAGE_WTSG) as PLN_WGE_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,e.loc_no,e.dply_seq,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no,e.loc_no,e.dply_seq 
order by e.ar_no,e.loc_no,e.dply_seq) wge
on wge.ar_no=lc.ar_no 
group by lc.ar_no order by lc.ar_no) wge,
(select lc.ar_no,NVL(sls.PLN_SLS_WTSG,0) as PLN_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.PLN_SLS_WTSG) as PLN_SLS_WTSG from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_WTSG,sum(e.refcst_itm_cnt) as PLN_ITM_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20,0,90) 
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_WTSG,sum(e.mgr_pln_itm_cnt) as PLN_ITM_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20,0,90) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
/*and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_WTSG,sum(e.gnrt_itm) as GEN_ITM_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20,0,90) 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
/*and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no) sls
where wge.ar_no=sls.ar_no]]> 
  </PlannedWagesPercentageTotal>
  
  <PlannedCPH>
<![CDATA[select lc.loc_nm,
CASE When NVL(wge.PLN_WAGE_WTSG,0)=0 Then 0 When NVL(wge.PLN_HOURS_WTSG,0)=0 Then 0 
ELSE NVL(ROUND((wge.PLN_WAGE_WTSG / wge.PLN_HOURS_WTSG),2),0) END as PLN_CPH_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) wge
on lc.loc_no=wge.loc_no order by lc.loc_nm]]> 
  </PlannedCPH>
  
  <PlannedCPHTotal>
<![CDATA[select lc.ar_no,
CASE When NVL(wge.PLN_WAGE_TOT_WTSG,0)=0 Then 0 When NVL(wge.PLN_HOURS_TOT_WTSG,0)=0 Then 0 
ELSE NVL(ROUND((wge.PLN_WAGE_TOT_WTSG / wge.PLN_HOURS_TOT_WTSG),2),0) END as PLN_CPH_TOT_WTSG from
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no]]> 
  </PlannedCPHTotal>
  
  <ActualCPH>
<![CDATA[select lc.loc_nm,
CASE When NVL(wge.ACTL_WAGE_WTSG,0)=0 Then 0 When NVL(wge.ACTL_HOURS_WTSG,0)=0 Then 0 
ELSE NVL(ROUND((wge.ACTL_WAGE_WTSG / wge.ACTL_HOURS_WTSG),2),0) END as ACTL_CPH_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WAGE_WTSG,sum(e.actl_hrs) as ACTL_HOURS_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_nm]]> 
  </ActualCPH>
  
  <ActualCPHTotal>
<![CDATA[select lc.ar_no,
CASE When NVL(wge.ACTL_WAGE_TOT_WTSG,0)=0 Then 0 When NVL(wge.ACTL_HOURS_TOT_WTSG,0)=0 Then 0 
ELSE NVL(ROUND((wge.ACTL_WAGE_TOT_WTSG / wge.ACTL_HOURS_TOT_WTSG),2),0) END as ACTL_CPH_TOT_WTSG from
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,sum(e.actl_wage_amt) as ACTL_WAGE_TOT_WTSG,sum(e.actl_hrs) as ACTL_HOURS_TOT_WTSG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) wge
on wge.ar_no=lc.ar_no order by lc.ar_no]]> 
  </ActualCPHTotal>
  
  <VarWages>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_WGE_PCT_WTSG - pln.BDGT_WGE_PCT_WTSG),2) as VAR_WGE_PCT_WTSG from 
(select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_WTSG=0 Then 0 when nume_den.ACTL_SLS_WTSG=0 Then 0
ELSE ((nume_den.ACTL_WGE_WTSG / nume_den.ACTL_SLS_WTSG)*100) END as ACTL_WGE_PCT_WTSG from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_WTSG,0) as ACTL_WGE_WTSG,NVL(den.ACTL_SLS_WTSG,0) as ACTL_SLS_WTSG from 
(select lc.loc_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_WTSG,0) as ACTL_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den) actl,
(select wge.loc_nm,
CASE When wge.BDGT_WGE_WTSG=0 Then 0 When sls.BDGT_SLS_WTSG=0 Then 0
ELSE NVL((wge.BDGT_WGE_WTSG / sls.BDGT_SLS_WTSG)*100,0) END as BDGT_WGE_PCT_WTSG from 
(select lc.loc_no,lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no
group by lc.loc_no,lc.loc_nm order by lc.loc_no) wge,
(select lc.loc_no,lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no
group by lc.loc_no,lc.loc_nm order by lc.loc_no) sls
where wge.loc_nm=sls.loc_nm) pln
where pln.loc_nm=actl.loc_nm order by pln.loc_nm]]> 
  </VarWages>
  
  <VarWagesTotal>
<![CDATA[select pln.ar_no,ROUND((actl.ACTL_WGE_PCT_TOT_WTSG - pln.BDGT_WGE_PCT_TOT_WTSG),2) as VAR_WGE_TOT_WTSG from 
(select nume_den.ar_no,
CASE When nume_den.ACTL_WGE_TOT_WTSG=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSG=0 Then 0
ELSE ((nume_den.ACTL_WGE_TOT_WTSG / nume_den.ACTL_SLS_TOT_WTSG)*100) END as ACTL_WGE_PCT_TOT_WTSG from 
(select nume.ar_no,NVL(nume.ACTL_WGE_TOT_WTSG,0) as ACTL_WGE_TOT_WTSG,NVL(den.ACTL_SLS_TOT_WTSG,0) as ACTL_SLS_TOT_WTSG from 
(select lc.ar_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) hrs
on hrs.ar_no=lc.ar_no order by lc.ar_no) nume,
(select lc.ar_no,NVL(sls.ACTL_SLS_TOT_WTSG,0) as ACTL_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) den 
where nume.ar_no=den.ar_no) nume_den) actl,
(select wge.ar_no,
CASE When wge.BDGT_WGE_TOT_WTSG=0 Then 0 When sls.BDGT_SLS_TOT_WTSG=0 Then 0
ELSE NVL((wge.BDGT_WGE_TOT_WTSG / sls.BDGT_SLS_TOT_WTSG)*100,0) END as BDGT_WGE_PCT_TOT_WTSG from 
(select lc.ar_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.ar_no=bdgt.ar_no
group by lc.ar_no order by lc.ar_no) wge,
(select lc.ar_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.ar_no=bdgt.ar_no
group by lc.ar_no order by lc.ar_no) sls
where wge.ar_no=sls.ar_no) pln
where pln.ar_no=actl.ar_no]]> 
  </VarWagesTotal>
  
    <VarFcstWages>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_WGE_PCT_WTSG - pln.FCST_WGE_PCT_WTSG),2) as VAR_FCST_WGE_WTSG from 
(select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_WTSG=0 Then 0 when nume_den.ACTL_SLS_WTSG=0 Then 0
ELSE ((nume_den.ACTL_WGE_WTSG / nume_den.ACTL_SLS_WTSG)*100) END as ACTL_WGE_PCT_WTSG from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_WTSG,0) as ACTL_WGE_WTSG,NVL(den.ACTL_SLS_WTSG,0) as ACTL_SLS_WTSG from 
(select lc.loc_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_WTSG,0) as ACTL_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/ ) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den) actl,
(select wge.loc_nm,
CASE When wge.FCST_WGE_WTSG=0 Then 0 When sls.FCST_SLS_WTSG=0 Then 0
ELSE NVL((wge.FCST_WGE_WTSG / sls.FCST_SLS_WTSG)*100,0) END as FCST_WGE_PCT_WTSG from 
(select lc.loc_no,lc.loc_nm,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no
group by lc.loc_no,lc.loc_nm order by lc.loc_no) wge,
(select lc.loc_no,lc.loc_nm,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_WTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no
group by lc.loc_no,lc.loc_nm order by lc.loc_no) sls
where wge.loc_nm=sls.loc_nm) pln
where pln.loc_nm=actl.loc_nm order by pln.loc_nm]]> 
  </VarFcstWages>
  
  <VarFcstWagesTotal>
<![CDATA[select pln.ar_no,ROUND((actl.ACTL_WGE_PCT_TOT_WTSG - pln.FCST_WGE_PCT_TOT_WTSG),2) as VAR_FCST_WGE_TOT_WTSG from 
(select nume_den.ar_no,
CASE When nume_den.ACTL_WGE_TOT_WTSG=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSG=0 Then 0
ELSE ((nume_den.ACTL_WGE_TOT_WTSG / nume_den.ACTL_SLS_TOT_WTSG)*100) END as ACTL_WGE_PCT_TOT_WTSG from 
(select nume.ar_no,NVL(nume.ACTL_WGE_TOT_WTSG,0) as ACTL_WGE_TOT_WTSG,NVL(den.ACTL_SLS_TOT_WTSG,0) as ACTL_SLS_TOT_WTSG from 
(select lc.ar_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select e.ar_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.ar_no order by e.ar_no) hrs
on hrs.ar_no=lc.ar_no order by lc.ar_no) nume,
(select lc.ar_no,NVL(sls.ACTL_SLS_TOT_WTSG,0) as ACTL_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) den 
where nume.ar_no=den.ar_no) nume_den) actl,
(select wge.ar_no,
CASE When wge.FCST_WGE_TOT_WTSG=0 Then 0 When sls.FCST_SLS_TOT_WTSG=0 Then 0
ELSE NVL(((wge.FCST_WGE_TOT_WTSG / sls.FCST_SLS_TOT_WTSG)*100),0) END as FCST_WGE_PCT_TOT_WTSG from 
(select lc.ar_no,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.ar_no=fcst.ar_no
group by lc.ar_no order by lc.ar_no) wge,
(select lc.ar_no,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_TOT_WTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.ar_no=fcst.ar_no
group by lc.ar_no order by lc.ar_no) sls
where wge.ar_no=sls.ar_no) pln
where pln.ar_no=actl.ar_no]]> 
  </VarFcstWagesTotal>
  <AllowedWages>
<![CDATA[select src.loc_nm,
case 
when src.ACTL_SLS_MTSG > src.BDGT_SLS_MTSG 
	then NVL(ROUND((((BDGT_WGE_PCT_MTSG * BDGT_SLS_MTSG) + ((ACTL_SLS_MTSG - BDGT_SLS_MTSG) * (PST_FACTOR_MTSG * BDGT_WGE_PCT_MTSG)))/100),0),0)
When src.ACTL_SLS_MTSG < src.BDGT_SLS_MTSG 
	then NVL(ROUND((((BDGT_WGE_PCT_MTSG * BDGT_SLS_MTSG) + ((ACTL_SLS_MTSG - BDGT_SLS_MTSG) * (NGT_FACTOR_MTSG * BDGT_WGE_PCT_MTSG)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_MTSG * ACTL_SLS_MTSG)/100),0),0) end as ALWD_WGE_MTSG from 

(select actl_sls.loc_nm,rte_fct.wk_id,actl_sls.ACTL_SLS_MTSG,rte_fct.PST_FACTOR_MTSG,rte_fct.NGT_FACTOR_MTSG,
bdgt_wge_pct.BDGT_WGE_PCT_MTSG,bdgt_wge_pct.BDGT_WGE_MTSG,bdgt_wge_pct.BDGT_SLS_MTSG from

(select lc.loc_nm,NVL(ROUND(sls.ACTL_SLS_MTSG,0),0) as ACTL_SLS_MTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_MTSG from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_nm) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_MTSG,NVL(src.ngt_factor,1) as NGT_FACTOR_MTSG from 
(select perd_desc,wk_id from wk where wk_id  between 'WeekStart' and 'WeekStart') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id  between 'WeekStart' and 'WeekStart') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select wge.loc_nm,NVL(ROUND(wge.BDGT_WGE_MTSG,0),0) as BDGT_WGE_MTSG,NVL(ROUND(sls.BDGT_SLS_MTSG,0),0) as BDGT_SLS_MTSG,
CASE When NVL(wge.BDGT_WGE_MTSG,0)=0 and NVL(sls.BDGT_SLS_MTSG,0)=0 Then 0
When NVL(wge.BDGT_WGE_MTSG,0)=0 Then 0 When NVL(sls.BDGT_SLS_MTSG,0)=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_MTSG / sls.BDGT_SLS_MTSG)*100,5),0) END as BDGT_WGE_PCT_MTSG from 
(select lc.loc_no,lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_MTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no
group by lc.loc_no,lc.loc_nm order by lc.loc_no) wge,
(select lc.loc_no,lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_MTSG from 
(select distinct b.loc_no,b.loc_nm from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.loc_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no
group by lc.loc_no,lc.loc_nm order by lc.loc_no) sls
where wge.loc_nm=sls.loc_nm order by wge.loc_nm) bdgt_wge_pct

where actl_sls.loc_nm=bdgt_wge_pct.loc_nm order by actl_sls.loc_nm,rte_fct.wk_id) src 
order by src.loc_nm ]]> 
  </AllowedWages>
  
  <AllowedWagesTotal>
<![CDATA[select src.ar_no,
case 
when src.ACTL_SLS_TOT_MTSG > src.BDGT_SLS_TOT_MTSG 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_MTSG * BDGT_SLS_TOT_MTSG) + ((ACTL_SLS_TOT_MTSG - BDGT_SLS_TOT_MTSG) * (PST_FACTOR_TOT_MTSG * BDGT_WGE_PCT_TOT_MTSG)))/100),0),0)
When src.ACTL_SLS_TOT_MTSG < src.BDGT_SLS_TOT_MTSG 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_MTSG * BDGT_SLS_TOT_MTSG) + ((ACTL_SLS_TOT_MTSG - BDGT_SLS_TOT_MTSG) * (NGT_FACTOR_TOT_MTSG * BDGT_WGE_PCT_TOT_MTSG)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_TOT_MTSG * ACTL_SLS_TOT_MTSG)/100),0),0) end as ALWD_WGE_TOT_MTSG from 

(select actl_sls.ar_no,rte_fct.wk_id,actl_sls.ACTL_SLS_TOT_MTSG,rte_fct.PST_FACTOR_TOT_MTSG,rte_fct.NGT_FACTOR_TOT_MTSG,
bdgt_wge_pct.BDGT_WGE_PCT_TOT_MTSG,bdgt_wge_pct.BDGT_WGE_TOT_MTSG,bdgt_wge_pct.BDGT_SLS_TOT_MTSG from

(select lc.ar_no,NVL(ROUND(sls.ACTL_SLS_TOT_MTSG,0),0) as ACTL_SLS_TOT_MTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select h.ar_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_MTSG from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f) h 
group by h.ar_no order by h.ar_no) sls
on lc.ar_no=sls.ar_no order by lc.ar_no) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_TOT_MTSG,NVL(src.ngt_factor,1) as NGT_FACTOR_TOT_MTSG from 
(select perd_desc,wk_id from wk where wk_id  between 'WeekStart' and 'WeekStart') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id  between 'WeekStart' and 'WeekStart') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select wge.ar_no,NVL(ROUND(wge.BDGT_WGE_TOT_MTSG,0),0) as BDGT_WGE_TOT_MTSG, NVL(ROUND(sls.BDGT_SLS_TOT_MTSG,0),0) as BDGT_SLS_TOT_MTSG,
CASE When NVL(wge.BDGT_WGE_TOT_MTSG,0)=0 and NVL(sls.BDGT_SLS_TOT_MTSG,0)=0 Then 0
When NVL(wge.BDGT_WGE_TOT_MTSG,0)=0 Then 0 When NVL(sls.BDGT_SLS_TOT_MTSG,0)=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_MTSG / sls.BDGT_SLS_TOT_MTSG)*100,5),0) END as BDGT_WGE_PCT_TOT_MTSG from 
(select lc.ar_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_MTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.ar_no=bdgt.ar_no
group by lc.ar_no order by lc.ar_no) wge,
(select lc.ar_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_MTSG from 
(select distinct b.ar_no from loc b where b.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' order by b.ar_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.rgn_no='Region' and b.zone_no='Zone' and b.ar_no='Area' 
and a.wk_id=c.wk_id and c.wk_id  between 'WeekStart' and 'WeekEnd'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,0,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.ar_no=bdgt.ar_no
group by lc.ar_no order by lc.ar_no) sls
where wge.ar_no=sls.ar_no) bdgt_wge_pct

where actl_sls.ar_no=bdgt_wge_pct.ar_no order by actl_sls.ar_no,rte_fct.wk_id) src order by src.ar_no ]]> 
  </AllowedWagesTotal>
  </TCName>
  
</configuration>