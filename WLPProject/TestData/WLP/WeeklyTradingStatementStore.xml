<?xml version="1.0" encoding="UTF-8" ?> 
<configuration>

<TCName name="SalesColumnValidation">
<PlannedSales>
<![CDATA[select lc.dept_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSS from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.dply_seq,e.loc_no,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.loc_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq]]> 
  </PlannedSales>
  
  <PlannedSalesTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no]]> 
  </PlannedSalesTotal>
  
  <ActualSales>
<![CDATA[select lc.dept_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq]]> 
  </ActualSales>
  
  <ActualSalesTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no]]> 
  </ActualSalesTotal>
  
  <VarSales>
<![CDATA[select pln.dept_nm,ROUND((actl.wtd - pln.wtd),0) as VAR_SLS_WTD_WTSS from 
(select lc.dept_nm,NVL(sls.wtd,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSS from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.dply_seq,e.loc_no,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.loc_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq) pln,
(select lc.dept_nm,NVL(sls.wtd,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) actl
where pln.dept_nm=actl.dept_nm]]> 
  </VarSales>
  
  <VarSalesTotal>
<![CDATA[select pln.loc_nm,ROUND((actl.wtd - pln.wtd),0) as VAR_SLS_WTD_WTSS from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) pln,
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl
where pln.loc_nm=actl.loc_nm]]> 
  </VarSalesTotal>
  
  <LYSales>
<![CDATA[select lc.dept_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq]]> 
  </LYSales>
  
  <LYSalesTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no]]> 
  </LYSalesTotal>
  
  <LYSalesPct>
<![CDATA[select lc.dept_nm,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0     
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select cy_val.dept_nm,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.dept_nm,NVL(sls.wtd,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) cy_val
LEFT OUTER JOIN
(select lc.dept_nm,NVL(sls.wtd,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) ly_val
on cy_val.dept_nm=ly_val.dept_nm 
group by cy_val.dept_nm ) cyly_wtd
on cyly_wtd.dept_nm=lc.dept_nm]]> 
  </LYSalesPct>
  
  <LYSalesPctTotal>
<![CDATA[select lc.loc_nm,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100
     WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select cy_val.loc_nm,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) cy_val
LEFT OUTER JOIN
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) ly_val
on cy_val.loc_nm=ly_val.loc_nm 
group by cy_val.loc_nm) cyly_wtd
on cyly_wtd.loc_nm=lc.loc_nm]]> 
  </LYSalesPctTotal>
  
  <BudgetSales>
<![CDATA[select lc.dept_nm,NVL(bdgt.BDGT_SALES_WTSS,0) as BDGT_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.dply_seq order by e.dply_seq) bdgt
on lc.dply_seq=bdgt.dply_seq order by lc.dply_seq]]> 
  </BudgetSales>
  
  <BudgetSalesTotal>
<![CDATA[select lc.loc_nm,NVL(bdgt.BDGT_SALES_TOT_WTSS,0) as BDGT_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no]]> 
  </BudgetSalesTotal>
  
  <ForecastSales>
<![CDATA[select lc.dept_nm,NVL(fcst.FCST_SALES_WTSS,0) as FCST_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,ROUND(sum(e.frcst_sls),0) as FCST_SALES_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.dply_seq order by e.dply_seq) fcst
on lc.dply_seq=fcst.dply_seq order by lc.dply_seq]]> 
  </ForecastSales>
  
<ForecastSalesTotal>
<![CDATA[select lc.loc_nm,NVL(bdgt.FCST_SALES_TOT_WTSS,0) as FCST_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,ROUND(sum(e.frcst_sls),0) as FCST_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no]]> 
  </ForecastSalesTotal>
  
  <VarBudgetSales>
<![CDATA[select actl.dept_nm,ROUND((actl.wtd - bdgt.wtd),0) as VAR_BDGT_SLS_WTSS from 
(select lc.dept_nm,NVL(sls.wtd,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) actl,
(select lc.dept_nm,NVL(bdgt.BDGT_SALES_WTSS,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.bdgt_sls) as BDGT_SALES_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.dply_seq order by e.dply_seq) bdgt
on lc.dply_seq=bdgt.dply_seq order by lc.dply_seq) bdgt
where bdgt.dept_nm=actl.dept_nm]]> 
  </VarBudgetSales>
  
  <VarBudgetSalesTotal>
<![CDATA[select actl.loc_nm,ROUND((actl.wtd - bdgt.wtd),0) as VAR_BDGT_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl,
(select lc.loc_nm,NVL(bdgt.BDGT_SALES_TOT_WTSS,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.bdgt_sls) as BDGT_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no) bdgt
where bdgt.loc_nm=actl.loc_nm]]> 
  </VarBudgetSalesTotal>
  
  <VarFcstSales>
<![CDATA[select actl.dept_nm,ROUND((actl.wtd - fcst.wtd),0) as VAR_FCST_SLS_WTSS from 
(select lc.dept_nm,NVL(sls.wtd,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) actl,
(select lc.dept_nm,NVL(fcst.FCST_SALES_WTSS,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.frcst_sls) as FCST_SALES_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.dply_seq order by e.dply_seq) fcst
on lc.dply_seq=fcst.dply_seq order by lc.dply_seq) fcst
where fcst.dept_nm=actl.dept_nm]]> 
  </VarFcstSales>
  
  <VarFcstSalesTotal>
<![CDATA[select actl.loc_nm,ROUND((actl.wtd - fcst.wtd),0) as VAR_FCST_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(sls.wtd,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl,
(select lc.loc_nm,NVL(bdgt.FCST_SALES_TOT_WTSS,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.frcst_sls) as FCST_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no) fcst
where fcst.loc_nm=actl.loc_nm]]> 
  </VarFcstSalesTotal>
  
  <AvgBasketSales>
<![CDATA[select lc.dept_nm,
CASE WHEN nume_den.wtd_sls = 0 AND nume_den.wtd_cust = 0 THEN 0
WHEN nume_den.wtd_sls = 0 THEN 0 WHEN nume_den.wtd_cust = 0 THEN 0
ELSE NVL(ROUND((nume_den.wtd_sls / nume_den.wtd_cust),2),0) END as AVG_BASKET_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_cust + x.Tue_cust + x.Wed_cust + x.Thu_cust + x.Fri_cust + x.Sat_cust + x.Sun_cust) as WTD_CUST from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_WTSS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_WTSS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_WTSS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_WTSS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_WTSS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_WTSS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_WTSS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_WTSS)),0) Mon_cust,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_WTSS)),0) Tue_cust,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_WTSS)),0) Wed_cust,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_WTSS)),0) Thu_cust,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_WTSS)),0) Fri_cust,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_WTSS)),0) Sat_cust,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_WTSS)),0) Sun_cust from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) nume_den
on nume_den.dply_seq=lc.dply_seq]]> 
  </AvgBasketSales>
  
  <AvgBasketSalesTotal>
<![CDATA[select lc.loc_nm,
CASE WHEN nume_den.wtd_sls = 0 AND nume_den.wtd_cust = 0 THEN 0
WHEN nume_den.wtd_sls = 0 THEN 0 WHEN nume_den.wtd_cust = 0 THEN 0
ELSE NVL(ROUND((nume_den.wtd_sls / nume_den.wtd_cust),2),0) END as AVG_BASKET_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_cust + x.Tue_cust + x.Wed_cust + x.Thu_cust + x.Fri_cust + x.Sat_cust + x.Sun_cust) as WTD_CUST from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_WTSS)),0) Mon_cust,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_WTSS)),0) Tue_cust,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_WTSS)),0) Wed_cust,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_WTSS)),0) Thu_cust,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_WTSS)),0) Fri_cust,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_WTSS)),0) Sat_cust,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_WTSS)),0) Sun_cust from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (85,90)  
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) nume_den
on nume_den.loc_no=lc.loc_no]]> 
  </AvgBasketSalesTotal>
  
  <WkyMixSales>
<![CDATA[select lc.dept_nm,
CASE WHEN NVL(nume_den.ACTL_SLS_WTSS,0) = 0 AND NVL(nume_den.ACTL_SLS_TOT_WTSS,0) = 0 THEN 0
WHEN nume_den.ACTL_SLS_WTSS = 0 THEN 0 WHEN NVL(nume_den.ACTL_SLS_TOT_WTSS,0) = 0 THEN 0
ELSE ROUND((nume_den.ACTL_SLS_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100,2) END as WKY_MIX_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select nume.dept_nm,nume.ACTL_SLS_WTSS,den.ACTL_SLS_TOT_WTSS from 
(select lc.dept_nm,NVL(sls.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq order by h.dply_seq) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den ) nume_den
on nume_den.dept_nm=lc.dept_nm]]> 
  </WkyMixSales>
  
  <WkyMixSalesTotal>
<![CDATA[select nume_den.loc_nm,
CASE WHEN nume_den.ACTL_SLS_TOT_WTSS = 0 THEN 0 
ELSE ROUND((nume_den.ACTL_SLS_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100,2) END as WKY_MIX_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) nume_den]]> 
  </WkyMixSalesTotal>
  
</TCName>
  
<TCName name="ItemsColumnValidation">  
  
  <PlannedItems>
<![CDATA[select lc.dept_nm,NVL(ROUND(itm.PLN_ITM_WTSS,0),0) as PLN_ITM_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.PLN_ITM_DTS) as PLN_ITM_WTSS from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.dply_seq,e.loc_no,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.loc_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.dply_seq order by h.dply_seq) itm
on lc.dply_seq=itm.dply_seq]]> 
  </PlannedItems>
  
  <PlannedItemsTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(itm.PLN_ITM_TOT_WTSS,0),0) as PLN_ITM_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no]]> 
  </PlannedItemsTotal>
  
  <ActualItems>
<![CDATA[select lc.dept_nm,NVL(ROUND(itm.ACTL_ITM_WTSS,0),0) as ACTL_ITM_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_ITM_DTS) as ACTL_ITM_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq order by h.dply_seq) itm
on lc.dply_seq=itm.dply_seq order by lc.dply_seq]]> 
  </ActualItems>
  
  <ActualItemsTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(itm.ACTL_ITM_TOT_WTSS,0),0) as ACTL_ITM_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_no]]> 
  </ActualItemsTotal>

  <PlannedItemPrice>
<![CDATA[select lc.dept_nm,
case when NVL(sls_itm.PLN_SLS_WTSS,0)=0 and NVL(sls_itm.PLN_ITM_WTSS,0)=0 then 0
when NVL(sls_itm.PLN_SLS_WTSS,0)=0 then 0 when NVL(sls_itm.PLN_ITM_WTSS,0)=0 then 0 
else NVL(ROUND((sls_itm.PLN_SLS_WTSS / sls_itm.PLN_ITM_WTSS),2),0) end as PLN_ITMPRZ_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSS,sum(h.PLN_ITM_DTS) as PLN_ITM_WTSS from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.dply_seq,e.loc_no,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.loc_no,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.dply_seq order by h.dply_seq) sls_itm
on lc.dply_seq=sls_itm.dply_seq]]> 
  </PlannedItemPrice>
  
  <PlannedItemPriceTotal>
<![CDATA[select lc.loc_nm,
case when NVL(sls_itm.PLN_SLS_TOT_WTSS,0)=0 and NVL(sls_itm.PLN_ITM_TOT_WTSS,0)=0 then 0
when NVL(sls_itm.PLN_SLS_TOT_WTSS,0)=0 then 0 when NVL(sls_itm.PLN_ITM_TOT_WTSS,0)=0 then 0 
else NVL(ROUND((sls_itm.PLN_SLS_TOT_WTSS / sls_itm.PLN_ITM_TOT_WTSS),2),0) end as PLN_ITMPRZ_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_WTSS,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.loc_no order by h.loc_no) sls_itm
on lc.loc_no=sls_itm.loc_no]]> 
  </PlannedItemPriceTotal>
  
  <ActualItemPrice>
<![CDATA[select lc.dept_nm,
CASE WHEN NVL(sls_itm.ACTL_SLS_WTSS,0)=0 and NVL(sls_itm.ACTL_ITM_WTSS,0)=0 then 0
WHEN NVL(sls_itm.ACTL_SLS_WTSS,0)=0 then 0 WHEN NVL(sls_itm.ACTL_ITM_WTSS,0)=0 then 0
ELSE NVL(ROUND((sls_itm.ACTL_SLS_WTSS / sls_itm.ACTL_ITM_WTSS),2),0) END as ACTL_ITMPRZ_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS,sum(h.ACTL_ITM_DTS) as ACTL_ITM_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 --and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq order by h.dply_seq) sls_itm
on lc.dply_seq=sls_itm.dply_seq order by lc.dply_seq]]> 
  </ActualItemPrice>
  
  <ActualItemPriceTotal>
<![CDATA[select lc.loc_nm,
CASE WHEN NVL(sls_itm.ACTL_SLS_TOT_WTSS,0)=0 and NVL(sls_itm.ACTL_ITM_TOT_WTSS,0)=0 then 0
WHEN NVL(sls_itm.ACTL_SLS_TOT_WTSS,0)=0 then 0 WHEN NVL(sls_itm.ACTL_ITM_TOT_WTSS,0)=0 then 0
ELSE NVL(ROUND((sls_itm.ACTL_SLS_TOT_WTSS / sls_itm.ACTL_ITM_TOT_WTSS),2),0) END as ACTL_ITMPRZ_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0 --and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no order by h.loc_no) sls_itm
on lc.loc_no=sls_itm.loc_no order by lc.loc_no]]> 
  </ActualItemPriceTotal>
  
</TCName>  
  
<TCName name="CustomersColumnValidation">  
  
  <ThisYrActlCustomers>
<![CDATA[select lc.dept_nm,NVL(ROUND(itm.ACTL_CUST_WTSS,0),0) as ACTL_CUST_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq order by h.dply_seq) itm
on lc.dply_seq=itm.dply_seq order by lc.dply_seq]]> 
  </ThisYrActlCustomers>
  
  <ThisYrActlCustomersTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(itm.ACTL_CUST_TOT_WTSS,0),0) as ACTL_CUST_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_no]]> 
  </ThisYrActlCustomersTotal>
  
  <PctLastYrCustomers>
<![CDATA[select lc.dept_nm,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0     
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select cy_val.dept_nm,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.dept_nm,NVL(sls.ACTL_CUST_WTSS,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq order by h.dply_seq) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) cy_val
LEFT OUTER JOIN
(select lc.dept_nm,NVL(sls.ACTL_CUST_WTSS,0) as WTD from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq order by h.dply_seq) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) ly_val
on cy_val.dept_nm=ly_val.dept_nm 
group by cy_val.dept_nm ) cyly_wtd
on cyly_wtd.dept_nm=lc.dept_nm]]> 
  </PctLastYrCustomers>
  
  <PctLastYrCustomersTotal>
<![CDATA[select lc.loc_nm,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as ACTL_LY_PCT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select cy_val.loc_nm,sum(cy_val.WTD) as cy_wtd,sum(ly_val.WTD) as ly_wtd from 
(select lc.loc_nm,NVL(sls.ACTL_CUST_WTSS,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) cy_val
LEFT OUTER JOIN
(select lc.loc_nm,NVL(sls.ACTL_CUST_WTSS,0) as WTD from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) ly_val
on cy_val.loc_nm=ly_val.loc_nm 
group by cy_val.loc_nm ) cyly_wtd
on cyly_wtd.loc_nm=lc.loc_nm]]> 
  </PctLastYrCustomersTotal>
  
  <DataPenetrationCustomers>
<![CDATA[select nume_den.dept_nm,
CASE When nume_den.ACTL_CUST_WTSS=0 and nume_den.ACTL_CUST_TOT_WTSS=0 Then 0
When nume_den.ACTL_CUST_WTSS=0 Then 0 when nume_den.ACTL_CUST_TOT_WTSS=0 Then 0
ELSE ROUND((nume_den.ACTL_CUST_WTSS / nume_den.ACTL_CUST_TOT_WTSS)*100,2) END as DATA_PEN_CUST_WTSS from 
(select nume.dept_nm,NVL(nume.ACTL_CUST_WTSS,0) as ACTL_CUST_WTSS,NVL(den.ACTL_CUST_TOT_WTSS,0) as ACTL_CUST_TOT_WTSS from 
(select lc.dply_seq,lc.dept_nm,itm.ACTL_CUST_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_CUST_DTS) as ACTL_CUST_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq order by h.dply_seq) itm
on lc.dply_seq=itm.dply_seq order by lc.dply_seq) nume,
(select lc.loc_nm,itm.ACTL_CUST_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_no) den order by nume.dply_seq) nume_den]]> 
  </DataPenetrationCustomers>
  
  <DataPenetrationCustomersTotal>
<![CDATA[select nume_den.loc_nm,
CASE When nume_den.ACTL_CUST_TOT_WTSS=0 Then 0 
ELSE ROUND((nume_den.ACTL_CUST_TOT_WTSS / nume_den.ACTL_CUST_TOT_WTSS)*100,2) END as DATA_PEN_CUST_TOT_WTSS from 
(select lc.loc_nm,NVL(itm.ACTL_CUST_TOT_WTSS,0) as ACTL_CUST_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_cust_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no IN (85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no order by h.loc_no) itm
on lc.loc_no=itm.loc_no order by lc.loc_no) nume_den]]> 
  </DataPenetrationCustomersTotal>
  
</TCName>  
  
<TCName name="HoursColumnValidation">  
  
  <ActualHours>
<![CDATA[select lc.dept_nm,NVL(ROUND(hrs.ACTL_HRS_DTS,2),0) as ACTL_HRS_WTSS from 
(select distinct dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq]]> 
  </ActualHours>
  
  <ActualHoursTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(hrs.ACTL_HRS_DTS,2),0) as ACTL_HRS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no]]> 
  </ActualHoursTotal>
  
  <CurrentActualHours>
<![CDATA[select z.dept_nm,NVL(ROUND(y.ACTL_HOURS_WTSS,2),0) as ACTL_HRS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.dply_seq order by e.dply_seq) y
on z.dply_seq=y.dply_seq order by z.dply_seq]]> 
  </CurrentActualHours>
  
  <CurrentActualHoursTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(y.ACTL_HOURS_TOT_WTSS,2),0) as ACTL_HRS_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on lc.loc_no=y.loc_no order by lc.loc_no]]> 
  </CurrentActualHoursTotal>
  
  <PlannedHours>
<![CDATA[select z.dept_nm,NVL(ROUND(y.PLN_HOURS_WTSS,2),0) as PLN_HRS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq,e.dept_nm 
order by e.dply_seq) y
on z.dept_nm=y.dept_nm order by z.dply_seq]]> 
  </PlannedHours>
  
  <PlannedHoursTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(sum(hrs.PLN_HOURS_TOT_WTSS),2),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm]]> 
  </PlannedHoursTotal>
  
  <CurrentPlannedHours>
<![CDATA[select z.dept_nm,NVL(ROUND(y.PLN_HOURS_WTSS,2),0) as PLN_HRS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq,e.dept_nm 
order by e.dply_seq) y
on z.dept_nm=y.dept_nm order by z.dply_seq]]> 
  </CurrentPlannedHours>
  
  <CurrentPlannedHoursTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(sum(hrs.PLN_HOURS_TOT_WTSS),2),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm]]> 
  </CurrentPlannedHoursTotal>
  
  <VarHours>
<![CDATA[select pln.dept_nm,ROUND((actl.ACTL_HRS_WTSS - pln.PLN_HRS_WTSS),2) as VAR_HRS_WTSS from 
(select z.dept_nm,NVL(y.PLN_HOURS_WTSS,0) as PLN_HRS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq,e.dept_nm 
order by e.dply_seq) y
on z.dept_nm=y.dept_nm order by z.dply_seq) pln,
(select lc.dept_nm,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_WTSS from 
(select distinct dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq) actl
where pln.dept_nm=actl.dept_nm]]> 
  </VarHours>
  
  <VarHoursTotal>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_HRS_TOT_WTSS - pln.PLN_HRS_TOT_WTSS),2) as VAR_HRS_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(hrs.PLN_HOURS_TOT_WTSS),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm) pln,
(select lc.loc_nm,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) actl
where pln.loc_nm=actl.loc_nm]]> 
  </VarHoursTotal>
  
  <CurrentVarHours>
<![CDATA[select pln.dept_nm,ROUND((actl.ACTL_HRS_WTSS - pln.PLN_HRS_WTSS),2) as VAR_HRS_WTSS from 
(select z.dept_nm,NVL(y.PLN_HOURS_WTSS,0) as PLN_HRS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq,e.dept_nm 
order by e.dply_seq) y
on z.dept_nm=y.dept_nm order by z.dply_seq) pln,
(select z.dept_nm,NVL(y.ACTL_HOURS_WTSS,0) as ACTL_HRS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.dply_seq order by e.dply_seq) y
on z.dply_seq=y.dply_seq order by z.dply_seq) actl
where pln.dept_nm=actl.dept_nm]]> 
  </CurrentVarHours>
  
  <CurrentVarHoursTotal>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_HRS_TOT_WTSS - pln.PLN_HRS_TOT_WTSS),2) as VAR_HRS_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(hrs.PLN_HOURS_TOT_WTSS),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm) pln,
(select lc.loc_nm,NVL(sum(hrs.PLN_HOURS_TOT_WTSS),0) as PLN_HRS_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) hrs
on hrs.loc_nm=lc.loc_nm group by lc.loc_nm) actl
where pln.loc_nm=actl.loc_nm]]> 
  </CurrentVarHoursTotal>
  
  <VarianceSMS>
<![CDATA[select actl_hrs.dept_nm,NVL(ROUND((actl_hrs.ACTL_HRS_WTSS - actl_sms.ACTL_SMS_WTSS),2),0) as VAR_SMS_WTSS from 
(select lc.dept_nm,NVL(ROUND(hrs.ACTL_HRS_DTS,2),0) as ACTL_HRS_WTSS from 
(select distinct dept_no,dply_seq,dept_nm from dept where div_no='Division' 
and dept_no IN (select dept_no from loc_dept where dept_no NOT IN (20) and loc_no='store') 
and dply_seq is not null order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq) actl_hrs,
(select lc.dept_nm,NVL(ROUND(xy.WK_TO_DT_TOT,2),0) as ACTL_SMS_WTSS from 
(select distinct dept_no,dply_seq,dept_nm from dept where div_no='Division' 
and dept_no IN (select dept_no from loc_dept where dept_no NOT IN (20) and loc_no='store') 
and dply_seq is not null order by dply_seq) lc
LEFT OUTER JOIN
(select  dept_nm,Sum(plan_sms_hrs) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
NVL(ds.actl_itm_cnt,0) as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by dept_nm) xy
on lc.dept_nm=xy.dept_nm order by lc.dply_seq) actl_sms
where actl_hrs.dept_nm=actl_sms.dept_nm]]>
		</VarianceSMS>

		<VarianceSMSTotal>
<![CDATA[select actl_hrs.loc_nm,NVL(ROUND((actl_hrs.ACTL_HRS_TOT_WTSS - actl_sms.ACTL_SMS_TOT_WTSS),2),0) as VAR_SMS_TOT_WTSS from 
(select lc.loc_nm,NVL(ROUND(hrs.ACTL_HRS_DTS,2),0) as ACTL_HRS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) actl_hrs,
(select lc.loc_nm,NVL(ROUND(xy.WK_TO_DT_TOT,2),0) as ACTL_SMS_TOT_WTSS from 
(select distinct loc_no,loc_nm from loc where div_no='Division' and loc_no='store') lc
LEFT OUTER JOIN
(select  loc_no,Sum(plan_sms_hrs) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no) xy
on lc.loc_no=xy.loc_no) actl_sms]]>
  </VarianceSMSTotal>
  
  <ActualSMS>
	<![CDATA[select lc.dept_nm,NVL(ROUND(xy.WK_TO_DT_TOT,2),0) as ACTL_SMS_WTSS from 
(select distinct dept_no,dply_seq,dept_nm from dept where div_no='Division' 
and dept_no IN (select dept_no from loc_dept where dept_no NOT IN (20) and loc_no='store') 
and dply_seq is not null order by dply_seq) lc
LEFT OUTER JOIN
(select  dept_nm,Sum(plan_sms_hrs) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
NVL(ds.actl_itm_cnt,0) as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by dept_nm) xy
on lc.dept_nm=xy.dept_nm order by lc.dply_seq]]>
		</ActualSMS>

		<ActualSMSTotal>
	<![CDATA[select lc.loc_nm,NVL(ROUND(xy.WK_TO_DT_TOT,2),0) as ACTL_SMS_TOT_WTSS from 
(select distinct loc_no,loc_nm from loc where div_no='Division' and loc_no='store') lc
LEFT OUTER JOIN
(select  loc_no,Sum(plan_sms_hrs) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no) xy
on lc.loc_no=xy.loc_no]]>
		</ActualSMSTotal>

		<ORPercentage>
	<![CDATA[select actl_sms.dept_nm,
case when NVL(actl_sms.ACTL_SMS_WTSS,0)=0 and NVL(actl_hrs.ACTL_HRS_WTSS,0)=0 then 0 
when NVL(actl_sms.ACTL_SMS_WTSS,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_WTSS,0)=0 then 0 
else NVL(ROUND((actl_sms.ACTL_SMS_WTSS / actl_hrs.ACTL_HRS_WTSS)*100,2),0) end as WTD from  
(select lc.dept_nm,NVL(xy.WK_TO_DT_TOT,0) as ACTL_SMS_WTSS from 
(select distinct dept_no,dply_seq,dept_nm from dept where div_no='Division' 
and dept_no IN (select dept_no from loc_dept where dept_no NOT IN (20) and loc_no='store') 
and dply_seq is not null order by dply_seq) lc
LEFT OUTER JOIN
(select  dept_nm,Sum(plan_sms_hrs) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
NVL(ds.actl_itm_cnt,0) as actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by dept_nm) xy
on lc.dept_nm=xy.dept_nm order by lc.dply_seq)actl_sms
LEFT OUTER JOIN
(select lc.dept_nm,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_WTSS from 
(select distinct dept_no,dply_seq,dept_nm from dept where div_no='Division' 
and dept_no IN (select dept_no from loc_dept where dept_no NOT IN (20) and loc_no='store') 
and dply_seq is not null order by dply_seq) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq)actl_hrs
on actl_sms.dept_nm=actl_hrs.dept_nm]]>
		</ORPercentage>

		<ORPercentageTotal>
	<![CDATA[select actl_sms.loc_nm,
	case when NVL(actl_sms.ACTL_SMS_TOT_WTSS,0)=0 and NVL(actl_hrs.ACTL_HRS_TOT_WTSS,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_TOT_WTSS,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_TOT_WTSS,0)=0 then 0 
	else NVL(ROUND((actl_sms.ACTL_SMS_TOT_WTSS / actl_hrs.ACTL_HRS_TOT_WTSS)*100,2),0) end as ACTL_OR_TOT_WTSS from
(select lc.loc_nm,NVL(xy.WK_TO_DT_TOT,0) as ACTL_SMS_TOT_WTSS from 
(select distinct loc_no,loc_nm from loc where div_no='Division' and loc_no='store') lc
LEFT OUTER JOIN
(select  loc_no,Sum(plan_sms_hrs) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no='store' --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by loc_no) xy
on lc.loc_no=xy.loc_no)actl_sms,
(select lc.loc_nm,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no)actl_hrs
where actl_sms.loc_nm=actl_hrs.loc_nm order by actl_sms.loc_nm]]>
		</ORPercentageTotal>
</TCName>

<TCName name = "WagesColumnValidation" >

  <ActualWages>
<![CDATA[select lc.dept_nm,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_WTSS from 
(select distinct dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq]]> 
  </ActualWages>
  
  <ActualWagesTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no]]> 
  </ActualWagesTotal>
  
  <CurrentActualWages>
<![CDATA[select z.dept_nm,NVL(ROUND(y.ACTL_WAGE_WTSS,0),0) as ACTL_WGE_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.dply_seq order by e.dply_seq) y
on z.dply_seq=y.dply_seq order by z.dply_seq]]> 
  </CurrentActualWages>
  
  <CurrentActualWagesTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(y.ACTL_WAGE_TOT_WTSS,0),0) as ACTL_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on lc.loc_no=y.loc_no order by lc.loc_no]]> 
  </CurrentActualWagesTotal>
  
  <ActualWagePercentage>
<![CDATA[select nume_den.dept_nm,
CASE When nume_den.ACTL_WGE_WTSS=0 and nume_den.ACTL_SLS_WTSS=0 Then 0
When nume_den.ACTL_WGE_WTSS=0 Then 0 when nume_den.ACTL_SLS_WTSS=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_WTSS / nume_den.ACTL_SLS_WTSS)*100,2) END as ACTL_WGE_PCT_WTSS from 
(select nume.dept_nm,NVL(nume.ACTL_WGE_WTSS,0) as ACTL_WGE_WTSS,NVL(den.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select lc.dept_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_WTSS from 
(select distinct dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq) nume,
(select lc.dept_nm,NVL(sls.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq order by h.dply_seq) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) den 
where nume.dept_nm=den.dept_nm) nume_den]]> 
  </ActualWagePercentage>
  
  <ActualWagePercentageTotal>
<![CDATA[select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_TOT_WTSS=0 and nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
When nume_den.ACTL_WGE_TOT_WTSS=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100,2) END as ACTL_WGE_PCT_TOT_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS,NVL(den.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den]]> 
  </ActualWagePercentageTotal>
  
  <CurrentActualWagePercentage>
<![CDATA[select nume_den.dept_nm,
CASE When nume_den.ACTL_WGE_WTSS=0 and nume_den.ACTL_SLS_WTSS=0 Then 0
When nume_den.ACTL_WGE_WTSS=0 Then 0 when nume_den.ACTL_SLS_WTSS=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_WTSS / nume_den.ACTL_SLS_WTSS)*100,2) END as ACTL_WGE_PCT_WTSS from 
(select nume.dept_nm,NVL(nume.ACTL_WGE_WTSS,0) as ACTL_WGE_WTSS,NVL(den.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select z.dept_nm,NVL(y.ACTL_WAGE_WTSS,0) as ACTL_WGE_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.dply_seq order by e.dply_seq) y
on z.dply_seq=y.dply_seq order by z.dply_seq) nume,
(select lc.dept_nm,NVL(sls.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq order by h.dply_seq) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) den 
where nume.dept_nm=den.dept_nm) nume_den]]> 
  </CurrentActualWagePercentage>
  
  <CurrentActualWagePercentageTotal>
<![CDATA[select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_TOT_WTSS=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
ELSE ROUND((nume_den.ACTL_WGE_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100,2) END as ACTL_WGE_PCT_TOT_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS,NVL(den.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(y.ACTL_WAGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_TOT_WTSS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where a.loc_no='store' and dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.loc_no order by e.loc_no) y
on lc.loc_no=y.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den]]> 
  </CurrentActualWagePercentageTotal>
  
  <BudgetWages>
<![CDATA[select lc.dept_nm,NVL(ROUND(bdgt.BDGT_WAGE_WTSS,0),0) as BDGT_WGE_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.bdgt_wage_amt) as BDGT_WAGE_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.dply_seq order by e.dply_seq) bdgt
on lc.dply_seq=bdgt.dply_seq order by lc.dply_seq]]> 
  </BudgetWages>
  
  <BudgetWagesTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(bdgt.BDGT_WAGE_TOT_WTSS,0),0) as BDGT_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.bdgt_wage_amt) as BDGT_WAGE_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) bdgt
on lc.loc_no=bdgt.loc_no order by lc.loc_no]]> 
  </BudgetWagesTotal>
  
  <ForecastWages>
<![CDATA[select lc.dept_nm,NVL(ROUND(fcst.FCST_WAGE_WTSS,0),0) as FCST_WGE_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.frcst_wage_amt) as FCST_WAGE_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.dply_seq order by e.dply_seq) fcst
on lc.dply_seq=fcst.dply_seq order by lc.dply_seq]]> 
  </ForecastWages>
  
  <ForecastWagesTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(fcst.FCST_WAGE_TOT_WTSS,0),0) as FCST_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.frcst_wage_amt) as FCST_WAGE_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.loc_no order by e.loc_no) fcst
on lc.loc_no=fcst.loc_no order by lc.loc_no]]> 
  </ForecastWagesTotal>
  
  <BudgetWagePercentage>
<![CDATA[select dpt.dept_nm,
CASE When NVL(bdgt.bdgt_wage_amt,0)=0 Then 0 When NVL(bdgt.bdgt_sls,0)=0 Then 0
ELSE NVL(ROUND((bdgt.bdgt_wage_amt / bdgt.bdgt_sls)*100,2),0) END as BDGT_WGE_PCT_WTSS from 
(select dply_seq,dept_nm from dept where dept_no NOT IN (20) and div_no='Division' and dply_seq is NOT NULL) dpt
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on dpt.dply_seq=bdgt.dply_seq and dpt.dept_nm=bdgt.dept_nm
order by dpt.dply_seq]]> 
  </BudgetWagePercentage>
  
  <BudgetWagePercentageTotal>
<![CDATA[select wge.loc_nm,
CASE When wge.BDGT_WGE_TOT_WTSS=0 Then 0 When sls.BDGT_SLS_TOT_WTSS=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_WTSS / sls.BDGT_SLS_TOT_WTSS)*100,2),0) END as BDGT_WGE_PCT_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm]]> 
  </BudgetWagePercentageTotal>
  
  <ForecastWagePercentage>
<![CDATA[select dpt.dept_nm,
CASE When NVL(fcst.frcst_wage_amt,0)=0 Then 0 When NVL(fcst.frcst_sls,0)=0 Then 0
ELSE NVL(ROUND((fcst.frcst_wage_amt / fcst.frcst_sls)*100,2),0) END as FCST_WGE_PCT_WTSS from 
(select dply_seq,dept_nm from dept where dept_no NOT IN (20) and div_no='Division' and dply_seq is NOT NULL) dpt
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on dpt.dply_seq=fcst.dply_seq and dpt.dept_nm=fcst.dept_nm
order by dpt.dply_seq]]> 
  </ForecastWagePercentage>
  
  <ForecastWagePercentageTotal>
<![CDATA[select wge.loc_nm,
CASE When wge.FCST_WGE_TOT_WTSS=0 Then 0 When sls.FCST_SLS_TOT_WTSS=0 Then 0
ELSE NVL(ROUND((wge.FCST_WGE_TOT_WTSS / sls.FCST_SLS_TOT_WTSS)*100,2),0) END as FCST_WGE_PCT_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm]]> 
  </ForecastWagePercentageTotal>
  
  <PlannedWages>
<![CDATA[select z.dept_nm,NVL(ROUND(y.PLN_WAGE_WTSS,0),0) as PLN_WGE_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq,e.dept_nm 
order by e.dply_seq) y
on z.dept_nm=y.dept_nm order by z.dply_seq]]> 
  </PlannedWages>
  
  <PlannedWagesTotal>
<![CDATA[select lc.loc_nm,NVL(ROUND(sum(wge.PLN_WAGE_WTSS),0),0) as PLN_WGE_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm]]> 
  </PlannedWagesTotal>
  
  <PlannedWagesPercentage>
<![CDATA[select wge.dept_nm,
CASE When wge.PLN_WGE_WTSS=0 AND sls.PLN_SLS_WTSS=0 Then 0 
When wge.PLN_WGE_WTSS=0 Then 0 When sls.PLN_SLS_WTSS=0 Then 0 
ELSE NVL(ROUND((wge.PLN_WGE_WTSS / sls.PLN_SLS_WTSS)*100,2),0) END as PLN_WGE_PRCNT_WTSS from
(select z.dept_nm,NVL(y.PLN_WAGE_WTSS,0) as PLN_WGE_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select e.dply_seq,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) y
on z.dply_seq=y.dply_seq order by z.dply_seq) wge,
(select z.dept_nm,NVL(y.PLN_SLS_WTSS,0) as PLN_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) z
LEFT OUTER JOIN
(select h.dply_seq,sum(h.PLN_SLS_WTSS) as PLN_SLS_WTSS from 
(/*select * from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_WTSS,sum(e.refcst_itm_cnt) as PLN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_WTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_WTSS,sum(e.gnrt_itm) as GEN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
/*and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) g*/) sec_prty) h 
group by h.dply_seq order by h.dply_seq) y
on z.dply_seq=y.dply_seq order by z.dply_seq) sls
where wge.dept_nm=sls.dept_nm]]> 
  </PlannedWagesPercentage>
  
  <PlannedWagesPercentageTotal>
<![CDATA[select wge.loc_nm,
CASE WHEN NVL(wge.PLN_WGE_TOT_WTSS,0)=0 and NVL(sls.PLN_SLS_TOT_WTSS,0)=0 then 0
WHEN NVL(wge.PLN_WGE_TOT_WTSS,0)=0 then 0 WHEN NVL(sls.PLN_SLS_TOT_WTSS,0)=0 then 0
ELSE NVL(ROUND((wge.PLN_WGE_TOT_WTSS / sls.PLN_SLS_TOT_WTSS)*100,2),0) END as PLN_WGE_PRCNT_TOT_WTSS from
(select lc.loc_nm,sum(wge.PLN_WAGE_WTSS) as PLN_WGE_TOT_WTSS from 
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_nm,e.dply_seq,e.dept_nm 
order by e.loc_nm,e.dply_seq) wge
on wge.loc_nm=lc.loc_nm group by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sls.wtd,0) as PLN_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as STR_TOT from loc where loc_no='store') lc
LEFT OUTER JOIN
(select z.loc_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_WTSS) as PLN_SLS_WTSS from 
(/*select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_WTSS,sum(e.refcst_itm_cnt) as PLN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_WTSS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
/*and (a.dept_no,a.mgr_pln_sls_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_WTSS,sum(e.gnrt_itm) as GEN_ITM_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,mgr_pln_sls_dte from mgr_dly_pln a, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
/*and (a.dept_no,a.fcst_dte) NOT IN (select dept_no,pln_dte from mgr_dly_refcst a, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.loc_no,e.dply_seq,e.day_of_wk) g*/) sec_prty) h group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no) sls
where wge.loc_nm=sls.loc_nm]]> 
  </PlannedWagesPercentageTotal>
 
  <AllowedWages>
<![CDATA[select src.dept_nm,
case 
when src.ACTL_SLS_WTSS > src.BDGT_SLS_WTSS 
	then NVL(ROUND((((BDGT_WGE_PCT_WTSS * BDGT_SLS_WTSS) + ((ACTL_SLS_WTSS - BDGT_SLS_WTSS) * (PST_FACTOR_WTSS * BDGT_WGE_PCT_WTSS)))/100),0),0)
When src.ACTL_SLS_WTSS < src.BDGT_SLS_WTSS 
	then NVL(ROUND((((BDGT_WGE_PCT_WTSS * BDGT_SLS_WTSS) + ((ACTL_SLS_WTSS - BDGT_SLS_WTSS) * (NGT_FACTOR_WTSS * BDGT_WGE_PCT_WTSS)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_WTSS * ACTL_SLS_WTSS)/100),0),0) end as ALWD_WGE_WTSS from 

(select actl_sls.dept_nm,rte_fct.wk_id,actl_sls.ACTL_SLS_WTSS,rte_fct.PST_FACTOR_WTSS,rte_fct.NGT_FACTOR_WTSS,
bdgt_wge_pct.BDGT_WGE_PCT_WTSS,bdgt_wge_pct.BDGT_WGE_WTSS,bdgt_wge_pct.BDGT_SLS_WTSS from

(select lc.dept_nm,NVL(ROUND(sls.wtd,0),0) as ACTL_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select z.dply_seq,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.dply_seq,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_WTSS)),0) Sun from 
(select h.dply_seq,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f) h 
group by h.dply_seq,h.day_of_wk order by h.dply_seq,h.day_of_wk) b
group by b.dply_seq order by b.dply_seq) x ) z) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_WTSS,NVL(src.ngt_factor,1) as NGT_FACTOR_WTSS from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select dpt.dept_nm,NVL(ROUND(bdgt.bdgt_wage_amt,0),0) as BDGT_WGE_WTSS, NVL(ROUND(bdgt.bdgt_sls,0),0) as BDGT_SLS_WTSS,
CASE When NVL(bdgt.bdgt_wage_amt,0)=0 and NVL(bdgt.bdgt_sls,0)=0 Then 0
When NVL(bdgt.bdgt_wage_amt,0)=0 Then 0 When NVL(bdgt.bdgt_sls,0)=0 Then 0
ELSE NVL(ROUND((bdgt.bdgt_wage_amt / bdgt.bdgt_sls)*100,5),0) END as BDGT_WGE_PCT_WTSS from 
(select dply_seq,dept_nm from dept where dept_no NOT IN (20) and div_no='Division' and dply_seq is NOT NULL) dpt
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on dpt.dply_seq=bdgt.dply_seq and dpt.dept_nm=bdgt.dept_nm
order by dpt.dply_seq) bdgt_wge_pct

where actl_sls.dept_nm=bdgt_wge_pct.dept_nm) src]]> 
  </AllowedWages>
  
  <AllowedWagesTotal>
<![CDATA[select src.loc_nm,
case 
when src.ACTL_SLS_TOT_WTSS > src.BDGT_SLS_TOT_WTSS 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_WTSS * BDGT_SLS_TOT_WTSS) + ((ACTL_SLS_TOT_WTSS - BDGT_SLS_TOT_WTSS) * (PST_FACTOR_TOT_WTSS * BDGT_WGE_PCT_TOT_WTSS)))/100),0),0)
When src.ACTL_SLS_TOT_WTSS < src.BDGT_SLS_TOT_WTSS 
	then NVL(ROUND((((BDGT_WGE_PCT_TOT_WTSS * BDGT_SLS_TOT_WTSS) + ((ACTL_SLS_TOT_WTSS - BDGT_SLS_TOT_WTSS) * (NGT_FACTOR_TOT_WTSS * BDGT_WGE_PCT_TOT_WTSS)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_TOT_WTSS * ACTL_SLS_TOT_WTSS)/100),0),0) end as ALWD_WGE_TOT_WTSS from 

(select actl_sls.loc_nm,rte_fct.wk_id,actl_sls.ACTL_SLS_TOT_WTSS,rte_fct.PST_FACTOR_TOT_WTSS,rte_fct.NGT_FACTOR_TOT_WTSS,
bdgt_wge_pct.BDGT_WGE_PCT_TOT_WTSS,bdgt_wge_pct.BDGT_WGE_TOT_WTSS,bdgt_wge_pct.BDGT_SLS_TOT_WTSS from

(select lc.loc_nm,NVL(ROUND(sls.wtd,0),0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select z.loc_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.loc_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_WTSS)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_WTSS)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_WTSS)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_WTSS)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_WTSS)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_WTSS)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_WTSS)),0) Sun from 
(select h.loc_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f) h 
group by h.loc_no,h.day_of_wk order by h.loc_no,h.day_of_wk) b
group by b.loc_no order by b.loc_no) x ) z) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_TOT_WTSS,NVL(src.ngt_factor,1) as NGT_FACTOR_TOT_WTSS from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select wge.loc_nm,NVL(ROUND(wge.BDGT_WGE_TOT_WTSS,0),0) as BDGT_WGE_TOT_WTSS, NVL(ROUND(sls.BDGT_SLS_TOT_WTSS,0),0) as BDGT_SLS_TOT_WTSS,
CASE When NVL(wge.BDGT_WGE_TOT_WTSS,0)=0 and NVL(sls.BDGT_SLS_TOT_WTSS,0)=0 Then 0
When NVL(wge.BDGT_WGE_TOT_WTSS,0)=0 Then 0 When NVL(sls.BDGT_SLS_TOT_WTSS,0)=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_WTSS / sls.BDGT_SLS_TOT_WTSS)*100,5),0) END as BDGT_WGE_PCT_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) bdgt_wge_pct

where actl_sls.loc_nm=bdgt_wge_pct.loc_nm order by actl_sls.loc_nm,rte_fct.wk_id) src
order by src.loc_nm ]]> 
  </AllowedWagesTotal>
 
  <PlannedCPH>
<![CDATA[select lc.dept_nm,
CASE When NVL(wge.PLN_WAGE_WTSS,0)=0 AND NVL(wge.PLN_HOURS_WTSS,0)=0 Then 0 
When NVL(wge.PLN_WAGE_WTSS,0)=0 Then 0 When NVL(wge.PLN_HOURS_WTSS,0)=0 Then 0 
ELSE NVL(ROUND((wge.PLN_WAGE_WTSS / wge.PLN_HOURS_WTSS),2),0) END as PLN_CPH_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq,e.dept_nm 
order by e.dply_seq) wge
on lc.dept_nm=wge.dept_nm order by lc.dply_seq]]> 
  </PlannedCPH>
  
  <PlannedCPHTotal>
<![CDATA[select lc.loc_nm,
CASE When NVL(wge.PLN_WAGE_TOT_WTSS,0)=0 AND NVL(wge.PLN_HOURS_TOT_WTSS,0)=0 Then 0 
When NVL(wge.PLN_WAGE_TOT_WTSS,0)=0 Then 0 When NVL(wge.PLN_HOURS_TOT_WTSS,0)=0 Then 0 
ELSE NVL(ROUND((wge.PLN_WAGE_TOT_WTSS / wge.PLN_HOURS_TOT_WTSS),2),0) END as PLN_CPH_TOT_WTSS from
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_no]]> 
  </PlannedCPHTotal>
  
  <ActualCPH>
<![CDATA[select lc.dept_nm,
CASE When NVL(wge.ACTL_WAGE_WTSS,0)=0 AND NVL(wge.ACTL_HOURS_WTSS,0)=0 Then 0 
When NVL(wge.ACTL_WAGE_WTSS,0)=0 Then 0 When NVL(wge.ACTL_HOURS_WTSS,0)=0 Then 0 
ELSE NVL(ROUND((wge.ACTL_WAGE_WTSS / wge.ACTL_HOURS_WTSS),2),0) END as ACTL_CPH_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WAGE_WTSS,sum(e.actl_hrs) as ACTL_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) wge
on wge.dply_seq=lc.dply_seq order by lc.dply_seq]]> 
  </ActualCPH>
  
  <ActualCPHTotal>
<![CDATA[select lc.loc_nm,
CASE When NVL(wge.ACTL_WAGE_TOT_WTSS,0)=0 AND NVL(wge.ACTL_HOURS_TOT_WTSS,0)=0 Then 0 
When NVL(wge.ACTL_WAGE_TOT_WTSS,0)=0 Then 0 When NVL(wge.ACTL_HOURS_TOT_WTSS,0)=0 Then 0 
ELSE NVL(ROUND((wge.ACTL_WAGE_TOT_WTSS / wge.ACTL_HOURS_TOT_WTSS),2),0) END as ACTL_CPH_TOT_WTSS from
(select b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WAGE_TOT_WTSS,sum(e.actl_hrs) as ACTL_HOURS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) wge
on wge.loc_no=lc.loc_no order by lc.loc_no]]> 
  </ActualCPHTotal>
  
  <VarWages>
<![CDATA[select pln.dept_nm,ROUND((actl.ACTL_WGE_PCT_WTSS - pln.BDGT_WGE_PCT_WTSS),2) as VAR_WGE_WTSS from 
(select nume_den.dept_nm,
CASE When nume_den.ACTL_WGE_WTSS=0 AND nume_den.ACTL_SLS_WTSS=0 Then 0
When nume_den.ACTL_WGE_WTSS=0 Then 0 when nume_den.ACTL_SLS_WTSS=0 Then 0
ELSE ((nume_den.ACTL_WGE_WTSS / nume_den.ACTL_SLS_WTSS)*100) END as ACTL_WGE_PCT_WTSS from 
(select nume.dept_nm,NVL(nume.ACTL_WGE_WTSS,0) as ACTL_WGE_WTSS,NVL(den.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select lc.dept_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_WTSS from 
(select distinct dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq) nume,
(select lc.dept_nm,NVL(sls.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq order by h.dply_seq) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) den 
where nume.dept_nm=den.dept_nm) nume_den) actl,
(select dpt.dept_nm,
CASE When NVL(bdgt.bdgt_wage_amt,0)=0 AND NVL(bdgt.bdgt_sls,0)=0 Then 0
When NVL(bdgt.bdgt_wage_amt,0)=0 Then 0 When NVL(bdgt.bdgt_sls,0)=0 Then 0
ELSE NVL((bdgt.bdgt_wage_amt / bdgt.bdgt_sls)*100,0) END as BDGT_WGE_PCT_WTSS from 
(select dply_seq,dept_nm from dept where dept_no NOT IN (20) and div_no='Division' and dply_seq is NOT NULL) dpt
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on dpt.dply_seq=bdgt.dply_seq and dpt.dept_nm=bdgt.dept_nm
order by dpt.dply_seq) pln
where pln.dept_nm=actl.dept_nm]]> 
  </VarWages>
  
  <VarWagesTotal>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_WGE_PCT_TOT_WTSS - pln.BDGT_WGE_PCT_TOT_WTSS),2) as VAR_WGE_TOT_WTSS from 
(select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_TOT_WTSS=0 AND nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
When nume_den.ACTL_WGE_TOT_WTSS=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
ELSE ((nume_den.ACTL_WGE_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100) END as ACTL_WGE_PCT_TOT_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS,NVL(den.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den) actl,
(select wge.loc_nm,
CASE When wge.BDGT_WGE_TOT_WTSS=0 AND sls.BDGT_SLS_TOT_WTSS=0 Then 0
When wge.BDGT_WGE_TOT_WTSS=0 Then 0 When sls.BDGT_SLS_TOT_WTSS=0 Then 0
ELSE NVL((wge.BDGT_WGE_TOT_WTSS / sls.BDGT_SLS_TOT_WTSS)*100,0) END as BDGT_WGE_PCT_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'Store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.loc_no=bdgt.loc_no and lc.loc_nm=bdgt.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) pln
where pln.loc_nm=actl.loc_nm]]> 
  </VarWagesTotal>
  
  <VarFcstWages>
<![CDATA[select pln.dept_nm,ROUND((actl.ACTL_WGE_PCT_WTSS - pln.FCST_WGE_PCT_WTSS),2) as VAR_FCST_WGE_WTSS from 
(select nume_den.dept_nm,
CASE When nume_den.ACTL_WGE_WTSS=0 AND nume_den.ACTL_SLS_WTSS=0 Then 0
When nume_den.ACTL_WGE_WTSS=0 Then 0 when nume_den.ACTL_SLS_WTSS=0 Then 0
ELSE ((nume_den.ACTL_WGE_WTSS / nume_den.ACTL_SLS_WTSS)*100) END as ACTL_WGE_PCT_WTSS from 
(select nume.dept_nm,NVL(nume.ACTL_WGE_WTSS,0) as ACTL_WGE_WTSS,NVL(den.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select lc.dept_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_WTSS from 
(select distinct dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20)) lc
LEFT OUTER JOIN
(select e.dply_seq,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.dply_seq order by e.dply_seq) hrs
on hrs.dply_seq=lc.dply_seq order by lc.dply_seq) nume,
(select lc.dept_nm,NVL(sls.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select dept_no,dept_nm,dply_seq from ww_wlp.dept where dply_seq is not null and div_no='Division' and dept_no NOT IN (20) order by dply_seq) lc
LEFT OUTER JOIN
(select h.dply_seq,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.dply_seq order by h.dply_seq) sls
on lc.dply_seq=sls.dply_seq order by lc.dply_seq) den 
where nume.dept_nm=den.dept_nm) nume_den) actl,
(select dpt.dept_nm,
CASE When NVL(fcst.frcst_wage_amt,0)=0 AND NVL(fcst.frcst_sls,0)=0 Then 0
When NVL(fcst.frcst_wage_amt,0)=0 Then 0 When NVL(fcst.frcst_sls,0)=0 Then 0
ELSE NVL(((fcst.frcst_wage_amt / fcst.frcst_sls)*100),0) END as FCST_WGE_PCT_WTSS from 
(select dply_seq,dept_nm from dept where dept_no NOT IN (20) and div_no='Division' and dply_seq is NOT NULL) dpt
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on dpt.dply_seq=fcst.dply_seq and dpt.dept_nm=fcst.dept_nm
order by dpt.dply_seq) pln
where pln.dept_nm=actl.dept_nm]]> 
  </VarFcstWages>
  
  <VarFcstWagesTotal>
<![CDATA[select pln.loc_nm,ROUND((actl.ACTL_WGE_PCT_TOT_WTSS - pln.FCST_WGE_PCT_TOT_WTSS),2) as VAR_FCST_WGE_TOT_WTSS from 
(select nume_den.loc_nm,
CASE When nume_den.ACTL_WGE_TOT_WTSS=0 AND nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
When nume_den.ACTL_WGE_TOT_WTSS=0 Then 0 when nume_den.ACTL_SLS_TOT_WTSS=0 Then 0
ELSE ((nume_den.ACTL_WGE_TOT_WTSS / nume_den.ACTL_SLS_TOT_WTSS)*100) END as ACTL_WGE_PCT_TOT_WTSS from 
(select nume.loc_nm,NVL(nume.ACTL_WGE_TOT_WTSS,0) as ACTL_WGE_TOT_WTSS,NVL(den.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select lc.loc_nm,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select e.loc_no,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.loc_no order by e.loc_no) hrs
on hrs.loc_no=lc.loc_no order by lc.loc_no) nume,
(select lc.loc_nm,NVL(sls.ACTL_SLS_TOT_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct b.loc_no,b.loc_nm from loc b where b.loc_no='store' order by b.loc_no) lc
LEFT OUTER JOIN
(select h.loc_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) f ) h 
group by h.loc_no order by h.loc_no) sls
on lc.loc_no=sls.loc_no order by lc.loc_no) den 
where nume.loc_nm=den.loc_nm) nume_den) actl,
(select wge.loc_nm,
CASE When wge.FCST_WGE_TOT_WTSS=0 AND sls.FCST_SLS_TOT_WTSS=0 Then 0
When wge.FCST_WGE_TOT_WTSS=0 Then 0 When sls.FCST_SLS_TOT_WTSS=0 Then 0
ELSE NVL(((wge.FCST_WGE_TOT_WTSS / sls.FCST_SLS_TOT_WTSS)*100),0) END as FCST_WGE_PCT_TOT_WTSS from 
(select lc.loc_nm,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_TOT_WTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) wge,
(select lc.loc_nm,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_TOT_WTSS from 
(select loc_no,loc_nm,'store Total' as str_tot from loc where loc_no='store') lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.loc_no=fcst.loc_no and lc.loc_nm=fcst.loc_nm
group by lc.loc_nm order by lc.loc_nm) sls
where wge.loc_nm=sls.loc_nm) pln
where pln.loc_nm=actl.loc_nm]]> 
  </VarFcstWagesTotal>
  
  </TCName>
 
 
<TCName name = "SalesColumnValidationNewTable" >
<BudgetSales>
<![CDATA[select lc.fin_wk_no,NVL(bdgt.BDGT_SALES_TOT_WTSS,0) as BDGT_SLS_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
 and d.dept_no=ld.dept_no and a.loc_no=ld.loc_no
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.wk_id order by e.wk_id) bdgt
on lc.wk_id=bdgt.wk_id order by lc.wk_id]]> 
  </BudgetSales>
  
  <BudgetSalesTotal>
<![CDATA[select 'Total' as Tot,NVL(bdgt.BDGT_SALES_TOT_WTSS,0) as BDGT_SLS_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
 and d.dept_no=ld.dept_no and a.loc_no=ld.loc_no 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.perd_desc order by e.perd_desc) bdgt
on lc.perd_desc=bdgt.perd_desc order by lc.perd_desc]]> 
  </BudgetSalesTotal>
  
  <ForecastSales>
<![CDATA[select lc.fin_wk_no,NVL(bdgt.FCST_SALES_TOT_WTSS,0) as FCST_SLS_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,ROUND(sum(e.frcst_sls),0) as FCST_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
 and d.dept_no=ld.dept_no and a.loc_no=ld.loc_no 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.wk_id order by e.wk_id) bdgt
on lc.wk_id=bdgt.wk_id order by lc.wk_id]]> 
  </ForecastSales>
  
  <ForecastSalesTotal>
<![CDATA[select 'Total' as Tot,NVL(bdgt.FCST_SALES_TOT_WTSS,0) as FCST_SLS_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,ROUND(sum(e.frcst_sls),0) as FCST_SALES_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
 and d.dept_no=ld.dept_no and a.loc_no=ld.loc_no 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.perd_desc order by e.perd_desc) bdgt
on lc.perd_desc=bdgt.perd_desc order by lc.perd_desc]]> 
  </ForecastSalesTotal>
  
  <MonthlyPlannedSales>
	<![CDATA[select f.fin_wk_no,NVL(e.PLAN_SALES,0) as PLN_SLS_WTSS from 
	(select distinct wk_id,fin_wk_no from ww_wlp.wk where perd_desc='Month' order by wk_id) f
	LEFT OUTER JOIN 
    (select * from 
    (select b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES 
    from ww_wlp.mgr_wky_pln a,wk b 
	where a.div_no='Division' and a.loc_no='store' and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
    group by b.perd_desc,a.wk_id order by b.perd_desc,a.wk_id) c 
    UNION 
    select * from 
    (select b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES 
    from ww_wlp.fcst a,wk b
	where div_no='Division' and loc_no='store' and dept_no NOT IN (0,20,85,90) and fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and wk_id NOT IN
	(select wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no='store' and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
	group by b.perd_desc,b.wk_id order by b.perd_desc,b.wk_id) d) e 
    on f.wk_id=e.wk_id order by f.wk_id]]>
	</MonthlyPlannedSales>
  
	<MonthlyPlannedSalesTotal>
	<![CDATA[select 'Total' as Tot,NVL(ROUND(e.PLAN_SALES,0),0) as PLN_SLS_TOT_WTSS from 
	(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
    (select z.perd_desc,sum(PLAN_SALES) as PLAN_SALES from 
    (select * from 
    (select b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES 
    from ww_wlp.mgr_wky_pln a,wk b 
	where a.div_no='Division' and a.loc_no='store' and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
    group by b.perd_desc,a.wk_id order by b.perd_desc,a.wk_id) c 
    UNION 
    select * from 
    (select b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES 
    from ww_wlp.fcst a,wk b
	where div_no='Division' and loc_no='store' and dept_no NOT IN (0,20,85,90) and fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and wk_id NOT IN
	(select wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no='store' and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
	group by b.perd_desc,b.wk_id order by b.perd_desc,b.wk_id) d) z 
    group by z.perd_desc order by z.perd_desc) e 
    on lc.perd_desc=e.perd_desc order by lc.perd_desc]]>
	</MonthlyPlannedSalesTotal>
	
<WeeklyPlannedSales>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(sls.PLN_SLS_WTSS,0),0) as PLN_SLS_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select h.wk_id,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust 
from ww_wlp.fcst a, loc b, wk c , dept d, day dy, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) g*/) sec_prty) h 
group by h.wk_id order by h.wk_id) sls
on lc.wk_id=sls.wk_id]]> 
</WeeklyPlannedSales>

<WeeklyPlannedSalesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(sls.PLN_SLS_WTSS,0),0) as PLN_SLS_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select h.perd_desc,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust 
from ww_wlp.fcst a, loc b, wk c , dept d, day dy, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) g*/) sec_prty) h 
group by h.perd_desc order by h.perd_desc) sls
on lc.perd_desc=sls.perd_desc]]> 
</WeeklyPlannedSalesTotal>
 
<ActualSales>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(sls.ACTL_SLS_WTSS,0),0) as ACTL_SLS_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select h.wk_id,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) f ) h 
group by h.wk_id order by h.wk_id) sls
on lc.wk_id=sls.wk_id order by lc.wk_id]]> 
  </ActualSales>
  
  <ActualSalesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(sls.ACTL_SLS_WTSS,0),0) as ACTL_SLS_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select h.perd_desc,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) f ) h 
group by h.perd_desc order by h.perd_desc) sls
on lc.perd_desc=sls.perd_desc order by lc.perd_desc]]> 
  </ActualSalesTotal>
</TCName>

<TCName name = "WagesColumnValidationNewTable" >
 <BudgetWages>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(bdgt.BDGT_WAGE_TOT_WTSS,0),0) as BDGT_WGE_TOT_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.bdgt_wage_amt) as BDGT_WAGE_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.wk_id order by e.wk_id) bdgt
on lc.wk_id=bdgt.wk_id order by lc.wk_id]]> 
  </BudgetWages>
  
  <BudgetWagesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(bdgt.BDGT_WAGE_TOT_WTSS,0),0) as BDGT_WGE_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.bdgt_wage_amt) as BDGT_WAGE_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,18) 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.perd_desc order by e.perd_desc) bdgt
on lc.perd_desc=bdgt.perd_desc order by lc.perd_desc]]> 
  </BudgetWagesTotal>
  
  <ForecastWages>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(fcst.FCST_WAGE_WTSS,0),0) as FCST_WGE_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.frcst_wage_amt) as FCST_WAGE_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.wk_id order by e.wk_id) fcst
on lc.wk_id=fcst.wk_id order by lc.wk_id]]> 
  </ForecastWages>
  
  <ForecastWagesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(fcst.FCST_WAGE_TOT_WTSS,0),0) as FCST_WGE_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.frcst_wage_amt) as FCST_WAGE_TOT_WTSS from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and b.loc_no='store' 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.perd_desc order by e.perd_desc) fcst
on lc.perd_desc=fcst.perd_desc order by lc.perd_desc]]> 
  </ForecastWagesTotal>
  
  <MonthlyPlannedWages>
	<![CDATA[select f.fin_wk_no,NVL(e.PLN_WAGE_MPS,0) as PLN_WAGE_WTSS from 
  (select perd_desc,wk_id,fin_wk_no from ww_wlp.wk where perd_desc in ('Month') order by wk_id) f
	LEFT OUTER JOIN 
  (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c
  where a.loc_no=c.loc_no and c.loc_no='store' 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id order by d.wk_id) 
  UNION 
  select * from (select d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c , loc_dept ld 
  where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no) d where d.wk_id NOT IN 
  (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id order by d.wk_id)) e 
  on e.wk_id=f.wk_id order by f.wk_id]]>
	</MonthlyPlannedWages>
	
  <MonthlyPlannedWagesTotal>
	<![CDATA[select 'Total' as Tot,NVL(e.PLN_WAGE_WTSS,0) as PLN_WGE_TOT_WTSS from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSS from 
  (select * from (select d.perd_desc,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no='store' 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.wk_id order by d.perd_desc,d.wk_id) 
  UNION 
  select * from (select d.perd_desc,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c , loc_dept ld 
  where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no) d where d.wk_id NOT IN 
  (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.wk_id order by d.perd_desc,d.wk_id)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc]]>
	</MonthlyPlannedWagesTotal>
	
	<WeeklyPlannedWages>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(wge.PLN_WAGE_WTSS,0),0) as PLN_WGE_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) wge
on wge.wk_id=lc.wk_id order by lc.wk_id]]> 
  </WeeklyPlannedWages>
  
  <WeeklyPlannedWagesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(wge.PLN_WAGE_WTSS,0),0) as PLN_WGE_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) wge
on wge.perd_desc=lc.perd_desc order by lc.perd_desc]]> 
  </WeeklyPlannedWagesTotal>
  
  <ActualWages>
<![CDATA[select lc.fin_wk_no,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) hrs
on hrs.wk_id=lc.wk_id order by lc.wk_id]]> 
  </ActualWages>
  
  <ActualWagesTotal>
<![CDATA[select 'Total' as Tot,NVL(ROUND(hrs.ACTL_WGE_DTS,0),0) as ACTL_WGE_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) hrs
on hrs.perd_desc=lc.perd_desc order by lc.perd_desc]]> 
  </ActualWagesTotal>
</TCName>

<TCName name = "WagePercentageColumnValidationNewTable" >
  <BudgetWagePercentage>
<![CDATA[select wge.fin_wk_no,
CASE When NVL(wge.BDGT_WGE_WTSS,0)=0 and NVL(sls.BDGT_SLS_WTSS,0)=0 Then 0
When NVL(wge.BDGT_WGE_WTSS,0)=0 Then 0 When NVL(sls.BDGT_SLS_WTSS,0)=0 Then 0
ELSE ROUND((wge.BDGT_WGE_WTSS / sls.BDGT_SLS_WTSS)*100,2) END as BDGT_WGE_PCT_WTSS from 
(select lc.fin_wk_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.wk_id=bdgt.wk_id 
group by lc.fin_wk_no order by lc.fin_wk_no) wge,
(select lc.fin_wk_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.wk_id=bdgt.wk_id 
group by lc.fin_wk_no order by lc.fin_wk_no) sls
where wge.fin_wk_no=sls.fin_wk_no]]> 
  </BudgetWagePercentage>
  
  <BudgetWagePercentageTotal>
<![CDATA[select 'Total' as Tot,
CASE When NVL(wge.BDGT_WGE_TOT_WTSS,0)=0 and NVL(sls.BDGT_SLS_TOT_WTSS,0)=0 Then 0
When NVL(wge.BDGT_WGE_TOT_WTSS,0)=0 Then 0 When NVL(sls.BDGT_SLS_TOT_WTSS,0)=0 Then 0
ELSE ROUND((wge.BDGT_WGE_TOT_WTSS / sls.BDGT_SLS_TOT_WTSS)*100,2) END as BDGT_WGE_PCT_TOT_WTSS from 
(select lc.perd_desc,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.perd_desc=bdgt.perd_desc 
group by lc.perd_desc order by lc.perd_desc) wge,
(select lc.perd_desc,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.perd_desc=bdgt.perd_desc 
group by lc.perd_desc order by lc.perd_desc) sls
where wge.perd_desc=sls.perd_desc order by wge.perd_desc]]> 
  </BudgetWagePercentageTotal>
  
  <ForecastWagePercentage>
<![CDATA[select wge.fin_wk_no,
CASE When NVL(wge.FCST_WGE_WTSS,0)=0 and NVL(sls.FCST_SLS_WTSS,0)=0 Then 0
When NVL(wge.FCST_WGE_WTSS,0)=0 Then 0 When NVL(sls.FCST_SLS_WTSS,0)=0 Then 0
ELSE ROUND((wge.FCST_WGE_WTSS / sls.FCST_SLS_WTSS)*100,2) END as FCST_WGE_PCT_WTSS from 
(select lc.fin_wk_no,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.wk_id=fcst.wk_id 
group by lc.fin_wk_no order by lc.fin_wk_no) wge,
(select lc.fin_wk_no,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.wk_id=fcst.wk_id 
group by lc.fin_wk_no order by lc.fin_wk_no) sls
where wge.fin_wk_no=sls.fin_wk_no order by wge.fin_wk_no]]> 
  </ForecastWagePercentage>
  
  <ForecastWagePercentageTotal>
<![CDATA[select 'Total' as Tot,
CASE When NVL(wge.FCST_WGE_TOT_WTSS,0)=0 and NVL(sls.FCST_SLS_TOT_WTSS,0)=0 Then 0
When NVL(wge.FCST_WGE_TOT_WTSS,0)=0 Then 0 When NVL(sls.FCST_SLS_TOT_WTSS,0)=0 Then 0
ELSE ROUND((wge.FCST_WGE_TOT_WTSS / sls.FCST_SLS_TOT_WTSS)*100,2) END as FCST_WGE_PCT_TOT_WTSS from 
(select lc.perd_desc,NVL(sum(fcst.frcst_wage_amt),0) as FCST_WGE_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.perd_desc=fcst.perd_desc 
group by lc.perd_desc order by lc.perd_desc) wge,
(select lc.perd_desc,NVL(sum(fcst.frcst_sls),0) as FCST_SLS_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' and a.loc_no='store' 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,20,85,90) 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) fcst
on lc.perd_desc=fcst.perd_desc 
group by lc.perd_desc order by lc.perd_desc) sls
where wge.perd_desc=sls.perd_desc order by wge.perd_desc]]> 
  </ForecastWagePercentageTotal>
  
  <MonthlyPlannedWagePercentage>
	<![CDATA[select j.fin_wk_no,
	case when NVL(j.PLN_WAGE_WTSS,0)=0 and NVL(n.PLN_SLS_WTSS,0)=0 then 0 
	when NVL(j.PLN_WAGE_WTSS,0)=0 then 0 when NVL(n.PLN_SLS_WTSS,0)=0 then 0 
	else ROUND((j.PLN_WAGE_WTSS / n.PLN_SLS_WTSS)*100,2) end as PLN_WAGE_PRCNT_WTSS from 
  (select f.fin_wk_no,NVL(e.PLN_WAGE_MPS,0) as PLN_WAGE_WTSS from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) f
	LEFT OUTER JOIN 
  (select * from (select d.perd_desc,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.wk_id order by d.perd_desc,d.wk_id)
	UNION 
  select * from (select d.perd_desc,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
  from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c , loc_dept ld 
  where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no ) d 
  where d.wk_id NOT IN 
  (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
	group by d.perd_desc,d.wk_id order by d.perd_desc,d.wk_id)) e 
  on e.wk_id=f.wk_id order by f.wk_id) j
	INNER JOIN 
  (select f.fin_wk_no,NVL(e.PLAN_SALES,0) as PLN_SLS_WTSS from 
	(select distinct wk_id,fin_wk_no from ww_wlp.wk where perd_desc='Month' order by wk_id) f
	LEFT OUTER JOIN 
    (select * from 
    (select b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES 
    from ww_wlp.mgr_wky_pln a,wk b 
	where a.div_no='Division' and a.loc_no='store' and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
    group by b.perd_desc,a.wk_id order by b.perd_desc,a.wk_id) c 
    UNION 
    select * from 
    (select b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES 
    from ww_wlp.fcst a,wk b
	where div_no='Division' and loc_no='store' and dept_no NOT IN (0,20,85,90) and fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and wk_id NOT IN
	(select wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no='store' and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
	group by b.perd_desc,b.wk_id order by b.perd_desc,b.wk_id) d) e 
    on f.wk_id=e.wk_id order by f.wk_id) n 
  on j.fin_wk_no=n.fin_wk_no]]>
	</MonthlyPlannedWagePercentage>

  <MonthlyPlannedWagePercentageTotal>
	<![CDATA[select 'Total' as Tot,
	case when NVL(j.PLN_WAGE_TOT_WTSS,0)=0 and NVL(n.PLN_SLS_TOT_WTSS,0)=0 then 0 
	when NVL(j.PLN_WAGE_TOT_WTSS,0)=0 then 0 when NVL(n.PLN_SLS_TOT_WTSS,0)=0 then 0 
	else ROUND((j.PLN_WAGE_TOT_WTSS / n.PLN_SLS_TOT_WTSS)*100,2) end as PLN_WAGE_PRCNT_TOT_WTSS from 
  (select g.perd_desc,NVL(sum(g.PLN_WAGE_MPS),0) as PLN_WAGE_TOT_WTSS from 
  (select f.perd_desc,NVL(e.PLN_WAGE_MPS,0) as PLN_WAGE_MPS from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) f
	LEFT OUTER JOIN 
  (select * from (select d.perd_desc,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.wk_id order by d.perd_desc,d.wk_id)
	UNION 
  select * from (select d.perd_desc,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
	(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
  from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c , loc_dept ld 
  where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no ) d 
  where d.wk_id NOT IN 
  (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
	group by d.perd_desc,d.wk_id order by d.perd_desc,d.wk_id)) e 
  on e.perd_desc=f.perd_desc order by f.perd_desc) g 
  group by g.perd_desc order by g.perd_desc) j
	INNER JOIN 
  (select e.perd_desc,NVL(ROUND(e.PLAN_SALES,0),0) as PLN_SLS_TOT_WTSS from 
	(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
    (select z.perd_desc,sum(PLAN_SALES) as PLAN_SALES from 
    (select * from 
    (select b.perd_desc,a.wk_id,round(sum(a.mgr_wky_sls),0) as PLAN_SALES 
    from ww_wlp.mgr_wky_pln a,wk b 
	where a.div_no='Division' and a.loc_no='store' and a.wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month') and a.wk_id=b.wk_id 
    group by b.perd_desc,a.wk_id order by b.perd_desc,a.wk_id) c 
    UNION 
    select * from 
    (select b.perd_desc,b.wk_id,Round(sum(gnrt_sls),0) as GEN_SALES 
    from ww_wlp.fcst a,wk b
	where div_no='Division' and loc_no='store' and dept_no NOT IN (0,20,85,90) and fcst_dte between b.wk_strt and b.wk_end and b.perd_desc='Month' and wk_id NOT IN
	(select wk_id from ww_wlp.mgr_wky_pln where div_no='Division' and loc_no='store' and wk_id in (select wk_id from ww_wlp.wk where perd_desc='Month'))
	group by b.perd_desc,b.wk_id order by b.perd_desc,b.wk_id) d) z 
    group by z.perd_desc order by z.perd_desc) e 
    on lc.perd_desc=e.perd_desc order by lc.perd_desc) n 
  on j.perd_desc=n.perd_desc]]>
	</MonthlyPlannedWagePercentageTotal>
	
  <WeeklyPlannedWagePercentage>
<![CDATA[select wge.fin_wk_no,
case when NVL(wge.PLN_WGE_WTSS,0)=0 and NVL(sls.PLN_SLS_WTSS,0)=0 then 0 
when NVL(wge.PLN_WGE_WTSS,0)=0 then 0 when NVL(sls.PLN_SLS_WTSS,0)=0 then 0 
else ROUND((wge.PLN_WGE_WTSS / sls.PLN_SLS_WTSS)*100,2) end as PLN_WGE_PRCNT_WTSS from
(select lc.fin_wk_no,NVL(wge.PLN_WAGE_WTSS,0) as PLN_WGE_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) wge
on wge.wk_id=lc.wk_id order by lc.wk_id) wge,
(select lc.fin_wk_no,NVL(sls.PLN_SLS_WTSS,0) as PLN_SLS_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select h.wk_id,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust 
from ww_wlp.fcst a, loc b, wk c , dept d, day dy, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.wk_id,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) g*/) sec_prty) h 
group by h.wk_id order by h.wk_id) sls
on lc.wk_id=sls.wk_id) sls
where wge.fin_wk_no=sls.fin_wk_no]]> 
  </WeeklyPlannedWagePercentage>
  
  <WeeklyPlannedWagePercentageTotal>
<![CDATA[select 'Total' as Tot,
case when NVL(wge.PLN_WGE_TOT_WTSS,0)=0 and NVL(sls.PLN_SLS_TOT_WTSS,0)=0 then 0 
when NVL(wge.PLN_WGE_TOT_WTSS,0)=0 then 0 when NVL(sls.PLN_SLS_TOT_WTSS,0)=0 then 0 
else ROUND((wge.PLN_WGE_TOT_WTSS / sls.PLN_SLS_TOT_WTSS)*100,2) end as PLN_WGE_PRCNT_TOT_WTSS from
(select lc.perd_desc,NVL(wge.PLN_WAGE_WTSS,0) as PLN_WGE_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) wge
on wge.perd_desc=lc.perd_desc order by lc.perd_desc) wge,
(select lc.perd_desc,NVL(sls.PLN_SLS_WTSS,0) as PLN_SLS_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select h.perd_desc,sum(h.PLN_SLS_DTS) as PLN_SLS_WTSS from 
(/*select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT in (0,20,85,90)
and a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION*/
select * from (select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT in (0,20,85,90)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
/*and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')*/
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust 
from ww_wlp.fcst a, loc b, wk c , dept d, day dy, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT in (0,20,85,90)
and a.fcst_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
/*and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.perd_desc='Month' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.dept_nm,e.perd_desc,e.day_of_wk 
order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) g*/) sec_prty) h 
group by h.perd_desc order by h.perd_desc) sls
on lc.perd_desc=sls.perd_desc) sls
where wge.perd_desc=sls.perd_desc]]> 
  </WeeklyPlannedWagePercentageTotal>
  
  <ActualWagePercentage>
<![CDATA[select wge.fin_wk_no,
case when NVL(wge.ACTL_WGE_WTSS,0)=0 and NVL(sls.ACTL_SLS_WTSS,0)=0 then 0 
when NVL(wge.ACTL_WGE_WTSS,0)=0 then 0 when NVL(sls.ACTL_SLS_WTSS,0)=0 then 0 
else ROUND((wge.ACTL_WGE_WTSS / sls.ACTL_SLS_WTSS)*100,2) end as ACTL_WGE_PRCNT_WTSS from
(select lc.fin_wk_no,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) hrs
on hrs.wk_id=lc.wk_id order by lc.wk_id) wge,
(select lc.fin_wk_no,NVL(sls.ACTL_SLS_WTSS,0) as ACTL_SLS_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select h.wk_id,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.wk_id,e.day_of_wk) f ) h 
group by h.wk_id order by h.wk_id) sls
on lc.wk_id=sls.wk_id order by lc.wk_id) sls
where wge.fin_wk_no=sls.fin_wk_no]]> 
  </ActualWagePercentage>
  
  <ActualWagePercentageTotal>
<![CDATA[select 'Total' as Tot,
case when NVL(wge.ACTL_WGE_TOT_WTSS,0)=0 and NVL(sls.ACTL_SLS_TOT_WTSS,0)=0 then 0 
when NVL(wge.ACTL_WGE_TOT_WTSS,0)=0 then 0 when NVL(sls.ACTL_SLS_TOT_WTSS,0)=0 then 0 
else ROUND((wge.ACTL_WGE_TOT_WTSS / sls.ACTL_SLS_TOT_WTSS)*100,2) end as ACTL_WGE_PRCNT_TOT_WTSS from
(select lc.perd_desc,NVL(hrs.ACTL_WGE_DTS,0) as ACTL_WGE_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) hrs
on hrs.perd_desc=lc.perd_desc order by lc.perd_desc) wge,
(select lc.perd_desc,NVL(sls.ACTL_SLS_WTSS,0) as ACTL_SLS_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select h.perd_desc,sum(h.ACTL_SLS_DTS) as ACTL_SLS_WTSS from 
(select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (0,20,85,90) 
and a.txn_dte between c.wk_strt and c.wk_end and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.perd_desc,e.day_of_wk) f ) h 
group by h.perd_desc order by h.perd_desc) sls
on lc.perd_desc=sls.perd_desc order by lc.perd_desc) sls
where wge.perd_desc=sls.perd_desc]]> 
  </ActualWagePercentageTotal>
</TCName>

<TCName name = "ORColumnValidationNewTable" >
 <MonthlyPlannedOR>
	<![CDATA[select sms_hrs.WK_ID,
	case when NVL(sms_hrs.SMS_HRS_WTSS,0)=0 and NVL(pln_hrs.PLN_HRS_WTSS,0)=0 then 0 
	when NVL(sms_hrs.SMS_HRS_WTSS,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_WTSS,0)=0 then 0 
	else ROUND((sms_hrs.SMS_HRS_WTSS / pln_hrs.PLN_HRS_WTSS)*100,1) end as PLN_OR_WTSS from 
	(select lc.wk_id,NVL(ROUND(((ROUND(((y.SMS_HOURS_WTSS*100)/25),0)*25)/100),2),0) as SMS_HRS_WTSS from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
  LEFT OUTER JOIN
	(select C.wk_id,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_WTSS from 
  (select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,
	a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
  from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d /*,loc_dept ld */
	where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no and d.dept_no NOT IN (20,27,28) 
  and b.perd_desc in ('Month') and c.div_no='Division' and c.loc_no='store'
  /*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no*/ ) A
	group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C 
  group by C.wk_id order by c.wk_id) y
	on lc.wk_id=y.wk_id order by lc.wk_id) sms_hrs,
	(select lc.wk_id,NVL(ROUND(((ROUND(((e.PLN_HOURS_MPS*100)/25),0)*25)/100),2),0) as PLN_HRS_WTSS from 
  (select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc 
  LEFT OUTER JOIN 
  (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id order by d.wk_id) 
  UNION 
  select * from (select d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
  from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c , loc_dept ld 
  where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no) d 
  where d.wk_id NOT IN 
  (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
	group by d.wk_id order by d.wk_id)) e 
  on e.wk_id=lc.wk_id order by lc.wk_id) pln_hrs 
	where sms_hrs.wk_id=pln_hrs.wk_id order by sms_hrs.wk_id]]>
	</MonthlyPlannedOR>
  
  <MonthlyPlannedORTotal>
	<![CDATA[select 'Total' as Tot,
	case when NVL(sms_hrs.SMS_HRS_TOT_WTSS,0)=0 and NVL(pln_hrs.PLN_HRS_TOT_WTSS,0)=0 then 0 
	when NVL(sms_hrs.SMS_HRS_TOT_WTSS,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_TOT_WTSS,0)=0 then 0 
	else ROUND((sms_hrs.SMS_HRS_TOT_WTSS / pln_hrs.PLN_HRS_TOT_WTSS)*100,1) end as PLN_OR_TOT_WTSS from 
	(select sms_hours.perd_desc,NVL(ROUND(sum(sms_hours.SMS_HRS_WTSS),2),0) as SMS_HRS_TOT_WTSS from 
  (select lc.perd_desc,lc.wk_id,NVL(ROUND(((ROUND(((y.SMS_HOURS_WTSS*100)/25),0)*25)/100),2),0) as SMS_HRS_WTSS from 
  (select distinct c.perd_desc,c.wk_id from wk c where c.perd_desc='Month' order by c.wk_id) lc
  LEFT OUTER JOIN
	(select C.wk_id,(sum(C.FIX_HRS_DEPT_TOT) + sum(C.VOL_HRS_DEPT_TOT)) as SMS_HOURS_WTSS from 
  (select A.loc_no,A.loc_nm,A.wk_id,A.dept_no,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,
	a.task_no,nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
  from ww_wlp.wky_lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d /*,loc_dept ld */
	where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no and d.dept_no NOT IN (20,27,28) 
  and b.perd_desc in ('Month') and c.div_no='Division' and c.loc_no='store'
  /*and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no*/ ) A
	group by A.loc_no,A.loc_nm,A.wk_id,A.dept_no order by A.loc_no,A.wk_id,A.dept_no) C 
  group by C.wk_id order by c.wk_id) y
	on lc.wk_id=y.wk_id order by lc.wk_id) sms_hours
  group by sms_hours.perd_desc order by sms_hours.perd_desc)sms_hrs,
	(select pln_hours.perd_desc,NVL(ROUND(sum(pln_hours.PLN_HRS_WTSS),2),0) as PLN_HRS_TOT_WTSS from 
  (select lc.perd_desc,lc.wk_id,NVL(ROUND(((ROUND(((e.PLN_HOURS_MPS*100)/25),0)*25)/100),2),0) as PLN_HRS_WTSS from 
  (select distinct c.perd_desc,c.wk_id from wk c where c.perd_desc='Month' order by c.wk_id) lc 
  LEFT OUTER JOIN 
  (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_HRS),0) as PLN_HOURS_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id order by d.wk_id) 
  UNION 
  select * from (select d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
  from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c , loc_dept ld 
  where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no) d 
  where d.wk_id NOT IN 
  (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
	where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month'))
	group by d.wk_id order by d.wk_id)) e 
  on e.wk_id=lc.wk_id order by lc.wk_id) pln_hours 
  group by pln_hours.perd_desc order by pln_hours.perd_desc) pln_hrs 
	where sms_hrs.perd_desc=pln_hrs.perd_desc order by sms_hrs.perd_desc]]>
	</MonthlyPlannedORTotal>
	
		<WeeklyPlannedOR>
	<![CDATA[select sms_hrs.fin_wk_no,
	CASE When NVL(sms_hrs.SMS_HRS_WTSS,0)=0 and NVL(pln_hrs.PLN_HRS_WTSS,0)=0 Then 0 
	When NVL(sms_hrs.SMS_HRS_WTSS,0)=0 Then 0 When NVL(pln_hrs.PLN_HRS_WTSS,0)=0 Then 0 
	ELSE ROUND((sms_hrs.SMS_HRS_WTSS / pln_hrs.PLN_HRS_WTSS)*100,1) END as PLN_OR_WTSS from 
(select lc.fin_wk_no,NVL(y.SMS_HOURS_WTSS,0) as SMS_HRS_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select z.wk_id,sum(SMS_HOURS_WPS) as SMS_HOURS_WTSS from 
(select C.loc_no,c.wk_id,C.dept_nm,NVL(((ROUND((((C.FIX_HRS_DEPT_TOT + C.VOL_HRS_DEPT_TOT)*100)/25),0)*25)/100),0) as SMS_HOURS_WPS from 
(select A.loc_no,A.loc_nm,A.wk_id,A.dept_nm,A.dply_seq,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,dpt.dply_seq,dpt.dept_nm,a.task_no,
nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
from ww_wlp.lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d, ww_wlp.dept dpt, loc_dept ld 
where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
and d.dept_no NOT IN (20,27,28) and b.perd_desc='Month' and c.div_no='Division' and c.loc_no='store'
and d.dept_no=dpt.dept_no and dpt.dply_seq is NOT NULL and dpt.div_no='Division'
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no) A
group by A.loc_no,A.loc_nm,A.wk_id,A.dply_seq,A.dept_nm order by A.loc_no,A.wk_id,A.dply_seq) C
order by C.loc_no,c.wk_id,C.dply_seq) z
group by z.wk_id order by z.wk_id) y
on lc.wk_id=y.wk_id order by lc.wk_id) sms_hrs, 
(select lc.fin_wk_no,NVL(e.PLN_HOURS_WPS,0) as PLN_HRS_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select z.wk_id,NVL(sum(PLN_HOURS_WPS),0) as PLN_HOURS_WPS from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d,loc_dept ld 
where a.wk_id=b.wk_id and b.perd_desc='Month' 
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28)
and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,b.perd_desc,b.wk_id,d.dply_seq) z
group by z.wk_id order by z.wk_id) e
on e.wk_id=lc.wk_id order by lc.wk_id) pln_hrs 
where sms_hrs.fin_wk_no=pln_hrs.fin_wk_no]]>
	</WeeklyPlannedOR>
  
  <WeeklyPlannedORTotal>
	<![CDATA[select 'Total' as Tot,
	CASE When NVL(sms_hrs.SMS_HRS_TOT_WTSS,0)=0 and NVL(pln_hrs.PLN_HRS_TOT_WTSS,0)=0 Then 0 
	When NVL(sms_hrs.SMS_HRS_TOT_WTSS,0)=0 Then 0 When NVL(pln_hrs.PLN_HRS_TOT_WTSS,0)=0 Then 0 
	ELSE ROUND((sms_hrs.SMS_HRS_TOT_WTSS / pln_hrs.PLN_HRS_TOT_WTSS)*100,1) END as PLN_OR_TOT_WTSS from 
(select lc.perd_desc,NVL(y.SMS_HOURS_WTSS,0) as SMS_HRS_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select z.perd_desc,sum(SMS_HOURS_WPS) as SMS_HOURS_WTSS from 
(select C.loc_no,c.perd_desc,C.dept_nm,NVL(((ROUND((((C.FIX_HRS_DEPT_TOT + C.VOL_HRS_DEPT_TOT)*100)/25),0)*25)/100),0) as SMS_HOURS_WPS from 
(select A.loc_no,A.loc_nm,A.perd_desc,A.dept_nm,A.dply_seq,sum(fix_hrs) as FIX_HRS_DEPT_TOT,Sum(vol_hrs) as VOL_HRS_DEPT_TOT from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,B.PERD_DESC,a.wk_id,d.dept_no,dpt.dply_seq,dpt.dept_nm,a.task_no,
nvl(a.fix_hrs,0) as fix_hrs,NVL(a.vol_hrs,0) as vol_hrs 
from ww_wlp.lbr_std a, ww_wlp.wk b, ww_wlp.loc c, ww_wlp.task d, ww_wlp.dept dpt, loc_dept ld 
where a.task_no=d.task_no and a.wk_id=b.wk_id and a.loc_no=c.loc_no 
and d.dept_no NOT IN (20,27,28) and b.perd_desc='Month' and c.div_no='Division' and c.loc_no='store'
and d.dept_no=dpt.dept_no and dpt.dply_seq is NOT NULL and dpt.div_no='Division'
and a.loc_no=ld.loc_no and ld.dept_no=d.dept_no) A
group by A.loc_no,A.loc_nm,A.perd_desc,A.dply_seq,A.dept_nm order by A.loc_no,A.perd_desc,A.dply_seq) C
order by C.loc_no,c.perd_desc,C.dply_seq) z
group by z.perd_desc order by z.perd_desc) y
on lc.perd_desc=y.perd_desc order by lc.perd_desc) sms_hrs, 
(select lc.perd_desc,NVL(e.PLN_HOURS_WPS,0) as PLN_HRS_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select z.perd_desc,NVL(sum(PLN_HOURS_WPS),0) as PLN_HOURS_WPS from 
(select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm,
ROUND((sum(nvl(a.TA_PLN_WAGE_AMT,0)) + sum(nvl(a.WAGE_ADJ_AMT,0))),0) as PLN_WAGE_WPS,
ROUND((sum(nvl(a.TA_PLN_HRS,0)) + sum(nvl(a.WAGE_ADJ_HRS,0))),0) as PLN_HOURS_WPS
from ww_wlp.wky_dept_pln a,wk b,loc c,dept d,loc_dept ld 
where a.wk_id=b.wk_id and b.perd_desc='Month' 
and a.div_no=c.div_no and a.loc_no=c.loc_no and a.div_no='Division' and a.loc_no='store'
and a.div_no=d.div_no and a.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28)
and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no
group by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,b.wk_id,a.dept_no,d.dply_seq,d.dept_nm
order by c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,b.perd_desc,b.wk_id,d.dply_seq) z
group by z.perd_desc order by z.perd_desc) e
on e.perd_desc=lc.perd_desc order by lc.perd_desc) pln_hrs 
where sms_hrs.perd_desc=pln_hrs.perd_desc]]>
	</WeeklyPlannedORTotal>
	
	<ActualOR>
	<![CDATA[select actl_sms.fin_wk_no,
	case when NVL(actl_sms.ACTL_SMS_WTSS,0)=0 and NVL(actl_hrs.ACTL_HRS_WTSS,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_WTSS,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_WTSS,0)=0 then 0 
	else NVL(ROUND((actl_sms.ACTL_SMS_WTSS / actl_hrs.ACTL_HRS_WTSS)*100,1),0) end as ACTL_OR_WTSS from
(select lc.fin_wk_no,NVL(xy.WK_TO_DT_TOT,0) as ACTL_SMS_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select  wk_id,Sum(plan_sms_hrs) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.perd_desc,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no='Division'
where w.perd_desc='Month' and A.loc_no='store' --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by wk_id) xy
on lc.wk_id=xy.wk_id order by lc.wk_id)actl_sms,
(select lc.fin_wk_no,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_WTSS from 
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) hrs
on hrs.wk_id=lc.wk_id order by lc.wk_id)actl_hrs
where actl_sms.fin_wk_no=actl_hrs.fin_wk_no order by actl_sms.fin_wk_no]]> 
</ActualOR>

<ActualORTotal>
	<![CDATA[select 'Total' as Tot,
	case when NVL(actl_sms.ACTL_SMS_TOT_WTSS,0)=0 and NVL(actl_hrs.ACTL_HRS_TOT_WTSS,0)=0 then 0 
	when NVL(actl_sms.ACTL_SMS_TOT_WTSS,0)=0 then 0 when NVL(actl_hrs.ACTL_HRS_TOT_WTSS,0)=0 then 0 
	else NVL(ROUND((actl_sms.ACTL_SMS_TOT_WTSS / actl_hrs.ACTL_HRS_TOT_WTSS)*100,1),0) end as ACTL_OR_TOT_WTSS from
(select lc.perd_desc,NVL(xy.WK_TO_DT_TOT,0) as ACTL_SMS_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select perd_desc,Sum(plan_sms_hrs) as WK_TO_DT_TOT 
from 
(select distinct src.*,
(CASE
/*when dept_no in (5,10,15) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)*/
when dept_no in (91,10,30,45,5,27,28,85,90,0) Then NVL(((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs),0)
END) as plan_sms_hrs
from
(select LL.task_no,LL.task_nm,LL.loc_no,LL.dept_no,LL.dept_nm,LL.perd_desc,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case 
/*When LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) */
when dept_no in (91,10,30,45,5,27,28,85,90,0)  then  (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end) as itm_cnt
from 
(select Y.task_no,Y.task_nm,Y.loc_no,Y.dept_no,Y.dept_nm,Y.perd_desc,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,A.loc_no, dt.dept_nm,W.perd_desc,A.wk_id,A.day_of_wk,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no 
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no='Division'
where w.perd_desc='Month' and A.loc_no='store' --and tk.dept_no=25  
and A.day_of_wk in (0,1,2,3,4,5,6)
--and a.task_no='600062'
order by A.task_no,tk.dept_no,dt.dept_nm  ) Y
inner join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, LL.loc_no, LL.dept_no,LL.dept_nm, LL.perd_desc,LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.day_of_wk) src where dept_no not in (20)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by perd_desc) xy
on lc.perd_desc=xy.perd_desc order by lc.perd_desc)actl_sms,
(select lc.perd_desc,NVL(hrs.ACTL_HRS_DTS,0) as ACTL_HRS_TOT_WTSS from 
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.actl_wage_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) hrs
on hrs.perd_desc=lc.perd_desc order by lc.perd_desc)actl_hrs
where actl_sms.perd_desc=actl_hrs.perd_desc order by actl_sms.perd_desc]]> 
</ActualORTotal>
</TCName>

<TCName name = "CPHColumnValidationNewTable" >
<MonthlyPlannedCPH>
	<![CDATA[select pln_wge.fin_wk_no,
	case when NVL(pln_wge.PLN_WGE_WTSS,0)=0 and NVL(pln_hrs.PLN_HRS_WTSS,0)=0 then 0 
	when NVL(pln_wge.PLN_WGE_WTSS,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_WTSS,0)=0 then 0 
	else ROUND((pln_wge.PLN_WGE_WTSS / pln_hrs.PLN_HRS_WTSS),2) end as PLN_CPH_WTSS from 
  (select lc.fin_wk_no,NVL(e.PLN_WAGE_MPS,0) as PLN_WGE_WTSS from 
  (select perd_desc,wk_id,fin_wk_no from ww_wlp.wk where perd_desc in ('Month') order by wk_id) lc
	LEFT OUTER JOIN 
  (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c
  where a.loc_no=c.loc_no and c.loc_no='store' 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id order by d.wk_id) 
  UNION 
  select * from (select d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c , loc_dept ld 
  where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no) d where d.wk_id NOT IN 
  (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id order by d.wk_id)) e 
  on e.wk_id=lc.wk_id order by lc.wk_id) pln_wge,
  (select lc.fin_wk_no,NVL(e.PLN_HOURS_WTSS,0) as PLN_HRS_WTSS from 
  (select perd_desc,wk_id,fin_wk_no from ww_wlp.wk where perd_desc in ('Month') order by wk_id) lc
	LEFT OUTER JOIN 
  (select * from (select d.wk_id,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_WTSS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c
  where a.loc_no=c.loc_no and c.loc_no='store' 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.wk_id order by d.wk_id) 
  UNION 
  select * from (select d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_WTSS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c , loc_dept ld 
  where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no) d where d.wk_id NOT IN 
  (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.wk_id order by d.wk_id)) e 
  on e.wk_id=lc.wk_id order by lc.wk_id) pln_hrs 
  where pln_wge.fin_wk_no=pln_hrs.fin_wk_no order by pln_wge.fin_wk_no]]>
	</MonthlyPlannedCPH>
  
	<MonthlyPlannedCPHTotal>
	<![CDATA[select 'Total' as Tot,
	case when NVL(pln_wge.PLN_WGE_TOT_WTSS,0)=0 and NVL(pln_hrs.PLN_HRS_TOT_WTSS,0)=0 then 0 
	when NVL(pln_wge.PLN_WGE_TOT_WTSS,0)=0 then 0 when NVL(pln_hrs.PLN_HRS_TOT_WTSS,0)=0 then 0 
	else ROUND((pln_wge.PLN_WGE_TOT_WTSS / pln_hrs.PLN_HRS_TOT_WTSS),2) end as PLN_CPH_TOT_WTSS from 
  (select lc.perd_desc,NVL(e.PLN_WAGE_WTSS,0) as PLN_WGE_TOT_WTSS from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_WAGE_MPS) as PLN_WAGE_WTSS from 
  (select * from (select d.perd_desc,d.wk_id,ROUND(sum(d.MGR_WKY_WGE) ,0) as PLN_WAGE_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_WGE 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no='store' 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.wk_id order by d.perd_desc,d.wk_id) 
  UNION 
  select * from (select d.perd_desc,d.wk_id,ROUND((sum(d.TA_PLN_WAGE_AMT) + sum(d.WAGE_ADJ_AMT)),0) as BASE_COST_MPS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_WAGE_AMT,WAGE_ADJ_AMT 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c , loc_dept ld 
  where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no) d where d.wk_id NOT IN 
  (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.wk_id order by d.perd_desc,d.wk_id)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc) pln_wge,
  (select lc.perd_desc,NVL(e.PLN_HOURS_WTSS,0) as PLN_HRS_TOT_WTSS from 
  (select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
	LEFT OUTER JOIN 
  (select z.perd_desc,sum(PLN_HOURS_WTSS) as PLN_HOURS_WTSS from 
  (select * from (select d.perd_desc,d.wk_id,ROUND(sum(d.MGR_WKY_HRS) ,0) as PLN_HOURS_WTSS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,MGR_WKY_HRS 
  from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c 
  where a.loc_no=c.loc_no and c.loc_no='store' 
  and a.wk_id=b.wk_id and b.perd_desc in ('Month')) d 
  group by d.perd_desc,d.wk_id order by d.perd_desc,d.wk_id) 
  UNION 
  select * from (select d.perd_desc,d.wk_id,ROUND((sum(d.TA_PLN_HRS) + sum(d.WAGE_ADJ_HRS)),0) as BASE_HOURS_WTSS from 
  (select c.div_no,c.rgn_no,c.zone_no,c.ar_no,a.loc_no,c.loc_nm,b.perd_desc,a.wk_id,a.dept_no,TA_PLN_HRS,WAGE_ADJ_HRS 
	from ww_wlp.wky_dept_pln a, ww_wlp.wk b, ww_wlp.loc c , loc_dept ld 
  where a.loc_no=c.loc_no and c.loc_no='store' and a.wk_id=b.wk_id and b.perd_desc in ('Month') and a.DEPT_NO NOT IN (20,27,28)
  and a.loc_no=ld.loc_no and a.dept_no=ld.dept_no) d where d.wk_id NOT IN 
  (select a.wk_id from ww_wlp.mgr_wky_pln a, ww_wlp.wk b, ww_wlp.loc c where a.loc_no=c.loc_no and c.loc_no='store' and 
	a.wk_id=b.wk_id and b.perd_desc in ('Month')) 
  group by d.perd_desc,d.wk_id order by d.perd_desc,d.wk_id)) z
  group by z.perd_desc order by z.perd_desc) e 
  on e.perd_desc=lc.perd_desc order by lc.perd_desc) pln_hrs 
  where pln_wge.perd_desc=pln_hrs.perd_desc order by pln_wge.perd_desc]]>
	</MonthlyPlannedCPHTotal>
	
	  <WeeklyPlannedCPH>
<![CDATA[select lc.fin_wk_no,
CASE When NVL(wge_hrs.PLN_WGE_WTSS,0)=0 and NVL(wge_hrs.PLN_HRS_WTSS,0)=0 Then 0 
When NVL(wge_hrs.PLN_WGE_WTSS,0)=0 Then 0 When NVL(wge_hrs.PLN_HRS_WTSS,0)=0 Then 0 
ELSE ROUND((wge_hrs.PLN_WGE_WTSS / wge_hrs.PLN_HRS_WTSS),2) END as PLN_CPH_WTSS from
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WGE_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HRS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) wge_hrs
on wge_hrs.wk_id=lc.wk_id order by lc.wk_id]]> 
  </WeeklyPlannedCPH>
  
  <WeeklyPlannedCPHTotal>
<![CDATA[select 'Total' as Tot,
CASE When NVL(wge_hrs.PLN_WGE_TOT_WTSS,0)=0 and NVL(wge_hrs.PLN_HRS_TOT_WTSS,0)=0 Then 0 
When NVL(wge_hrs.PLN_WGE_TOT_WTSS,0)=0 Then 0 When NVL(wge_hrs.PLN_HRS_TOT_WTSS,0)=0 Then 0 
ELSE ROUND((wge_hrs.PLN_WGE_TOT_WTSS / wge_hrs.PLN_HRS_TOT_WTSS),2) END as PLN_CPH_TOT_WTSS from
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WGE_TOT_WTSS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HRS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) wge_hrs
on wge_hrs.perd_desc=lc.perd_desc order by lc.perd_desc]]> 
  </WeeklyPlannedCPHTotal>
  
  <ActualCPH>
<![CDATA[select lc.fin_wk_no,
CASE When NVL(wge_hrs.ACTL_WGE_WTSS,0)=0 and NVL(wge_hrs.ACTL_HRS_WTSS,0)=0 Then 0 
When NVL(wge_hrs.ACTL_WGE_WTSS,0)=0 Then 0 When NVL(wge_hrs.ACTL_HRS_WTSS,0)=0 Then 0 
ELSE ROUND((wge_hrs.ACTL_WGE_WTSS / wge_hrs.ACTL_HRS_WTSS),2) END as ACTL_CPH_WTSS from
(select distinct c.wk_id,c.fin_wk_no from wk c where c.perd_desc='Month' order by c.wk_id) lc
LEFT OUTER JOIN
(select e.wk_id,sum(e.actl_wage_amt) as ACTL_WGE_WTSS,sum(e.actl_hrs) as ACTL_HRS_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c, dept d, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.wk_id order by e.wk_id) wge_hrs
on wge_hrs.wk_id=lc.wk_id order by lc.wk_id]]> 
  </ActualCPH>
  
  <ActualCPHTotal>
<![CDATA[select 'Total' as Tot,
CASE When NVL(wge_hrs.ACTL_WGE_TOT_WTSS,0)=0 and NVL(wge_hrs.ACTL_HRS_TOT_WTSS,0)=0 Then 0 
When NVL(wge_hrs.ACTL_WGE_TOT_WTSS,0)=0 Then 0 When NVL(wge_hrs.ACTL_HRS_TOT_WTSS,0)=0 Then 0 
ELSE ROUND((wge_hrs.ACTL_WGE_TOT_WTSS / wge_hrs.ACTL_HRS_TOT_WTSS),2) END as ACTL_CPH_TOT_WTSS from
(select distinct c.perd_desc from wk c where c.perd_desc='Month' order by c.perd_desc) lc
LEFT OUTER JOIN
(select e.perd_desc,sum(e.actl_wage_amt) as ACTL_WGE_TOT_WTSS,sum(e.actl_hrs) as ACTL_HRS_TOT_WTSS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c, dept d, loc_dept ld 
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and b.loc_no='store' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.perd_desc='Month' 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' 
and a.loc_no=ld.loc_no and ld.dept_no=a.dept_no 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.perd_desc order by e.perd_desc) wge_hrs 
on wge_hrs.perd_desc=lc.perd_desc order by lc.perd_desc]]> 
  </ActualCPHTotal>
</TCName>

 
</configuration>