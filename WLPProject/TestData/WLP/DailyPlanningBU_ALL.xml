<?xml version="1.0" encoding="UTF-8" ?> 
<configuration>
<TCName name="SalesView">
<PlannedSalesColumn>
<![CDATA[ 
select z.rgn_no,
NVL(y.Mon_sls,0) as Mon,NVL(y.Tue_sls,0) as Tue,NVL(y.Wed_sls,0) as Wed,NVL(y.Thu_sls,0) as Thu,NVL(y.Fri_sls,0) as Fri,
NVL(y.Sat_sls,0) as Sat,NVL(y.Sun_sls,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DPBU)),0) Sun_itm from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DPBU,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no

  ]]> 
  </PlannedSalesColumn>
<PlannedSalesTotal>
<![CDATA[ 
select z.div_no,
NVL(y.Mon_sls,0) as Mon,NVL(y.Tue_sls,0) as Tue,NVL(y.Wed_sls,0) as Wed,NVL(y.Thu_sls,0) as Thu,NVL(y.Fri_sls,0) as Fri,
NVL(y.Sat_sls,0) as Sat,NVL(y.Sun_sls,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DPBU)),0) Sun_itm from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_TOT_DPBU,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no

  ]]> 
  </PlannedSalesTotal>
<PlannedSalesWkToDt>
<![CDATA[ 
select z.rgn_no,NVL(ROUND(y.wtd_sls,0),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DPBU)),0) Sun_itm from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DPBU,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no

  ]]> 
  </PlannedSalesWkToDt>
<PlannedSalesWkToDtTotal>
<![CDATA[ 
select z.div_no,NVL(ROUND(y.wtd_sls,0),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DPBU)),0) Sun_itm from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DPBU,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no

  ]]> 
  </PlannedSalesWkToDtTotal>
<ActualSalesColumn>
<![CDATA[ 
select lc.rgn_no,
NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_SLS_DTS),0) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no

  ]]> 
  </ActualSalesColumn>
<ActualSalesTotal>
<![CDATA[ 
select lc.div_no,
NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_SLS_DTS),0) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no

  ]]> 
  </ActualSalesTotal>
<ActualSalesWkToDt>
<![CDATA[ 
select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no

  ]]> 
  </ActualSalesWkToDt>
<ActualSalesWkToDtTotal>
<![CDATA[ 
select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no

  ]]> 
  </ActualSalesWkToDtTotal>
<VarianceSalesColumn>
<![CDATA[ select nyu.rgn_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select lc.rgn_no,
NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_SLS_DTS),0) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) den,
(select z.rgn_no,
NVL(y.Mon_sls,0) as Mon,NVL(y.Tue_sls,0) as Tue,NVL(y.Wed_sls,0) as Wed,NVL(y.Thu_sls,0) as Thu,NVL(y.Fri_sls,0) as Fri,
NVL(y.Sat_sls,0) as Sat,NVL(y.Sun_sls,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DPBU)),0) Sun_itm from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DPBU,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no) nyu
where nyu.rgn_no = den.rgn_no
  ]]> 
  </VarianceSalesColumn>
<VarianceSalesTotal>
<![CDATA[select nyu.div_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select lc.div_no,
NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_SLS_DTS),0) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) den,
(select z.div_no,
NVL(y.Mon_sls,0) as Mon,NVL(y.Tue_sls,0) as Tue,NVL(y.Wed_sls,0) as Wed,NVL(y.Thu_sls,0) as Thu,NVL(y.Fri_sls,0) as Fri,
NVL(y.Sat_sls,0) as Sat,NVL(y.Sun_sls,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DPBU)),0) Sun_itm from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_TOT_DPBU,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no) nyu
where nyu.div_no = den.div_no 
 
  ]]> 
  </VarianceSalesTotal>
<VarianceSalesWkToDt>
<![CDATA[ select nyu.rgn_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_CPH_DPG from
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) den,
(select z.rgn_no,NVL(ROUND(y.wtd_sls,0),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DPBU)),0) Sun_itm from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DPBU,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no) nyu
where nyu.rgn_no= den.rgn_no


  ]]> 
  </VarianceSalesWkToDt>
<VarianceSalesWkToDtTotal>
<![CDATA[ select nyu.div_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_CPH_TOT_DPG from
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) den,
(select z.div_no,NVL(ROUND(y.wtd_sls,0),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DPBU)),0) Sun_itm from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DPBU,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no) nyu where nyu.div_no = den.div_no 
  ]]> 
  </VarianceSalesWkToDtTotal>
  </TCName>
<TCName name="ScheduledHoursView">
<PlannedHoursColumn>
<![CDATA[ 
select lc.rgn_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_HRS_DTS),1) as PLN_HRS_DPBU from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no

  ]]> 
  </PlannedHoursColumn>
<PlannedHoursTotal>
<![CDATA[ 
select lc.div_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_HRS_DTS),1) as PLN_HRS_TOT_DPBU from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no

  ]]> 
  </PlannedHoursTotal>
<PlannedHoursWkToDt>
<![CDATA[ 
select lc.rgn_no,NVL(ROUND(wge.PLN_HOURS_DPBU,1),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no

  ]]> 
  </PlannedHoursWkToDt>
<PlannedHoursWkToDtTotal>
<![CDATA[ 
select lc.div_no,NVL(ROUND(wge.PLN_HOURS_TOT_DPBU,1),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no

  ]]> 
  </PlannedHoursWkToDtTotal>
<ActualHoursColumn>
<![CDATA[ 
select lc.rgn_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSR)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTS),2) as ACTL_HRS_DTSR from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no

  ]]> 
  </ActualHoursColumn>
<ActualHoursTotal>
<![CDATA[ 
select lc.div_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTS),2) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no

  ]]> 
  </ActualHoursTotal>
<ActualHoursWkToDt>
<![CDATA[ 
select lc.rgn_no,NVL(ROUND(wge.ACTL_HRS_DTSBU,1),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/*UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i*/) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no

  ]]> 
  </ActualHoursWkToDt>
<ActualHoursWkToDtTotal>
<![CDATA[ 
select lc.div_no,NVL(ROUND(wge.ACTL_HRS_TOT_DTSBU,1),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/*UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i*/) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no

  ]]> 
  </ActualHoursWkToDtTotal>
<PlannedPayHoursColumn>
<![CDATA[ 
select lc.rgn_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_HRS_DTS),1) as PLN_HRS_DPBU from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no

  ]]> 
  </PlannedPayHoursColumn>
<PlannedPayHoursTotal>
<![CDATA[ 
select lc.div_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_HRS_DTS),1) as PLN_HRS_TOT_DPBU from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no

  ]]> 
  </PlannedPayHoursTotal>
<PlannedPayHoursWkToDt>
<![CDATA[ 
select lc.rgn_no,NVL(ROUND(wge.PLN_HOURS_DPBU,1),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no

  ]]> 
  </PlannedPayHoursWkToDt>
<PlannedPayHoursWkToDtTotal>
<![CDATA[ 
select lc.div_no,NVL(ROUND(wge.PLN_HOURS_TOT_DPBU,1),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no

  ]]> 
  </PlannedPayHoursWkToDtTotal>
<ActualPayHoursColumn>
<![CDATA[ 
select lc.rgn_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSR)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTS),2) as ACTL_HRS_DTSR from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no

  ]]> 
  </ActualPayHoursColumn>
<ActualPayHoursTotal>
<![CDATA[ 
select lc.div_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTS),2) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no

  ]]> 
  </ActualPayHoursTotal>
<ActualPayHoursWkToDt>
<![CDATA[ 
select lc.rgn_no,NVL(ROUND(wge.ACTL_HRS_DTSBU,1),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/*UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i*/) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no

  ]]> 
  </ActualPayHoursWkToDt>
<ActualPayHoursWkToDtTotal>
<![CDATA[ 
select lc.div_no,NVL(ROUND(wge.ACTL_HRS_TOT_DTSBU,1),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/*UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i*/) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no

  ]]> 
  </ActualPayHoursWkToDtTotal>
<VarianceHoursColumn>
<![CDATA[ select nyu.rgn_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),1) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),1) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),1) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),1) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),1) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),1) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),1) end as Sun from
(select lc.rgn_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSR)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTS),2) as ACTL_HRS_DTSR from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) den,
(select lc.rgn_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_HRS_DTS),1) as PLN_HRS_DPBU from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) nyu
where nyu.rgn_no = den.rgn_no
  ]]> 
  </VarianceHoursColumn>
<VarianceHoursTotal>
<![CDATA[ select nyu.div_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),1) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),1) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),1) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),1) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),1) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),1) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),1) end as Sun from
(select lc.div_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTS),2) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) den,
(select lc.div_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_HRS_DTS),1) as PLN_HRS_TOT_DPBU from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) nyu
where nyu.div_no = den.div_no 
  ]]> 
  </VarianceHoursTotal>
<VarianceHoursWkToDt>
<![CDATA[ select nyu.rgn_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),1) end as VAR_CPH_DPG from
(select lc.rgn_no,NVL(ROUND(wge.ACTL_HRS_DTSBU,2),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/*UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i*/) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) den,
(select lc.rgn_no,NVL(ROUND(wge.PLN_HOURS_DPBU,1),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no) nyu
where nyu.rgn_no= den.rgn_no
  ]]> 
  </VarianceHoursWkToDt>
<VarianceHoursWkToDtTotal>
<![CDATA[ select nyu.div_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),1) end as VAR_CPH_TOT_DPG from
(select lc.div_no,NVL(ROUND(wge.ACTL_HRS_TOT_DTSBU,2),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/*UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i*/) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) den,
(select lc.div_no,NVL(ROUND(wge.PLN_HOURS_TOT_DPBU,1),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no) nyu where nyu.div_no = den.div_no 
  ]]> 
  </VarianceHoursWkToDtTotal>
  </TCName>
<TCName name="WagesView">
<PlannedWagesColumn>
<![CDATA[ 
select lc.rgn_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_DPBU from 
(select e.rgn_no,e.zone_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no

  ]]> 
  </PlannedWagesColumn>
<PlannedWagesTotal>
<![CDATA[ 
select lc.div_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_TOT_DPBU from 
(select e.div_no,e.rgn_no,e.zone_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no

  ]]> 
  </PlannedWagesTotal>
<PlannedWagesWkToDt>
<![CDATA[ 
select lc.rgn_no,NVL(ROUND(wge.PLN_WAGE_DPBU,0),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no

  ]]> 
  </PlannedWagesWkToDt>
<PlannedWagesWkToDtTotal>
<![CDATA[ 
select lc.div_no,NVL(ROUND(wge.PLN_WAGE_TOT_DPBU,0),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no

  ]]> 
  </PlannedWagesWkToDtTotal>
<ActualWagesColumn>
<![CDATA[ 
select lc.rgn_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_WGE_DTS),0) as ACTL_WGE_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no

  ]]> 
  </ActualWagesColumn>
<ActualWagesTotal>
<![CDATA[ 
select lc.div_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_WGE_DTS),0) as ACTL_WGE_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no

  ]]> 
  </ActualWagesTotal>
<ActualWagesWkToDt>
<![CDATA[ 
select lc.rgn_no,NVL(ROUND(wge.ACTL_WGE_DTSBU,0),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/*UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i*/) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no

  ]]> 
  </ActualWagesWkToDt>
<ActualWagesWkToDtTotal>
<![CDATA[ 
select lc.div_no,NVL(ROUND(wge.ACTL_WGE_TOT_DTSBU,0),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/*UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i*/) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no

  ]]> 
  </ActualWagesWkToDtTotal>
<VarianceWagesColumn>
<![CDATA[ select nyu.rgn_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select lc.rgn_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_WGE_DTS),0) as ACTL_WGE_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) den,
(select lc.rgn_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_DPBU from 
(select e.rgn_no,e.zone_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) nyu
where nyu.rgn_no = den.rgn_no
  ]]> 
  </VarianceWagesColumn>
<VarianceWagesTotal>
<![CDATA[select nyu.div_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select lc.div_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_WGE_DTS),0) as ACTL_WGE_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) den,
(select lc.div_no,
NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_TOT_DPBU from 
(select e.div_no,e.rgn_no,e.zone_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) nyu
where nyu.div_no = den.div_no  
  ]]> 
  </VarianceWagesTotal>
<VarianceWagesWkToDt>
<![CDATA[ select nyu.rgn_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_CPH_DPG from
(select lc.rgn_no,NVL(ROUND(wge.ACTL_WGE_DTSBU,0),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/*UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i*/) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) den,
(select lc.rgn_no,NVL(ROUND(wge.PLN_WAGE_DPBU,0),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) nyu
where nyu.rgn_no= den.rgn_no
  ]]> 
  </VarianceWagesWkToDt>
<VarianceWagesWkToDtTotal>
<![CDATA[ select nyu.div_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_CPH_TOT_DPG from
(select lc.div_no,NVL(ROUND(wge.ACTL_WGE_TOT_DTSBU,0),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/*UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i*/) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) den,
(select lc.div_no,NVL(ROUND(wge.PLN_WAGE_TOT_DPBU,0),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) nyu where nyu.div_no = den.div_no 
  ]]> 
  </VarianceWagesWkToDtTotal>
  </TCName>
<TCName name="WagesPercentageView">
<PlannedWagesPrcntColumn>
<![CDATA[ 
select wge.rgn_no,
case when wge.mon=0 and sls.mon=0 then 0 when wge.mon=0 then 0 when sls.mon=0 then 0 
else NVL(ROUND((wge.mon / sls.mon)*100,2),0) end as Mon,
case when wge.tue=0 and sls.tue=0 then 0 when wge.tue=0 then 0 when sls.tue=0 then 0 
else NVL(ROUND((wge.tue / sls.tue)*100,2),0) end as Tue,
case when wge.wed=0 and sls.wed=0 then 0 when wge.wed=0 then 0 when sls.wed=0 then 0 
else NVL(ROUND((wge.wed / sls.wed)*100,2),0) end as Wed,
case when wge.thu=0 and sls.thu=0 then 0 when wge.thu=0 then 0 when sls.thu=0 then 0 
else NVL(ROUND((wge.thu / sls.thu)*100,2),0) end as Thu,
case when wge.fri=0 and sls.fri=0 then 0 when wge.fri=0 then 0 when sls.fri=0 then 0 
else NVL(ROUND((wge.fri / sls.fri)*100,2),0) end as Fri,
case when wge.sat=0 and sls.sat=0 then 0 when wge.sat=0 then 0 when sls.sat=0 then 0 
else NVL(ROUND((wge.sat / sls.sat)*100,2),0) end as Sat,
case when wge.sun=0 and sls.sun=0 then 0 when wge.sun=0 then 0 when sls.sun=0 then 0 
else NVL(ROUND((wge.sun / sls.sun)*100,2),0) end as Sun from
(select lc.rgn_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_DPBU from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select z.rgn_no,y.Mon,y.Tue,y.Wed,y.Thu,y.Fri,y.Sat,y.Sun,y.wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no) sls 
where wge.rgn_no=sls.rgn_no order by wge.rgn_no

  ]]> 
  </PlannedWagesPrcntColumn>
<PlannedWagesPrcntTotal>
<![CDATA[ 
select wge.div_no,
case when wge.mon=0 and sls.mon=0 then 0 when wge.mon=0 then 0 when sls.mon=0 then 0 
else NVL(ROUND((wge.mon / sls.mon)*100,2),0) end as Mon,
case when wge.tue=0 and sls.tue=0 then 0 when wge.tue=0 then 0 when sls.tue=0 then 0 
else NVL(ROUND((wge.tue / sls.tue)*100,2),0) end as Tue,
case when wge.wed=0 and sls.wed=0 then 0 when wge.wed=0 then 0 when sls.wed=0 then 0 
else NVL(ROUND((wge.wed / sls.wed)*100,2),0) end as Wed,
case when wge.thu=0 and sls.thu=0 then 0 when wge.thu=0 then 0 when sls.thu=0 then 0 
else NVL(ROUND((wge.thu / sls.thu)*100,2),0) end as Thu,
case when wge.fri=0 and sls.fri=0 then 0 when wge.fri=0 then 0 when sls.fri=0 then 0 
else NVL(ROUND((wge.fri / sls.fri)*100,2),0) end as Fri,
case when wge.sat=0 and sls.sat=0 then 0 when wge.sat=0 then 0 when sls.sat=0 then 0 
else NVL(ROUND((wge.sat / sls.sat)*100,2),0) end as Sat,
case when wge.sun=0 and sls.sun=0 then 0 when wge.sun=0 then 0 when sls.sun=0 then 0 
else NVL(ROUND((wge.sun / sls.sun)*100,2),0) end as Sun from
(select lc.div_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_TOT_DPBU from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select z.div_no,y.Mon,y.Tue,y.Wed,y.Thu,y.Fri,y.Sat,y.Sun,y.wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no) sls 
where wge.div_no=sls.div_no order by wge.div_no

  ]]> 
  </PlannedWagesPrcntTotal>
<PlannedWagesPrcntWkToDt>
<![CDATA[ 
select wge.rgn_no,
case when wge.wtd=0 and sls.wtd=0 then 0 when wge.wtd=0 then 0 when sls.wtd=0 then 0 
else NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) end as WTD from
(select lc.rgn_no,wge.PLN_WAGE_DPBU as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no) wge,
(select z.rgn_no,y.Mon,y.Tue,y.Wed,y.Thu,y.Fri,y.Sat,y.Sun,y.wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no) sls 
where wge.rgn_no=sls.rgn_no order by wge.rgn_no

  ]]> 
  </PlannedWagesPrcntWkToDt>
<PlannedWagesPrcntWkToDtTotal>
<![CDATA[ 
select wge.div_no,
case when wge.wtd=0 and sls.wtd=0 then 0 when wge.wtd=0 then 0 when sls.wtd=0 then 0 
else NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) end as WTD from
(select lc.div_no,wge.PLN_WAGE_TOT_DPBU as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no) wge,
(select z.div_no,y.Mon,y.Tue,y.Wed,y.Thu,y.Fri,y.Sat,y.Sun,y.wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no) sls 
where wge.div_no=sls.div_no order by wge.div_no

  ]]> 
  </PlannedWagesPrcntWkToDtTotal>
<ActualWagesPrcntColumn>
<![CDATA[ 
select wge.rgn_no,
case when wge.mon=0 and sls.mon=0 then 0 when wge.mon=0 then 0 when sls.mon=0 then 0 
else NVL(ROUND((wge.mon / sls.mon)*100,2),0) end as Mon,
case when wge.tue=0 and sls.tue=0 then 0 when wge.tue=0 then 0 when sls.tue=0 then 0 
else NVL(ROUND((wge.tue / sls.tue)*100,2),0) end as Tue,
case when wge.wed=0 and sls.wed=0 then 0 when wge.wed=0 then 0 when sls.wed=0 then 0 
else NVL(ROUND((wge.wed / sls.wed)*100,2),0) end as Wed,
case when wge.thu=0 and sls.thu=0 then 0 when wge.thu=0 then 0 when sls.thu=0 then 0 
else NVL(ROUND((wge.thu / sls.thu)*100,2),0) end as Thu,
case when wge.fri=0 and sls.fri=0 then 0 when wge.fri=0 then 0 when sls.fri=0 then 0 
else NVL(ROUND((wge.fri / sls.fri)*100,2),0) end as Fri,
case when wge.sat=0 and sls.sat=0 then 0 when wge.sat=0 then 0 when sls.sat=0 then 0 
else NVL(ROUND((wge.sat / sls.sat)*100,2),0) end as Sat,
case when wge.sun=0 and sls.sun=0 then 0 when wge.sun=0 then 0 when sls.sun=0 then 0 
else NVL(ROUND((wge.sun / sls.sun)*100,2),0) end as Sun from
(select lc.rgn_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no

  ]]> 
  </ActualWagesPrcntColumn>
<ActualWagesPrcntTotal>
<![CDATA[ 
select wge.div_no,
case when wge.mon=0 and sls.mon=0 then 0 when wge.mon=0 then 0 when sls.mon=0 then 0 
else NVL(ROUND((wge.mon / sls.mon)*100,2),0) end as Mon,
case when wge.tue=0 and sls.tue=0 then 0 when wge.tue=0 then 0 when sls.tue=0 then 0 
else NVL(ROUND((wge.tue / sls.tue)*100,2),0) end as Tue,
case when wge.wed=0 and sls.wed=0 then 0 when wge.wed=0 then 0 when sls.wed=0 then 0 
else NVL(ROUND((wge.wed / sls.wed)*100,2),0) end as Wed,
case when wge.thu=0 and sls.thu=0 then 0 when wge.thu=0 then 0 when sls.thu=0 then 0 
else NVL(ROUND((wge.thu / sls.thu)*100,2),0) end as Thu,
case when wge.fri=0 and sls.fri=0 then 0 when wge.fri=0 then 0 when sls.fri=0 then 0 
else NVL(ROUND((wge.fri / sls.fri)*100,2),0) end as Fri,
case when wge.sat=0 and sls.sat=0 then 0 when wge.sat=0 then 0 when sls.sat=0 then 0 
else NVL(ROUND((wge.sat / sls.sat)*100,2),0) end as Sat,
case when wge.sun=0 and sls.sun=0 then 0 when wge.sun=0 then 0 when sls.sun=0 then 0 
else NVL(ROUND((wge.sun / sls.sun)*100,2),0) end as Sun from
(select lc.div_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select lc.div_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no

  ]]> 
  </ActualWagesPrcntTotal>
<ActualWagesPrcntWkToDt>
<![CDATA[ 
select wge.rgn_no,
case when wge.wtd=0 and sls.wtd=0 then 0 when wge.wtd=0 then 0 when sls.wtd=0 then 0 
else NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) end as ACTL_WGE_PCT_DTSBU from 
(select lc.rgn_no,wge.ACTL_WGE_DTSBU as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/*UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i*/) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,sls.wtd as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no

  ]]> 
  </ActualWagesPrcntWkToDt>
<ActualWagesPrcntWkToDtTotal>
<![CDATA[ 
select wge.div_no,
case when wge.wtd=0 and sls.wtd=0 then 0 when wge.wtd=0 then 0 when sls.wtd=0 then 0 
else NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) end as ACTL_WGE_PCT_TOT_DTSBU from 
(select lc.div_no,wge.ACTL_WGE_TOT_DTSBU as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/*UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i*/) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select lc.div_no,sls.wtd as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no
  ]]> 
  </ActualWagesPrcntWkToDtTotal>
<VarianceWagesPrcntColumn>
<![CDATA[ select nyu.rgn_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select wge.rgn_no,
case when wge.mon=0 and sls.mon=0 then 0 when wge.mon=0 then 0 when sls.mon=0 then 0 
else NVL(ROUND((wge.mon / sls.mon)*100,2),0) end as Mon,
case when wge.tue=0 and sls.tue=0 then 0 when wge.tue=0 then 0 when sls.tue=0 then 0 
else NVL(ROUND((wge.tue / sls.tue)*100,2),0) end as Tue,
case when wge.wed=0 and sls.wed=0 then 0 when wge.wed=0 then 0 when sls.wed=0 then 0 
else NVL(ROUND((wge.wed / sls.wed)*100,2),0) end as Wed,
case when wge.thu=0 and sls.thu=0 then 0 when wge.thu=0 then 0 when sls.thu=0 then 0 
else NVL(ROUND((wge.thu / sls.thu)*100,2),0) end as Thu,
case when wge.fri=0 and sls.fri=0 then 0 when wge.fri=0 then 0 when sls.fri=0 then 0 
else NVL(ROUND((wge.fri / sls.fri)*100,2),0) end as Fri,
case when wge.sat=0 and sls.sat=0 then 0 when wge.sat=0 then 0 when sls.sat=0 then 0 
else NVL(ROUND((wge.sat / sls.sat)*100,2),0) end as Sat,
case when wge.sun=0 and sls.sun=0 then 0 when wge.sun=0 then 0 when sls.sun=0 then 0 
else NVL(ROUND((wge.sun / sls.sun)*100,2),0) end as Sun from
(select lc.rgn_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no) den,
(select wge.rgn_no,
case when wge.mon=0 and sls.mon=0 then 0 when wge.mon=0 then 0 when sls.mon=0 then 0 
else NVL(ROUND((wge.mon / sls.mon)*100,2),0) end as Mon,
case when wge.tue=0 and sls.tue=0 then 0 when wge.tue=0 then 0 when sls.tue=0 then 0 
else NVL(ROUND((wge.tue / sls.tue)*100,2),0) end as Tue,
case when wge.wed=0 and sls.wed=0 then 0 when wge.wed=0 then 0 when sls.wed=0 then 0 
else NVL(ROUND((wge.wed / sls.wed)*100,2),0) end as Wed,
case when wge.thu=0 and sls.thu=0 then 0 when wge.thu=0 then 0 when sls.thu=0 then 0 
else NVL(ROUND((wge.thu / sls.thu)*100,2),0) end as Thu,
case when wge.fri=0 and sls.fri=0 then 0 when wge.fri=0 then 0 when sls.fri=0 then 0 
else NVL(ROUND((wge.fri / sls.fri)*100,2),0) end as Fri,
case when wge.sat=0 and sls.sat=0 then 0 when wge.sat=0 then 0 when sls.sat=0 then 0 
else NVL(ROUND((wge.sat / sls.sat)*100,2),0) end as Sat,
case when wge.sun=0 and sls.sun=0 then 0 when wge.sun=0 then 0 when sls.sun=0 then 0 
else NVL(ROUND((wge.sun / sls.sun)*100,2),0) end as Sun from
(select lc.rgn_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_DPBU from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select z.rgn_no,y.Mon,y.Tue,y.Wed,y.Thu,y.Fri,y.Sat,y.Sun,y.wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no) sls 
where wge.rgn_no=sls.rgn_no order by wge.rgn_no) nyu
where nyu.rgn_no = den.rgn_no
  ]]> 
  </VarianceWagesPrcntColumn>
<VarianceWagesPrcntTotal>
<![CDATA[select nyu.div_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select wge.div_no,
case when wge.mon=0 and sls.mon=0 then 0 when wge.mon=0 then 0 when sls.mon=0 then 0 
else NVL(ROUND((wge.mon / sls.mon)*100,2),0) end as Mon,
case when wge.tue=0 and sls.tue=0 then 0 when wge.tue=0 then 0 when sls.tue=0 then 0 
else NVL(ROUND((wge.tue / sls.tue)*100,2),0) end as Tue,
case when wge.wed=0 and sls.wed=0 then 0 when wge.wed=0 then 0 when sls.wed=0 then 0 
else NVL(ROUND((wge.wed / sls.wed)*100,2),0) end as Wed,
case when wge.thu=0 and sls.thu=0 then 0 when wge.thu=0 then 0 when sls.thu=0 then 0 
else NVL(ROUND((wge.thu / sls.thu)*100,2),0) end as Thu,
case when wge.fri=0 and sls.fri=0 then 0 when wge.fri=0 then 0 when sls.fri=0 then 0 
else NVL(ROUND((wge.fri / sls.fri)*100,2),0) end as Fri,
case when wge.sat=0 and sls.sat=0 then 0 when wge.sat=0 then 0 when sls.sat=0 then 0 
else NVL(ROUND((wge.sat / sls.sat)*100,2),0) end as Sat,
case when wge.sun=0 and sls.sun=0 then 0 when wge.sun=0 then 0 when sls.sun=0 then 0 
else NVL(ROUND((wge.sun / sls.sun)*100,2),0) end as Sun from
(select lc.div_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select lc.div_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no) den,
(select wge.div_no,
case when wge.mon=0 and sls.mon=0 then 0 when wge.mon=0 then 0 when sls.mon=0 then 0 
else NVL(ROUND((wge.mon / sls.mon)*100,2),0) end as Mon,
case when wge.tue=0 and sls.tue=0 then 0 when wge.tue=0 then 0 when sls.tue=0 then 0 
else NVL(ROUND((wge.tue / sls.tue)*100,2),0) end as Tue,
case when wge.wed=0 and sls.wed=0 then 0 when wge.wed=0 then 0 when sls.wed=0 then 0 
else NVL(ROUND((wge.wed / sls.wed)*100,2),0) end as Wed,
case when wge.thu=0 and sls.thu=0 then 0 when wge.thu=0 then 0 when sls.thu=0 then 0 
else NVL(ROUND((wge.thu / sls.thu)*100,2),0) end as Thu,
case when wge.fri=0 and sls.fri=0 then 0 when wge.fri=0 then 0 when sls.fri=0 then 0 
else NVL(ROUND((wge.fri / sls.fri)*100,2),0) end as Fri,
case when wge.sat=0 and sls.sat=0 then 0 when wge.sat=0 then 0 when sls.sat=0 then 0 
else NVL(ROUND((wge.sat / sls.sat)*100,2),0) end as Sat,
case when wge.sun=0 and sls.sun=0 then 0 when wge.sun=0 then 0 when sls.sun=0 then 0 
else NVL(ROUND((wge.sun / sls.sun)*100,2),0) end as Sun from
(select lc.div_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_TOT_DPBU from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select z.div_no,y.Mon,y.Tue,y.Wed,y.Thu,y.Fri,y.Sat,y.Sun,y.wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no) sls 
where wge.div_no=sls.div_no order by wge.div_no) nyu
where nyu.div_no = den.div_no  
  ]]> 
  </VarianceWagesPrcntTotal>
<VarianceWagesPrcntWkToDt>
<![CDATA[select nyu.rgn_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as WTD from
(select wge.rgn_no,
case when wge.wtd=0 and sls.wtd=0 then 0 when wge.wtd=0 then 0 when sls.wtd=0 then 0 
else NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) end as WTD from 
(select lc.rgn_no,wge.ACTL_WGE_DTSBU as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/*UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i*/) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,sls.wtd as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no) den,
(select wge.rgn_no,
case when wge.wtd=0 and sls.wtd=0 then 0 when wge.wtd=0 then 0 when sls.wtd=0 then 0 
else NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) end as WTD from
(select lc.rgn_no,wge.PLN_WAGE_DPBU as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no) wge,
(select z.rgn_no,y.Mon,y.Tue,y.Wed,y.Thu,y.Fri,y.Sat,y.Sun,y.wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no) sls 
where wge.rgn_no=sls.rgn_no order by wge.rgn_no) nyu
where nyu.rgn_no= den.rgn_no
  ]]> 
  </VarianceWagesPrcntWkToDt>
<VarianceWagesPrcntWkToDtTotal>
<![CDATA[ select nyu.div_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as WTD from
(select wge.div_no,
case when wge.wtd=0 and sls.wtd=0 then 0 when wge.wtd=0 then 0 when sls.wtd=0 then 0 
else NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) end as WTD from 
(select lc.div_no,wge.ACTL_WGE_TOT_DTSBU as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/*UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i*/) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select lc.div_no,sls.wtd as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no) den,
(select wge.div_no,
case when wge.wtd=0 and sls.wtd=0 then 0 when wge.wtd=0 then 0 when sls.wtd=0 then 0 
else NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) end as WTD from
(select lc.div_no,wge.PLN_WAGE_TOT_DPBU as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no) wge,
(select z.div_no,y.Mon,y.Tue,y.Wed,y.Thu,y.Fri,y.Sat,y.Sun,y.wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no) sls 
where wge.div_no=sls.div_no order by wge.div_no) nyu where nyu.div_no = den.div_no 
  ]]> 
  </VarianceWagesPrcntWkToDtTotal>
  </TCName>
<TCName name="ORPercentageView">
<PlannedORPrcntColumn>
<![CDATA[ 
select sms_hrs.rgn_no,
case when sms_hrs.mon=0 and pln_hrs.mon=0 then 0 when sms_hrs.mon=0 then 0 when pln_hrs.mon=0 then 0 
else NVL(ROUND((sms_hrs.mon / pln_hrs.mon)*100,1),0) end as Mon,
case when sms_hrs.tue=0 and pln_hrs.tue=0 then 0 when sms_hrs.tue=0 then 0 when pln_hrs.tue=0 then 0 
else NVL(ROUND((sms_hrs.tue / pln_hrs.tue)*100,1),0) end as Tue,
case when sms_hrs.wed=0 and pln_hrs.wed=0 then 0 when sms_hrs.wed=0 then 0 when pln_hrs.wed=0 then 0 
else NVL(ROUND((sms_hrs.wed / pln_hrs.wed)*100,1),0) end as Wed,
case when sms_hrs.thu=0 and pln_hrs.thu=0 then 0 when sms_hrs.thu=0 then 0 when pln_hrs.thu=0 then 0 
else NVL(ROUND((sms_hrs.Thu / pln_hrs.Thu)*100,1),0) end as Thu,
case when sms_hrs.fri=0 and pln_hrs.fri=0 then 0 when sms_hrs.fri=0 then 0 when pln_hrs.fri=0 then 0 
else NVL(ROUND((sms_hrs.fri / pln_hrs.fri)*100,1),0) end as Fri,
case when sms_hrs.sat=0 and pln_hrs.sat=0 then 0 when sms_hrs.sat=0 then 0 when pln_hrs.sat=0 then 0 
else NVL(ROUND((sms_hrs.sat / pln_hrs.sat)*100,1),0) end as Sat,
case when sms_hrs.sun=0 and pln_hrs.sun=0 then 0 when sms_hrs.sun=0 then 0 when pln_hrs.sun=0 then 0 
else NVL(ROUND((sms_hrs.sun / pln_hrs.sun)*100,1),0) end as Sun from  
(select lc.rgn_no,sms.mon,sms.tue,sms.wed,sms.thu,sms.fri,sms.sat,sms.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DPBU from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division'  and tsk.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z ) sms
on sms.rgn_no=lc.rgn_no) sms_hrs,
(select lc.rgn_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_HRS_DTS) as PLN_HRS_DPBU from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no) pln_hrs 
where sms_hrs.rgn_no=pln_hrs.rgn_no order by sms_hrs.rgn_no

  ]]> 
  </PlannedORPrcntColumn>
<PlannedORPrcntTotal>
<![CDATA[ 
select sms_hrs.div_no,
case when sms_hrs.mon=0 and pln_hrs.mon=0 then 0 when sms_hrs.mon=0 then 0 when pln_hrs.mon=0 then 0 
else NVL(ROUND((sms_hrs.mon / pln_hrs.mon)*100,1),0) end as Mon,
case when sms_hrs.tue=0 and pln_hrs.tue=0 then 0 when sms_hrs.tue=0 then 0 when pln_hrs.tue=0 then 0 
else NVL(ROUND((sms_hrs.tue / pln_hrs.tue)*100,1),0) end as Tue,
case when sms_hrs.wed=0 and pln_hrs.wed=0 then 0 when sms_hrs.wed=0 then 0 when pln_hrs.wed=0 then 0 
else NVL(ROUND((sms_hrs.wed / pln_hrs.wed)*100,1),0) end as Wed,
case when sms_hrs.thu=0 and pln_hrs.thu=0 then 0 when sms_hrs.thu=0 then 0 when pln_hrs.thu=0 then 0 
else NVL(ROUND((sms_hrs.Thu / pln_hrs.Thu)*100,1),0) end as Thu,
case when sms_hrs.fri=0 and pln_hrs.fri=0 then 0 when sms_hrs.fri=0 then 0 when pln_hrs.fri=0 then 0 
else NVL(ROUND((sms_hrs.fri / pln_hrs.fri)*100,1),0) end as Fri,
case when sms_hrs.sat=0 and pln_hrs.sat=0 then 0 when sms_hrs.sat=0 then 0 when pln_hrs.sat=0 then 0 
else NVL(ROUND((sms_hrs.sat / pln_hrs.sat)*100,1),0) end as Sat,
case when sms_hrs.sun=0 and pln_hrs.sun=0 then 0 when sms_hrs.sun=0 then 0 when pln_hrs.sun=0 then 0 
else NVL(ROUND((sms_hrs.sun / pln_hrs.sun)*100,1),0) end as Sun from 
(select lc.div_no,sms.mon,sms.tue,sms.wed,sms.thu,sms.fri,sms.sat,sms.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_TOT_DPBU from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division'  and tsk.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z ) sms
on sms.div_no=lc.div_no) sms_hrs,
(select lc.div_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_HRS_DTS) as PLN_HRS_TOT_DPBU from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no) pln_hrs 
where sms_hrs.div_no=pln_hrs.div_no order by sms_hrs.div_no

  ]]> 
  </PlannedORPrcntTotal>
<PlannedORPrcntWkToDt>
<![CDATA[ 
select sms_hrs.rgn_no,
case when sms_hrs.wtd=0 and pln_hrs.wtd=0 then 0 when sms_hrs.wtd=0 then 0 when pln_hrs.wtd=0 then 0 
else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end as WTD from  
(select lc.rgn_no,sms.wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sms
on sms.rgn_no=lc.rgn_no) sms_hrs,
(select lc.rgn_no,sum(wge.PLN_HOURS_DPBU) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm order by e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq) wge
on wge.rgn_no=lc.rgn_no group by lc.rgn_no order by lc.rgn_no) pln_hrs 
where sms_hrs.rgn_no=pln_hrs.rgn_no

  ]]> 
  </PlannedORPrcntWkToDt>
<PlannedORPrcntWkToDtTotal>
<![CDATA[ 
select sms_hrs.div_no,
case when sms_hrs.wtd=0 and pln_hrs.wtd=0 then 0 when sms_hrs.wtd=0 then 0 when pln_hrs.wtd=0 then 0 
else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end as WTD from  
(select lc.div_no,sms.wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_TOT_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z ) sms
on sms.div_no=lc.div_no) sms_hrs,
(select lc.div_no,sum(wge.PLN_HOURS_TOT_DPBU) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq) wge
on wge.div_no=lc.div_no group by lc.div_no order by lc.div_no) pln_hrs 
where sms_hrs.div_no=pln_hrs.div_no
  ]]> 
  </PlannedORPrcntWkToDtTotal>
<ActualORPrcntColumn>
<![CDATA[ 
select sms.rgn_no,
case when NVL(sms.mon,0)=0 and NVL(krn.mon,0)=0 then 0 when NVL(sms.mon,0)=0 then 0 when NVL(krn.mon,0)=0 then 0
else ROUND((sms.mon / krn.mon)*100,1) end as MON,
case when NVL(sms.tue,0)=0 and NVL(krn.tue,0)=0 then 0 when NVL(sms.tue,0)=0 then 0 when NVL(krn.tue,0)=0 then 0
else ROUND((sms.tue / krn.tue)*100,1) end as TUE,
case when NVL(sms.wed,0)=0 and NVL(krn.wed,0)=0 then 0 when NVL(sms.wed,0)=0 then 0 when NVL(krn.wed,0)=0 then 0
else ROUND((sms.wed / krn.wed)*100,1) end as WED,
case when NVL(sms.thu,0)=0 and NVL(krn.thu,0)=0 then 0 when NVL(sms.thu,0)=0 then 0 when NVL(krn.thu,0)=0 then 0
else ROUND((sms.thu / krn.thu)*100,1) end as THU,
case when NVL(sms.fri,0)=0 and NVL(krn.fri,0)=0 then 0 when NVL(sms.fri,0)=0 then 0 when NVL(krn.fri,0)=0 then 0
else ROUND((sms.fri / krn.fri)*100,1) end as FRI,
case when NVL(sms.sat,0)=0 and NVL(krn.sat,0)=0 then 0 when NVL(sms.sat,0)=0 then 0 when NVL(krn.sat,0)=0 then 0
else ROUND((sms.sat / krn.sat)*100,1) end as SAT,
case when NVL(sms.sun,0)=0 and NVL(krn.sun,0)=0 then 0 when NVL(sms.sun,0)=0 then 0 when NVL(krn.sun,0)=0 then 0
else ROUND((sms.sun / krn.sun)*100,1) end as SUN from 
(select lc.rgn_no,
NVL(xy.Monday,0) as mon,NVL(xy.Tuesday,0) as tue,NVL(xy.Wednesday,0) as wed,NVL(xy.Thursday,0) as thu,
NVL(xy.Friday,0) as fri,NVL(xy.Saturday,0) as sat,NVL(xy.Sunday,0) as sun from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select rgn_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSBU )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSBU )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSBU )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSBU )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSBU )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSBU )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSBU )),0) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no NOT IN (20,85)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
/*UNION 
select * from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no)*/) xyz 
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no) sms,
(select lc.rgn_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSR)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_DTSR from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) krn
where sms.rgn_no=krn.rgn_no

  ]]> 
  </ActualORPrcntColumn>
<ActualORPrcntTotal>
<![CDATA[ 
select sms.div_no,
case when NVL(sms.mon,0)=0 and NVL(krn.mon,0)=0 then 0 when NVL(sms.mon,0)=0 then 0 when NVL(krn.mon,0)=0 then 0
else ROUND((sms.mon / krn.mon)*100,1) end as MON,
case when NVL(sms.tue,0)=0 and NVL(krn.tue,0)=0 then 0 when NVL(sms.tue,0)=0 then 0 when NVL(krn.tue,0)=0 then 0
else ROUND((sms.tue / krn.tue)*100,1) end as TUE,
case when NVL(sms.wed,0)=0 and NVL(krn.wed,0)=0 then 0 when NVL(sms.wed,0)=0 then 0 when NVL(krn.wed,0)=0 then 0
else ROUND((sms.wed / krn.wed)*100,1) end as WED,
case when NVL(sms.thu,0)=0 and NVL(krn.thu,0)=0 then 0 when NVL(sms.thu,0)=0 then 0 when NVL(krn.thu,0)=0 then 0
else ROUND((sms.thu / krn.thu)*100,1) end as THU,
case when NVL(sms.fri,0)=0 and NVL(krn.fri,0)=0 then 0 when NVL(sms.fri,0)=0 then 0 when NVL(krn.fri,0)=0 then 0
else ROUND((sms.fri / krn.fri)*100,1) end as FRI,
case when NVL(sms.sat,0)=0 and NVL(krn.sat,0)=0 then 0 when NVL(sms.sat,0)=0 then 0 when NVL(krn.sat,0)=0 then 0
else ROUND((sms.sat / krn.sat)*100,1) end as SAT,
case when NVL(sms.sun,0)=0 and NVL(krn.sun,0)=0 then 0 when NVL(sms.sun,0)=0 then 0 when NVL(krn.sun,0)=0 then 0
else ROUND((sms.sun / krn.sun)*100,1) end as SUN from 
(select lc.div_no,
NVL(xy.Monday,0) as mon,NVL(xy.Tuesday,0) as tue,NVL(xy.Wednesday,0) as wed,NVL(xy.Thursday,0) as thu,
NVL(xy.Friday,0) as fri,NVL(xy.Saturday,0) as sat,NVL(xy.Sunday,0) as sun from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select div_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSBU )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSBU )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSBU )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSBU )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSBU )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSBU )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSBU )),0) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,
A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no NOT IN (20,85)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
/*UNION 
select * from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,85)
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,
A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no)*/) xyz 
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no) sms,
(select lc.div_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) krn
where sms.div_no=krn.div_no

  ]]> 
  </ActualORPrcntTotal>
<ActualORPrcntWkToDt>
<![CDATA[ 
select sms.rgn_no,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as WTD from 
(select lc.rgn_no,NVL(xy.ACTL_SMS_DTSBU,0) as wtd from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select rgn_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no NOT IN (20,85)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
/*UNION
select * from 
(select h.rgn_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,85)
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no order by h.rgn_no)*/) xyz
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no) sms,
(select lc.rgn_no,NVL(ROUND(wge.ACTL_HRS_DTSBU,2),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/*UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i*/) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) krn
where sms.rgn_no=krn.rgn_no

  ]]> 
  </ActualORPrcntWkToDt>
<ActualORPrcntWkToDtTotal>
<![CDATA[ 
select sms.div_no,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as WTD from 
(select lc.div_no,NVL(xy.ACTL_SMS_DTSBU,0) as wtd from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select div_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no NOT IN (20,85)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
/*UNION
select * from 
(select h.div_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,85)
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no order by h.div_no)*/) xyz
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no) sms,
(select lc.div_no,NVL(ROUND(wge.ACTL_HRS_TOT_DTSBU,2),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/*UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i*/) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) krn
where sms.div_no=krn.div_no

  ]]> 
  </ActualORPrcntWkToDtTotal>
<PlannedORPrcntColumnPayPlan>
<![CDATA[ 
select sms_hrs.rgn_no,
case when sms_hrs.mon=0 and pln_hrs.mon=0 then 0 when sms_hrs.mon=0 then 0 when pln_hrs.mon=0 then 0 
else NVL(ROUND((sms_hrs.mon / pln_hrs.mon)*100,1),0) end as Mon,
case when sms_hrs.tue=0 and pln_hrs.tue=0 then 0 when sms_hrs.tue=0 then 0 when pln_hrs.tue=0 then 0 
else NVL(ROUND((sms_hrs.tue / pln_hrs.tue)*100,1),0) end as Tue,
case when sms_hrs.wed=0 and pln_hrs.wed=0 then 0 when sms_hrs.wed=0 then 0 when pln_hrs.wed=0 then 0 
else NVL(ROUND((sms_hrs.wed / pln_hrs.wed)*100,1),0) end as Wed,
case when sms_hrs.thu=0 and pln_hrs.thu=0 then 0 when sms_hrs.thu=0 then 0 when pln_hrs.thu=0 then 0 
else NVL(ROUND((sms_hrs.Thu / pln_hrs.Thu)*100,1),0) end as Thu,
case when sms_hrs.fri=0 and pln_hrs.fri=0 then 0 when sms_hrs.fri=0 then 0 when pln_hrs.fri=0 then 0 
else NVL(ROUND((sms_hrs.fri / pln_hrs.fri)*100,1),0) end as Fri,
case when sms_hrs.sat=0 and pln_hrs.sat=0 then 0 when sms_hrs.sat=0 then 0 when pln_hrs.sat=0 then 0 
else NVL(ROUND((sms_hrs.sat / pln_hrs.sat)*100,1),0) end as Sat,
case when sms_hrs.sun=0 and pln_hrs.sun=0 then 0 when sms_hrs.sun=0 then 0 when pln_hrs.sun=0 then 0 
else NVL(ROUND((sms_hrs.sun / pln_hrs.sun)*100,1),0) end as Sun from 
(select lc.rgn_no,sms.mon,sms.tue,sms.wed,sms.thu,sms.fri,sms.sat,sms.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DPBU from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division'  and tsk.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z ) sms
on sms.rgn_no=lc.rgn_no) sms_hrs,
(select lc.rgn_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_HRS_DTS) as PLN_HRS_DPBU from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no) pln_hrs 
where sms_hrs.rgn_no=pln_hrs.rgn_no order by sms_hrs.rgn_no

  ]]> 
  </PlannedORPrcntColumnPayPlan>
<PlannedORPrcntTotalPayPlan>
<![CDATA[ 
select sms_hrs.div_no,
case when sms_hrs.mon=0 and pln_hrs.mon=0 then 0 when sms_hrs.mon=0 then 0 when pln_hrs.mon=0 then 0 
else NVL(ROUND((sms_hrs.mon / pln_hrs.mon)*100,1),0) end as Mon,
case when sms_hrs.tue=0 and pln_hrs.tue=0 then 0 when sms_hrs.tue=0 then 0 when pln_hrs.tue=0 then 0 
else NVL(ROUND((sms_hrs.tue / pln_hrs.tue)*100,1),0) end as Tue,
case when sms_hrs.wed=0 and pln_hrs.wed=0 then 0 when sms_hrs.wed=0 then 0 when pln_hrs.wed=0 then 0 
else NVL(ROUND((sms_hrs.wed / pln_hrs.wed)*100,1),0) end as Wed,
case when sms_hrs.thu=0 and pln_hrs.thu=0 then 0 when sms_hrs.thu=0 then 0 when pln_hrs.thu=0 then 0 
else NVL(ROUND((sms_hrs.Thu / pln_hrs.Thu)*100,1),0) end as Thu,
case when sms_hrs.fri=0 and pln_hrs.fri=0 then 0 when sms_hrs.fri=0 then 0 when pln_hrs.fri=0 then 0 
else NVL(ROUND((sms_hrs.fri / pln_hrs.fri)*100,1),0) end as Fri,
case when sms_hrs.sat=0 and pln_hrs.sat=0 then 0 when sms_hrs.sat=0 then 0 when pln_hrs.sat=0 then 0 
else NVL(ROUND((sms_hrs.sat / pln_hrs.sat)*100,1),0) end as Sat,
case when sms_hrs.sun=0 and pln_hrs.sun=0 then 0 when sms_hrs.sun=0 then 0 when pln_hrs.sun=0 then 0 
else NVL(ROUND((sms_hrs.sun / pln_hrs.sun)*100,1),0) end as Sun from  
(select lc.div_no,sms.mon,sms.tue,sms.wed,sms.thu,sms.fri,sms.sat,sms.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_TOT_DPBU from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division'  and tsk.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z ) sms
on sms.div_no=lc.div_no) sms_hrs,
(select lc.div_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_HRS_DTS) as PLN_HRS_TOT_DPBU from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no) pln_hrs 
where sms_hrs.div_no=pln_hrs.div_no order by sms_hrs.div_no

  ]]> 
  </PlannedORPrcntTotalPayPlan>
<PlannedORPrcntWkToDtPayPlan>
<![CDATA[ 
select sms_hrs.rgn_no,
case when sms_hrs.wtd=0 and pln_hrs.wtd=0 then 0 when sms_hrs.wtd=0 then 0 when pln_hrs.wtd=0 then 0 
else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end as WTD from  
(select lc.rgn_no,sms.wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DPBU from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division'  and tsk.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and sysdate-1
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z ) sms
on sms.rgn_no=lc.rgn_no) sms_hrs,
(select lc.rgn_no,sum(wge.PLN_HOURS_DPBU) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm order by e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq) wge
on wge.rgn_no=lc.rgn_no group by lc.rgn_no order by lc.rgn_no) pln_hrs 
where sms_hrs.rgn_no=pln_hrs.rgn_no

  ]]> 
  </PlannedORPrcntWkToDtPayPlan>
<PlannedORPrcntWkToDtTotalPayPlan>
<![CDATA[ 
select sms_hrs.div_no,
case when sms_hrs.wtd=0 and pln_hrs.wtd=0 then 0 when sms_hrs.wtd=0 then 0 when pln_hrs.wtd=0 then 0 
else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end as WTD from  
(select lc.div_no,sms.wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_TOT_DPBU from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division'  and tsk.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and sysdate-1
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z ) sms
on sms.div_no=lc.div_no) sms_hrs,
(select lc.div_no,sum(wge.PLN_HOURS_TOT_DPBU) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq) wge
on wge.div_no=lc.div_no group by lc.div_no order by lc.div_no) pln_hrs 
where sms_hrs.div_no=pln_hrs.div_no

  ]]> 
  </PlannedORPrcntWkToDtTotalPayPlan>
<ActualORPrcntColumnPayPlan>
<![CDATA[ 
select sms.rgn_no,
case when NVL(sms.mon,0)=0 and NVL(krn.mon,0)=0 then 0 when NVL(sms.mon,0)=0 then 0 when NVL(krn.mon,0)=0 then 0
else ROUND((sms.mon / krn.mon)*100,1) end as MON,
case when NVL(sms.tue,0)=0 and NVL(krn.tue,0)=0 then 0 when NVL(sms.tue,0)=0 then 0 when NVL(krn.tue,0)=0 then 0
else ROUND((sms.tue / krn.tue)*100,1) end as TUE,
case when NVL(sms.wed,0)=0 and NVL(krn.wed,0)=0 then 0 when NVL(sms.wed,0)=0 then 0 when NVL(krn.wed,0)=0 then 0
else ROUND((sms.wed / krn.wed)*100,1) end as WED,
case when NVL(sms.thu,0)=0 and NVL(krn.thu,0)=0 then 0 when NVL(sms.thu,0)=0 then 0 when NVL(krn.thu,0)=0 then 0
else ROUND((sms.thu / krn.thu)*100,1) end as THU,
case when NVL(sms.fri,0)=0 and NVL(krn.fri,0)=0 then 0 when NVL(sms.fri,0)=0 then 0 when NVL(krn.fri,0)=0 then 0
else ROUND((sms.fri / krn.fri)*100,1) end as FRI,
case when NVL(sms.sat,0)=0 and NVL(krn.sat,0)=0 then 0 when NVL(sms.sat,0)=0 then 0 when NVL(krn.sat,0)=0 then 0
else ROUND((sms.sat / krn.sat)*100,1) end as SAT,
case when NVL(sms.sun,0)=0 and NVL(krn.sun,0)=0 then 0 when NVL(sms.sun,0)=0 then 0 when NVL(krn.sun,0)=0 then 0
else ROUND((sms.sun / krn.sun)*100,1) end as SUN from 
(select lc.rgn_no,
NVL(xy.Monday,0) as mon,NVL(xy.Tuesday,0) as tue,NVL(xy.Wednesday,0) as wed,NVL(xy.Thursday,0) as thu,
NVL(xy.Friday,0) as fri,NVL(xy.Saturday,0) as sat,NVL(xy.Sunday,0) as sun from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select rgn_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSBU )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSBU )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSBU )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSBU )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSBU )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSBU )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSBU )),0) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no NOT IN (20,85)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
/*UNION 
select * from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no)*/) xyz 
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no) sms,
(select lc.rgn_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSR)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_DTSR from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) krn
where sms.rgn_no=krn.rgn_no

  ]]> 
  </ActualORPrcntColumnPayPlan>
<ActualORPrcntTotalPayPlan>
<![CDATA[ 
select sms.div_no,
case when NVL(sms.mon,0)=0 and NVL(krn.mon,0)=0 then 0 when NVL(sms.mon,0)=0 then 0 when NVL(krn.mon,0)=0 then 0
else ROUND((sms.mon / krn.mon)*100,1) end as MON,
case when NVL(sms.tue,0)=0 and NVL(krn.tue,0)=0 then 0 when NVL(sms.tue,0)=0 then 0 when NVL(krn.tue,0)=0 then 0
else ROUND((sms.tue / krn.tue)*100,1) end as TUE,
case when NVL(sms.wed,0)=0 and NVL(krn.wed,0)=0 then 0 when NVL(sms.wed,0)=0 then 0 when NVL(krn.wed,0)=0 then 0
else ROUND((sms.wed / krn.wed)*100,1) end as WED,
case when NVL(sms.thu,0)=0 and NVL(krn.thu,0)=0 then 0 when NVL(sms.thu,0)=0 then 0 when NVL(krn.thu,0)=0 then 0
else ROUND((sms.thu / krn.thu)*100,1) end as THU,
case when NVL(sms.fri,0)=0 and NVL(krn.fri,0)=0 then 0 when NVL(sms.fri,0)=0 then 0 when NVL(krn.fri,0)=0 then 0
else ROUND((sms.fri / krn.fri)*100,1) end as FRI,
case when NVL(sms.sat,0)=0 and NVL(krn.sat,0)=0 then 0 when NVL(sms.sat,0)=0 then 0 when NVL(krn.sat,0)=0 then 0
else ROUND((sms.sat / krn.sat)*100,1) end as SAT,
case when NVL(sms.sun,0)=0 and NVL(krn.sun,0)=0 then 0 when NVL(sms.sun,0)=0 then 0 when NVL(krn.sun,0)=0 then 0
else ROUND((sms.sun / krn.sun)*100,1) end as SUN from 
(select lc.div_no,
NVL(xy.Monday,0) as mon,NVL(xy.Tuesday,0) as tue,NVL(xy.Wednesday,0) as wed,NVL(xy.Thursday,0) as thu,
NVL(xy.Friday,0) as fri,NVL(xy.Saturday,0) as sat,NVL(xy.Sunday,0) as sun from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select div_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSBU )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSBU )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSBU )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSBU )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSBU )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSBU )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSBU )),0) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,
A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no NOT IN (20,85)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
/*UNION 
select * from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,85)
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,
A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no)*/) xyz 
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no) sms,
(select lc.div_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) krn
where sms.div_no=krn.div_no

  ]]> 
  </ActualORPrcntTotalPayPlan>
<ActualORPrcntWkToDtPayPlan>
<![CDATA[ 
select sms.rgn_no,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as WTD from 
(select lc.rgn_no,NVL(xy.ACTL_SMS_DTSBU,0) as wtd from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select rgn_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no NOT IN (20,85)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
/*UNION
select * from 
(select h.rgn_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,85)
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no order by h.rgn_no)*/) xyz
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no) sms,
(select lc.rgn_no,NVL(ROUND(wge.ACTL_HRS_DTSBU,2),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/*UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i*/) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) krn
where sms.rgn_no=krn.rgn_no

  ]]> 
  </ActualORPrcntWkToDtPayPlan>
<ActualORPrcntWkToDtTotalPayPlan>
<![CDATA[ 
select sms.div_no,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as WTD from 
(select lc.div_no,NVL(xy.ACTL_SMS_DTSBU,0) as wtd from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select div_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no NOT IN (20,85)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
/*UNION
select * from 
(select h.div_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,85)
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no order by h.div_no)*/) xyz
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no) sms,
(select lc.div_no,NVL(ROUND(wge.ACTL_HRS_TOT_DTSBU,2),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/*UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_adj_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i*/) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) krn
where sms.div_no=krn.div_no

  ]]> 
  </ActualORPrcntWkToDtTotalPayPlan>
<VarianceORPrcntColumn>
<![CDATA[ select nyu.rgn_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select sms.rgn_no,
case when NVL(sms.mon,0)=0 and NVL(krn.mon,0)=0 then 0 when NVL(sms.mon,0)=0 then 0 when NVL(krn.mon,0)=0 then 0
else ROUND((sms.mon / krn.mon)*100,1) end as MON,
case when NVL(sms.tue,0)=0 and NVL(krn.tue,0)=0 then 0 when NVL(sms.tue,0)=0 then 0 when NVL(krn.tue,0)=0 then 0
else ROUND((sms.tue / krn.tue)*100,1) end as TUE,
case when NVL(sms.wed,0)=0 and NVL(krn.wed,0)=0 then 0 when NVL(sms.wed,0)=0 then 0 when NVL(krn.wed,0)=0 then 0
else ROUND((sms.wed / krn.wed)*100,1) end as WED,
case when NVL(sms.thu,0)=0 and NVL(krn.thu,0)=0 then 0 when NVL(sms.thu,0)=0 then 0 when NVL(krn.thu,0)=0 then 0
else ROUND((sms.thu / krn.thu)*100,1) end as THU,
case when NVL(sms.fri,0)=0 and NVL(krn.fri,0)=0 then 0 when NVL(sms.fri,0)=0 then 0 when NVL(krn.fri,0)=0 then 0
else ROUND((sms.fri / krn.fri)*100,1) end as FRI,
case when NVL(sms.sat,0)=0 and NVL(krn.sat,0)=0 then 0 when NVL(sms.sat,0)=0 then 0 when NVL(krn.sat,0)=0 then 0
else ROUND((sms.sat / krn.sat)*100,1) end as SAT,
case when NVL(sms.sun,0)=0 and NVL(krn.sun,0)=0 then 0 when NVL(sms.sun,0)=0 then 0 when NVL(krn.sun,0)=0 then 0
else ROUND((sms.sun / krn.sun)*100,1) end as SUN from 
(select lc.rgn_no,
NVL(xy.Monday,0) as mon,NVL(xy.Tuesday,0) as tue,NVL(xy.Wednesday,0) as wed,NVL(xy.Thursday,0) as thu,
NVL(xy.Friday,0) as fri,NVL(xy.Saturday,0) as sat,NVL(xy.Sunday,0) as sun from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select rgn_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSBU )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSBU )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSBU )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSBU )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSBU )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSBU )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSBU )),0) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no NOT IN (20,85)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
/*UNION 
select * from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no)*/) xyz 
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no) sms,
(select lc.rgn_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSR)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_DTSR from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) krn
where sms.rgn_no=krn.rgn_no) den,
(select sms_hrs.rgn_no,
case when sms_hrs.mon=0 and pln_hrs.mon=0 then 0 when sms_hrs.mon=0 then 0 when pln_hrs.mon=0 then 0 
else NVL(ROUND((sms_hrs.mon / pln_hrs.mon)*100,1),0) end as Mon,
case when sms_hrs.tue=0 and pln_hrs.tue=0 then 0 when sms_hrs.tue=0 then 0 when pln_hrs.tue=0 then 0 
else NVL(ROUND((sms_hrs.tue / pln_hrs.tue)*100,1),0) end as Tue,
case when sms_hrs.wed=0 and pln_hrs.wed=0 then 0 when sms_hrs.wed=0 then 0 when pln_hrs.wed=0 then 0 
else NVL(ROUND((sms_hrs.wed / pln_hrs.wed)*100,1),0) end as Wed,
case when sms_hrs.thu=0 and pln_hrs.thu=0 then 0 when sms_hrs.thu=0 then 0 when pln_hrs.thu=0 then 0 
else NVL(ROUND((sms_hrs.Thu / pln_hrs.Thu)*100,1),0) end as Thu,
case when sms_hrs.fri=0 and pln_hrs.fri=0 then 0 when sms_hrs.fri=0 then 0 when pln_hrs.fri=0 then 0 
else NVL(ROUND((sms_hrs.fri / pln_hrs.fri)*100,1),0) end as Fri,
case when sms_hrs.sat=0 and pln_hrs.sat=0 then 0 when sms_hrs.sat=0 then 0 when pln_hrs.sat=0 then 0 
else NVL(ROUND((sms_hrs.sat / pln_hrs.sat)*100,1),0) end as Sat,
case when sms_hrs.sun=0 and pln_hrs.sun=0 then 0 when sms_hrs.sun=0 then 0 when pln_hrs.sun=0 then 0 
else NVL(ROUND((sms_hrs.sun / pln_hrs.sun)*100,1),0) end as Sun from  
(select lc.rgn_no,sms.mon,sms.tue,sms.wed,sms.thu,sms.fri,sms.sat,sms.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DPBU from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division'  and tsk.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z ) sms
on sms.rgn_no=lc.rgn_no) sms_hrs,
(select lc.rgn_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_HRS_DTS) as PLN_HRS_DPBU from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no) pln_hrs 
where sms_hrs.rgn_no=pln_hrs.rgn_no order by sms_hrs.rgn_no) nyu
where nyu.rgn_no = den.rgn_no

  ]]> 
  </VarianceORPrcntColumn>
<VarianceORPrcntTotal>
<![CDATA[ select nyu.div_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select sms.div_no,
case when NVL(sms.mon,0)=0 and NVL(krn.mon,0)=0 then 0 when NVL(sms.mon,0)=0 then 0 when NVL(krn.mon,0)=0 then 0
else ROUND((sms.mon / krn.mon)*100,1) end as MON,
case when NVL(sms.tue,0)=0 and NVL(krn.tue,0)=0 then 0 when NVL(sms.tue,0)=0 then 0 when NVL(krn.tue,0)=0 then 0
else ROUND((sms.tue / krn.tue)*100,1) end as TUE,
case when NVL(sms.wed,0)=0 and NVL(krn.wed,0)=0 then 0 when NVL(sms.wed,0)=0 then 0 when NVL(krn.wed,0)=0 then 0
else ROUND((sms.wed / krn.wed)*100,1) end as WED,
case when NVL(sms.thu,0)=0 and NVL(krn.thu,0)=0 then 0 when NVL(sms.thu,0)=0 then 0 when NVL(krn.thu,0)=0 then 0
else ROUND((sms.thu / krn.thu)*100,1) end as THU,
case when NVL(sms.fri,0)=0 and NVL(krn.fri,0)=0 then 0 when NVL(sms.fri,0)=0 then 0 when NVL(krn.fri,0)=0 then 0
else ROUND((sms.fri / krn.fri)*100,1) end as FRI,
case when NVL(sms.sat,0)=0 and NVL(krn.sat,0)=0 then 0 when NVL(sms.sat,0)=0 then 0 when NVL(krn.sat,0)=0 then 0
else ROUND((sms.sat / krn.sat)*100,1) end as SAT,
case when NVL(sms.sun,0)=0 and NVL(krn.sun,0)=0 then 0 when NVL(sms.sun,0)=0 then 0 when NVL(krn.sun,0)=0 then 0
else ROUND((sms.sun / krn.sun)*100,1) end as SUN from 
(select lc.div_no,
NVL(xy.Monday,0) as mon,NVL(xy.Tuesday,0) as tue,NVL(xy.Wednesday,0) as wed,NVL(xy.Thursday,0) as thu,
NVL(xy.Friday,0) as fri,NVL(xy.Saturday,0) as sat,NVL(xy.Sunday,0) as sun from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select div_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSBU )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSBU )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSBU )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSBU )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSBU )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSBU )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSBU )),0) Sunday 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,
A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no NOT IN (20,85)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
/*UNION 
select * from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,85)
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,
A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no)*/) xyz 
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no) sms,
(select lc.div_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) krn
where sms.div_no=krn.div_no) den,
(select sms_hrs.div_no,
case when sms_hrs.mon=0 and pln_hrs.mon=0 then 0 when sms_hrs.mon=0 then 0 when pln_hrs.mon=0 then 0 
else NVL(ROUND((sms_hrs.mon / pln_hrs.mon)*100,1),0) end as Mon,
case when sms_hrs.tue=0 and pln_hrs.tue=0 then 0 when sms_hrs.tue=0 then 0 when pln_hrs.tue=0 then 0 
else NVL(ROUND((sms_hrs.tue / pln_hrs.tue)*100,1),0) end as Tue,
case when sms_hrs.wed=0 and pln_hrs.wed=0 then 0 when sms_hrs.wed=0 then 0 when pln_hrs.wed=0 then 0 
else NVL(ROUND((sms_hrs.wed / pln_hrs.wed)*100,1),0) end as Wed,
case when sms_hrs.thu=0 and pln_hrs.thu=0 then 0 when sms_hrs.thu=0 then 0 when pln_hrs.thu=0 then 0 
else NVL(ROUND((sms_hrs.Thu / pln_hrs.Thu)*100,1),0) end as Thu,
case when sms_hrs.fri=0 and pln_hrs.fri=0 then 0 when sms_hrs.fri=0 then 0 when pln_hrs.fri=0 then 0 
else NVL(ROUND((sms_hrs.fri / pln_hrs.fri)*100,1),0) end as Fri,
case when sms_hrs.sat=0 and pln_hrs.sat=0 then 0 when sms_hrs.sat=0 then 0 when pln_hrs.sat=0 then 0 
else NVL(ROUND((sms_hrs.sat / pln_hrs.sat)*100,1),0) end as Sat,
case when sms_hrs.sun=0 and pln_hrs.sun=0 then 0 when sms_hrs.sun=0 then 0 when pln_hrs.sun=0 then 0 
else NVL(ROUND((sms_hrs.sun / pln_hrs.sun)*100,1),0) end as Sun from 
(select lc.div_no,sms.mon,sms.tue,sms.wed,sms.thu,sms.fri,sms.sat,sms.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_TOT_DPBU from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division'  and tsk.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z ) sms
on sms.div_no=lc.div_no) sms_hrs,
(select lc.div_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_HRS_DTS) as PLN_HRS_TOT_DPBU from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no) pln_hrs 
where sms_hrs.div_no=pln_hrs.div_no order by sms_hrs.div_no) nyu
where nyu.div_no = den.div_no 
  ]]> 
  </VarianceORPrcntTotal>
<VarianceORPrcntWkToDt>
<![CDATA[select nyu.rgn_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_CPH_DPG from
(select sms.rgn_no,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as WTD from 
(select lc.rgn_no,NVL(xy.ACTL_SMS_DTSBU,0) as wtd from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select rgn_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU 
from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no NOT IN (20,85)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
/*UNION
select * from 
(select h.rgn_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,85)
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no order by h.rgn_no)*/) xyz
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no) sms,
(select lc.rgn_no,NVL(ROUND(wge.ACTL_HRS_DTSBU,2),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/*UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i*/) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) krn
where sms.rgn_no=krn.rgn_no) den,
(select sms_hrs.rgn_no,
case when sms_hrs.wtd=0 and pln_hrs.wtd=0 then 0 when sms_hrs.wtd=0 then 0 when pln_hrs.wtd=0 then 0 
else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end as WTD from  
(select lc.rgn_no,sms.wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DPBU from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division'  and tsk.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and sysdate-1
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z ) sms
on sms.rgn_no=lc.rgn_no) sms_hrs,
(select lc.rgn_no,sum(wge.PLN_HOURS_DPBU) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm order by e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq) wge
on wge.rgn_no=lc.rgn_no group by lc.rgn_no order by lc.rgn_no) pln_hrs 
where sms_hrs.rgn_no=pln_hrs.rgn_no) nyu
where nyu.rgn_no= den.rgn_no
  ]]> 
  </VarianceORPrcntWkToDt>
<VarianceORPrcntWkToDtTotal>
<![CDATA[select nyu.div_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_CPH_TOT_DPG from
(select sms.div_no,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as WTD from 
(select lc.div_no,NVL(xy.ACTL_SMS_DTSBU,0) as wtd from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select div_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select distinct src.*,
(CASE
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no NOT IN (20,85)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
/*UNION
select * from 
(select h.div_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,85)
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no = 3
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,85))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no order by h.div_no)*/) xyz
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no) sms,
(select lc.div_no,NVL(ROUND(wge.ACTL_HRS_TOT_DTSBU,2),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_wrk_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/*UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_wrk_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_wrk_hrs is NOT NULL and a.actl_wrk_hrs!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,85)
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i*/) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) krn
where sms.div_no=krn.div_no) den,
(select sms_hrs.div_no,
case when sms_hrs.wtd=0 and pln_hrs.wtd=0 then 0 when sms_hrs.wtd=0 then 0 when pln_hrs.wtd=0 then 0 
else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end as WTD from  
(select lc.div_no,sms.wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_TOT_DPBU from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division'  and tsk.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and sysdate-1
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z ) sms
on sms.div_no=lc.div_no) sms_hrs,
(select lc.div_no,sum(wge.PLN_HOURS_TOT_DPBU) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq,e.dept_nm 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_no,e.loc_nm,e.dply_seq) wge
on wge.div_no=lc.div_no group by lc.div_no order by lc.div_no) pln_hrs 
where sms_hrs.div_no=pln_hrs.div_no) nyu where nyu.div_no = den.div_no  
  ]]> 
  </VarianceORPrcntWkToDtTotal>
  </TCName>
<TCName name="ItemsView">
<PlannedItemsColumn>
<![CDATA[ 
select z.rgn_no,
NVL(y.Mon_itm,0) as Mon,NVL(y.Tue_itm,0) as Tue,NVL(y.Wed_itm,0) as Wed,NVL(y.Thu_itm,0) as Thu,NVL(y.Fri_itm,0) as Fri,
NVL(y.Sat_itm,0) as Sat,NVL(y.Sun_itm,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DPBU)),0) Sun_itm from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DPBU,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no

  ]]> 
  </PlannedItemsColumn>
<PlannedItemsTotal>
<![CDATA[ 
select z.div_no,
NVL(y.Mon_itm,0) as Mon,NVL(y.Tue_itm,0) as Tue,NVL(y.Wed_itm,0) as Wed,NVL(y.Thu_itm,0) as Thu,NVL(y.Fri_itm,0) as Fri,
NVL(y.Sat_itm,0) as Sat,NVL(y.Sun_itm,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DPBU)),0) Sun_itm from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_TOT_DPBU,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no

  ]]> 
  </PlannedItemsTotal>
<PlannedItemsWkToDt>
<![CDATA[ 
select z.rgn_no,NVL(ROUND(y.wtd_itm,0),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DPBU)),0) Sun_itm from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DPBU,sum(h.PLN_ITM_DTS) as PLN_ITM_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no

  ]]> 
  </PlannedItemsWkToDt>
<PlannedItemsWkToDtTotal>
<![CDATA[ 
select z.div_no,NVL(ROUND(y.wtd_itm,0),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DPBU)),0) Sun_itm from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_TOT_DPBU,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no

  ]]> 
  </PlannedItemsWkToDtTotal>
<ActualItemsColumn>
<![CDATA[ 
select lc.rgn_no,
NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_ITM_DTS),0) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no

  ]]> 
  </ActualItemsColumn>
<ActualItemsTotal>
<![CDATA[ 
select lc.div_no,
NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_ITM_DTS),0) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no

  ]]> 
  </ActualItemsTotal>
<ActualItemsWkToDt>
<![CDATA[ 
select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no

  ]]> 
  </ActualItemsWkToDt>
<ActualItemsWkToDtTotal>
<![CDATA[ 
select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no

  ]]> 
  </ActualItemsWkToDtTotal>
<VarianceItemsColumn>
<![CDATA[ select nyu.rgn_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select lc.rgn_no,
NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_ITM_DTS),0) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) den,
(select z.rgn_no,
NVL(y.Mon_itm,0) as Mon,NVL(y.Tue_itm,0) as Tue,NVL(y.Wed_itm,0) as Wed,NVL(y.Thu_itm,0) as Thu,NVL(y.Fri_itm,0) as Fri,
NVL(y.Sat_itm,0) as Sat,NVL(y.Sun_itm,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DPBU)),0) Sun_itm from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DPBU,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no) nyu
where nyu.rgn_no = den.rgn_no
  ]]> 
  </VarianceItemsColumn>
<VarianceItemsTotal>
<![CDATA[select nyu.div_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select lc.div_no,
NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_ITM_DTS),0) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) den,
(select z.div_no,
NVL(y.Mon_itm,0) as Mon,NVL(y.Tue_itm,0) as Tue,NVL(y.Wed_itm,0) as Wed,NVL(y.Thu_itm,0) as Thu,NVL(y.Fri_itm,0) as Fri,
NVL(y.Sat_itm,0) as Sat,NVL(y.Sun_itm,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DPBU)),0) Sun_itm from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_TOT_DPBU,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no) nyu
where nyu.div_no = den.div_no  
  ]]> 
  </VarianceItemsTotal>
<VarianceItemsWkToDt>
<![CDATA[ select nyu.rgn_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as WTD from
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) den,
(select z.rgn_no,NVL(ROUND(y.wtd_itm,0),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DPBU)),0) Sun_itm from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DPBU,sum(h.PLN_ITM_DTS) as PLN_ITM_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no) nyu
where nyu.rgn_no= den.rgn_no
  ]]> 
  </VarianceItemsWkToDt>
<VarianceItemsWkToDtTotal>
<![CDATA[ select nyu.div_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_CPH_TOT_DPG from
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) den,
(select z.div_no,NVL(ROUND(y.wtd_itm,0),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DPBU)),0) Sun_itm from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_TOT_DPBU,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no) nyu where nyu.div_no = den.div_no 
  ]]> 
  </VarianceItemsWkToDtTotal>
  </TCName>
<TCName name="ItemsPriceView">
<PlannedItemsPriceColumn>
<![CDATA[ 
select sls_itm.rgn_no,
case when sls_itm.mon_sls=0 and sls_itm.mon_itm=0 then 0 when sls_itm.mon_sls=0 then 0 when sls_itm.mon_itm=0 then 0 
else NVL(ROUND((sls_itm.mon_sls / sls_itm.mon_itm),2),0) end as Mon,
case when sls_itm.tue_sls=0 and sls_itm.tue_itm=0 then 0 when sls_itm.tue_sls=0 then 0 when sls_itm.tue_itm=0 then 0 
else NVL(ROUND((sls_itm.tue_sls / sls_itm.tue_itm),2),0) end as Tue,
case when sls_itm.wed_sls=0 and sls_itm.wed_itm=0 then 0 when sls_itm.wed_sls=0 then 0 when sls_itm.wed_itm=0 then 0 
else NVL(ROUND((sls_itm.wed_sls / sls_itm.wed_itm),2),0) end as Wed,
case when sls_itm.thu_sls=0 and sls_itm.thu_itm=0 then 0 when sls_itm.thu_sls=0 then 0 when sls_itm.thu_itm=0 then 0 
else NVL(ROUND((sls_itm.thu_sls / sls_itm.thu_itm),2),0) end as Thu,
case when sls_itm.fri_sls=0 and sls_itm.fri_itm=0 then 0 when sls_itm.fri_sls=0 then 0 when sls_itm.fri_itm=0 then 0 
else NVL(ROUND((sls_itm.fri_sls / sls_itm.fri_itm),2),0) end as Fri,
case when sls_itm.sat_sls=0 and sls_itm.sat_itm=0 then 0 when sls_itm.sat_sls=0 then 0 when sls_itm.sat_itm=0 then 0 
else NVL(ROUND((sls_itm.sat_sls / sls_itm.sat_itm),2),0) end as Sat,
case when sls_itm.sun_sls=0 and sls_itm.sun_itm=0 then 0 when sls_itm.sun_sls=0 then 0 when sls_itm.sun_itm=0 then 0 
else NVL(ROUND((sls_itm.sun_sls / sls_itm.sun_itm),2),0) end as Sun from
(select z.rgn_no,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,y.wtd_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm,y.wtd_itm from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DPBU)),0) Sun_itm from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DPBU,sum(h.PLN_ITM_DTS) as PLN_ITM_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no) sls_itm

  ]]> 
  </PlannedItemsPriceColumn>
<PlannedItemsPriceTotal>
<![CDATA[ 
select sls_itm.div_no,
case when sls_itm.mon_sls=0 and sls_itm.mon_itm=0 then 0 when sls_itm.mon_sls=0 then 0 when sls_itm.mon_itm=0 then 0 
else NVL(ROUND((sls_itm.mon_sls / sls_itm.mon_itm),2),0) end as Mon,
case when sls_itm.tue_sls=0 and sls_itm.tue_itm=0 then 0 when sls_itm.tue_sls=0 then 0 when sls_itm.tue_itm=0 then 0 
else NVL(ROUND((sls_itm.tue_sls / sls_itm.tue_itm),2),0) end as Tue,
case when sls_itm.wed_sls=0 and sls_itm.wed_itm=0 then 0 when sls_itm.wed_sls=0 then 0 when sls_itm.wed_itm=0 then 0 
else NVL(ROUND((sls_itm.wed_sls / sls_itm.wed_itm),2),0) end as Wed,
case when sls_itm.thu_sls=0 and sls_itm.thu_itm=0 then 0 when sls_itm.thu_sls=0 then 0 when sls_itm.thu_itm=0 then 0 
else NVL(ROUND((sls_itm.thu_sls / sls_itm.thu_itm),2),0) end as Thu,
case when sls_itm.fri_sls=0 and sls_itm.fri_itm=0 then 0 when sls_itm.fri_sls=0 then 0 when sls_itm.fri_itm=0 then 0 
else NVL(ROUND((sls_itm.fri_sls / sls_itm.fri_itm),2),0) end as Fri,
case when sls_itm.sat_sls=0 and sls_itm.sat_itm=0 then 0 when sls_itm.sat_sls=0 then 0 when sls_itm.sat_itm=0 then 0 
else NVL(ROUND((sls_itm.sat_sls / sls_itm.sat_itm),2),0) end as Sat,
case when sls_itm.sun_sls=0 and sls_itm.sun_itm=0 then 0 when sls_itm.sun_sls=0 then 0 when sls_itm.sun_itm=0 then 0 
else NVL(ROUND((sls_itm.sun_sls / sls_itm.sun_itm),2),0) end as Sun from
(select z.div_no,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,y.wtd_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm,y.wtd_itm from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DPBU)),0) Sun_itm from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DPBU,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no) sls_itm

  ]]> 
  </PlannedItemsPriceTotal>
<PlannedItemsPriceWkToDt>
<![CDATA[ 
select sls_itm.rgn_no,
case when sls_itm.wtd_sls=0 and sls_itm.wtd_itm=0 then 0 when sls_itm.wtd_sls=0 then 0 when sls_itm.wtd_itm=0 then 0 
else NVL(ROUND((sls_itm.wtd_sls / sls_itm.wtd_itm),2),0) end as WTD from
(select z.rgn_no,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,y.wtd_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm,y.wtd_itm from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DPBU)),0) Sun_itm from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DPBU,sum(h.PLN_ITM_DTS) as PLN_ITM_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no) sls_itm

  ]]> 
  </PlannedItemsPriceWkToDt>
<PlannedItemsPriceWkToDtTotal>
<![CDATA[ 
select sls_itm.div_no,
case when sls_itm.wtd_sls=0 and sls_itm.wtd_itm=0 then 0 when sls_itm.wtd_sls=0 then 0 when sls_itm.wtd_itm=0 then 0 
else NVL(ROUND((sls_itm.wtd_sls / sls_itm.wtd_itm),2),0) end as WTD from
(select z.div_no,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,y.wtd_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm,y.wtd_itm from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DPBU)),0) Sun_itm from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DPBU,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no) sls_itm

  ]]> 
  </PlannedItemsPriceWkToDtTotal>
<ActualItemsPriceColumn>
<![CDATA[ 
select sls.rgn_no,
case when sls.mon=0 and itm.mon=0 then 0 when sls.mon=0 then 0 when itm.mon=0 then 0 
else NVL(ROUND((sls.mon / itm.mon),2),0) end as mon,
case when sls.tue=0 and itm.tue=0 then 0 when sls.tue=0 then 0 when itm.tue=0 then 0 
else NVL(ROUND((sls.tue / itm.tue),2),0) end as tue,
case when sls.wed=0 and itm.wed=0 then 0 when sls.wed=0 then 0 when itm.wed=0 then 0 
else NVL(ROUND((sls.wed / itm.wed),2),0) end as wed,
case when sls.thu=0 and itm.thu=0 then 0 when sls.thu=0 then 0 when itm.thu=0 then 0 
else NVL(ROUND((sls.thu / itm.thu),2),0) end as thu,
case when sls.fri=0 and itm.fri=0 then 0 when sls.fri=0 then 0 when itm.fri=0 then 0 
else NVL(ROUND((sls.fri / itm.fri),2),0) end as fri,
case when sls.sat=0 and itm.sat=0 then 0 when sls.sat=0 then 0 when itm.sat=0 then 0 
else NVL(ROUND((sls.sat / itm.sat),2),0) end as sat,
case when sls.sun=0 and itm.sun=0 then 0 when sls.sun=0 then 0 when itm.sun=0 then 0 
else NVL(ROUND((sls.sun / itm.sun),2),0) end as sun from 
(select lc.rgn_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls,
(select lc.rgn_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) itm 
where sls.rgn_no=itm.rgn_no

  ]]> 
  </ActualItemsPriceColumn>
<ActualItemsPriceTotal>
<![CDATA[ 
select sls.div_no,
case when sls.mon=0 and itm.mon=0 then 0 when sls.mon=0 then 0 when itm.mon=0 then 0 
else NVL(ROUND((sls.mon / itm.mon),2),0) end as mon,
case when sls.tue=0 and itm.tue=0 then 0 when sls.tue=0 then 0 when itm.tue=0 then 0 
else NVL(ROUND((sls.tue / itm.tue),2),0) end as tue,
case when sls.wed=0 and itm.wed=0 then 0 when sls.wed=0 then 0 when itm.wed=0 then 0 
else NVL(ROUND((sls.wed / itm.wed),2),0) end as wed,
case when sls.thu=0 and itm.thu=0 then 0 when sls.thu=0 then 0 when itm.thu=0 then 0 
else NVL(ROUND((sls.thu / itm.thu),2),0) end as thu,
case when sls.fri=0 and itm.fri=0 then 0 when sls.fri=0 then 0 when itm.fri=0 then 0 
else NVL(ROUND((sls.fri / itm.fri),2),0) end as fri,
case when sls.sat=0 and itm.sat=0 then 0 when sls.sat=0 then 0 when itm.sat=0 then 0 
else NVL(ROUND((sls.sat / itm.sat),2),0) end as sat,
case when sls.sun=0 and itm.sun=0 then 0 when sls.sun=0 then 0 when itm.sun=0 then 0 
else NVL(ROUND((sls.sun / itm.sun),2),0) end as sun from 
(select lc.div_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls,
(select lc.div_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) itm 
where sls.div_no=itm.div_no

  ]]> 
  </ActualItemsPriceTotal>
<ActualItemsPriceWkToDt>
<![CDATA[ 
select sls.rgn_no,
case when sls.wtd=0 and itm.wtd=0 then 0 when sls.wtd=0 then 0 when itm.wtd=0 then 0
else NVL(ROUND((sls.wtd / itm.wtd),2),0) end as wtd from 
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls,
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) itm 
where sls.rgn_no=itm.rgn_no

  ]]> 
  </ActualItemsPriceWkToDt>
<ActualItemsPriceWkToDtTotal>
<![CDATA[ 
select sls.div_no,
case when sls.wtd=0 and itm.wtd=0 then 0 when sls.wtd=0 then 0 when itm.wtd=0 then 0
else NVL(ROUND((sls.wtd / itm.wtd),2),0) end as wtd from 
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls,
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) itm 
where sls.div_no=itm.div_no

  ]]> 
  </ActualItemsPriceWkToDtTotal>
<VarianceItemsPriceColumn>
<![CDATA[ select nyu.rgn_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select sls.rgn_no,
case when sls.mon=0 and itm.mon=0 then 0 when sls.mon=0 then 0 when itm.mon=0 then 0 
else NVL(ROUND((sls.mon / itm.mon),2),0) end as mon,
case when sls.tue=0 and itm.tue=0 then 0 when sls.tue=0 then 0 when itm.tue=0 then 0 
else NVL(ROUND((sls.tue / itm.tue),2),0) end as tue,
case when sls.wed=0 and itm.wed=0 then 0 when sls.wed=0 then 0 when itm.wed=0 then 0 
else NVL(ROUND((sls.wed / itm.wed),2),0) end as wed,
case when sls.thu=0 and itm.thu=0 then 0 when sls.thu=0 then 0 when itm.thu=0 then 0 
else NVL(ROUND((sls.thu / itm.thu),2),0) end as thu,
case when sls.fri=0 and itm.fri=0 then 0 when sls.fri=0 then 0 when itm.fri=0 then 0 
else NVL(ROUND((sls.fri / itm.fri),2),0) end as fri,
case when sls.sat=0 and itm.sat=0 then 0 when sls.sat=0 then 0 when itm.sat=0 then 0 
else NVL(ROUND((sls.sat / itm.sat),2),0) end as sat,
case when sls.sun=0 and itm.sun=0 then 0 when sls.sun=0 then 0 when itm.sun=0 then 0 
else NVL(ROUND((sls.sun / itm.sun),2),0) end as sun from 
(select lc.rgn_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls,
(select lc.rgn_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) itm 
where sls.rgn_no=itm.rgn_no) den,
(select sls_itm.rgn_no,
case when sls_itm.mon_sls=0 and sls_itm.mon_itm=0 then 0 when sls_itm.mon_sls=0 then 0 when sls_itm.mon_itm=0 then 0 
else NVL(ROUND((sls_itm.mon_sls / sls_itm.mon_itm),2),0) end as Mon,
case when sls_itm.tue_sls=0 and sls_itm.tue_itm=0 then 0 when sls_itm.tue_sls=0 then 0 when sls_itm.tue_itm=0 then 0 
else NVL(ROUND((sls_itm.tue_sls / sls_itm.tue_itm),2),0) end as Tue,
case when sls_itm.wed_sls=0 and sls_itm.wed_itm=0 then 0 when sls_itm.wed_sls=0 then 0 when sls_itm.wed_itm=0 then 0 
else NVL(ROUND((sls_itm.wed_sls / sls_itm.wed_itm),2),0) end as Wed,
case when sls_itm.thu_sls=0 and sls_itm.thu_itm=0 then 0 when sls_itm.thu_sls=0 then 0 when sls_itm.thu_itm=0 then 0 
else NVL(ROUND((sls_itm.thu_sls / sls_itm.thu_itm),2),0) end as Thu,
case when sls_itm.fri_sls=0 and sls_itm.fri_itm=0 then 0 when sls_itm.fri_sls=0 then 0 when sls_itm.fri_itm=0 then 0 
else NVL(ROUND((sls_itm.fri_sls / sls_itm.fri_itm),2),0) end as Fri,
case when sls_itm.sat_sls=0 and sls_itm.sat_itm=0 then 0 when sls_itm.sat_sls=0 then 0 when sls_itm.sat_itm=0 then 0 
else NVL(ROUND((sls_itm.sat_sls / sls_itm.sat_itm),2),0) end as Sat,
case when sls_itm.sun_sls=0 and sls_itm.sun_itm=0 then 0 when sls_itm.sun_sls=0 then 0 when sls_itm.sun_itm=0 then 0 
else NVL(ROUND((sls_itm.sun_sls / sls_itm.sun_itm),2),0) end as Sun from
(select z.rgn_no,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,y.wtd_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm,y.wtd_itm from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DPBU)),0) Sun_itm from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DPBU,sum(h.PLN_ITM_DTS) as PLN_ITM_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no) sls_itm) nyu
where nyu.rgn_no = den.rgn_no
  ]]> 
  </VarianceItemsPriceColumn>
<VarianceItemsPriceTotal>
<![CDATA[select nyu.div_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select sls.div_no,
case when sls.mon=0 and itm.mon=0 then 0 when sls.mon=0 then 0 when itm.mon=0 then 0 
else NVL(ROUND((sls.mon / itm.mon),2),0) end as mon,
case when sls.tue=0 and itm.tue=0 then 0 when sls.tue=0 then 0 when itm.tue=0 then 0 
else NVL(ROUND((sls.tue / itm.tue),2),0) end as tue,
case when sls.wed=0 and itm.wed=0 then 0 when sls.wed=0 then 0 when itm.wed=0 then 0 
else NVL(ROUND((sls.wed / itm.wed),2),0) end as wed,
case when sls.thu=0 and itm.thu=0 then 0 when sls.thu=0 then 0 when itm.thu=0 then 0 
else NVL(ROUND((sls.thu / itm.thu),2),0) end as thu,
case when sls.fri=0 and itm.fri=0 then 0 when sls.fri=0 then 0 when itm.fri=0 then 0 
else NVL(ROUND((sls.fri / itm.fri),2),0) end as fri,
case when sls.sat=0 and itm.sat=0 then 0 when sls.sat=0 then 0 when itm.sat=0 then 0 
else NVL(ROUND((sls.sat / itm.sat),2),0) end as sat,
case when sls.sun=0 and itm.sun=0 then 0 when sls.sun=0 then 0 when itm.sun=0 then 0 
else NVL(ROUND((sls.sun / itm.sun),2),0) end as sun from 
(select lc.div_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls,
(select lc.div_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) itm 
where sls.div_no=itm.div_no) den,
(select sls_itm.div_no,
case when sls_itm.mon_sls=0 and sls_itm.mon_itm=0 then 0 when sls_itm.mon_sls=0 then 0 when sls_itm.mon_itm=0 then 0 
else NVL(ROUND((sls_itm.mon_sls / sls_itm.mon_itm),2),0) end as Mon,
case when sls_itm.tue_sls=0 and sls_itm.tue_itm=0 then 0 when sls_itm.tue_sls=0 then 0 when sls_itm.tue_itm=0 then 0 
else NVL(ROUND((sls_itm.tue_sls / sls_itm.tue_itm),2),0) end as Tue,
case when sls_itm.wed_sls=0 and sls_itm.wed_itm=0 then 0 when sls_itm.wed_sls=0 then 0 when sls_itm.wed_itm=0 then 0 
else NVL(ROUND((sls_itm.wed_sls / sls_itm.wed_itm),2),0) end as Wed,
case when sls_itm.thu_sls=0 and sls_itm.thu_itm=0 then 0 when sls_itm.thu_sls=0 then 0 when sls_itm.thu_itm=0 then 0 
else NVL(ROUND((sls_itm.thu_sls / sls_itm.thu_itm),2),0) end as Thu,
case when sls_itm.fri_sls=0 and sls_itm.fri_itm=0 then 0 when sls_itm.fri_sls=0 then 0 when sls_itm.fri_itm=0 then 0 
else NVL(ROUND((sls_itm.fri_sls / sls_itm.fri_itm),2),0) end as Fri,
case when sls_itm.sat_sls=0 and sls_itm.sat_itm=0 then 0 when sls_itm.sat_sls=0 then 0 when sls_itm.sat_itm=0 then 0 
else NVL(ROUND((sls_itm.sat_sls / sls_itm.sat_itm),2),0) end as Sat,
case when sls_itm.sun_sls=0 and sls_itm.sun_itm=0 then 0 when sls_itm.sun_sls=0 then 0 when sls_itm.sun_itm=0 then 0 
else NVL(ROUND((sls_itm.sun_sls / sls_itm.sun_itm),2),0) end as Sun from
(select z.div_no,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,y.wtd_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm,y.wtd_itm from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DPBU)),0) Sun_itm from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DPBU,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no) sls_itm) nyu
where nyu.div_no = den.div_no  
  ]]> 
  </VarianceItemsPriceTotal>
<VarianceItemsPriceWkToDt>
<![CDATA[ select nyu.rgn_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_CPH_DPG from
(select sls.rgn_no,
case when sls.wtd=0 and itm.wtd=0 then 0 when sls.wtd=0 then 0 when itm.wtd=0 then 0
else NVL(ROUND((sls.wtd / itm.wtd),2),0) end as wtd from 
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls,
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) itm 
where sls.rgn_no=itm.rgn_no) den,
(select sls_itm.rgn_no,
case when sls_itm.wtd_sls=0 and sls_itm.wtd_itm=0 then 0 when sls_itm.wtd_sls=0 then 0 when sls_itm.wtd_itm=0 then 0 
else NVL(ROUND((sls_itm.wtd_sls / sls_itm.wtd_itm),2),0) end as WTD from
(select z.rgn_no,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,y.wtd_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm,y.wtd_itm from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DPBU)),0) Sun_itm from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DPBU,sum(h.PLN_ITM_DTS) as PLN_ITM_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no) sls_itm) nyu
where nyu.rgn_no= den.rgn_no
  ]]> 
  </VarianceItemsPriceWkToDt>
<VarianceItemsPriceWkToDtTotal>
<![CDATA[ select nyu.div_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_CPH_TOT_DPG from
(select sls.div_no,
case when sls.wtd=0 and itm.wtd=0 then 0 when sls.wtd=0 then 0 when itm.wtd=0 then 0
else NVL(ROUND((sls.wtd / itm.wtd),2),0) end as wtd from 
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls,
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) itm 
where sls.div_no=itm.div_no) den,
(select sls_itm.div_no,
case when sls_itm.wtd_sls=0 and sls_itm.wtd_itm=0 then 0 when sls_itm.wtd_sls=0 then 0 when sls_itm.wtd_itm=0 then 0 
else NVL(ROUND((sls_itm.wtd_sls / sls_itm.wtd_itm),2),0) end as WTD from
(select z.div_no,y.Mon_sls,y.Tue_sls,y.Wed_sls,y.Thu_sls,y.Fri_sls,y.Sat_sls,y.Sun_sls,y.wtd_sls,
y.Mon_itm,y.Tue_itm,y.Wed_itm,y.Thu_itm,y.Fri_itm,y.Sat_itm,y.Sun_itm,y.wtd_itm from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_sls + x.Tue_sls + x.Wed_sls + x.Thu_sls + x.Fri_sls + x.Sat_sls + x.Sun_sls) as WTD_SLS,
(x.Mon_itm + x.Tue_itm + x.Wed_itm + x.Thu_itm + x.Fri_itm + x.Sat_itm + x.Sun_itm) as WTD_ITM from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DPBU)),0) Mon_sls,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DPBU)),0) Tue_sls,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DPBU)),0) Wed_sls,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DPBU)),0) Thu_sls,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DPBU)),0) Fri_sls,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DPBU)),0) Sat_sls,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DPBU)),0) Sun_sls,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DPBU)),0) Mon_itm,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DPBU)),0) Tue_itm,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DPBU)),0) Wed_itm,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DPBU)),0) Thu_itm,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DPBU)),0) Fri_itm,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DPBU)),0) Sat_itm,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DPBU)),0) Sun_itm from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DPBU,sum(h.PLN_ITM_DTS) as PLN_ITM_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no) sls_itm) nyu where nyu.div_no = den.div_no 
  ]]> 
  </VarianceItemsPriceWkToDtTotal>
  </TCName>
<TCName name="CustomersView">
<PlannedCustomersColumn>
<![CDATA[ 
select z.rgn_no,
NVL(y.Mon,0) as Mon,NVL(y.Tue,0) as Tue,NVL(y.Wed,0) as Wed,NVL(y.Thu,0) as Thu,NVL(y.Fri,0) as Fri,
NVL(y.Sat,0) as Sat,NVL(y.Sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no IN (90,85)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no IN (90,85)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no

  ]]> 
  </PlannedCustomersColumn>
<PlannedCustomersTotal>
<![CDATA[ 
select z.div_no,
NVL(y.Mon,0) as Mon,NVL(y.Tue,0) as Tue,NVL(y.Wed,0) as Wed,NVL(y.Thu,0) as Thu,NVL(y.Fri,0) as Fri,
NVL(y.Sat,0) as Sat,NVL(y.Sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no IN (90,85)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no IN (90,85)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no

  ]]> 
  </PlannedCustomersTotal>
<PlannedCustomersWkToDt>
<![CDATA[ 
select z.rgn_no,NVL(ROUND(y.wtd,0),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_CUST_DTS) as PLN_CUST_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no IN (90,85)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no IN (90,85)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no

  ]]> 
  </PlannedCustomersWkToDt>
<PlannedCustomersWkToDtTotal>
<![CDATA[ 
select z.div_no,NVL(ROUND(y.wtd,0),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_CUST_DTS) as PLN_CUST_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no IN (90,85)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no IN (90,85)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no

  ]]> 
  </PlannedCustomersWkToDtTotal>
<ActualCustomersColumn>
<![CDATA[ 
select lc.rgn_no,
NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_CUST_DTS),0) as ACTL_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no

  ]]> 
  </ActualCustomersColumn>
<ActualCustomersTotal>
<![CDATA[ 
select lc.div_no,
NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_CUST_DTS),0) as ACTL_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.rgn_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no

  ]]> 
  </ActualCustomersTotal>
<ActualCustomersWkToDt>
<![CDATA[ 
select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no

  ]]> 
  </ActualCustomersWkToDt>
<ActualCustomersWkToDtTotal>
<![CDATA[ 
select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no

  ]]> 
  </ActualCustomersWkToDtTotal>
<VarianceCustomersColumn>
<![CDATA[ select nyu.rgn_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select lc.rgn_no,
NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_CUST_DTS),0) as ACTL_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) den,
(select z.rgn_no,
NVL(y.Mon,0) as Mon,NVL(y.Tue,0) as Tue,NVL(y.Wed,0) as Wed,NVL(y.Thu,0) as Thu,NVL(y.Fri,0) as Fri,
NVL(y.Sat,0) as Sat,NVL(y.Sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no IN (90,85)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no IN (90,85)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no) nyu
where nyu.rgn_no = den.rgn_no
  ]]> 
  </VarianceCustomersColumn>
<VarianceCustomersTotal>
<![CDATA[select nyu.div_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select lc.div_no,
NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_CUST_DTS),0) as ACTL_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.rgn_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) den,
(select z.div_no,
NVL(y.Mon,0) as Mon,NVL(y.Tue,0) as Tue,NVL(y.Wed,0) as Wed,NVL(y.Thu,0) as Thu,NVL(y.Fri,0) as Fri,
NVL(y.Sat,0) as Sat,NVL(y.Sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no IN (90,85)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no IN (90,85)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no) nyu
where nyu.div_no = den.div_no  
  ]]> 
  </VarianceCustomersTotal>
<VarianceCustomersWkToDt>
<![CDATA[ select nyu.rgn_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_CPH_DPG from
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) den,
(select z.rgn_no,NVL(ROUND(y.wtd,0),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DPBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_CUST_DTS) as PLN_CUST_DPBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no IN (90,85)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no IN (90,85)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no) nyu
where nyu.rgn_no= den.rgn_no
  ]]> 
  </VarianceCustomersWkToDt>
<VarianceCustomersWkToDtTotal>
<![CDATA[ select nyu.div_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_CPH_TOT_DPG from
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) den,
(select z.div_no,NVL(ROUND(y.wtd,0),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_TOT_DPBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_TOT_DPBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_TOT_DPBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_TOT_DPBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_TOT_DPBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_TOT_DPBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_TOT_DPBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_CUST_DTS) as PLN_CUST_TOT_DPBU from 
(select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_cust_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no IN (90,85)  
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_cust) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no IN (90,85)  
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) g) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no) nyu where nyu.div_no = den.div_no 
  ]]> 
  </VarianceCustomersWkToDtTotal>
  </TCName>
<TCName name="CPHView">
<PlannedCPHColumn>
<![CDATA[ 
select wge_hrs.rgn_no,
case when wge_hrs.mon_wge=0 and wge_hrs.mon_hrs=0 then 0 when wge_hrs.mon_wge=0 then 0 when wge_hrs.mon_hrs=0 then 0 
else NVL(ROUND((wge_hrs.mon_wge / wge_hrs.mon_hrs),2),0) end as Mon,
case when wge_hrs.tue_wge=0 and wge_hrs.tue_hrs=0 then 0 when wge_hrs.tue_wge=0 then 0 when wge_hrs.tue_hrs=0 then 0 
else NVL(ROUND((wge_hrs.tue_wge / wge_hrs.tue_hrs),2),0) end as Tue,
case when wge_hrs.wed_wge=0 and wge_hrs.wed_hrs=0 then 0 when wge_hrs.wed_wge=0 then 0 when wge_hrs.wed_hrs=0 then 0 
else NVL(ROUND((wge_hrs.wed_wge / wge_hrs.wed_hrs),2),0) end as Wed,
case when wge_hrs.thu_wge=0 and wge_hrs.thu_hrs=0 then 0 when wge_hrs.thu_wge=0 then 0 when wge_hrs.thu_hrs=0 then 0 
else NVL(ROUND((wge_hrs.thu_wge / wge_hrs.thu_hrs),2),0) end as Thu,
case when wge_hrs.fri_wge=0 and wge_hrs.fri_hrs=0 then 0 when wge_hrs.fri_wge=0 then 0 when wge_hrs.fri_hrs=0 then 0 
else NVL(ROUND((wge_hrs.fri_wge / wge_hrs.fri_hrs),2),0) end as Fri,
case when wge_hrs.sat_wge=0 and wge_hrs.sat_hrs=0 then 0 when wge_hrs.sat_wge=0 then 0 when wge_hrs.sat_hrs=0 then 0 
else NVL(ROUND((wge_hrs.sat_wge / wge_hrs.sat_hrs),2),0) end as Sat,
case when wge_hrs.sun_wge=0 and wge_hrs.sun_hrs=0 then 0 when wge_hrs.sun_wge=0 then 0 when wge_hrs.sun_hrs=0 then 0 
else NVL(ROUND((wge_hrs.sun_wge / wge_hrs.sun_hrs),2),0) end as Sun from
(select z.rgn_no,y.Mon_wge,y.Tue_wge,y.Wed_wge,y.Thu_wge,y.Fri_wge,y.Sat_wge,y.Sun_wge,y.wtd_wge,
y.Mon_hrs,y.Tue_hrs,y.Wed_hrs,y.Thu_hrs,y.Fri_hrs,y.Sat_hrs,y.Sun_hrs,y.wtd_hrs from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_wge + x.Tue_wge + x.Wed_wge + x.Thu_wge + x.Fri_wge + x.Sat_wge + x.Sun_wge) as WTD_wge,
(x.Mon_hrs + x.Tue_hrs + x.Wed_hrs + x.Thu_hrs + x.Fri_hrs + x.Sat_hrs + x.Sun_hrs) as WTD_hrs from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DPBU)),0) Mon_wge,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DPBU)),0) Tue_wge,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DPBU)),0) Wed_wge,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DPBU)),0) Thu_wge,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DPBU)),0) Fri_wge,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DPBU)),0) Sat_wge,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DPBU)),0) Sun_wge,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DPBU)),0) Mon_hrs,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DPBU)),0) Tue_hrs,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DPBU)),0) Wed_hrs,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DPBU)),0) Thu_hrs,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DPBU)),0) Fri_hrs,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DPBU)),0) Sat_hrs,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DPBU)),0) Sun_hrs from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_DPBU,sum(h.PLN_HRS_DTS) as PLN_HRS_DPBU from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no) wge_hrs
  ]]> 
  </PlannedCPHColumn>
<PlannedCPHTotal>
<![CDATA[ 
select wge_hrs.div_no,
case when wge_hrs.mon_wge=0 and wge_hrs.mon_hrs=0 then 0 when wge_hrs.mon_wge=0 then 0 when wge_hrs.mon_hrs=0 then 0 
else NVL(ROUND((wge_hrs.mon_wge / wge_hrs.mon_hrs),2),0) end as Mon,
case when wge_hrs.tue_wge=0 and wge_hrs.tue_hrs=0 then 0 when wge_hrs.tue_wge=0 then 0 when wge_hrs.tue_hrs=0 then 0 
else NVL(ROUND((wge_hrs.tue_wge / wge_hrs.tue_hrs),2),0) end as Tue,
case when wge_hrs.wed_wge=0 and wge_hrs.wed_hrs=0 then 0 when wge_hrs.wed_wge=0 then 0 when wge_hrs.wed_hrs=0 then 0 
else NVL(ROUND((wge_hrs.wed_wge / wge_hrs.wed_hrs),2),0) end as Wed,
case when wge_hrs.thu_wge=0 and wge_hrs.thu_hrs=0 then 0 when wge_hrs.thu_wge=0 then 0 when wge_hrs.thu_hrs=0 then 0 
else NVL(ROUND((wge_hrs.thu_wge / wge_hrs.thu_hrs),2),0) end as Thu,
case when wge_hrs.fri_wge=0 and wge_hrs.fri_hrs=0 then 0 when wge_hrs.fri_wge=0 then 0 when wge_hrs.fri_hrs=0 then 0 
else NVL(ROUND((wge_hrs.fri_wge / wge_hrs.fri_hrs),2),0) end as Fri,
case when wge_hrs.sat_wge=0 and wge_hrs.sat_hrs=0 then 0 when wge_hrs.sat_wge=0 then 0 when wge_hrs.sat_hrs=0 then 0 
else NVL(ROUND((wge_hrs.sat_wge / wge_hrs.sat_hrs),2),0) end as Sat,
case when wge_hrs.sun_wge=0 and wge_hrs.sun_hrs=0 then 0 when wge_hrs.sun_wge=0 then 0 when wge_hrs.sun_hrs=0 then 0 
else NVL(ROUND((wge_hrs.sun_wge / wge_hrs.sun_hrs),2),0) end as Sun from
(select z.div_no,y.Mon_wge,y.Tue_wge,y.Wed_wge,y.Thu_wge,y.Fri_wge,y.Sat_wge,y.Sun_wge,y.wtd_wge,
y.Mon_hrs,y.Tue_hrs,y.Wed_hrs,y.Thu_hrs,y.Fri_hrs,y.Sat_hrs,y.Sun_hrs,y.wtd_hrs from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_wge + x.Tue_wge + x.Wed_wge + x.Thu_wge + x.Fri_wge + x.Sat_wge + x.Sun_wge) as WTD_wge,
(x.Mon_hrs + x.Tue_hrs + x.Wed_hrs + x.Thu_hrs + x.Fri_hrs + x.Sat_hrs + x.Sun_hrs) as WTD_hrs from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DPBU)),0) Mon_wge,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DPBU)),0) Tue_wge,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DPBU)),0) Wed_wge,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DPBU)),0) Thu_wge,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DPBU)),0) Fri_wge,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DPBU)),0) Sat_wge,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DPBU)),0) Sun_wge,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DPBU)),0) Mon_hrs,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DPBU)),0) Tue_hrs,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DPBU)),0) Wed_hrs,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DPBU)),0) Thu_hrs,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DPBU)),0) Fri_hrs,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DPBU)),0) Sat_hrs,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DPBU)),0) Sun_hrs from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_TOT_DPBU,sum(h.PLN_HRS_DTS) as PLN_HRS_TOT_DPBU from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no) wge_hrs

  ]]> 
  </PlannedCPHTotal>
<PlannedCPHWkToDt>
<![CDATA[ 
select wge_hrs.rgn_no,
case when wge_hrs.PLN_WGE_DPBU=0 and wge_hrs.PLN_HRS_DPBU=0 then 0 when wge_hrs.PLN_WGE_DPBU=0 then 0 when wge_hrs.PLN_HRS_DPBU=0 then 0 
else NVL(ROUND((wge_hrs.PLN_WGE_DPBU / wge_hrs.PLN_HRS_DPBU),2),0) end as WTD from
(select lc.rgn_no,ROUND(wge.PLN_WGE_DPBU,0) as PLN_WGE_DPBU,wge.PLN_HRS_DPBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WGE_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HRS_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge_hrs

  ]]> 
  </PlannedCPHWkToDt>
<PlannedCPHWkToDtTotal>
<![CDATA[ 
select wge_hrs.div_no,
case when wge_hrs.PLN_WGE_TOT_DPBU=0 and wge_hrs.PLN_HRS_TOT_DPBU=0 then 0 when wge_hrs.PLN_WGE_TOT_DPBU=0 then 0 when wge_hrs.PLN_HRS_TOT_DPBU=0 then 0 
else NVL(ROUND((wge_hrs.PLN_WGE_TOT_DPBU / wge_hrs.PLN_HRS_TOT_DPBU),2),0) end as WTD from
(select lc.div_no,ROUND(wge.PLN_WGE_TOT_DPBU,0) as PLN_WGE_TOT_DPBU,wge.PLN_HRS_TOT_DPBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WGE_TOT_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HRS_TOT_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) wge_hrs

  ]]> 
  </PlannedCPHWkToDtTotal>
<ActualCPHColumn>
<![CDATA[ 
select wge.rgn_no,
case when wge.mon=0 and hrs.mon=0 then 0 when wge.mon=0 then 0 when hrs.mon=0 then 0
else NVL(ROUND((wge.mon / hrs.mon),2),0) end as mon, 
case when wge.tue=0 and hrs.tue=0 then 0 when wge.tue=0 then 0 when hrs.tue=0 then 0
else NVL(ROUND((wge.tue / hrs.tue),2),0) end as tue,
case when wge.wed=0 and hrs.wed=0 then 0 when wge.wed=0 then 0 when hrs.wed=0 then 0
else NVL(ROUND((wge.wed / hrs.wed),2),0) end as wed,
case when wge.thu=0 and hrs.thu=0 then 0 when wge.thu=0 then 0 when hrs.thu=0 then 0
else NVL(ROUND((wge.thu / hrs.thu),2),0) end as thu,
case when wge.fri=0 and hrs.fri=0 then 0 when wge.fri=0 then 0 when hrs.fri=0 then 0
else NVL(ROUND((wge.fri / hrs.fri),2),0) end as fri,
case when wge.sat=0 and hrs.sat=0 then 0 when wge.sat=0 then 0 when hrs.sat=0 then 0
else NVL(ROUND((wge.sat / hrs.sat),2),0) end as sat,
case when wge.sun=0 and hrs.sun=0 then 0 when wge.sun=0 then 0 when hrs.sun=0 then 0
else NVL(ROUND((wge.sun / hrs.sun),2),0) end as sun from 
(select lc.rgn_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSR)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_DTSR from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) hrs 
where wge.rgn_no=hrs.rgn_no

  ]]> 
  </ActualCPHColumn>
<ActualCPHTotal>
<![CDATA[ 
select wge.div_no,
case when wge.mon=0 and hrs.mon=0 then 0 when wge.mon=0 then 0 when hrs.mon=0 then 0
else NVL(ROUND((wge.mon / hrs.mon),2),0) end as mon, 
case when wge.tue=0 and hrs.tue=0 then 0 when wge.tue=0 then 0 when hrs.tue=0 then 0
else NVL(ROUND((wge.tue / hrs.tue),2),0) end as tue,
case when wge.wed=0 and hrs.wed=0 then 0 when wge.wed=0 then 0 when hrs.wed=0 then 0
else NVL(ROUND((wge.wed / hrs.wed),2),0) end as wed,
case when wge.thu=0 and hrs.thu=0 then 0 when wge.thu=0 then 0 when hrs.thu=0 then 0
else NVL(ROUND((wge.thu / hrs.thu),2),0) end as thu,
case when wge.fri=0 and hrs.fri=0 then 0 when wge.fri=0 then 0 when hrs.fri=0 then 0
else NVL(ROUND((wge.fri / hrs.fri),2),0) end as fri,
case when wge.sat=0 and hrs.sat=0 then 0 when wge.sat=0 then 0 when hrs.sat=0 then 0
else NVL(ROUND((wge.sat / hrs.sat),2),0) end as sat,
case when wge.sun=0 and hrs.sun=0 then 0 when wge.sun=0 then 0 when hrs.sun=0 then 0
else NVL(ROUND((wge.sun / hrs.sun),2),0) end as sun from 
(select lc.div_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select lc.div_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) hrs 
where wge.div_no=hrs.div_no

  ]]> 
  </ActualCPHTotal>
<ActualCPHWkToDt>
<![CDATA[ 
select wge_hrs.rgn_no,
case when wge_hrs.wtd_wge=0 and wge_hrs.wtd_hrs=0 then 0 when wge_hrs.wtd_wge=0 then 0 when wge_hrs.wtd_hrs=0 then 0 
else NVL(ROUND((wge_hrs.wtd_wge / wge_hrs.wtd_hrs),2),0) end as WTD from 
(select wge.rgn_no,wge.WTD_WGE,hrs.WTD_HRS from 
(select lc.rgn_no,wge.ACTL_WGE_DTSBU as WTD_WGE from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/*UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i*/) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,wge.ACTL_HRS_DTSBU as WTD_HRS from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/*UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i*/) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) hrs 
where wge.rgn_no=hrs.rgn_no) wge_hrs

  ]]> 
  </ActualCPHWkToDt>
<ActualCPHWkToDtTotal>
<![CDATA[ 
select wge_hrs.div_no,
case when wge_hrs.wtd_wge=0 and wge_hrs.wtd_hrs=0 then 0 when wge_hrs.wtd_wge=0 then 0 when wge_hrs.wtd_hrs=0 then 0 
else NVL(ROUND((wge_hrs.wtd_wge / wge_hrs.wtd_hrs),2),0) end as WTD from 
(select wge.div_no,wge.wtd_wge,hrs.wtd_hrs from 
(select lc.div_no,wge.ACTL_WGE_TOT_DTSBU as WTD_WGE from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/*UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i*/) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select lc.div_no,wge.ACTL_HRS_TOT_DTSBU as WTD_HRS from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/*UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i*/) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) hrs where wge.div_no=hrs.div_no order by wge.div_no) wge_hrs
order by wge_hrs.div_no

  ]]> 
  </ActualCPHWkToDtTotal>
<VarianceCPHColumn>
<![CDATA[ select nyu.rgn_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select wge.rgn_no,
case when wge.mon=0 and hrs.mon=0 then 0 when wge.mon=0 then 0 when hrs.mon=0 then 0
else NVL(ROUND((wge.mon / hrs.mon),2),0) end as mon, 
case when wge.tue=0 and hrs.tue=0 then 0 when wge.tue=0 then 0 when hrs.tue=0 then 0
else NVL(ROUND((wge.tue / hrs.tue),2),0) end as tue,
case when wge.wed=0 and hrs.wed=0 then 0 when wge.wed=0 then 0 when hrs.wed=0 then 0
else NVL(ROUND((wge.wed / hrs.wed),2),0) end as wed,
case when wge.thu=0 and hrs.thu=0 then 0 when wge.thu=0 then 0 when hrs.thu=0 then 0
else NVL(ROUND((wge.thu / hrs.thu),2),0) end as thu,
case when wge.fri=0 and hrs.fri=0 then 0 when wge.fri=0 then 0 when hrs.fri=0 then 0
else NVL(ROUND((wge.fri / hrs.fri),2),0) end as fri,
case when wge.sat=0 and hrs.sat=0 then 0 when wge.sat=0 then 0 when hrs.sat=0 then 0
else NVL(ROUND((wge.sat / hrs.sat),2),0) end as sat,
case when wge.sun=0 and hrs.sun=0 then 0 when wge.sun=0 then 0 when hrs.sun=0 then 0
else NVL(ROUND((wge.sun / hrs.sun),2),0) end as sun from 
(select lc.rgn_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSR)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_DTSR from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) hrs 
where wge.rgn_no=hrs.rgn_no) den,
(select wge_hrs.rgn_no,
case when wge_hrs.mon_wge=0 and wge_hrs.mon_hrs=0 then 0 when wge_hrs.mon_wge=0 then 0 when wge_hrs.mon_hrs=0 then 0 
else NVL(ROUND((wge_hrs.mon_wge / wge_hrs.mon_hrs),2),0) end as Mon,
case when wge_hrs.tue_wge=0 and wge_hrs.tue_hrs=0 then 0 when wge_hrs.tue_wge=0 then 0 when wge_hrs.tue_hrs=0 then 0 
else NVL(ROUND((wge_hrs.tue_wge / wge_hrs.tue_hrs),2),0) end as Tue,
case when wge_hrs.wed_wge=0 and wge_hrs.wed_hrs=0 then 0 when wge_hrs.wed_wge=0 then 0 when wge_hrs.wed_hrs=0 then 0 
else NVL(ROUND((wge_hrs.wed_wge / wge_hrs.wed_hrs),2),0) end as Wed,
case when wge_hrs.thu_wge=0 and wge_hrs.thu_hrs=0 then 0 when wge_hrs.thu_wge=0 then 0 when wge_hrs.thu_hrs=0 then 0 
else NVL(ROUND((wge_hrs.thu_wge / wge_hrs.thu_hrs),2),0) end as Thu,
case when wge_hrs.fri_wge=0 and wge_hrs.fri_hrs=0 then 0 when wge_hrs.fri_wge=0 then 0 when wge_hrs.fri_hrs=0 then 0 
else NVL(ROUND((wge_hrs.fri_wge / wge_hrs.fri_hrs),2),0) end as Fri,
case when wge_hrs.sat_wge=0 and wge_hrs.sat_hrs=0 then 0 when wge_hrs.sat_wge=0 then 0 when wge_hrs.sat_hrs=0 then 0 
else NVL(ROUND((wge_hrs.sat_wge / wge_hrs.sat_hrs),2),0) end as Sat,
case when wge_hrs.sun_wge=0 and wge_hrs.sun_hrs=0 then 0 when wge_hrs.sun_wge=0 then 0 when wge_hrs.sun_hrs=0 then 0 
else NVL(ROUND((wge_hrs.sun_wge / wge_hrs.sun_hrs),2),0) end as Sun from
(select z.rgn_no,y.Mon_wge,y.Tue_wge,y.Wed_wge,y.Thu_wge,y.Fri_wge,y.Sat_wge,y.Sun_wge,y.wtd_wge,
y.Mon_hrs,y.Tue_hrs,y.Wed_hrs,y.Thu_hrs,y.Fri_hrs,y.Sat_hrs,y.Sun_hrs,y.wtd_hrs from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_wge + x.Tue_wge + x.Wed_wge + x.Thu_wge + x.Fri_wge + x.Sat_wge + x.Sun_wge) as WTD_wge,
(x.Mon_hrs + x.Tue_hrs + x.Wed_hrs + x.Thu_hrs + x.Fri_hrs + x.Sat_hrs + x.Sun_hrs) as WTD_hrs from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DPBU)),0) Mon_wge,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DPBU)),0) Tue_wge,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DPBU)),0) Wed_wge,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DPBU)),0) Thu_wge,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DPBU)),0) Fri_wge,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DPBU)),0) Sat_wge,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DPBU)),0) Sun_wge,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DPBU)),0) Mon_hrs,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DPBU)),0) Tue_hrs,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DPBU)),0) Wed_hrs,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DPBU)),0) Thu_hrs,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DPBU)),0) Fri_hrs,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DPBU)),0) Sat_hrs,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DPBU)),0) Sun_hrs from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_DPBU,sum(h.PLN_HRS_DTS) as PLN_HRS_DPBU from 
(select e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no) wge_hrs) nyu
where nyu.rgn_no = den.rgn_no
  ]]> 
  </VarianceCPHColumn>
<VarianceCPHTotal>
<![CDATA[select nyu.div_no,
case when den.Mon=0 or nyu.Mon=0 then 0 
else ROUND((den.Mon - nyu.Mon),2) end as Mon,
case when den.Tue=0 or nyu.Tue=0 then 0 
else ROUND((den.Tue - nyu.Tue),2) end as Tue,
case when den.Wed=0 or nyu.Wed=0 then 0 
else ROUND((den.Wed - nyu.Wed),2) end as Wed,
case when den.Thu=0 or nyu.Thu=0 then 0 
else ROUND((den.Thu - nyu.Thu),2) end as Thu,
case when den.Fri=0 or nyu.Fri=0 then 0 
else ROUND((den.Fri - nyu.Fri),2) end as Fri,
case when den.Sat=0 or nyu.Sat=0 then 0 
else ROUND((den.Sat - nyu.Sat),2) end as Sat,
case when den.Sun=0 or nyu.Sun=0 then 0 
else ROUND((den.Sun - nyu.Sun),2) end as Sun from
(select wge.div_no,
case when wge.mon=0 and hrs.mon=0 then 0 when wge.mon=0 then 0 when hrs.mon=0 then 0
else NVL(ROUND((wge.mon / hrs.mon),2),0) end as mon, 
case when wge.tue=0 and hrs.tue=0 then 0 when wge.tue=0 then 0 when hrs.tue=0 then 0
else NVL(ROUND((wge.tue / hrs.tue),2),0) end as tue,
case when wge.wed=0 and hrs.wed=0 then 0 when wge.wed=0 then 0 when hrs.wed=0 then 0
else NVL(ROUND((wge.wed / hrs.wed),2),0) end as wed,
case when wge.thu=0 and hrs.thu=0 then 0 when wge.thu=0 then 0 when hrs.thu=0 then 0
else NVL(ROUND((wge.thu / hrs.thu),2),0) end as thu,
case when wge.fri=0 and hrs.fri=0 then 0 when wge.fri=0 then 0 when hrs.fri=0 then 0
else NVL(ROUND((wge.fri / hrs.fri),2),0) end as fri,
case when wge.sat=0 and hrs.sat=0 then 0 when wge.sat=0 then 0 when hrs.sat=0 then 0
else NVL(ROUND((wge.sat / hrs.sat),2),0) end as sat,
case when wge.sun=0 and hrs.sun=0 then 0 when wge.sun=0 then 0 when hrs.sun=0 then 0
else NVL(ROUND((wge.sun / hrs.sun),2),0) end as sun from 
(select lc.div_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select lc.div_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt /*and c.wk_end and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) hrs 
where wge.div_no=hrs.div_no) den,
(select wge_hrs.div_no,
case when wge_hrs.mon_wge=0 and wge_hrs.mon_hrs=0 then 0 when wge_hrs.mon_wge=0 then 0 when wge_hrs.mon_hrs=0 then 0 
else NVL(ROUND((wge_hrs.mon_wge / wge_hrs.mon_hrs),2),0) end as Mon,
case when wge_hrs.tue_wge=0 and wge_hrs.tue_hrs=0 then 0 when wge_hrs.tue_wge=0 then 0 when wge_hrs.tue_hrs=0 then 0 
else NVL(ROUND((wge_hrs.tue_wge / wge_hrs.tue_hrs),2),0) end as Tue,
case when wge_hrs.wed_wge=0 and wge_hrs.wed_hrs=0 then 0 when wge_hrs.wed_wge=0 then 0 when wge_hrs.wed_hrs=0 then 0 
else NVL(ROUND((wge_hrs.wed_wge / wge_hrs.wed_hrs),2),0) end as Wed,
case when wge_hrs.thu_wge=0 and wge_hrs.thu_hrs=0 then 0 when wge_hrs.thu_wge=0 then 0 when wge_hrs.thu_hrs=0 then 0 
else NVL(ROUND((wge_hrs.thu_wge / wge_hrs.thu_hrs),2),0) end as Thu,
case when wge_hrs.fri_wge=0 and wge_hrs.fri_hrs=0 then 0 when wge_hrs.fri_wge=0 then 0 when wge_hrs.fri_hrs=0 then 0 
else NVL(ROUND((wge_hrs.fri_wge / wge_hrs.fri_hrs),2),0) end as Fri,
case when wge_hrs.sat_wge=0 and wge_hrs.sat_hrs=0 then 0 when wge_hrs.sat_wge=0 then 0 when wge_hrs.sat_hrs=0 then 0 
else NVL(ROUND((wge_hrs.sat_wge / wge_hrs.sat_hrs),2),0) end as Sat,
case when wge_hrs.sun_wge=0 and wge_hrs.sun_hrs=0 then 0 when wge_hrs.sun_wge=0 then 0 when wge_hrs.sun_hrs=0 then 0 
else NVL(ROUND((wge_hrs.sun_wge / wge_hrs.sun_hrs),2),0) end as Sun from
(select z.div_no,y.Mon_wge,y.Tue_wge,y.Wed_wge,y.Thu_wge,y.Fri_wge,y.Sat_wge,y.Sun_wge,y.wtd_wge,
y.Mon_hrs,y.Tue_hrs,y.Wed_hrs,y.Thu_hrs,y.Fri_hrs,y.Sat_hrs,y.Sun_hrs,y.wtd_hrs from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_wge + x.Tue_wge + x.Wed_wge + x.Thu_wge + x.Fri_wge + x.Sat_wge + x.Sun_wge) as WTD_wge,
(x.Mon_hrs + x.Tue_hrs + x.Wed_hrs + x.Thu_hrs + x.Fri_hrs + x.Sat_hrs + x.Sun_hrs) as WTD_hrs from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DPBU)),0) Mon_wge,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DPBU)),0) Tue_wge,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DPBU)),0) Wed_wge,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DPBU)),0) Thu_wge,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DPBU)),0) Fri_wge,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DPBU)),0) Sat_wge,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DPBU)),0) Sun_wge,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DPBU)),0) Mon_hrs,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DPBU)),0) Tue_hrs,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DPBU)),0) Wed_hrs,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DPBU)),0) Thu_hrs,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DPBU)),0) Fri_hrs,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DPBU)),0) Sat_hrs,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DPBU)),0) Sun_hrs from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_TOT_DPBU,sum(h.PLN_HRS_DTS) as PLN_HRS_TOT_DPBU from 
(select e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.dly_wage_dte between c.wk_strt and c.wk_end /*and trunc(sysdate-1)*/ and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.zone_no,e.ar_no,e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no) wge_hrs) nyu
where nyu.div_no = den.div_no  
  ]]> 
  </VarianceCPHTotal>
<VarianceCPHWkToDt>
<![CDATA[ select nyu.rgn_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_CPH_DPG from
(select wge_hrs.rgn_no,
case when wge_hrs.wtd_wge=0 and wge_hrs.wtd_hrs=0 then 0 when wge_hrs.wtd_wge=0 then 0 when wge_hrs.wtd_hrs=0 then 0 
else NVL(ROUND((wge_hrs.wtd_wge / wge_hrs.wtd_hrs),2),0) end as WTD from 
(select wge.rgn_no,wge.WTD_WGE,hrs.WTD_HRS from 
(select lc.rgn_no,wge.ACTL_WGE_DTSBU as WTD_WGE from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/*UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i*/) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,wge.ACTL_HRS_DTSBU as WTD_HRS from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/*UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i*/) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) hrs 
where wge.rgn_no=hrs.rgn_no) wge_hrs) den,
(select wge_hrs.rgn_no,
case when wge_hrs.PLN_WGE_DPBU=0 and wge_hrs.PLN_HRS_DPBU=0 then 0 when wge_hrs.PLN_WGE_DPBU=0 then 0 when wge_hrs.PLN_HRS_DPBU=0 then 0 
else NVL(ROUND((wge_hrs.PLN_WGE_DPBU / wge_hrs.PLN_HRS_DPBU),2),0) end as WTD from
(select lc.rgn_no,ROUND(wge.PLN_WGE_DPBU,0) as PLN_WGE_DPBU,wge.PLN_HRS_DPBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WGE_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HRS_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge_hrs) nyu
where nyu.rgn_no= den.rgn_no

  ]]> 
  </VarianceCPHWkToDt>
<VarianceCPHWkToDtTotal>
<![CDATA[ select nyu.div_no,
case when den.WTD=0 or nyu.WTD=0 then 0 
else ROUND((den.WTD - nyu.WTD),2) end as VAR_CPH_TOT_DPG from
(select wge_hrs.div_no,
case when wge_hrs.wtd_wge=0 and wge_hrs.wtd_hrs=0 then 0 when wge_hrs.wtd_wge=0 then 0 when wge_hrs.wtd_hrs=0 then 0 
else NVL(ROUND((wge_hrs.wtd_wge / wge_hrs.wtd_hrs),2),0) end as WTD from 
(select wge.div_no,wge.wtd_wge,hrs.wtd_hrs from 
(select lc.div_no,wge.ACTL_WGE_TOT_DTSBU as WTD_WGE from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/*UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i*/) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select lc.div_no,wge.ACTL_HRS_TOT_DTSBU as WTD_HRS from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/*UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte in (select distinct max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week')
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i*/) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) hrs where wge.div_no=hrs.div_no order by wge.div_no) wge_hrs
order by wge_hrs.div_no) den,
(select wge_hrs.div_no,
case when wge_hrs.PLN_WGE_TOT_DPBU=0 and wge_hrs.PLN_HRS_TOT_DPBU=0 then 0 when wge_hrs.PLN_WGE_TOT_DPBU=0 then 0 when wge_hrs.PLN_HRS_TOT_DPBU=0 then 0 
else NVL(ROUND((wge_hrs.PLN_WGE_TOT_DPBU / wge_hrs.PLN_HRS_TOT_DPBU),2),0) end as WTD from
(select lc.div_no,ROUND(wge.PLN_WGE_TOT_DPBU,0) as PLN_WGE_TOT_DPBU,wge.PLN_HRS_TOT_DPBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WGE_TOT_DPBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HRS_TOT_DPBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28)  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) wge_hrs) nyu where nyu.div_no = den.div_no 
  ]]> 
  </VarianceCPHWkToDtTotal>
  </TCName>
  </configuration>