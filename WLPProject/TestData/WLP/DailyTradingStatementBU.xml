<?xml version="1.0" encoding="UTF-8"?>

<configuration>

<TCName name = "SalesColumnValidation" >
	<PlannedSales>
	<![CDATA[select lc.rgn_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select div_no,rgn_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N') group by div_no,rgn_no order by div_no,rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</PlannedSales>
	
	<PlannedSalesTotal>
	<![CDATA[select lc.div_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct div_no from ww_wlp.loc where div_no='Division' and wlp_live_ind in ('Y','N')) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTSG)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTSG)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTSG)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTSG)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTSG)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTSG)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTSG)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_TOT_DTSG from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no]]>
	</PlannedSalesTotal>
	
	<PlannedSalesWkToDt>
	<![CDATA[select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct rgn_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N') order by rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</PlannedSalesWkToDt>
	
	<PlannedSalesWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct div_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N')) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no]]>
	</PlannedSalesWkToDtTotal>
	
	
	
	
	
	
	<BudgetSales>
	<![CDATA[select lc.rgn_no,NVL(bdgt.BDGT_SALES_DTSBU,0) as BDGT_SLS_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no]]>
	</BudgetSales>
	
	<BudgetSalesTotal>
	<![CDATA[select lc.div_no,NVL(bdgt.BDGT_SALES_TOT_DTSBU,0) as BDGT_SLS_TOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,ROUND(sum(e.bdgt_sls),0) as BDGT_SALES_TOT_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) bdgt
on lc.div_no=bdgt.div_no order by lc.div_no]]>
	</BudgetSalesTotal>
	
	
	
	
	
	
	
	
	<ForecastSales>
	<![CDATA[select lc.rgn_no,NVL(fcst.FCST_SALES_DTSBU,0) as FCST_SLS_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,ROUND(sum(e.frcst_sls),0) as FCST_SALES_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) fcst
on lc.rgn_no=fcst.rgn_no order by lc.rgn_no]]>
	</ForecastSales>
	
	<ForecastSalesTotal>
	<![CDATA[select lc.div_no,NVL(fcst.FCST_SALES_TOT_DTSBU,0) as FCST_SLS_TOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,ROUND(sum(e.frcst_sls),0) as FCST_SALES_TOT_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) fcst
on lc.div_no=fcst.div_no order by lc.div_no]]>
	</ForecastSalesTotal>
	
	
	
	
	
	<PastWeekActualSales>
	<![CDATA[select lc.rgn_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_SLS_DTS),0) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</PastWeekActualSales>
	
	<PastWeekActualSalesTotal>
	<![CDATA[select lc.div_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_SLS_DTS),0) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no]]>
	</PastWeekActualSalesTotal>
	
	<PastWeekActualSalesWkToDt>
	<![CDATA[select lc.rgn_no,NVL(sls.wtd,0) as ACTl_SLS_WTD_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</PastWeekActualSalesWkToDt>
	
	<PastWeekActualSalesWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(sls.wtd,0) as ACTl_SLS_WTDTOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no]]>
	</PastWeekActualSalesWkToDtTotal>	
		
		
		
		
	<PastWeekLYsales>
	<![CDATA[select actl_cy.rgn_no,
CASE WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.Tue,0) = 0 AND NVL(actl_ly.Tue,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.Wed,0) = 0 AND NVL(actl_ly.Wed,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.Thu,0) = 0 AND NVL(actl_ly.Thu,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.Fri,0) = 0 AND NVL(actl_ly.Fri,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.Sat,0) = 0 AND NVL(actl_ly.Sat,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.Sun,0) = 0 AND NVL(actl_ly.Sun,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.rgn_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl_cy,
(select lc.rgn_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl_ly
where actl_cy.rgn_no=actl_ly.rgn_no]]>
	</PastWeekLYsales>
	
	<PastWeekLYSalesTotal>
	<![CDATA[select actl_cy.div_no,
CASE WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.Tue,0) = 0 AND NVL(actl_ly.Tue,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.Wed,0) = 0 AND NVL(actl_ly.Wed,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.Thu,0) = 0 AND NVL(actl_ly.Thu,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.Fri,0) = 0 AND NVL(actl_ly.Fri,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.Sat,0) = 0 AND NVL(actl_ly.Sat,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.Sun,0) = 0 AND NVL(actl_ly.Sun,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.div_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSR)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSR)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSR)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSR)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSR)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSR)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSR)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSR from 
(select * from 
(select e.div_no,e.rgn_no,e.ar_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk order by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.ar_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.rgn_no,e.ar_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.ar_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk order by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.ar_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.rgn_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk order by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl_cy,
(select lc.div_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSR)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSR)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSR)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSR)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSR)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSR)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSR)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSR from 
(select * from 
(select e.div_no,e.rgn_no,e.ar_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk order by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.zone_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.zone_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl_ly
where actl_cy.div_no=actl_ly.div_no]]>
	</PastWeekLYSalesTotal>
	
	<PastWeekLYSalesWkToDt>
	<![CDATA[select lc.rgn_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100  
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as LYPCT_SLS_WTD_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select cy_val.rgn_no,sum(cy_val.ACTL_SLS_CY_DTSBU) as cy_wtd,sum(ly_val.ACTL_SLS_LY_DTSBU) as ly_wtd from 
(select b.rgn_no,/* b.dte_of_wk, */sum(b.ACTL_SLS_DTS) as ACTL_SLS_CY_DTSBU from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.ACTL_SLS_DTS from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h ) b
group by b.rgn_no/* ,b.dte_of_wk */ order by b.rgn_no/* ,b.dte_of_wk */) cy_val,
(select b.rgn_no,/* b.dte_of_wk, */sum(b.ACTL_SLS_DTS) as ACTL_SLS_LY_DTSBU from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.ACTL_SLS_DTS from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h ) b
group by b.rgn_no/* ,b.dte_of_wk */ order by b.rgn_no/* ,b.dte_of_wk */) ly_val
where /* cy_val.dte_of_wk=ly_val.dte_of_wk and */ cy_val.rgn_no=ly_val.rgn_no 
group by cy_val.rgn_no order by cy_val.rgn_no) cyly_wtd
on cyly_wtd.rgn_no=lc.rgn_no order by lc.rgn_no ]]>
	</PastWeekLYSalesWkToDt>
	
	<PastWeekLYSalesWkToDtTotal>
	<![CDATA[select lc.div_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100  
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as LYPCT_SLS_WTDTOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select cy_val.div_no,sum(cy_val.ACTL_SLS_CY_TOT_DTSBU) as cy_wtd,sum(ly_val.ACTL_SLS_LY_TOT_DTSBU) as ly_wtd from 
(select h.div_no,/* SUBSTR(h.day_of_wk,0,2) as dte_of_wk, */sum(h.ACTL_SLS_DTS) as ACTL_SLS_CY_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no/* ,h.day_of_wk */ order by h.div_no/* ,h.day_of_wk */) cy_val,
(select h.div_no,/* SUBSTR(h.day_of_wk,0,2) as dte_of_wk, */sum(h.ACTL_SLS_DTS) as ACTL_SLS_LY_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no/* ,h.day_of_wk */ order by h.div_no/* ,h.day_of_wk */) ly_val
where /* cy_val.dte_of_wk=ly_val.dte_of_wk and */ cy_val.div_no=ly_val.div_no 
group by cy_val.div_no order by cy_val.div_no) cyly_wtd
on cyly_wtd.div_no=lc.div_no order by lc.div_no]]>
	</PastWeekLYSalesWkToDtTotal>
	




	
	<PastWeekVarSalesWkToDt>
	<![CDATA[select pln.rgn_no,(actl.wtd - pln.wtd) as VAR_SLS_WTD_DTSBU from 
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct rgn_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N') order by rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no) pln,
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end /*and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl
where pln.rgn_no=actl.rgn_no]]>
	</PastWeekVarSalesWkToDt>
	
	<PastWeekVarSalesWkToDtTotal>
	<![CDATA[select pln.div_no,(actl.wtd - pln.wtd) as VAR_SLS_WTD_DTSBU from 
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct div_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N')) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no) pln,
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl
where pln.div_no=actl.div_no]]>
	</PastWeekVarSalesWkToDtTotal>
	
	
	
	
	
	
	<PastWeekEstimatedFcstSales>
	<![CDATA[select lc.rgn_no,NVL(sls.wtd,0) as EST_FCST_SLS_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</PastWeekEstimatedFcstSales>
	
	<PastWeekEstimatedFcstSalesTotal>
	<![CDATA[select lc.div_no,NVL(sls.wtd,0) as EST_FCST_SLS_TOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no]]>
	</PastWeekEstimatedFcstSalesTotal>
	
	
	
	
	
	
	
	<PastWeekVarSales>
	<![CDATA[select bdgt.rgn_no,NVL(ROUND(estd.wtd - bdgt.wtd,0),0) as BDGT_VAR_SLS_WTD_DTSBU from 
(select lc.rgn_no,NVL(bdgt.BDGT_SALES_DTSBU,0) as wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.bdgt_sls) as BDGT_SALES_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no) bdgt,
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) estd
where bdgt.rgn_no=estd.rgn_no]]>
	</PastWeekVarSales>
	
	<PastWeekVarSalesTotal>
	<![CDATA[select bdgt.div_no,NVL(ROUND(estd.wtd - bdgt.wtd,0),0) as BDGT_VAR_SLS_WTDTOT_DTSBU from 
(select lc.div_no,NVL(bdgt.BDGT_SALES_TOT_DTSBU,0) as wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.bdgt_sls) as BDGT_SALES_TOT_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) bdgt
on lc.div_no=bdgt.div_no order by lc.div_no) bdgt,
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) estd
where bdgt.div_no=estd.div_no]]>
	</PastWeekVarSalesTotal>
	
	
	
	
	
	<PastWeekForecastVarSales>
	<![CDATA[select fcst.rgn_no,NVL(ROUND(estd.wtd - fcst.wtd,0),0) as FCST_VAR_SLS_WTD_DTSBU from 
(select lc.rgn_no,NVL(fcst.FCST_SALES_DTSBU,0) as wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,ROUND(sum(e.frcst_sls),0) as FCST_SALES_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) fcst
on lc.rgn_no=fcst.rgn_no order by lc.rgn_no) fcst,
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) estd
where fcst.rgn_no=estd.rgn_no]]>
	</PastWeekForecastVarSales>
	
	<PastWeekForecastVarSalesTotal>
	<![CDATA[select fcst.div_no,NVL(ROUND(estd.wtd - fcst.wtd,0),0) as FCST_VAR_SLS_WTDTOT_DTSS from 
(select lc.div_no,NVL(fcst.FCST_SALES_TOT_DTSBU,0) as wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,ROUND(sum(e.frcst_sls),0) as FCST_SALES_TOT_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) fcst
on lc.div_no=fcst.div_no order by lc.div_no) fcst,
(select lc.div_no,NVL(sls.wtd,0) as wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) estd
where fcst.div_no=estd.div_no]]>
	</PastWeekForecastVarSalesTotal>
	
	
	
	
	
	<PastWeekAllowedWages>
	<![CDATA[select src.rgn_no,
case when src.ACTL_SLS_DTSBU > src.BDGT_SLS_DTSBU 
	 then NVL(ROUND((((BDGT_WGE_PCT_DTSBU * BDGT_SLS_DTSBU) + ((ACTL_SLS_DTSBU - BDGT_SLS_DTSBU) * (PST_FACTOR_DTSBU * BDGT_WGE_PCT_DTSBU)))/100),0),0)
When src.ACTL_SLS_DTSBU < src.BDGT_SLS_DTSBU 
	 then NVL(ROUND((((BDGT_WGE_PCT_DTSBU * BDGT_SLS_DTSBU) + ((ACTL_SLS_DTSBU - BDGT_SLS_DTSBU) * (NGT_FACTOR_DTSBU * BDGT_WGE_PCT_DTSBU)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_DTSBU * ACTL_SLS_DTSBU)/100),0),0) end as ALWD_WGE_DTSBU from 

(select actl_sls.rgn_no,rte_fct.wk_id,actl_sls.ACTL_SLS_DTSBU,rte_fct.PST_FACTOR_DTSBU,rte_fct.NGT_FACTOR_DTSBU,
bdgt_wge_pct.BDGT_WGE_PCT_DTSBU,bdgt_wge_pct.BDGT_WGE_DTSBU,bdgt_wge_pct.BDGT_SLS_DTSBU from

(select lc.rgn_no,NVL(ROUND(sls.ACTL_SLS_DTSBU,0),0) as ACTL_SLS_DTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.wlp_live_ind in ('Y','N')  order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'   and a.dept_no not  IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_DTSBU,NVL(src.ngt_factor,1) as NGT_FACTOR_DTSBU from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select wge.rgn_no,NVL(ROUND(wge.BDGT_WGE_DTSBU,0),0) as BDGT_WGE_DTSBU, NVL(ROUND(sls.BDGT_SLS_DTSBU,0),0) as BDGT_SLS_DTSBU,
CASE When NVL(wge.BDGT_WGE_DTSBU,0)=0 and NVL(sls.BDGT_SLS_DTSBU,0)=0 Then 0
When NVL(wge.BDGT_WGE_DTSBU,0)=0 Then 0 When NVL(sls.BDGT_SLS_DTSBU,0)=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_DTSBU / sls.BDGT_SLS_DTSBU)*100,5),0) END as BDGT_WGE_PCT_DTSBU from 
(select lc.rgn_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_DTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.wlp_live_ind in ('Y','N') order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_DTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no) bdgt_wge_pct

where actl_sls.rgn_no=bdgt_wge_pct.rgn_no order by actl_sls.rgn_no,rte_fct.wk_id) src order by src.rgn_no  ]]>
	</PastWeekAllowedWages>
	
	<PastWeekAllowedWagesTotal>
	<![CDATA[select src.div_no,
case when src.ACTL_SLS_TOT_DTSBU > src.BDGT_SLS_TOT_DTSBU 
	 then NVL(ROUND((((BDGT_WGE_PCT_TOT_DTSBU * BDGT_SLS_TOT_DTSBU) + ((ACTL_SLS_TOT_DTSBU - BDGT_SLS_TOT_DTSBU) * (PST_FACTOR_TOT_DTSBU * BDGT_WGE_PCT_TOT_DTSBU)))/100),0),0)
When src.ACTL_SLS_TOT_DTSBU < src.BDGT_SLS_TOT_DTSBU 
	 then NVL(ROUND((((BDGT_WGE_PCT_TOT_DTSBU * BDGT_SLS_TOT_DTSBU) + ((ACTL_SLS_TOT_DTSBU - BDGT_SLS_TOT_DTSBU) * (NGT_FACTOR_TOT_DTSBU * BDGT_WGE_PCT_TOT_DTSBU)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_TOT_DTSBU * ACTL_SLS_TOT_DTSBU)/100),0),0) end as ALWD_WGE_TOT_DTSBU from 

(select actl_sls.div_no,rte_fct.wk_id,actl_sls.ACTL_SLS_TOT_DTSBU,rte_fct.PST_FACTOR_TOT_DTSBU,rte_fct.NGT_FACTOR_TOT_DTSBU,
bdgt_wge_pct.BDGT_WGE_PCT_TOT_DTSBU,bdgt_wge_pct.BDGT_WGE_TOT_DTSBU,bdgt_wge_pct.BDGT_SLS_TOT_DTSBU from

(select lc.div_no,NVL(ROUND(sls.ACTL_SLS_TOT_DTSBU,0),0) as ACTL_SLS_TOT_DTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division'   order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'   and a.dept_no not IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no order by lc.div_no) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_TOT_DTSBU,NVL(src.ngt_factor,1) as NGT_FACTOR_TOT_DTSBU from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select wge.div_no,NVL(ROUND(wge.BDGT_WGE_TOT_DTSBU,0),0) as BDGT_WGE_TOT_DTSBU, NVL(ROUND(sls.BDGT_SLS_TOT_DTSBU,0),0) as BDGT_SLS_TOT_DTSBU,
CASE When NVL(wge.BDGT_WGE_TOT_DTSBU,0)=0 and NVL(sls.BDGT_SLS_TOT_DTSBU,0)=0 Then 0
When NVL(wge.BDGT_WGE_TOT_DTSBU,0)=0 Then 0 When NVL(sls.BDGT_SLS_TOT_DTSBU,0)=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_DTSBU / sls.BDGT_SLS_TOT_DTSBU)*100,5),0) END as BDGT_WGE_PCT_TOT_DTSBU from 
(select lc.div_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_DTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.div_no=bdgt.div_no
group by lc.div_no order by lc.div_no) wge,
(select lc.div_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_DTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.div_no=bdgt.div_no
group by lc.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no) bdgt_wge_pct

where actl_sls.div_no=bdgt_wge_pct.div_no order by actl_sls.div_no,rte_fct.wk_id) src order by src.div_no]]>
	</PastWeekAllowedWagesTotal>
	
	
	
	
	
	
	
	<CurrentWeekActualSales>
	<![CDATA[select lc.rgn_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_SLS_DTS),0) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</CurrentWeekActualSales>
	
	<CurrentWeekActualSalesTotal>
	<![CDATA[select lc.div_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_SLS_DTS),0) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no]]>
	</CurrentWeekActualSalesTotal>
	
	<CurrentWeekActualSalesWkToDt>
	<![CDATA[select lc.rgn_no,NVL(sls.wtd,0) as ACTl_SLS_WTD_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'  and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'  and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'  and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</CurrentWeekActualSalesWkToDt>
	
	<CurrentWeekActualSalesWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(sls.wtd,0) as ACTl_SLS_WTDTOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'  and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no]]>
	</CurrentWeekActualSalesWkToDtTotal>	
		
		
		
		
	<CurrentWeekLYsales>
	<![CDATA[select actl_cy.rgn_no,
CASE WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.Tue,0) = 0 AND NVL(actl_ly.Tue,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.Wed,0) = 0 AND NVL(actl_ly.Wed,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.Thu,0) = 0 AND NVL(actl_ly.Thu,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.Fri,0) = 0 AND NVL(actl_ly.Fri,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.Sat,0) = 0 AND NVL(actl_ly.Sat,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.Sun,0) = 0 AND NVL(actl_ly.Sun,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.rgn_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl_cy,
(select lc.rgn_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl_ly
where actl_cy.rgn_no=actl_ly.rgn_no]]>
	</CurrentWeekLYsales>
	
	<CurrentWeekLYSalesTotal>
	<![CDATA[select actl_cy.div_no,
CASE WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.Tue,0) = 0 AND NVL(actl_ly.Tue,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.Wed,0) = 0 AND NVL(actl_ly.Wed,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.Thu,0) = 0 AND NVL(actl_ly.Thu,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.Fri,0) = 0 AND NVL(actl_ly.Fri,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.Sat,0) = 0 AND NVL(actl_ly.Sat,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.Sun,0) = 0 AND NVL(actl_ly.Sun,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.div_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSR)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSR)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSR)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSR)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSR)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSR)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSR)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSR from 
(select * from 
(select e.div_no,e.rgn_no,e.ar_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk order by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.ar_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.rgn_no,e.ar_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.ar_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk order by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.ar_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.rgn_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk order by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl_cy,
(select lc.div_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSR)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSR)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSR)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSR)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSR)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSR)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSR)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSR from 
(select * from 
(select e.div_no,e.rgn_no,e.ar_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk order by e.div_no,e.rgn_no,e.ar_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.zone_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.zone_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl_ly
where actl_cy.div_no=actl_ly.div_no]]>
	</CurrentWeekLYSalesTotal>
	
	<CurrentWeekLYSalesWkToDt>
	<![CDATA[select lc.rgn_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100  
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as LYPCT_SLS_WTD_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select cy_val.rgn_no,sum(cy_val.ACTL_SLS_CY_DTSBU) as cy_wtd,sum(ly_val.ACTL_SLS_LY_DTSBU) as ly_wtd from 
(select b.rgn_no,/* b.dte_of_wk, */sum(b.ACTL_SLS_DTS) as ACTL_SLS_CY_DTSBU from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.ACTL_SLS_DTS from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h ) b
group by b.rgn_no/* ,b.dte_of_wk */ order by b.rgn_no/* ,b.dte_of_wk */) cy_val,
(select b.rgn_no,/* b.dte_of_wk, */sum(b.ACTL_SLS_DTS) as ACTL_SLS_LY_DTSBU from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.ACTL_SLS_DTS from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )) h ) b
group by b.rgn_no/* ,b.dte_of_wk */ order by b.rgn_no/* ,b.dte_of_wk */) ly_val
where /* cy_val.dte_of_wk=ly_val.dte_of_wk and */ cy_val.rgn_no=ly_val.rgn_no 
group by cy_val.rgn_no order by cy_val.rgn_no) cyly_wtd
on cyly_wtd.rgn_no=lc.rgn_no order by lc.rgn_no ]]>
	</CurrentWeekLYSalesWkToDt>
	
	<CurrentWeekLYSalesWkToDtTotal>
	<![CDATA[select lc.div_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100  
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as LYPCT_SLS_WTDTOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select cy_val.div_no,sum(cy_val.ACTL_SLS_CY_TOT_DTSBU) as cy_wtd,sum(ly_val.ACTL_SLS_LY_TOT_DTSBU) as ly_wtd from 
(select h.div_no,/* SUBSTR(h.day_of_wk,0,2) as dte_of_wk, */sum(h.ACTL_SLS_DTS) as ACTL_SLS_CY_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.div_no/* ,h.day_of_wk */ order by h.div_no/* ,h.day_of_wk */) cy_val,
(select h.div_no,/* SUBSTR(h.day_of_wk,0,2) as dte_of_wk, */sum(h.ACTL_SLS_DTS) as ACTL_SLS_LY_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */) h 
group by h.div_no/* ,h.day_of_wk */ order by h.div_no/* ,h.day_of_wk */) ly_val
where /* cy_val.dte_of_wk=ly_val.dte_of_wk and */ cy_val.div_no=ly_val.div_no 
group by cy_val.div_no order by cy_val.div_no) cyly_wtd
on cyly_wtd.div_no=lc.div_no order by lc.div_no]]>
	</CurrentWeekLYSalesWkToDtTotal>
	




	
	<CurrentWeekVarSalesWkToDt>
	<![CDATA[select pln.rgn_no,(actl.wtd - pln.wtd) as VAR_SLS_WTD_DTSBU from 
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct rgn_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N') order by rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no) pln,
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'  and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'  and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl
where pln.rgn_no=actl.rgn_no]]>
	</CurrentWeekVarSalesWkToDt>
	
	<CurrentWeekVarSalesWkToDtTotal>
	<![CDATA[select pln.div_no,(actl.wtd - pln.wtd) as VAR_SLS_WTD_DTSBU from 
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct div_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N')) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no) pln,
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl
where pln.div_no=actl.div_no]]>
	</CurrentWeekVarSalesWkToDtTotal>
	
	
	
	
	
	
	<CurrentWeekEstimatedFcstSales>
	<![CDATA[select lc.rgn_no,NVL(sls.wtd,0) as EST_FCST_SLS_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/*where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</CurrentWeekEstimatedFcstSales>
	
	<CurrentWeekEstimatedFcstSalesTotal>
	<![CDATA[select lc.div_no,NVL(sls.wtd,0) as EST_FCST_SLS_TOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/*where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no]]>
	</CurrentWeekEstimatedFcstSalesTotal>
	
	
	
	
	
	
	
	<CurrentWeekVarSales>
	<![CDATA[select bdgt.rgn_no,NVL(ROUND(estd.wtd - bdgt.wtd,0),0) as BDGT_VAR_SLS_WTD_DTSBU from 
(select lc.rgn_no,NVL(bdgt.BDGT_SALES_DTSBU,0) as wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.bdgt_sls) as BDGT_SALES_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no) bdgt,
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/*where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) estd
where bdgt.rgn_no=estd.rgn_no order by bdgt.rgn_no ]]>
	</CurrentWeekVarSales>
	
	<CurrentWeekVarSalesTotal>
	<![CDATA[select bdgt.div_no,NVL(ROUND(estd.wtd - bdgt.wtd,0),0) as BDGT_VAR_SLS_WTDTOT_DTSBU from 
(select lc.div_no,NVL(bdgt.BDGT_SALES_TOT_DTSBU,0) as wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.bdgt_sls) as BDGT_SALES_TOT_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) bdgt
on lc.div_no=bdgt.div_no order by lc.div_no) bdgt,
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/*where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) estd
where bdgt.div_no=estd.div_no order by bdgt.div_no ]]>
	</CurrentWeekVarSalesTotal>
	
	
	
	
	
	<CurrentWeekForecastVarSales>
	<![CDATA[select fcst.rgn_no,NVL(ROUND(estd.wtd - fcst.wtd,0),0) as FCST_VAR_SLS_WTD_DTSBU from 
(select lc.rgn_no,NVL(fcst.FCST_SALES_DTSBU,0) as wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,ROUND(sum(e.frcst_sls),0) as FCST_SALES_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) fcst
on lc.rgn_no=fcst.rgn_no order by lc.rgn_no) fcst,
(select lc.rgn_no,NVL(sls.wtd,0) as wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/*where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) estd
where fcst.rgn_no=estd.rgn_no]]>
	</CurrentWeekForecastVarSales>
	
	<CurrentWeekForecastVarSalesTotal>
	<![CDATA[select fcst.div_no,NVL(ROUND(estd.wtd - fcst.wtd,0),0) as FCST_VAR_SLS_WTDTOT_DTSS from 
(select lc.div_no,NVL(fcst.FCST_SALES_TOT_DTSBU,0) as wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,ROUND(sum(e.frcst_sls),0) as FCST_SALES_TOT_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) fcst
on lc.div_no=fcst.div_no order by lc.div_no) fcst,
(select lc.div_no,NVL(sls.wtd,0) as wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/*where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) estd
where fcst.div_no=estd.div_no]]>
	</CurrentWeekForecastVarSalesTotal>
	
	
	
	
	
	<CurrentWeekAllowedWages>
	<![CDATA[select src.rgn_no,
case when src.ACTL_SLS_DTSBU > src.BDGT_SLS_DTSBU 
	 then NVL(ROUND((((BDGT_WGE_PCT_DTSBU * BDGT_SLS_DTSBU) + ((ACTL_SLS_DTSBU - BDGT_SLS_DTSBU) * (PST_FACTOR_DTSBU * BDGT_WGE_PCT_DTSBU)))/100),0),0)
When src.ACTL_SLS_DTSBU < src.BDGT_SLS_DTSBU 
	 then NVL(ROUND((((BDGT_WGE_PCT_DTSBU * BDGT_SLS_DTSBU) + ((ACTL_SLS_DTSBU - BDGT_SLS_DTSBU) * (NGT_FACTOR_DTSBU * BDGT_WGE_PCT_DTSBU)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_DTSBU * ACTL_SLS_DTSBU)/100),0),0) end as ALWD_WGE_DTSBU from 

(select actl_sls.rgn_no,rte_fct.wk_id,actl_sls.ACTL_SLS_DTSBU,rte_fct.PST_FACTOR_DTSBU,rte_fct.NGT_FACTOR_DTSBU,
bdgt_wge_pct.BDGT_WGE_PCT_DTSBU,bdgt_wge_pct.BDGT_WGE_DTSBU,bdgt_wge_pct.BDGT_SLS_DTSBU from

(select lc.rgn_no,NVL(ROUND(sls.ACTL_SLS_DTSBU,0),0) as ACTL_SLS_DTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.wlp_live_ind in ('Y','N')  order by b.rgn_no) lc
LEFT OUTER JOIN
(select h.rgn_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'   and a.dept_no not  IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/*where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.rgn_no order by h.rgn_no) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_DTSBU,NVL(src.ngt_factor,1) as NGT_FACTOR_DTSBU from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select wge.rgn_no,NVL(ROUND(wge.BDGT_WGE_DTSBU,0),0) as BDGT_WGE_DTSBU, NVL(ROUND(sls.BDGT_SLS_DTSBU,0),0) as BDGT_SLS_DTSBU,
CASE When NVL(wge.BDGT_WGE_DTSBU,0)=0 and NVL(sls.BDGT_SLS_DTSBU,0)=0 Then 0
When NVL(wge.BDGT_WGE_DTSBU,0)=0 Then 0 When NVL(sls.BDGT_SLS_DTSBU,0)=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_DTSBU / sls.BDGT_SLS_DTSBU)*100,5),0) END as BDGT_WGE_PCT_DTSBU from 
(select lc.rgn_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_DTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division' and b.wlp_live_ind in ('Y','N') order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_DTSBU from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no) bdgt_wge_pct

where actl_sls.rgn_no=bdgt_wge_pct.rgn_no order by actl_sls.rgn_no,rte_fct.wk_id) src order by src.rgn_no  ]]>
	</CurrentWeekAllowedWages>
	
	<CurrentWeekAllowedWagesTotal>
	<![CDATA[select src.div_no,
case when src.ACTL_SLS_TOT_DTSBU > src.BDGT_SLS_TOT_DTSBU 
	 then NVL(ROUND((((BDGT_WGE_PCT_TOT_DTSBU * BDGT_SLS_TOT_DTSBU) + ((ACTL_SLS_TOT_DTSBU - BDGT_SLS_TOT_DTSBU) * (PST_FACTOR_TOT_DTSBU * BDGT_WGE_PCT_TOT_DTSBU)))/100),0),0)
When src.ACTL_SLS_TOT_DTSBU < src.BDGT_SLS_TOT_DTSBU 
	 then NVL(ROUND((((BDGT_WGE_PCT_TOT_DTSBU * BDGT_SLS_TOT_DTSBU) + ((ACTL_SLS_TOT_DTSBU - BDGT_SLS_TOT_DTSBU) * (NGT_FACTOR_TOT_DTSBU * BDGT_WGE_PCT_TOT_DTSBU)))/100),0),0)
else NVL(ROUND(((BDGT_WGE_PCT_TOT_DTSBU * ACTL_SLS_TOT_DTSBU)/100),0),0) end as ALWD_WGE_TOT_DTSBU from 

(select actl_sls.div_no,rte_fct.wk_id,actl_sls.ACTL_SLS_TOT_DTSBU,rte_fct.PST_FACTOR_TOT_DTSBU,rte_fct.NGT_FACTOR_TOT_DTSBU,
bdgt_wge_pct.BDGT_WGE_PCT_TOT_DTSBU,bdgt_wge_pct.BDGT_WGE_TOT_DTSBU,bdgt_wge_pct.BDGT_SLS_TOT_DTSBU from

(select lc.div_no,NVL(ROUND(sls.ACTL_SLS_TOT_DTSBU,0),0) as ACTL_SLS_TOT_DTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division'   order by b.div_no) lc
LEFT OUTER JOIN
(select h.div_no,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'   and a.dept_no not IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/*where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.div_no order by h.div_no) sls
on lc.div_no=sls.div_no order by lc.div_no) actl_sls,

(select lc.wk_id,NVL(src.pst_factor,0.5) as PST_FACTOR_TOT_DTSBU,NVL(src.ngt_factor,1) as NGT_FACTOR_TOT_DTSBU from 
(select perd_desc,wk_id from wk where wk_id='Week') lc
LEFT OUTER JOIN 
(select * from WAGE_FCTR_CNFG where (wk_id,rgn_no) in 
(select wk_id,max(rgn_no) as rgn_no from WAGE_FCTR_CNFG where wk_id in (select wk_id from wk where wk_id='Week') and rgn_no in (99) group by wk_id)
order by wk_id,rgn_no) src
on lc.wk_id=src.wk_id order by lc.wk_id,src.rgn_no) rte_fct,

(select wge.div_no,NVL(ROUND(wge.BDGT_WGE_TOT_DTSBU,0),0) as BDGT_WGE_TOT_DTSBU, NVL(ROUND(sls.BDGT_SLS_TOT_DTSBU,0),0) as BDGT_SLS_TOT_DTSBU,
CASE When NVL(wge.BDGT_WGE_TOT_DTSBU,0)=0 and NVL(sls.BDGT_SLS_TOT_DTSBU,0)=0 Then 0
When NVL(wge.BDGT_WGE_TOT_DTSBU,0)=0 Then 0 When NVL(sls.BDGT_SLS_TOT_DTSBU,0)=0 Then 0
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_DTSBU / sls.BDGT_SLS_TOT_DTSBU)*100,5),0) END as BDGT_WGE_PCT_TOT_DTSBU from 
(select lc.div_no,NVL(sum(bdgt.bdgt_wage_amt),0) as BDGT_WGE_TOT_DTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.div_no=bdgt.div_no
group by lc.div_no order by lc.div_no) wge,
(select lc.div_no,NVL(sum(bdgt.bdgt_sls),0) as BDGT_SLS_TOT_DTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.div_no=bdgt.div_no
group by lc.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no) bdgt_wge_pct

where actl_sls.div_no=bdgt_wge_pct.div_no order by actl_sls.div_no,rte_fct.wk_id) src order by src.div_no]]>
	</CurrentWeekAllowedWagesTotal>
	
	
</TCName>







<TCName name = "ItemsColumnValidation" >
	<PlannedItems>
	<![CDATA[select lc.rgn_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select div_no,rgn_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N') group by div_no,rgn_no order by div_no,rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</PlannedItems>
	
	<PlannedItemsTotal>
	<![CDATA[ select lc.div_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct div_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N')) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by sls.div_no   ]]>
	</PlannedItemsTotal>
	
	<PlannedItemsWkToDt>
	<![CDATA[select lc.rgn_no,NVL(sls.wtd,0) as PLN_ITM_WTD_DTSBU from 
(select distinct div_no,rgn_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</PlannedItemsWkToDt>
	
	<PlannedItemsWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(sls.wtd,0) as PLN_ITM_WTDTOT_DTSBU from 
(select distinct div_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N')) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no ]]>
	</PlannedItemsWkToDtTotal>
	




	
	<PastWeekActualItems>
	<![CDATA[select lc.rgn_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_ITM_DTS),0) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</PastWeekActualItems>
	
	<PastWeekActualItemsTotal>
	
	<![CDATA[select lc.div_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_ITM_DTS),0) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no]]>
	</PastWeekActualItemsTotal>	
	
	<PastWeekActualItemsWkToDt>
	<![CDATA[select lc.rgn_no,NVL(sls.wtd,0) as ACTL_ITM_WTD_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</PastWeekActualItemsWkToDt>
	
	<PastWeekActualItemsWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(sls.wtd,0) as ACTL_ITM_WTDTOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no]]>
	</PastWeekActualItemsWkToDtTotal>
	
	
	
	
	
	<PastWeekLYItems>
	<![CDATA[select actl_cy.rgn_no,
CASE WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
	WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.Tue,0) = 0 AND NVL(actl_ly.Tue,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.Wed,0) = 0 AND NVL(actl_ly.Wed,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.Thu,0) = 0 AND NVL(actl_ly.Thu,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.Fri,0) = 0 AND NVL(actl_ly.Fri,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.Sat,0) = 0 AND NVL(actl_ly.Sat,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.Sun,0) = 0 AND NVL(actl_ly.Sun,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.rgn_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl_cy,
(select lc.rgn_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl_ly
where actl_cy.rgn_no=actl_ly.rgn_no order by actl_ly.rgn_no ]]>
	</PastWeekLYItems>
	
	
	<PastWeekLYItemsTotal>
	<![CDATA[select actl_cy.div_no,
CASE WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
	WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.Tue,0) = 0 AND NVL(actl_ly.Tue,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.Wed,0) = 0 AND NVL(actl_ly.Wed,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.Thu,0) = 0 AND NVL(actl_ly.Thu,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.Fri,0) = 0 AND NVL(actl_ly.Fri,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.Sat,0) = 0 AND NVL(actl_ly.Sat,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.Sun,0) = 0 AND NVL(actl_ly.Sun,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.div_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl_cy,
(select lc.div_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl_ly
where actl_cy.div_no=actl_ly.div_no ORDER BY actl_cy.div_no]]>
	</PastWeekLYItemsTotal>
	
	<PastWeekLYItemsWkToDt>
	<![CDATA[select lc.rgn_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0 
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100     
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as LYPCT_ITM_WTD_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select cy_val.rgn_no,sum(cy_val.ACTL_ITM_CY_DTSBU) as cy_wtd,sum(ly_val.ACTL_ITM_LY_DTSBU) as ly_wtd from 
(select b.rgn_no,/* b.dte_of_wk, */sum(b.ACTL_ITM_DTS) ACTL_ITM_CY_DTSBU from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.ACTL_ITM_DTS from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e )  */) h ) b
group by b.rgn_no/* ,b.dte_of_wk */ order by b.rgn_no/* ,b.dte_of_wk */) cy_val,
(select b.rgn_no,/* b.dte_of_wk, */sum(b.ACTL_ITM_DTS) ACTL_ITM_LY_DTSBU from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.ACTL_ITM_DTS from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h ) b
group by b.rgn_no/* ,b.dte_of_wk */ order by b.rgn_no/* ,b.dte_of_wk */) ly_val
where /* cy_val.dte_of_wk=ly_val.dte_of_wk and */ cy_val.rgn_no=ly_val.rgn_no 
group by cy_val.rgn_no order by cy_val.rgn_no) cyly_wtd
on cyly_wtd.rgn_no=lc.rgn_no order by lc.rgn_no]]>
	</PastWeekLYItemsWkToDt>
		
	<PastWeekLYItemsWkToDtTotal>
	<![CDATA[select lc.div_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0 
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100   
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as LYPCT_ITM_WTDTOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select cy_val.div_no,sum(cy_val.ACTL_ITM_CY_TOT_DTSBU) as cy_wtd,sum(ly_val.ACTL_ITM_LY_TOT_DTSBU) as ly_wtd from 
(select h.div_no,/* SUBSTR(h.day_of_wk,0,2) as dte_of_wk, */sum(h.ACTL_ITM_DTS) as ACTL_ITM_CY_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e )  */) h 
group by h.div_no/* ,h.day_of_wk */ order by h.div_no/* ,h.day_of_wk */) cy_val,
(select h.div_no,/* SUBSTR(h.day_of_wk,0,2) as dte_of_wk, */sum(h.ACTL_ITM_DTS) as ACTL_ITM_LY_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.div_no/* ,h.day_of_wk */ order by h.div_no/* ,h.day_of_wk */) ly_val
where /* cy_val.dte_of_wk=ly_val.dte_of_wk and */ cy_val.div_no=ly_val.div_no 
group by cy_val.div_no order by cy_val.div_no) cyly_wtd
on cyly_wtd.div_no=lc.div_no order by lc.div_no]]>
	</PastWeekLYItemsWkToDtTotal>

	
	
	
	
	
	<PastWeekVarItemsWkToDt>
	<![CDATA[select pln.rgn_no,(actl.wtd - pln.wtd) as VAR_ITM_WTD_DTSBU from 
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct rgn_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no) pln,
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]>
	</PastWeekVarItemsWkToDt>
	
	<PastWeekVarItemsWkToDtTotal>
	<![CDATA[select pln.div_no,(actl.wtd - pln.wtd) as VAR_ITM_WTDTOT_DTSBU from 
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct div_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N')) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no) pln,
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl
where pln.div_no=actl.div_no order by pln.div_no ]]>
	</PastWeekVarItemsWkToDtTotal>
	

	
	
	


<CurrentWeekActualItems>
	<![CDATA[select lc.rgn_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_ITM_DTS),0) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</CurrentWeekActualItems>
	
	<CurrentWeekActualItemsTotal>
	
	<![CDATA[select lc.div_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_ITM_DTS),0) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no]]>
	</CurrentWeekActualItemsTotal>	
	
	<CurrentWeekActualItemsWkToDt>
	<![CDATA[select lc.rgn_no,NVL(sls.wtd,0) as ACTL_ITM_WTD_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'  and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'  and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e )  */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</CurrentWeekActualItemsWkToDt>
	
	<CurrentWeekActualItemsWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(sls.wtd,0) as ACTL_ITM_WTDTOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e )  */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no]]>
	</CurrentWeekActualItemsWkToDtTotal>
	
	
	
	
	
	<CurrentWeekLYItems>
	<![CDATA[select actl_cy.rgn_no,
CASE WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
	WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.Tue,0) = 0 AND NVL(actl_ly.Tue,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.Wed,0) = 0 AND NVL(actl_ly.Wed,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.Thu,0) = 0 AND NVL(actl_ly.Thu,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.Fri,0) = 0 AND NVL(actl_ly.Fri,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.Sat,0) = 0 AND NVL(actl_ly.Sat,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.Sun,0) = 0 AND NVL(actl_ly.Sun,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.rgn_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl_cy,
(select lc.rgn_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl_ly
where actl_cy.rgn_no=actl_ly.rgn_no order by actl_ly.rgn_no ]]>
	</CurrentWeekLYItems>
	
	
	<CurrentWeekLYItemsTotal>
	<![CDATA[select actl_cy.div_no,
CASE WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
	WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.Tue,0) = 0 AND NVL(actl_ly.Tue,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.Wed,0) = 0 AND NVL(actl_ly.Wed,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.Thu,0) = 0 AND NVL(actl_ly.Thu,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.Fri,0) = 0 AND NVL(actl_ly.Fri,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.Sat,0) = 0 AND NVL(actl_ly.Sat,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.Sun,0) = 0 AND NVL(actl_ly.Sun,0) = 0 THEN 0 
	 WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.div_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl_cy,
(select lc.div_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl_ly
where actl_cy.div_no=actl_ly.div_no ORDER BY actl_cy.div_no]]>
	</CurrentWeekLYItemsTotal>
	
	<CurrentWeekLYItemsWkToDt>
	<![CDATA[select lc.rgn_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0 
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100     
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as LYPCT_ITM_WTD_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select cy_val.rgn_no,sum(cy_val.ACTL_ITM_CY_DTSBU) as cy_wtd,sum(ly_val.ACTL_ITM_LY_DTSBU) as ly_wtd from 
(select b.rgn_no,/* b.dte_of_wk, */sum(b.ACTL_ITM_DTS) ACTL_ITM_CY_DTSBU from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.ACTL_ITM_DTS from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/*where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h ) b
group by b.rgn_no/* ,b.dte_of_wk */ order by b.rgn_no/* ,b.dte_of_wk */) cy_val,
(select b.rgn_no,/* b.dte_of_wk, */sum(b.ACTL_ITM_DTS) ACTL_ITM_LY_DTSBU from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.ACTL_ITM_DTS from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h ) b
group by b.rgn_no/* ,b.dte_of_wk */ order by b.rgn_no/* ,b.dte_of_wk */) ly_val
where /* cy_val.dte_of_wk=ly_val.dte_of_wk and */ cy_val.rgn_no=ly_val.rgn_no 
group by cy_val.rgn_no order by cy_val.rgn_no) cyly_wtd
on cyly_wtd.rgn_no=lc.rgn_no order by lc.rgn_no]]>
	</CurrentWeekLYItemsWkToDt>
		
	<CurrentWeekLYItemsWkToDtTotal>
	<![CDATA[select lc.div_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0 
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100   
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as LYPCT_ITM_WTDTOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select cy_val.div_no,sum(cy_val.ACTL_ITM_CY_TOT_DTSBU) as cy_wtd,sum(ly_val.ACTL_ITM_LY_TOT_DTSBU) as ly_wtd from 
(select h.div_no,/* SUBSTR(h.day_of_wk,0,2) as dte_of_wk, */sum(h.ACTL_ITM_DTS) as ACTL_ITM_CY_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/*where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */ ) h 
group by h.div_no/* ,h.day_of_wk */ order by h.div_no/* ,h.day_of_wk */) cy_val,
(select h.div_no,/* SUBSTR(h.day_of_wk,0,2) as dte_of_wk, */sum(h.ACTL_ITM_DTS) as ACTL_ITM_LY_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.ar_no,pln_sls.loc_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */) h 
group by h.div_no/* ,h.day_of_wk */ order by h.div_no/* ,h.day_of_wk */) ly_val
where /* cy_val.dte_of_wk=ly_val.dte_of_wk and */ cy_val.div_no=ly_val.div_no 
group by cy_val.div_no order by cy_val.div_no) cyly_wtd
on cyly_wtd.div_no=lc.div_no order by lc.div_no]]>
	</CurrentWeekLYItemsWkToDtTotal>

	
	
	
	
	
	<CurrentWeekVarItemsWkToDt>
	<![CDATA[select pln.rgn_no,(actl.wtd - pln.wtd) as VAR_ITM_WTD_DTSBU from 
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct rgn_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N') order by div_no,rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no) pln,
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/*where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]>
	</CurrentWeekVarItemsWkToDt>
	
	<CurrentWeekVarItemsWkToDtTotal>
	<![CDATA[select pln.div_no,(actl.wtd - pln.wtd) as VAR_ITM_WTDTOT_DTSBU from 
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct div_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N')) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_ITM_DTS),0) as PLN_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no) pln,
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_ITM_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_ITM_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_ITM_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_ITM_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_ITM_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_ITM_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_ITM_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_ITM_DTS) as ACTL_ITM_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_itm_cnt is NOT NULL and a.actl_itm_cnt!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl
where pln.div_no=actl.div_no order by pln.div_no ]]>
	</CurrentWeekVarItemsWkToDtTotal>	
	

</TCName>



<TCName name = "CustomersColumnValidation" >
	<PlannedCustomers>
	<![CDATA[select lc.rgn_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct rgn_no from ww_wlp.loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk 
order by e.rgn_no,e.zone_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk 
order by e.rgn_no,e.zone_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk 
order by e.rgn_no,e.zone_no,e.day_of_wk) g ) sec_prty) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</PlannedCustomers>
	
	<PlannedCustomersTotal>
	<![CDATA[select lc.div_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct div_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N')) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no ]]>
	</PlannedCustomersTotal>
	
	<PlannedCustomersWkToDt>
	<![CDATA[select lc.rgn_no,NVL(sls.wtd,0) as PLN_CUST_WTD_DTSBU from 
(select distinct rgn_no from ww_wlp.loc where div_no='Division' 
and wlp_live_ind in ('Y','N') order by rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</PlannedCustomersWkToDt>
	
	<PlannedCustomersWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(sls.wtd,0) as PLN_CUST_WTDTOT_DTSR from 
(select distinct div_no from ww_wlp.loc where div_no='Division' 
and wlp_live_ind in ('Y','N')) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no]]>
	</PlannedCustomersWkToDtTotal>
	
	<PastWeekActualCustomers>
	<![CDATA[select lc.rgn_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_CUST_DTS),0) as ACTL_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) g ) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</PastWeekActualCustomers>
	
	<PastWeekActualCustomersTotal>
	<![CDATA[select lc.div_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_CUST_DTS),0) as ACTL_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no]]>
	</PastWeekActualCustomersTotal>
	
	
	<PastWeekActualCustomersWkToDt>
	<![CDATA[select lc.rgn_no,NVL(sls.wtd,0) as ACTL_CUST_WTD_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )  */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</PastWeekActualCustomersWkToDt>
	
	<PastWeekActualCustomersWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(sls.wtd,0) as ACTL_CUST_WTDTOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no]]>
	</PastWeekActualCustomersWkToDtTotal>
	



	
	<PastWeekLYCustomers>
	<![CDATA[select actl_cy.rgn_no,
CASE WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.Tue,0) = 0 AND NVL(actl_ly.Tue,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.Wed,0) = 0 AND NVL(actl_ly.Wed,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.Thu,0) = 0 AND NVL(actl_ly.Thu,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.Fri,0) = 0 AND NVL(actl_ly.Fri,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.Sat,0) = 0 AND NVL(actl_ly.Sat,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.Sun,0) = 0 AND NVL(actl_ly.Sun,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.rgn_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) g ) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl_cy,
(select lc.rgn_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl_ly
where actl_cy.rgn_no=actl_ly.rgn_no order by actl_cy.rgn_no  ]]>
	</PastWeekLYCustomers>
	
	<PastWeekLYCustomersTotal>
	<![CDATA[select actl_cy.div_no,
CASE WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.Tue,0) = 0 AND NVL(actl_ly.Tue,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.Wed,0) = 0 AND NVL(actl_ly.Wed,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.Thu,0) = 0 AND NVL(actl_ly.Thu,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.Fri,0) = 0 AND NVL(actl_ly.Fri,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.Sat,0) = 0 AND NVL(actl_ly.Sat,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.Sun,0) = 0 AND NVL(actl_ly.Sun,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.div_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl_cy,
(select lc.div_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl_ly
where actl_cy.div_no=actl_ly.div_no order by actl_cy.div_no  ]]>
	</PastWeekLYCustomersTotal>
	
	
	<PastWeekLYCustomersWkToDt>
	<![CDATA[select lc.rgn_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN -100
     WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as LYPCT_CUST_WTD_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select cy_val.rgn_no,sum(cy_val.ACTL_CUST_CY_DTSBU) as cy_wtd,sum(ly_val.ACTL_CUST_LY_DTSBU) as ly_wtd from 
(select b.rgn_no,/* b.dte_of_wk, */sum(b.ACTL_CUST_DTS) ACTL_CUST_CY_DTSBU from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.ACTL_CUST_DTS from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */ ) h ) b
group by b.rgn_no/* ,b.dte_of_wk */ order by b.rgn_no/* ,b.dte_of_wk */) cy_val,
(select b.rgn_no,/* b.dte_of_wk, */sum(b.ACTL_CUST_DTS) ACTL_CUST_LY_DTSBU from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.ACTL_CUST_DTS from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h ) b
group by b.rgn_no/* ,b.dte_of_wk */ order by b.rgn_no/* ,b.dte_of_wk */) ly_val
where /* cy_val.dte_of_wk=ly_val.dte_of_wk and */ cy_val.rgn_no=ly_val.rgn_no 
group by cy_val.rgn_no order by cy_val.rgn_no) cyly_wtd
on cyly_wtd.rgn_no=lc.rgn_no order by lc.rgn_no]]>
	</PastWeekLYCustomersWkToDt>
	
	<PastWeekLYCustomersWkToDtTotal>
	<![CDATA[select lc.div_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100
     WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as LYPCT_CUST_WTDTOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select cy_val.div_no,sum(cy_val.ACTL_CUST_CY_TOT_DTSBU) as cy_wtd,sum(ly_val.ACTL_CUST_LY_TOT_DTSBU) as ly_wtd from 
(select h.div_no,/* SUBSTR(h.day_of_wk,0,2) as dte_of_wk, */sum(h.ACTL_CUST_DTS) as ACTL_CUST_CY_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */ ) h 
group by h.div_no/* ,h.day_of_wk */ order by h.div_no/* ,h.day_of_wk */) cy_val,
(select h.div_no,/* SUBSTR(h.day_of_wk,0,2) as dte_of_wk, */sum(h.ACTL_CUST_DTS) as ACTL_CUST_LY_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.div_no/* ,h.day_of_wk */ order by h.div_no/* ,h.day_of_wk */) ly_val
where /* cy_val.dte_of_wk=ly_val.dte_of_wk and */ cy_val.div_no=ly_val.div_no 
group by cy_val.div_no order by cy_val.div_no) cyly_wtd
on cyly_wtd.div_no=lc.div_no order by lc.div_no]]>
	</PastWeekLYCustomersWkToDtTotal>
	
	
	
	
	
	<PastWeekVarCustomersWkToDt>
	<![CDATA[select pln.rgn_no,(actl.wtd - pln.wtd) as VAR_CUST_WTD_DTSBU from 
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct rgn_no from ww_wlp.loc where div_no='Division' and wlp_live_ind in ('Y','N') order by rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no) pln,
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]>
	</PastWeekVarCustomersWkToDt>
	

	<PastWeekVarCustomersWkToDtTotal>
	<![CDATA[select pln.div_no,(actl.wtd - pln.wtd) as VAR_CUST_WTDTOT_DTSBU from 
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct div_no from ww_wlp.loc where div_no='Division' and wlp_live_ind in ('Y','N') order by div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no) pln,
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )  */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl
where pln.div_no=actl.div_no  order by pln.div_no  ]]>
	</PastWeekVarCustomersWkToDtTotal>




<CurrentWeekActualCustomers>
	<![CDATA[select lc.rgn_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_CUST_DTS),0) as ACTL_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) g ) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</CurrentWeekActualCustomers>
	
	<CurrentWeekActualCustomersTotal>
	<![CDATA[select lc.div_no,NVL(sls.mon,0) as Mon,NVL(sls.tue,0) as Tue,NVL(sls.wed,0) as Wed,NVL(sls.thu,0) as Thu,
NVL(sls.fri,0) as Fri,NVL(sls.sat,0) as Sat,NVL(sls.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_CUST_DTS),0) as ACTL_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no]]>
	</CurrentWeekActualCustomersTotal>
	
	
	<CurrentWeekActualCustomersWkToDt>
	<![CDATA[select lc.rgn_no,NVL(sls.wtd,0) as ACTL_CUST_WTD_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no]]>
	</CurrentWeekActualCustomersWkToDt>
	
	<CurrentWeekActualCustomersWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(sls.wtd,0) as ACTL_CUST_WTDTOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no]]>
	</CurrentWeekActualCustomersWkToDtTotal>
	



	
	<CurrentWeekLYCustomers>
	<![CDATA[select actl_cy.rgn_no,
CASE WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.Tue,0) = 0 AND NVL(actl_ly.Tue,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.Wed,0) = 0 AND NVL(actl_ly.Wed,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.Thu,0) = 0 AND NVL(actl_ly.Thu,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.Fri,0) = 0 AND NVL(actl_ly.Fri,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.Sat,0) = 0 AND NVL(actl_ly.Sat,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.Sun,0) = 0 AND NVL(actl_ly.Sun,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.rgn_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) g ) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl_cy,
(select lc.rgn_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl_ly
where actl_cy.rgn_no=actl_ly.rgn_no order by actl_cy.rgn_no  ]]>
	</CurrentWeekLYCustomers>
	
	<CurrentWeekLYCustomersTotal>
	<![CDATA[select actl_cy.div_no,
CASE WHEN NVL(actl_cy.Mon,0) = 0 AND NVL(actl_ly.Mon,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.Tue,0) = 0 AND NVL(actl_ly.Tue,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.Wed,0) = 0 AND NVL(actl_ly.Wed,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.Thu,0) = 0 AND NVL(actl_ly.Thu,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.Fri,0) = 0 AND NVL(actl_ly.Fri,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.Sat,0) = 0 AND NVL(actl_ly.Sat,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.Sun,0) = 0 AND NVL(actl_ly.Sun,0) = 0 THEN 0 
     WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.div_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl_cy,
(select lc.div_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl_ly
where actl_cy.div_no=actl_ly.div_no order by actl_cy.div_no  ]]>
	</CurrentWeekLYCustomersTotal>
	
	
	<CurrentWeekLYCustomersWkToDt>
	<![CDATA[select lc.rgn_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN -100
     WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as LYPCT_CUST_WTD_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select cy_val.rgn_no,sum(cy_val.ACTL_CUST_CY_DTSBU) as cy_wtd,sum(ly_val.ACTL_CUST_LY_DTSBU) as ly_wtd from 
(select b.rgn_no,/* b.dte_of_wk, */sum(b.ACTL_CUST_DTS) ACTL_CUST_CY_DTSBU from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.ACTL_CUST_DTS from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'  and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e )  */) h ) b
group by b.rgn_no/* ,b.dte_of_wk */ order by b.rgn_no/* ,b.dte_of_wk */) cy_val,
(select b.rgn_no,/* b.dte_of_wk, */sum(b.ACTL_CUST_DTS) ACTL_CUST_LY_DTSBU from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,h.ACTL_CUST_DTS from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk
order by e.rgn_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h ) b
group by b.rgn_no/* ,b.dte_of_wk */ order by b.rgn_no/* ,b.dte_of_wk */) ly_val
where /* cy_val.dte_of_wk=ly_val.dte_of_wk and */ cy_val.rgn_no=ly_val.rgn_no 
group by cy_val.rgn_no order by cy_val.rgn_no) cyly_wtd
on cyly_wtd.rgn_no=lc.rgn_no order by lc.rgn_no]]>
	</CurrentWeekLYCustomersWkToDt>
	
	<CurrentWeekLYCustomersWkToDtTotal>
	<![CDATA[select lc.div_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100
     WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as LYPCT_CUST_WTDTOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select cy_val.div_no,sum(cy_val.ACTL_CUST_CY_TOT_DTSBU) as cy_wtd,sum(ly_val.ACTL_CUST_LY_TOT_DTSBU) as ly_wtd from 
(select h.div_no,/* SUBSTR(h.day_of_wk,0,2) as dte_of_wk, */sum(h.ACTL_CUST_DTS) as ACTL_CUST_CY_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */ ) h 
group by h.div_no/* ,h.day_of_wk */ order by h.div_no/* ,h.day_of_wk */) cy_val,
(select h.div_no,/* SUBSTR(h.day_of_wk,0,2) as dte_of_wk, */sum(h.ACTL_CUST_DTS) as ACTL_CUST_LY_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */) h 
group by h.div_no/* ,h.day_of_wk */ order by h.div_no/* ,h.day_of_wk */) ly_val
where /* cy_val.dte_of_wk=ly_val.dte_of_wk and */ cy_val.div_no=ly_val.div_no 
group by cy_val.div_no order by cy_val.div_no) cyly_wtd
on cyly_wtd.div_no=lc.div_no order by lc.div_no]]>
	</CurrentWeekLYCustomersWkToDtTotal>
	
	<CurrentWeekVarCustomersWkToDt>
	<![CDATA[select pln.rgn_no,(actl.wtd - pln.wtd) as VAR_CUST_WTD_DTSBU from 
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct rgn_no from ww_wlp.loc where div_no='Division' and wlp_live_ind in ('Y','N') order by rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no) pln,
(select lc.rgn_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]>
	</CurrentWeekVarCustomersWkToDt>
	

	<CurrentWeekVarCustomersWkToDtTotal>
	<![CDATA[select pln.div_no,(actl.wtd - pln.wtd) as VAR_CUST_WTDTOT_DTSBU from 
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct div_no from ww_wlp.loc where div_no='Division' and wlp_live_ind in ('Y','N') order by div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_CUST_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_CUST_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_CUST_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_CUST_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_CUST_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_CUST_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_CUST_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_CUST_DTS),0) as PLN_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no) pln,
(select lc.div_no,NVL(sls.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,ROUND((x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun),0) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_CUST_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_CUST_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_CUST_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_CUST_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_CUST_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_CUST_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_CUST_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_CUST_DTS) as ACTL_CUST_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_CUST_cnt) as ACTL_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_CUST_cnt) as PLN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_CUST) as GEN_CUST_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no IN (90,85) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_cust_cnt is NOT NULL and a.actl_cust_cnt!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) actl
where pln.div_no=actl.div_no order by pln.div_no ]]>
	</CurrentWeekVarCustomersWkToDtTotal>

	</TCName>


<TCName name = "WagesColumnValidation" >
	<PlannedWages>
	<![CDATA[select lc.rgn_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'
order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.loc_nm,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no]]>
	</PlannedWages>
	<PlannedWagesTotal>
	<![CDATA[select lc.div_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_TOT_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no]]>
	</PlannedWagesTotal>
	<PlannedWagesWkToDt>
	<![CDATA[select lc.rgn_no,NVL(ROUND(wge.PLN_WAGE_DTS,0),0) as PLN_WGE_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'
order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no]]>
	</PlannedWagesWkToDt>
	<PlannedWagesWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(ROUND(wge.PLN_WAGE_TOT_DTG,0),0) as PLN_WGE_TOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DTG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DTG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no]]>
	</PlannedWagesWkToDtTotal>

<BudgetWages>
	<![CDATA[select lc.rgn_no,NVL(bdgt.BDGT_WAGES_DTSBU,0) as BDGT_WGE_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,ROUND(sum(e.bdgt_wage_amt),0) as BDGT_WAGES_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no]]>
	</BudgetWages>
	<BudgetWagesTotal>
	<![CDATA[select lc.div_no,NVL(bdgt.BDGT_WAGES_TOT_DTSBU,0) as BDGT_WGE_TOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,ROUND(sum(e.bdgt_wage_amt),0) as BDGT_WAGES_TOT_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) bdgt
on lc.div_no=bdgt.div_no order by lc.div_no]]>
	</BudgetWagesTotal>
	
	<ForecastWages>
	<![CDATA[select lc.rgn_no,NVL(fcst.FCST_WAGES_DTSBU,0) as FCST_WGE_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,ROUND(sum(e.frcst_wage_amt),0) as FCST_WAGES_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) fcst
on lc.rgn_no=fcst.rgn_no order by lc.rgn_no]]>
	</ForecastWages>
	<ForecastWagesTotal>
	<![CDATA[select lc.div_no,NVL(fcst.FCST_WAGES_TOT_DTSBU,0) as FCST_WGE_TOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,ROUND(sum(e.frcst_wage_amt),0) as FCST_WAGES_TOT_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) fcst
on lc.div_no=fcst.div_no order by lc.div_no]]>
	</ForecastWagesTotal>

	

	<PastWeekActualWages>
	<![CDATA[select lc.rgn_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_WGE_DTS),0) as ACTL_WGE_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no ]]>
	</PastWeekActualWages>
	<PastWeekActualWagesTotal>
	<![CDATA[select lc.div_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_WGE_DTS),0) as ACTL_WGE_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no]]>
	</PastWeekActualWagesTotal>
	
	<PastWeekActualWagesWkToDt>
	<![CDATA[select lc.rgn_no,NVL(ROUND(wge.ACTL_WGE_DTSBU,0),0) as ACTL_WGE_WTD_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no]]>
	</PastWeekActualWagesWkToDt>
	<PastWeekActualWagesWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(ROUND(wge.ACTL_WGE_TOT_DTSBU,0),0) as ACTL_WGE_WTDTOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no]]>
	</PastWeekActualWagesWkToDtTotal>
	
	
	
	
	
	<PastWeekLYWages>
	<![CDATA[select actl_cy.rgn_no,
CASE WHEN NVL(actl_cy.Mon,0) = 0 and NVL(actl_ly.Mon,0) = 0 THEN 0
WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.tue,0) = 0 and NVL(actl_ly.tue,0) = 0 THEN 0
WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.wed,0) = 0 and NVL(actl_ly.wed,0) = 0 THEN 0
WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.thu,0) = 0 and NVL(actl_ly.thu,0) = 0 THEN 0
WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.fri,0) = 0 and NVL(actl_ly.fri,0) = 0 THEN 0
WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.sat,0) = 0 and NVL(actl_ly.sat,0) = 0 THEN 0
WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.sun,0) = 0 and NVL(actl_ly.sun,0) = 0 THEN 0
WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.rgn_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) actl_cy,
(select lc.rgn_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt 'and c.wk_end' and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) actl_ly
where actl_cy.rgn_no=actl_ly.rgn_no order by actl_cy.rgn_no ]]>
	</PastWeekLYWages>
	
	<PastWeekLYWagesTotal>
	<![CDATA[select actl_cy.div_no,
CASE WHEN NVL(actl_cy.Mon,0) = 0 and NVL(actl_ly.Mon,0) = 0 THEN 0
WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.tue,0) = 0 and NVL(actl_ly.tue,0) = 0 THEN 0
WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.wed,0) = 0 and NVL(actl_ly.wed,0) = 0 THEN 0
WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.thu,0) = 0 and NVL(actl_ly.thu,0) = 0 THEN 0
WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.fri,0) = 0 and NVL(actl_ly.fri,0) = 0 THEN 0
WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.sat,0) = 0 and NVL(actl_ly.sat,0) = 0 THEN 0
WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.sun,0) = 0 and NVL(actl_ly.sun,0) = 0 THEN 0
WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.div_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) actl_cy,
(select lc.div_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt 'and c.wk_end' and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.ar_no,g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) actl_ly
where actl_cy.div_no=actl_ly.div_no order by actl_cy.div_no ]]>
	</PastWeekLYWagesTotal>
	
	
	<PastWeekLYWagesWkToDt>
	<![CDATA[select actl_cy.rgn_no,
CASE WHEN NVL(actl_cy.cy_wtd,0) = 0 AND NVL(actl_ly.ly_wtd,0) = 0 THEN 0 
WHEN NVL(actl_cy.cy_wtd,0) = 0 THEN -100 WHEN NVL(actl_ly.ly_wtd,0) = 0 THEN 100
ELSE ROUND(((actl_cy.cy_wtd / actl_ly.ly_wtd)-1)*100,2) END as LYPCT_WGE_WTD_DTSBU from 
(select lc.rgn_no,wge.ACTL_WGE_DTSBU as cy_wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) actl_cy,
(select lc.rgn_no,wge.ACTL_WGE_LY_DTSBU as ly_wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WGE_LY_DTSBU,sum(e.actl_hrs) as ACTL_HRS_LY_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) actl_ly
where actl_cy.rgn_no=actl_ly.rgn_no order by actl_cy.rgn_no]]>
	</PastWeekLYWagesWkToDt>
	
	<PastWeekLYWagesWkToDtTotal>
	<![CDATA[select actl_cy.div_no,
CASE WHEN NVL(actl_cy.cy_wtd,0) = 0 AND NVL(actl_ly.ly_wtd,0) = 0 THEN 0 
WHEN NVL(actl_cy.cy_wtd,0) = 0 THEN -100 WHEN NVL(actl_ly.ly_wtd,0) = 0 THEN 100
ELSE ROUND(((actl_cy.cy_wtd / actl_ly.ly_wtd)-1)*100,2) END as LYPCT_WGE_WTDTOT_DTSBUU from 
(select lc.div_no,wge.ACTL_WGE_CY_TOT_DTSBU as cy_wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_CY_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_CY_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.ar_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) actl_cy,
(select lc.div_no,wge.ACTL_WGE_LY_DTSBU as ly_wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.actl_wage_amt) as ACTL_WGE_LY_DTSBU,sum(e.actl_hrs) as ACTL_HRS_LY_TOT_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) actl_ly
where actl_cy.div_no=actl_ly.div_no order by actl_ly.div_no]]>
	</PastWeekLYWagesWkToDtTotal>
	
	<PastWeekVarWagesWkToDt>
	<![CDATA[select pln.rgn_no,ROUND(actl.wtd - pln.wtd,0) as VAR_WGE_WTD_DTSBU from 
(select lc.rgn_no,NVL(wge.PLN_WAGE_DTS,0) as wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'
order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no) pln,
(select lc.rgn_no,NVL(wge.ACTL_WGE_DTSBU,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]>
	</PastWeekVarWagesWkToDt>
	<PastWeekVarWagesWkToDtTotal>
	<![CDATA[select pln.div_no,ROUND(actl.wtd - pln.wtd,0) as VAR_WGE_WTDTOT_DTSBU from 
(select lc.div_no,NVL(wge.PLN_WAGE_TOT_DTG,0) as wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DTG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DTG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no) pln,
(select lc.div_no,NVL(wge.ACTL_WGE_TOT_DTSBU,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) actl
where pln.div_no=actl.div_no order by pln.div_no]]>
	</PastWeekVarWagesWkToDtTotal>
	
	<PastWeekEstimatedFcstWage>
	<![CDATA[select lc.rgn_no,NVL(ROUND(wge.ACTL_WGE_DTSBU,0),0) as ESTD_FCST_WGE_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no]]>
	</PastWeekEstimatedFcstWage>
	<PastWeekEstimatedFcstWageTotal>
	<![CDATA[select lc.div_no,NVL(ROUND(wge.ACTL_WGE_TOT_DTSBU,0),0) as ESTD_FCST_WGE_TOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no]]>
	</PastWeekEstimatedFcstWageTotal>
	
	<PastWeekVarWages>
	<![CDATA[select estd_fcst.rgn_no,ROUND(( estd_fcst.WTD-bdgt_wge.wtd ),0) as BDGT_VAR_WGE_DTSBU from 
(select lc.rgn_no,NVL(wge.ACTL_WGE_DTSBU,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) estd_fcst,
(select lc.rgn_no,NVL(bdgt.BDGT_WAGES_DTSBU,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,ROUND(sum(e.bdgt_wage_amt),0) as BDGT_WAGES_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no) bdgt_wge
where estd_fcst.rgn_no=bdgt_wge.rgn_no order by estd_fcst.rgn_no]]>
	</PastWeekVarWages>
	
	<PastWeekVarWagesTotal>
	<![CDATA[select estd_fcst.div_no,ROUND(( estd_fcst.wtd-bdgt_wge.wtd ),0) as BDGT_VAR_WGE_TOT_DTSBU from 
(select lc.div_no,NVL(ROUND(wge.ACTL_WGE_TOT_DTSBU,0),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) estd_fcst,
(select lc.div_no,NVL(bdgt.BDGT_WAGES_TOT_DTSBU,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,ROUND(sum(e.bdgt_wage_amt),0) as BDGT_WAGES_TOT_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) bdgt
on lc.div_no=bdgt.div_no order by lc.div_no) bdgt_wge
where estd_fcst.div_no=bdgt_wge.div_no order by estd_fcst.div_no]]>
	</PastWeekVarWagesTotal>
	
	<PastWeekForecastVarWages>
	<![CDATA[select estd_fcst.rgn_no,ROUND(( estd_fcst.wtd-bdgt_wge.wtd ),0) as FCST_VAR_WGE_DTSBU from 
(select lc.rgn_no,NVL(wge.ACTL_WGE_DTSBU,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) estd_fcst,
(select lc.rgn_no,NVL(fcst.FCST_WAGES_DTSBU,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,ROUND(sum(e.frcst_wage_amt),0) as FCST_WAGES_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) fcst
on lc.rgn_no=fcst.rgn_no order by lc.rgn_no) bdgt_wge
where estd_fcst.rgn_no=bdgt_wge.rgn_no order by estd_fcst.rgn_no ]]>
	</PastWeekForecastVarWages>
	
	<PastWeekForecastVarWagesTotal>
	<![CDATA[select estd_fcst.div_no,ROUND(( estd_fcst.wtd-bdgt_wge.wtd ),0) as FCST_VAR_WGE_TOT_DTSBU from 
(select lc.div_no,NVL(ROUND(wge.ACTL_WGE_TOT_DTSBU,0),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) estd_fcst,
(select lc.div_no,NVL(fcst.FCST_WAGES_TOT_DTSBU,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,ROUND(sum(e.frcst_wage_amt),0) as FCST_WAGES_TOT_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) fcst
on lc.div_no=fcst.div_no order by lc.div_no) bdgt_wge
where estd_fcst.div_no=bdgt_wge.div_no order by estd_fcst.div_no ]]>
	</PastWeekForecastVarWagesTotal>
	
			

	<CurrentWeekActualWages>
	<![CDATA[select lc.rgn_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_WGE_DTS),0) as ACTL_WGE_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte<=trunc(sysdate-1) and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.KRN_SCHD_UP_TO_DATE a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte>=trunc(sysdate) and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g 
/*where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no ]]>
	</CurrentWeekActualWages>
	<CurrentWeekActualWagesTotal>
	<![CDATA[select lc.div_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_WGE_DTS),0) as ACTL_WGE_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte<=trunc(sysdate-1) and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.KRN_SCHD_UP_TO_DATE a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte>=trunc(sysdate) and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
/*where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no]]>
	</CurrentWeekActualWagesTotal>
	
	<CurrentWeekActualWagesWkToDt>
	<![CDATA[select lc.rgn_no,NVL(ROUND(wge.ACTL_WGE_DTSBU,0),0) as ACTL_WGE_WTD_DTSBU from 
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g */ ) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by wge.rgn_no ]]>
	</CurrentWeekActualWagesWkToDt>
	<CurrentWeekActualWagesWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(ROUND(wge.ACTL_WGE_TOT_DTSBU,0),0) as ACTL_WGE_WTDTOT_DTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28)
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) g  */) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no order by wge.div_no ]]>
	</CurrentWeekActualWagesWkToDtTotal>

	<CurrentWeekLYWages>
	<![CDATA[select actl_cy.rgn_no,
CASE WHEN NVL(actl_cy.Mon,0) = 0 and NVL(actl_ly.Mon,0) = 0 THEN 0
WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.tue,0) = 0 and NVL(actl_ly.tue,0) = 0 THEN 0
WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.wed,0) = 0 and NVL(actl_ly.wed,0) = 0 THEN 0
WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.thu,0) = 0 and NVL(actl_ly.thu,0) = 0 THEN 0
WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.fri,0) = 0 and NVL(actl_ly.fri,0) = 0 THEN 0
WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.sat,0) = 0 and NVL(actl_ly.sat,0) = 0 THEN 0
WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.sun,0) = 0 and NVL(actl_ly.sun,0) = 0 THEN 0
WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.rgn_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte<=trunc(sysdate-1) and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.KRN_SCHD_UP_TO_DATE a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte>=trunc(sysdate) and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g 
/*where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) actl_cy,
(select lc.rgn_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt 'and c.wk_end' and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.loc_no,e.dply_seq,e.day_of_wk order by e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) actl_ly
where actl_cy.rgn_no=actl_ly.rgn_no order by actl_cy.rgn_no  ]]>
	</CurrentWeekLYWages>
	<CurrentWeekLYWagesTotal>
	<![CDATA[select actl_cy.div_no,
CASE WHEN NVL(actl_cy.Mon,0) = 0 and NVL(actl_ly.Mon,0) = 0 THEN 0
WHEN NVL(actl_cy.Mon,0) = 0 THEN -100 WHEN NVL(actl_ly.Mon,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Mon / actl_ly.Mon)-1)*100,2) END as Mon,
CASE WHEN NVL(actl_cy.tue,0) = 0 and NVL(actl_ly.tue,0) = 0 THEN 0
WHEN NVL(actl_cy.Tue,0) = 0 THEN -100 WHEN NVL(actl_ly.Tue,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Tue / actl_ly.Tue)-1)*100,2) END as Tue,
CASE WHEN NVL(actl_cy.wed,0) = 0 and NVL(actl_ly.wed,0) = 0 THEN 0
WHEN NVL(actl_cy.Wed,0) = 0 THEN -100 WHEN NVL(actl_ly.Wed,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Wed / actl_ly.Wed)-1)*100,2) END as Wed,
CASE WHEN NVL(actl_cy.thu,0) = 0 and NVL(actl_ly.thu,0) = 0 THEN 0
WHEN NVL(actl_cy.Thu,0) = 0 THEN -100 WHEN NVL(actl_ly.Thu,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Thu / actl_ly.Thu)-1)*100,2) END as Thu,
CASE WHEN NVL(actl_cy.fri,0) = 0 and NVL(actl_ly.fri,0) = 0 THEN 0
WHEN NVL(actl_cy.Fri,0) = 0 THEN -100 WHEN NVL(actl_ly.Fri,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Fri / actl_ly.Fri)-1)*100,2) END as Fri,
CASE WHEN NVL(actl_cy.sat,0) = 0 and NVL(actl_ly.sat,0) = 0 THEN 0
WHEN NVL(actl_cy.Sat,0) = 0 THEN -100 WHEN NVL(actl_ly.Sat,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sat / actl_ly.Sat)-1)*100,2) END as Sat,
CASE WHEN NVL(actl_cy.sun,0) = 0 and NVL(actl_ly.sun,0) = 0 THEN 0
WHEN NVL(actl_cy.Sun,0) = 0 THEN -100 WHEN NVL(actl_ly.Sun,0) = 0 THEN 100
ELSE ROUND(((actl_cy.Sun / actl_ly.Sun)-1)*100,2) END as Sun from 
(select lc.div_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte<=trunc(sysdate-1) and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.KRN_SCHD_UP_TO_DATE a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte>=trunc(sysdate) and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
/*where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) actl_cy,
(select lc.div_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/*UNION
select * from 
(select e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt 'and c.wk_end' and sysdate-1 and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk order by e.ar_no,e.loc_no,e.dply_seq,e.day_of_wk) g 
where (g.ar_no,g.loc_no,g.day_of_wk) NOT IN 
(select distinct e.ar_no,e.loc_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e)*/) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) actl_ly
where actl_cy.div_no=actl_ly.div_no order by actl_cy.div_no ]]>
	</CurrentWeekLYWagesTotal>
	
	<CurrentWeekLYWagesWkToDt>
	<![CDATA[select lc.rgn_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0 
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as LYPCT_WGE_WTD_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select cy_val.rgn_no,sum(cy_val.actl_wge_CY_DTSBU) as cy_wtd,sum(ly_val.actl_wge_LY_DTSBU) as ly_wtd from 
(select lc.rgn_no,NVL(wge.ACTL_WGE_DTSBU,0) as actl_wge_CY_DTSBU from 
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g  */) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no) cy_val,
(select e.rgn_no,sum(e.actl_wage_amt) as ACTL_WGE_LY_DTSBU,sum(e.actl_hrs) as ACTL_HRS_LY_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) ly_val
where cy_val.rgn_no=ly_val.rgn_no 
group by cy_val.rgn_no order by cy_val.rgn_no) cyly_wtd 
on cyly_wtd.rgn_no=lc.rgn_no order by lc.rgn_no]]>
	</CurrentWeekLYWagesWkToDt>
	
	<CurrentWeekLYWagesWkToDtTotal>
	<![CDATA[select lc.div_no,
CASE WHEN NVL(cyly_wtd.cy_wtd,0) = 0 AND NVL(cyly_wtd.ly_wtd,0) = 0 THEN 0 
WHEN NVL(cyly_wtd.cy_wtd,0) = 0 THEN -100 WHEN NVL(cyly_wtd.ly_wtd,0) = 0 THEN 100
ELSE ROUND(((cyly_wtd.cy_wtd / cyly_wtd.ly_wtd)-1)*100,2) END as LYPCT_WGE_WTDTOT_DTSBU from
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select cy_val.div_no,sum(cy_val.actl_wge_CY_TOT_DTSBU) as cy_wtd,sum(ly_val.actl_wge_LY_TOT_DTSBU) as ly_wtd from 
(select lc.div_no,NVL(wge.ACTL_WGE_TOT_DTSBU,0) as actl_wge_CY_TOT_DTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28)
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) g  */) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no) cy_val,
(select e.div_no,sum(e.actl_wage_amt) as ACTL_WGE_LY_TOT_DTSBU,sum(e.actl_hrs) as ACTL_HRS_LY_TOT_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,a.wk_id,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_wky_wage a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='LYWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) ly_val
where cy_val.div_no=ly_val.div_no 
group by cy_val.div_no order by cy_val.div_no) cyly_wtd 
on cyly_wtd.div_no=lc.div_no order by lc.div_no]]>
	</CurrentWeekLYWagesWkToDtTotal>
	
	
	
	<CurrentWeekVarWagesWkToDt>
	<![CDATA[select pln.rgn_no,ROUND((actl.wtd - pln.wtd),0) as VAR_WGE_WTD_DTSBU from 
(select lc.rgn_no,NVL(wge.PLN_WAGE_DTS,0) as wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'
order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) pln,
(select lc.rgn_no,NVL(wge.ACTL_WGE_DTSBU,0) as WTD from 
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g */ ) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no ]]>
	</CurrentWeekVarWagesWkToDt>
	<CurrentWeekVarWagesWkToDtTotal>
	<![CDATA[select pln.div_no,ROUND((actl.wtd - pln.wtd),0) as VAR_WGE_WTDTOT_DTSBU from 
(select lc.div_no,NVL(wge.PLN_WAGE_TOT_DTG,0) as wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DTG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DTG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no) pln,
(select lc.div_no,NVL(wge.ACTL_WGE_TOT_DTSBU,0) as WTD from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28)
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) g */ ) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no) actl
where pln.div_no=actl.div_no order by pln.div_no ]]>
	</CurrentWeekVarWagesWkToDtTotal>
	
	
	<CurrentWeekEstimatedFcstWage>
	<![CDATA[select lc.rgn_no,NVL(ROUND(wge.ACTL_WGE_DTSBU,0),0) as ESTD_FCST_WGE_DTSBU from 
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g */ ) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by wge.rgn_no]]>
	</CurrentWeekEstimatedFcstWage>
	<CurrentWeekEstimatedFcstWageTotal>
	<![CDATA[select lc.div_no,NVL(ROUND(wge.ACTL_WGE_TOT_DTSBU,0),0) as ESTD_FCST_WGE_TOT_DTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28)
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) g */ ) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no order by wge.div_no ]]>
	</CurrentWeekEstimatedFcstWageTotal>
	
	
	
		
	
	<CurrentWeekVarWages>
	<![CDATA[select estd_fcst.rgn_no,ROUND(( estd_fcst.wtd-bdgt_wge.wtd ),0) as BDGT_VAR_WGE_DTSBU from 
(select lc.rgn_no,NVL(wge.ACTL_WGE_DTSBU,0) as WTD from 
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g  */) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no) estd_fcst,
(select lc.rgn_no,NVL(bdgt.BDGT_WAGES_DTSBU,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,ROUND(sum(e.bdgt_wage_amt),0) as BDGT_WAGES_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no) bdgt_wge
where estd_fcst.rgn_no=bdgt_wge.rgn_no order by estd_fcst.rgn_no ]]>
	</CurrentWeekVarWages>
	
	<CurrentWeekVarWagesTotal>
	<![CDATA[select estd_fcst.div_no,ROUND(( estd_fcst.wtd-bdgt_wge.wtd ),0) as BDGT_VAR_WGE_DTSBU from 
(select lc.div_no,NVL(wge.ACTL_WGE_TOT_DTSBU,0) as WTD from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28)
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) g */ ) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no) estd_fcst,
(select lc.div_no,NVL(bdgt.BDGT_WAGES_TOT_DTSBU,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,ROUND(sum(e.bdgt_wage_amt),0) as BDGT_WAGES_TOT_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) bdgt
on lc.div_no=bdgt.div_no order by lc.div_no) bdgt_wge
where estd_fcst.div_no=bdgt_wge.div_no order by estd_fcst.div_no ]]>
	</CurrentWeekVarWagesTotal>
	
	<CurrentWeekForecastVarWages>
	<![CDATA[select estd_fcst.rgn_no,ROUND(( estd_fcst.wtd-bdgt_wge.wtd ),0) as FCST_VAR_WGE_DTSBU from 
(select lc.rgn_no,NVL(ROUND(wge.ACTL_WGE_DTSBU,0),0) as WTD from 
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g */ ) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no) estd_fcst,
(select lc.rgn_no,NVL(fcst.FCST_WAGES_DTSBU,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,ROUND(sum(e.frcst_wage_amt),0) as FCST_WAGES_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) fcst
on lc.rgn_no=fcst.rgn_no order by lc.rgn_no) bdgt_wge
where estd_fcst.rgn_no=bdgt_wge.rgn_no order by estd_fcst.rgn_no ]]>
	</CurrentWeekForecastVarWages>
	
	<CurrentWeektForecastVarWagesTotal>
	<![CDATA[select estd_fcst.div_no,ROUND(( estd_fcst.wtd-bdgt_wge.wtd ),0) as FCST_VAR_WGE_TOT_DTSBU from 
(select lc.div_no,NVL(ROUND(wge.ACTL_WGE_TOT_DTSBU,0),0) as WTD from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null
and (b.div_no) NOT IN 
(select distinct b.div_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) g */ ) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no ) estd_fcst,
(select lc.div_no,NVL(fcst.FCST_WAGES_TOT_DTSBU,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,ROUND(sum(e.frcst_wage_amt),0) as FCST_WAGES_TOT_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) fcst
on lc.div_no=fcst.div_no order by lc.div_no) bdgt_wge
where estd_fcst.div_no=bdgt_wge.div_no order by estd_fcst.div_no ]]>
	</CurrentWeektForecastVarWagesTotal>
		
</TCName>





<TCName name = "HoursColumnValidation" >
	<PlannedHours>
	<![CDATA[select lc.rgn_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'
order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_HRS_DTS),2) as PLN_HRS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no]]>
	</PlannedHours>
	<PlannedHoursTotal>
	<![CDATA[select lc.div_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(ROUND(h.PLN_HRS_DTS,2)) as PLN_HRS_TOT_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no]]>
	</PlannedHoursTotal>
	
	<PlannedHoursWkToDt>
	<![CDATA[select lc.rgn_no,NVL(ROUND(wge.PLN_HOURS_DTS,2),0) as PLN_HRS_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'
order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no]]>
	</PlannedHoursWkToDt>
	<PlannedHoursWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(ROUND(wge.PLN_HOURS_TOT_DTG,2),0) as PLN_HRS_TOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DTG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DTG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no order by wge.div_no]]>
	</PlannedHoursWkToDtTotal>
	
	
	
	<PastWeekActualHours>
	<![CDATA[select lc.rgn_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTS),2) as ACTL_HRS_DTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/* UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no]]>
	</PastWeekActualHours>
	<PastWeekActualHoursTotal>
	<![CDATA[select lc.div_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTS),2) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no]]>
	</PastWeekActualHoursTotal>	
	
	<PastWeekActualHoursWkToDt>
	<![CDATA[select lc.rgn_no,NVL(ROUND(wge.ACTL_HRS_DTSBU,2),0) as ACTL_HRS_WTD_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no  ]]>
	</PastWeekActualHoursWkToDt>
	<PastWeekActualHoursWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(ROUND(wge.ACTL_HRS_TOT_DTSBU,2),0) as ACTL_HRS_WTDTOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no]]>
	</PastWeekActualHoursWkToDtTotal>	
	
	
	<PastWeekVarHoursWkToDt>
	<![CDATA[select pln.rgn_no,(actl.wtd - pln.wtd) as VAR_HRS_WTD_DTSBU from 
(select lc.rgn_no,NVL(ROUND(wge.PLN_HOURS_DTS,2),0) as wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'
order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no) pln,
(select lc.rgn_no,NVL(ROUND(wge.ACTL_HRS_DTSBU,2),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no ]]>
	</PastWeekVarHoursWkToDt>
	<PastWeekVarHoursWkToDtTotal>
	<![CDATA[select pln.div_no,(actl.wtd - pln.wtd) as VAR_HRS_WTDTOT_DTSBU from 
(select lc.div_no,NVL(ROUND(wge.PLN_HOURS_TOT_DTG,2),0) as wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DTG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DTG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no) pln,
(select lc.div_no,NVL(ROUND(wge.ACTL_HRS_TOT_DTSBU,2),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) actl
where pln.div_no=actl.div_no order by pln.div_no ]]>
	</PastWeekVarHoursWkToDtTotal>
	
	
	<CurrentWeekActualHours>
	<![CDATA[select lc.rgn_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSBu)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTS),2) as ACTL_HRS_DTSBU from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte<=trunc(sysdate-1) and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.KRN_SCHD_UP_TO_DATE a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte>=trunc(sysdate) and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g 
/*where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no]]>
	</CurrentWeekActualHours>
	<CurrentWeekActualHoursTotal>
	<![CDATA[select lc.div_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_HRS_DTS),2) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte<=trunc(sysdate-1) and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.KRN_SCHD_UP_TO_DATE a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte>=trunc(sysdate) and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
/*where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no]]>
	</CurrentWeekActualHoursTotal>	

  <CurrentWeekActualHoursWkToDt>
	<![CDATA[select lc.rgn_no,NVL(ROUND(wge.ACTL_HRS_DTSBU,2),0) as ACTL_HRS_WTD_DTSBU from 
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g */ ) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by wge.rgn_no ]]>
	</CurrentWeekActualHoursWkToDt>
	<CurrentWeekActualHoursWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(ROUND(wge.ACTL_HRS_TOT_DTSBU,2),0) as ACTL_HRS_WTDTOT_DTSBU from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28)
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) g  */) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no order by wge.div_no]]>
	</CurrentWeekActualHoursWkToDtTotal>
	
	
	
	<CurrenWeekVarHoursWkToDt>
	<![CDATA[select pln.rgn_no,ROUND((actl.wtd - pln.wtd),2) as VAR_HRS_WTD_DTSBU from 
(select lc.rgn_no,NVL(wge.PLN_HOURS_DTS,0) as wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'
order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) pln,
(select lc.rgn_no,NVL(wge.ACTL_HRS_DTSBU,0) as WTD from 
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g  */) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]>
	</CurrenWeekVarHoursWkToDt>
	<CurrentWeekVarHoursWkToDtTotal>
	<![CDATA[select pln.div_no,ROUND((actl.wtd - pln.wtd),2) as VAR_HRS_WTDTOT_DTSBU from 
(select lc.div_no,NVL(wge.PLN_HOURS_TOT_DTG,0) as wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DTG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DTG from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no) pln,
(select lc.div_no,NVL(wge.ACTL_HRS_TOT_DTSBU,0) as WTD from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28)
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) g */ ) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no) actl
where pln.div_no=actl.div_no order by pln.div_no ]]>
	</CurrentWeekVarHoursWkToDtTotal>
	
	
</TCName>






<TCName name = "CPHColumnValidation" >
	<PlannedCPH>
	<![CDATA[select wge_hrs.rgn_no,
CASE WHEN NVL(wge_hrs.mon_wge,0)=0 AND NVL(wge_hrs.mon_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.mon_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.mon_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.mon_wge / wge_hrs.mon_hrs),2),0) END as Mon,
CASE WHEN NVL(wge_hrs.tue_wge,0)=0 AND NVL(wge_hrs.tue_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.tue_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.tue_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.tue_wge / wge_hrs.tue_hrs),2),0) END as Tue,
CASE WHEN NVL(wge_hrs.wed_wge,0)=0 AND NVL(wge_hrs.wed_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.wed_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.wed_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.wed_wge / wge_hrs.wed_hrs),2),0) END as Wed,
CASE WHEN NVL(wge_hrs.thu_wge,0)=0 AND NVL(wge_hrs.thu_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.thu_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.thu_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.thu_wge / wge_hrs.thu_hrs),2),0) END as Thu,
CASE WHEN NVL(wge_hrs.fri_wge,0)=0 AND NVL(wge_hrs.fri_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.fri_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.fri_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.fri_wge / wge_hrs.fri_hrs),2),0) END as Fri,
CASE WHEN NVL(wge_hrs.sat_wge,0)=0 AND NVL(wge_hrs.sat_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.sat_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.sat_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.sat_wge / wge_hrs.sat_hrs),2),0) END as Sat,
CASE WHEN NVL(wge_hrs.sun_wge,0)=0 AND NVL(wge_hrs.sun_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.sun_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.sun_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.sun_wge / wge_hrs.sun_hrs),2),0) END as Sun from
(select z.rgn_no,y.Mon_wge,y.Tue_wge,y.Wed_wge,y.Thu_wge,y.Fri_wge,y.Sat_wge,y.Sun_wge,y.wtd_wge,
y.Mon_hrs,y.Tue_hrs,y.Wed_hrs,y.Thu_hrs,y.Fri_hrs,y.Sat_hrs,y.Sun_hrs,y.wtd_hrs from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_wge + x.Tue_wge + x.Wed_wge + x.Thu_wge + x.Fri_wge + x.Sat_wge + x.Sun_wge) as WTD_wge,
(x.Mon_hrs + x.Tue_hrs + x.Wed_hrs + x.Thu_hrs + x.Fri_hrs + x.Sat_hrs + x.Sun_hrs) as WTD_hrs from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DTSBU)) Mon_wge,
sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DTSBU)) Tue_wge,
sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DTSBU)) Wed_wge,
sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DTSBU)) Thu_wge,
sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DTSBU)) Fri_wge,
sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DTSBU)) Sat_wge,
sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DTSBU)) Sun_wge,
sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DTSBU)) Mon_hrs,
sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DTSBU)) Tue_hrs,
sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DTSBU)) Wed_hrs,
sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DTSBU)) Thu_hrs,
sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DTSBU)) Fri_hrs,
sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DTSBU)) Sat_hrs,
sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DTSBU)) Sun_hrs from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_WGE_DTS) as PLN_WGE_DTSBU,sum(h.PLN_HRS_DTS) as PLN_HRS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.ta_pln_wage_amt!=0 and a.ta_pln_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on z.rgn_no=y.rgn_no order by z.rgn_no) wge_hrs order by wge_hrs.rgn_no ]]>
	</PlannedCPH>
	<PlannedCPHTotal>
	<![CDATA[select wge_hrs.div_no,
CASE WHEN NVL(wge_hrs.mon_wge,0)=0 AND NVL(wge_hrs.mon_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.mon_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.mon_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.mon_wge / wge_hrs.mon_hrs),2),0) END as Mon,
CASE WHEN NVL(wge_hrs.tue_wge,0)=0 AND NVL(wge_hrs.tue_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.tue_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.tue_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.tue_wge / wge_hrs.tue_hrs),2),0) END as Tue,
CASE WHEN NVL(wge_hrs.wed_wge,0)=0 AND NVL(wge_hrs.wed_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.wed_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.wed_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.wed_wge / wge_hrs.wed_hrs),2),0) END as Wed,
CASE WHEN NVL(wge_hrs.thu_wge,0)=0 AND NVL(wge_hrs.thu_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.thu_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.thu_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.thu_wge / wge_hrs.thu_hrs),2),0) END as Thu,
CASE WHEN NVL(wge_hrs.fri_wge,0)=0 AND NVL(wge_hrs.fri_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.fri_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.fri_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.fri_wge / wge_hrs.fri_hrs),2),0) END as Fri,
CASE WHEN NVL(wge_hrs.sat_wge,0)=0 AND NVL(wge_hrs.sat_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.sat_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.sat_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.sat_wge / wge_hrs.sat_hrs),2),0) END as Sat,
CASE WHEN NVL(wge_hrs.sun_wge,0)=0 AND NVL(wge_hrs.sun_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.sun_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.sun_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.sun_wge / wge_hrs.sun_hrs),2),0) END as Sun from
(select z.div_no,y.Mon_wge,y.Tue_wge,y.Wed_wge,y.Thu_wge,y.Fri_wge,y.Sat_wge,y.Sun_wge,y.wtd_wge,
y.Mon_hrs,y.Tue_hrs,y.Wed_hrs,y.Thu_hrs,y.Fri_hrs,y.Sat_hrs,y.Sun_hrs,y.wtd_hrs from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) z
LEFT OUTER JOIN
(select x.*,(x.Mon_wge + x.Tue_wge + x.Wed_wge + x.Thu_wge + x.Fri_wge + x.Sat_wge + x.Sun_wge) as WTD_wge,
(x.Mon_hrs + x.Tue_hrs + x.Wed_hrs + x.Thu_hrs + x.Fri_hrs + x.Sat_hrs + x.Sun_hrs) as WTD_hrs from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DTSBU)) Mon_wge,
sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DTSBU)) Tue_wge,
sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DTSBU)) Wed_wge,
sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DTSBU)) Thu_wge,
sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DTSBU)) Fri_wge,
sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DTSBU)) Sat_wge,
sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DTSBU)) Sun_wge,
sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DTSBU)) Mon_hrs,
sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DTSBU)) Tue_hrs,
sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DTSBU)) Wed_hrs,
sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DTSBU)) Thu_hrs,
sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DTSBU)) Fri_hrs,
sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DTSBU)) Sat_hrs,
sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DTSBU)) Sun_hrs from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_TOT_DTSBU,sum(h.PLN_HRS_DTS) as PLN_HRS_TOT_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.ta_pln_wage_amt!=0 and a.ta_pln_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on z.div_no=y.div_no order by z.div_no) wge_hrs order by wge_hrs.div_no ]]>
	</PlannedCPHTotal>
	
	<PlannedCPHWkToDt>
	<![CDATA[select wge_hrs.rgn_no,
	CASE WHEN NVL(wge_hrs.PLN_WGE_DTSBU,0)=0 AND NVL(wge_hrs.PLN_HRS_DTSBU,0)=0 THEN 0 
WHEN NVL(wge_hrs.PLN_WGE_DTSBU,0)=0 THEN 0 WHEN NVL(wge_hrs.PLN_HRS_DTSBU,0)=0 THEN 0 
ELSE NVL(ROUND((wge_hrs.PLN_WGE_DTSBU / wge_hrs.PLN_HRS_DTSBU),2),0) END as PLN_CPH_WTD_DTSBU from
(select lc.rgn_no,ROUND(wge.PLN_WGE_DTSBU,0) as PLN_WGE_DTSBU,wge.PLN_HRS_DTSBU as PLN_HRS_DTSBU  from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HRS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge_hrs order by wge_hrs.rgn_no ]]>
	</PlannedCPHWkToDt>
	<PlannedCPHWkToDtTotal>
	<![CDATA[select wge_hrs.div_no,
	CASE WHEN NVL(wge_hrs.PLN_WGE_TOT_DTSBU,0)=0 AND NVL(wge_hrs.PLN_HRS_TOT_DTSBU,0)=0 THEN 0 
WHEN NVL(wge_hrs.PLN_WGE_TOT_DTSBU,0)=0 THEN 0 WHEN NVL(wge_hrs.PLN_HRS_TOT_DTSBU,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.PLN_WGE_TOT_DTSBU / wge_hrs.PLN_HRS_TOT_DTSBU),2),0) END as PLN_CPH_WTDTOT_DTSBU from
(select lc.div_no,ROUND(wge.PLN_WGE_TOT_DTSBU,0) as PLN_WGE_TOT_DTSBU,wge.PLN_HRS_TOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WGE_TOT_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HRS_TOT_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) wge_hrs order by wge_hrs.div_no]]>
	</PlannedCPHWkToDtTotal>
	
	<PastWeekActualCPH>
	<![CDATA[select wge_hrs.rgn_no,
CASE WHEN NVL(wge_hrs.mon_wge,0)=0 AND NVL(wge_hrs.mon_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.mon_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.mon_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.mon_wge / wge_hrs.mon_hrs),2),0) END as Mon,
CASE WHEN NVL(wge_hrs.tue_wge,0)=0 AND NVL(wge_hrs.tue_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.tue_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.tue_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.tue_wge / wge_hrs.tue_hrs),2),0) END as Tue,
CASE WHEN NVL(wge_hrs.wed_wge,0)=0 AND NVL(wge_hrs.wed_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.wed_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.wed_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.wed_wge / wge_hrs.wed_hrs),2),0)  END as Wed,
CASE WHEN NVL(wge_hrs.thu_wge,0)=0 AND NVL(wge_hrs.thu_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.thu_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.thu_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.thu_wge / wge_hrs.thu_hrs),2),0) END as Thu,
CASE WHEN NVL(wge_hrs.fri_wge,0)=0 AND NVL(wge_hrs.fri_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.fri_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.fri_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.fri_wge / wge_hrs.fri_hrs),2),0) END as Fri,
CASE WHEN NVL(wge_hrs.sat_wge,0)=0 AND NVL(wge_hrs.sat_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.sat_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.sat_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.sat_wge / wge_hrs.sat_hrs),2),0) END as Sat,
CASE WHEN NVL(wge_hrs.sun_wge,0)=0 AND NVL(wge_hrs.sun_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.sun_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.sun_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.sun_wge / wge_hrs.sun_hrs),2),0) END as Sun from
(select lc.rgn_no,y.Mon_wge,y.Tue_wge,y.Wed_wge,y.Thu_wge,y.Fri_wge,y.Sat_wge,y.Sun_wge,y.wtd_wge,
y.Mon_hrs,y.Tue_hrs,y.Wed_hrs,y.Thu_hrs,y.Fri_hrs,y.Sat_hrs,y.Sun_hrs,y.wtd_hrs from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select x.*,(x.Mon_wge + x.Tue_wge + x.Wed_wge + x.Thu_wge + x.Fri_wge + x.Sat_wge + x.Sun_wge) as WTD_wge,
(x.Mon_hrs + x.Tue_hrs + x.Wed_hrs + x.Thu_hrs + x.Fri_hrs + x.Sat_hrs + x.Sun_hrs) as WTD_hrs from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSR)),0) Mon_wge,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSR)),0) Tue_wge,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSR)),0) Wed_wge,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSR)),0) Thu_wge,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSR)),0) Fri_wge,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSR)),0) Sat_wge,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSR)),0) Sun_wge,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSR)),0) Mon_hrs,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSR)),0) Tue_hrs,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSR)),0) Wed_hrs,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSR)),0) Thu_hrs,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSR)),0) Fri_hrs,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSR)),0) Sat_hrs,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSR)),0) Sun_hrs from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_WGE_DTS),9) as ACTL_WGE_DTSR,ROUND(sum(h.ACTL_HRS_DTS),9) as ACTL_HRS_DTSR from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on lc.rgn_no=y.rgn_no order by lc.rgn_no) wge_hrs order by wge_hrs.rgn_no]]>
	</PastWeekActualCPH>
	
	<PastWeekActualCPHTotal>
	<![CDATA[select wge_hrs.div_no,
CASE WHEN NVL(wge_hrs.mon_wge,0)=0 AND NVL(wge_hrs.mon_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.mon_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.mon_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.mon_wge / wge_hrs.mon_hrs),2),0) END as Mon,
CASE WHEN NVL(wge_hrs.tue_wge,0)=0 AND NVL(wge_hrs.tue_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.tue_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.tue_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.tue_wge / wge_hrs.tue_hrs),2),0) END as Tue,
CASE WHEN NVL(wge_hrs.wed_wge,0)=0 AND NVL(wge_hrs.wed_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.wed_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.wed_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.wed_wge / wge_hrs.wed_hrs),2),0) END as Wed,
CASE WHEN NVL(wge_hrs.thu_wge,0)=0 AND NVL(wge_hrs.thu_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.thu_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.thu_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.thu_wge / wge_hrs.thu_hrs),2),0) END as Thu,
CASE WHEN NVL(wge_hrs.fri_wge,0)=0 AND NVL(wge_hrs.fri_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.fri_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.fri_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.fri_wge / wge_hrs.fri_hrs),2),0) END as Fri,
CASE WHEN NVL(wge_hrs.sat_wge,0)=0 AND NVL(wge_hrs.sat_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.sat_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.sat_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.sat_wge / wge_hrs.sat_hrs),2),0) END as Sat,
CASE WHEN NVL(wge_hrs.sun_wge,0)=0 AND NVL(wge_hrs.sun_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.sun_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.sun_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.sun_wge / wge_hrs.sun_hrs),2),0) END as Sun from
(select lc.div_no,y.Mon_wge,y.Tue_wge,y.Wed_wge,y.Thu_wge,y.Fri_wge,y.Sat_wge,y.Sun_wge,y.wtd_wge,
y.Mon_hrs,y.Tue_hrs,y.Wed_hrs,y.Thu_hrs,y.Fri_hrs,y.Sat_hrs,y.Sun_hrs,y.wtd_hrs from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select x.*,(x.Mon_wge + x.Tue_wge + x.Wed_wge + x.Thu_wge + x.Fri_wge + x.Sat_wge + x.Sun_wge) as WTD_wge,
(x.Mon_hrs + x.Tue_hrs + x.Wed_hrs + x.Thu_hrs + x.Fri_hrs + x.Sat_hrs + x.Sun_hrs) as WTD_hrs from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSR)),0) Mon_wge,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSR)),0) Tue_wge,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSR)),0) Wed_wge,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSR)),0) Thu_wge,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSR)),0) Fri_wge,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSR)),0) Sat_wge,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSR)),0) Sun_wge,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSR)),0) Mon_hrs,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSR)),0) Tue_hrs,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSR)),0) Wed_hrs,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSR)),0) Thu_hrs,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSR)),0) Fri_hrs,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSR)),0) Sat_hrs,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSR)),0) Sun_hrs from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_WGE_DTS),9) as ACTL_WGE_DTSR,ROUND(sum(h.ACTL_HRS_DTS),9) as ACTL_HRS_DTSR from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on lc.div_no=y.div_no order by lc.div_no) wge_hrs order by wge_hrs.div_no]]>
	</PastWeekActualCPHTotal>
	
	<PastWeekActualCPHWkToDt>
	<![CDATA[select wge_hrs.rgn_no,
	CASE WHEN NVL(wge_hrs.wtd_wge,0)=0 AND NVL(wge_hrs.wtd_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.wtd_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.wtd_hrs,0)=0 THEN 0 
ELSE NVL(ROUND((wge_hrs.wtd_wge / wge_hrs.wtd_hrs),2),0) END as ACTL_CPH_WTD_DTSBU from  
(select wge.rgn_no,wge.WTD_WGE,hrs.WTD_HRS from 
(select lc.rgn_no,wge.ACTL_WGE_DTSBU as WTD_WGE from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,wge.ACTL_HRS_DTSBU as WTD_HRS from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) hrs 
where wge.rgn_no=hrs.rgn_no) wge_hrs order by wge_hrs.rgn_no ]]>
	</PastWeekActualCPHWkToDt>
	<PastWeekActualCPHWkToDtTotal>
	<![CDATA[select wge_hrs.div_no,
	CASE WHEN NVL(wge_hrs.wtd_wge,0)=0 AND NVL(wge_hrs.wtd_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.wtd_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.wtd_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.wtd_wge / wge_hrs.wtd_hrs),2),0) END as ACTL_CPH_WTDTOT_DTSBU from 
(select wge.div_no,wge.wtd_wge,hrs.wtd_hrs from 
(select lc.div_no,wge.ACTL_WGE_TOT_DTSBU as WTD_WGE from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select lc.div_no,wge.ACTL_HRS_TOT_DTSBU as WTD_HRS from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) hrs where wge.div_no=hrs.div_no order by wge.div_no) wge_hrs
order by wge_hrs.div_no]]>
	</PastWeekActualCPHWkToDtTotal>
	
	<PastWeekVarCPHWkToDt>
	<![CDATA[select pln.rgn_no,ROUND(actl.wtd - pln.wtd,2) as VAR_CPH_WTD_DTSBU from 
(select wge_hrs.rgn_no,
CASE WHEN NVL(wge_hrs.PLN_WGE_DTSBU,0)=0 AND NVL(wge_hrs.PLN_HRS_DTSBU,0)=0 THEN 0 
WHEN NVL(wge_hrs.PLN_WGE_DTSBU,0)=0 THEN 0 WHEN NVL(wge_hrs.PLN_HRS_DTSBU,0)=0 THEN 0 
ELSE NVL(ROUND((wge_hrs.PLN_WGE_DTSBU / wge_hrs.PLN_HRS_DTSBU),2),0) END as WTD from
(select lc.rgn_no,wge.PLN_WGE_DTSBU as PLN_WGE_DTSBU,wge.PLN_HRS_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='3'
order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HRS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge_hrs) pln,
(select wge_hrs.rgn_no,NVL(ROUND((wge_hrs.wtd_wge / wge_hrs.wtd_hrs),2),0) as WTD from 
(select wge.rgn_no,wge.WTD_WGE,hrs.WTD_HRS from 
(select lc.rgn_no,wge.ACTL_WGE_DTSBU as WTD_WGE from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,wge.ACTL_HRS_DTSBU as WTD_HRS from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) hrs 
where wge.rgn_no=hrs.rgn_no) wge_hrs) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no ]]>
	</PastWeekVarCPHWkToDt>
	<PastWeekVarCPHWkToDtTotal>
	<![CDATA[select pln.div_no,ROUND(actl.wtd - pln.wtd,2) as VAR_CPH_WTDTOT_DTSBU from 
(select wge_hrs.div_no,
CASE WHEN NVL(wge_hrs.PLN_WGE_TOT_DTSBU,0)=0 AND NVL(wge_hrs.PLN_HRS_TOT_DTSBU,0)=0 THEN 0 
WHEN NVL(wge_hrs.PLN_WGE_TOT_DTSBU,0)=0 THEN 0 WHEN NVL(wge_hrs.PLN_HRS_TOT_DTSBU,0)=0 THEN 0 
ELSE NVL(ROUND((wge_hrs.PLN_WGE_TOT_DTSBU / wge_hrs.PLN_HRS_TOT_DTSBU),2),0) END as WTD from
(select lc.div_no,wge.PLN_WGE_TOT_DTSBU as PLN_WGE_TOT_DTSBU,wge.PLN_HRS_TOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WGE_TOT_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HRS_TOT_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) wge_hrs) pln,
(select wge_hrs.div_no,NVL((wge_hrs.wtd_wge / wge_hrs.wtd_hrs),0) as WTD from 
(select wge.div_no,wge.wtd_wge,hrs.wtd_hrs from 
(select lc.div_no,wge.ACTL_WGE_TOT_DTSBU as WTD_WGE from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select lc.div_no,wge.ACTL_HRS_TOT_DTSBU as WTD_HRS from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) hrs where wge.div_no=hrs.div_no order by wge.div_no) wge_hrs
order by wge_hrs.div_no) actl
where pln.div_no=actl.div_no order by pln.div_no ]]>
	</PastWeekVarCPHWkToDtTotal>
	
	
	
	
	<CurrentWeekActualCPH>
	<![CDATA[select wge_hrs.rgn_no,
CASE WHEN NVL(wge_hrs.mon_wge,0)=0 AND NVL(wge_hrs.mon_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.mon_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.mon_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.mon_wge / wge_hrs.mon_hrs),2),0) END as Mon,
CASE WHEN NVL(wge_hrs.tue_wge,0)=0 AND NVL(wge_hrs.tue_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.tue_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.tue_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.tue_wge / wge_hrs.tue_hrs),2),0) END as Tue,
CASE WHEN NVL(wge_hrs.wed_wge,0)=0 AND NVL(wge_hrs.wed_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.wed_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.wed_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.wed_wge / wge_hrs.wed_hrs),2),0)  END as Wed,
CASE WHEN NVL(wge_hrs.thu_wge,0)=0 AND NVL(wge_hrs.thu_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.thu_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.thu_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.thu_wge / wge_hrs.thu_hrs),2),0) END as Thu,
CASE WHEN NVL(wge_hrs.fri_wge,0)=0 AND NVL(wge_hrs.fri_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.fri_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.fri_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.fri_wge / wge_hrs.fri_hrs),2),0) END as Fri,
CASE WHEN NVL(wge_hrs.sat_wge,0)=0 AND NVL(wge_hrs.sat_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.sat_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.sat_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.sat_wge / wge_hrs.sat_hrs),2),0) END as Sat,
CASE WHEN NVL(wge_hrs.sun_wge,0)=0 AND NVL(wge_hrs.sun_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.sun_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.sun_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.sun_wge / wge_hrs.sun_hrs),2),0) END as Sun from
(select lc.rgn_no,y.Mon_wge,y.Tue_wge,y.Wed_wge,y.Thu_wge,y.Fri_wge,y.Sat_wge,y.Sun_wge,y.wtd_wge,
y.Mon_hrs,y.Tue_hrs,y.Wed_hrs,y.Thu_hrs,y.Fri_hrs,y.Sat_hrs,y.Sun_hrs,y.wtd_hrs from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select x.*,(x.Mon_wge + x.Tue_wge + x.Wed_wge + x.Thu_wge + x.Fri_wge + x.Sat_wge + x.Sun_wge) as WTD_wge,
(x.Mon_hrs + x.Tue_hrs + x.Wed_hrs + x.Thu_hrs + x.Fri_hrs + x.Sat_hrs + x.Sun_hrs) as WTD_hrs from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSR)),0) Mon_wge,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSR)),0) Tue_wge,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSR)),0) Wed_wge,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSR)),0) Thu_wge,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSR)),0) Fri_wge,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSR)),0) Sat_wge,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSR)),0) Sun_wge,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSR)),0) Mon_hrs,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSR)),0) Tue_hrs,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSR)),0) Wed_hrs,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSR)),0) Thu_hrs,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSR)),0) Fri_hrs,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSR)),0) Sat_hrs,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSR)),0) Sun_hrs from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_WGE_DTS),9) as ACTL_WGE_DTSR,ROUND(sum(h.ACTL_HRS_DTS),9) as ACTL_HRS_DTSR from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) y
on lc.rgn_no=y.rgn_no order by lc.rgn_no) wge_hrs order by wge_hrs.rgn_no]]>
	</CurrentWeekActualCPH>
	
	<CurrentWeekActualCPHTotal>
	<![CDATA[select wge_hrs.div_no,
CASE WHEN NVL(wge_hrs.mon_wge,0)=0 AND NVL(wge_hrs.mon_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.mon_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.mon_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.mon_wge / wge_hrs.mon_hrs),2),0) END as Mon,
CASE WHEN NVL(wge_hrs.tue_wge,0)=0 AND NVL(wge_hrs.tue_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.tue_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.tue_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.tue_wge / wge_hrs.tue_hrs),2),0) END as Tue,
CASE WHEN NVL(wge_hrs.wed_wge,0)=0 AND NVL(wge_hrs.wed_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.wed_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.wed_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.wed_wge / wge_hrs.wed_hrs),2),0) END as Wed,
CASE WHEN NVL(wge_hrs.thu_wge,0)=0 AND NVL(wge_hrs.thu_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.thu_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.thu_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.thu_wge / wge_hrs.thu_hrs),2),0) END as Thu,
CASE WHEN NVL(wge_hrs.fri_wge,0)=0 AND NVL(wge_hrs.fri_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.fri_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.fri_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.fri_wge / wge_hrs.fri_hrs),2),0) END as Fri,
CASE WHEN NVL(wge_hrs.sat_wge,0)=0 AND NVL(wge_hrs.sat_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.sat_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.sat_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.sat_wge / wge_hrs.sat_hrs),2),0) END as Sat,
CASE WHEN NVL(wge_hrs.sun_wge,0)=0 AND NVL(wge_hrs.sun_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.sun_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.sun_hrs,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.sun_wge / wge_hrs.sun_hrs),2),0) END as Sun from
(select lc.div_no,y.Mon_wge,y.Tue_wge,y.Wed_wge,y.Thu_wge,y.Fri_wge,y.Sat_wge,y.Sun_wge,y.wtd_wge,
y.Mon_hrs,y.Tue_hrs,y.Wed_hrs,y.Thu_hrs,y.Fri_hrs,y.Sat_hrs,y.Sun_hrs,y.wtd_hrs from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select x.*,(x.Mon_wge + x.Tue_wge + x.Wed_wge + x.Thu_wge + x.Fri_wge + x.Sat_wge + x.Sun_wge) as WTD_wge,
(x.Mon_hrs + x.Tue_hrs + x.Wed_hrs + x.Thu_hrs + x.Fri_hrs + x.Sat_hrs + x.Sun_hrs) as WTD_hrs from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSR)),0) Mon_wge,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSR)),0) Tue_wge,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSR)),0) Wed_wge,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSR)),0) Thu_wge,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSR)),0) Fri_wge,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSR)),0) Sat_wge,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSR)),0) Sun_wge,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSR)),0) Mon_hrs,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSR)),0) Tue_hrs,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSR)),0) Wed_hrs,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSR)),0) Thu_hrs,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSR)),0) Fri_hrs,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSR)),0) Sat_hrs,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSR)),0) Sun_hrs from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.ACTL_WGE_DTS),9) as ACTL_WGE_DTSR,ROUND(sum(h.ACTL_HRS_DTS),9) as ACTL_HRS_DTSR from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) y
on lc.div_no=y.div_no order by lc.div_no) wge_hrs order by wge_hrs.div_no]]>
	</CurrentWeekActualCPHTotal>
	

	<CurrentWeekActualCPHWkToDt>
	<![CDATA[select wge_hrs.rgn_no,
	CASE WHEN NVL(wge_hrs.wtd_wge,0)=0 AND NVL(wge_hrs.wtd_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.wtd_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.wtd_hrs,0)=0 THEN 0 
ELSE NVL(ROUND((wge_hrs.wtd_wge / wge_hrs.wtd_hrs),2),0) END as ACTL_CPH_WTD_DTSBU from 
(select wge.rgn_no,wge.WTD_WGE,hrs.WTD_HRS from 
(select lc.rgn_no,wge.ACTL_WGE_DTSBU as WTD_WGE from 
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g */ ) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no) wge,
(select lc.rgn_no,wge.ACTL_HRS_DTSBU as WTD_HRS from 
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g */ ) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no) hrs 
where wge.rgn_no=hrs.rgn_no) wge_hrs order by wge_hrs.rgn_no ]]>
	</CurrentWeekActualCPHWkToDt>
	<CurrentWeekActualCPHWkToDtTotal>
	<![CDATA[select wge_hrs.div_no,
	CASE WHEN NVL(wge_hrs.wtd_wge,0)=0 AND NVL(wge_hrs.wtd_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.wtd_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.wtd_hrs,0)=0 THEN 0 
ELSE NVL(ROUND((wge_hrs.wtd_wge / wge_hrs.wtd_hrs),2),0) END as ACTL_CPH_WTDTOT_DTSBU from
(select wge.div_no,wge.wtd_wge,hrs.wtd_hrs from 
(select lc.div_no,wge.ACTL_WGE_TOT_DTSBU as WTD_WGE from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.rgn_no,h.div_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.div_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.div_no,e.dply_seq order by e.rgn_no,e.div_no,e.dply_seq) h
group by h.rgn_no,h.div_no order by h.rgn_no,h.div_no) f
/* UNION
select * from 
(select e.rgn_no,e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no,e.div_no order by e.rgn_no,e.div_no) g */ ) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no) wge,
(select lc.div_no,wge.ACTL_HRS_TOT_DTSBU as WTD_HRS from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.rgn_no,h.div_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.div_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.div_no,e.dply_seq order by e.rgn_no,e.div_no,e.dply_seq) h
group by h.rgn_no,h.div_no order by h.rgn_no,h.div_no) f
/* UNION
select * from 
(select e.rgn_no,e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no,e.div_no order by e.rgn_no,e.div_no) g */ ) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no) hrs where wge.div_no=hrs.div_no order by wge.div_no) wge_hrs
order by wge_hrs.div_no]]>
	</CurrentWeekActualCPHWkToDtTotal>
	
	
	
	<CurrentWeekVarCPHWkToDt>
	<![CDATA[select pln.rgn_no,ROUND(actl.wtd - pln.wtd,2) as VAR_CPH_WTD_DTSBU from 
(select wge_hrs.rgn_no,
	CASE WHEN NVL(wge_hrs.PLN_WGE_DTSBU,0)=0 AND NVL(wge_hrs.PLN_HRS_DTSBU,0)=0 THEN 0 
WHEN NVL(wge_hrs.PLN_WGE_DTSBU,0)=0 THEN 0 WHEN NVL(wge_hrs.PLN_HRS_DTSBU,0)=0 THEN 0 
ELSE NVL(ROUND((wge_hrs.PLN_WGE_DTSBU / wge_hrs.PLN_HRS_DTSBU),2),0) END as wtd from
(select lc.rgn_no,ROUND(wge.PLN_WGE_DTSBU,0) as PLN_WGE_DTSBU,wge.PLN_HRS_DTSBU as PLN_HRS_DTSBU  from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HRS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge_hrs order by wge_hrs.rgn_no) PLN,
(select wge_hrs.rgn_no,
	CASE WHEN NVL(wge_hrs.wtd_wge,0)=0 AND NVL(wge_hrs.wtd_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.wtd_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.wtd_hrs,0)=0 THEN 0 
ELSE NVL(ROUND((wge_hrs.wtd_wge / wge_hrs.wtd_hrs),2),0) END as wtd from 
(select wge.rgn_no,wge.WTD_WGE,hrs.WTD_HRS from 
(select lc.rgn_no,wge.ACTL_WGE_DTSBU as WTD_WGE from 
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g */ ) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no) wge,
(select lc.rgn_no,wge.ACTL_HRS_DTSBU as WTD_HRS from 
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g */ ) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no) hrs 
where wge.rgn_no=hrs.rgn_no) wge_hrs order by wge_hrs.rgn_no) ACTL
where pln.rgn_no=actl.rgn_no order by pln.rgn_no ]]>
	</CurrentWeekVarCPHWkToDt>
	<CurrentWeekVarCPHWkToDtTotal>
	<![CDATA[select pln.div_no,ROUND(actl.wtd - pln.wtd,2) as VAR_CPH_WTDTOT_DTSBU from 
(select wge_hrs.div_no,
	CASE WHEN NVL(wge_hrs.PLN_WGE_TOT_DTSBU,0)=0 AND NVL(wge_hrs.PLN_HRS_TOT_DTSBU,0)=0 THEN 0 
WHEN NVL(wge_hrs.PLN_WGE_TOT_DTSBU,0)=0 THEN 0 WHEN NVL(wge_hrs.PLN_HRS_TOT_DTSBU,0)=0 THEN 100 
ELSE NVL(ROUND((wge_hrs.PLN_WGE_TOT_DTSBU / wge_hrs.PLN_HRS_TOT_DTSBU),2),0) END as wtd from
(select lc.div_no,ROUND(wge.PLN_WGE_TOT_DTSBU,0) as PLN_WGE_TOT_DTSBU,wge.PLN_HRS_TOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WGE_TOT_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HRS_TOT_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) wge_hrs order by wge_hrs.div_no) pln,
(select wge_hrs.div_no,
	CASE WHEN NVL(wge_hrs.wtd_wge,0)=0 AND NVL(wge_hrs.wtd_hrs,0)=0 THEN 0 
WHEN NVL(wge_hrs.wtd_wge,0)=0 THEN 0 WHEN NVL(wge_hrs.wtd_hrs,0)=0 THEN 0 
ELSE NVL(ROUND((wge_hrs.wtd_wge / wge_hrs.wtd_hrs),2),0) END as wtd from
(select wge.div_no,wge.wtd_wge,hrs.wtd_hrs from 
(select lc.div_no,wge.ACTL_WGE_TOT_DTSBU as WTD_WGE from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.rgn_no,h.div_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.div_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.div_no,e.dply_seq order by e.rgn_no,e.div_no,e.dply_seq) h
group by h.rgn_no,h.div_no order by h.rgn_no,h.div_no) f
/* UNION
select * from 
(select e.rgn_no,e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no,e.div_no order by e.rgn_no,e.div_no) g */ ) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no) wge,
(select lc.div_no,wge.ACTL_HRS_TOT_DTSBU as WTD_HRS from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.rgn_no,h.div_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.div_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.div_no,e.dply_seq order by e.rgn_no,e.div_no,e.dply_seq) h
group by h.rgn_no,h.div_no order by h.rgn_no,h.div_no) f
/* UNION
select * from 
(select e.rgn_no,e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no,e.div_no order by e.rgn_no,e.div_no) g */ ) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no) hrs where wge.div_no=hrs.div_no order by wge.div_no) wge_hrs
order by wge_hrs.div_no) actl
where pln.div_no=actl.div_no order by pln.div_no ]]>
	</CurrentWeekVarCPHWkToDtTotal>
	
	
</TCName>





<TCName name = "WagesPercentageColumnValidation" >
	<PlannedWagesPercentage>
	<![CDATA[select wge.rgn_no,
CASE WHEN NVL(wge.mon,0)=0 AND NVL(sls.mon,0)=0 THEN 0
WHEN NVL(wge.mon,0)=0 THEN 0 WHEN NVL(sls.mon,0)=0 THEN 0 
ELSE ROUND((wge.mon / sls.mon)*100,2) END as Mon,
CASE WHEN NVL(wge.tue,0)=0 AND NVL(sls.tue,0)=0 THEN 0
WHEN NVL(wge.tue,0)=0 THEN 0 WHEN NVL(sls.tue,0)=0 THEN 0 
ELSE ROUND((wge.tue / sls.tue)*100,2) END as Tue,
CASE WHEN NVL(wge.wed,0)=0 AND NVL(sls.wed,0)=0 THEN 0
WHEN NVL(wge.wed,0)=0 THEN 0 WHEN NVL(sls.wed,0)=0 THEN 0 
ELSE ROUND((wge.wed / sls.wed)*100,2) END as Wed,
CASE WHEN NVL(wge.thu,0)=0 AND NVL(sls.thu,0)=0 THEN 0
WHEN NVL(wge.thu,0)=0 THEN 0 WHEN NVL(sls.thu,0)=0 THEN 0 
ELSE ROUND((wge.thu / sls.thu)*100,2) END as Thu,
CASE WHEN NVL(wge.fri,0)=0 AND NVL(sls.fri,0)=0 THEN 0
WHEN NVL(wge.fri,0)=0 THEN 0 WHEN NVL(sls.fri,0)=0 THEN 0 
ELSE ROUND((wge.fri / sls.fri)*100,2) END as Fri,
CASE WHEN NVL(wge.sat,0)=0 AND NVL(sls.sat,0)=0 THEN 0
WHEN NVL(wge.sat,0)=0 THEN 0 WHEN NVL(sls.sat,0)=0 THEN 0 
ELSE ROUND((wge.sat / sls.sat)*100,2) END as Sat,
CASE WHEN NVL(wge.sun,0)=0 AND NVL(sls.sun,0)=0 THEN 0
WHEN NVL(wge.sun,0)=0 THEN 0 WHEN NVL(sls.sun,0)=0 THEN 0 
ELSE ROUND((wge.sun / sls.sun)*100,2) END as Sun from
(select lc.rgn_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'
order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from 
(select distinct rgn_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N') order by rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no ]]>
	</PlannedWagesPercentage>
	<PlannedWagesPercentageTotal>
	<![CDATA[select wge.div_no,
CASE WHEN NVL(wge.mon,0)=0 AND NVL(sls.mon,0)=0 THEN 0
WHEN NVL(wge.mon,0)=0 THEN 0 WHEN NVL(sls.mon,0)=0 THEN 0 
ELSE ROUND((wge.mon / sls.mon)*100,2) END as Mon,
CASE WHEN NVL(wge.tue,0)=0 AND NVL(sls.tue,0)=0 THEN 0
WHEN NVL(wge.tue,0)=0 THEN 0 WHEN NVL(sls.tue,0)=0 THEN 0 
ELSE ROUND((wge.tue / sls.tue)*100,2) END as Tue,
CASE WHEN NVL(wge.wed,0)=0 AND NVL(sls.wed,0)=0 THEN 0
WHEN NVL(wge.wed,0)=0 THEN 0 WHEN NVL(sls.wed,0)=0 THEN 0 
ELSE ROUND((wge.wed / sls.wed)*100,2) END as Wed,
CASE WHEN NVL(wge.thu,0)=0 AND NVL(sls.thu,0)=0 THEN 0
WHEN NVL(wge.thu,0)=0 THEN 0 WHEN NVL(sls.thu,0)=0 THEN 0 
ELSE ROUND((wge.thu / sls.thu)*100,2) END as Thu,
CASE WHEN NVL(wge.fri,0)=0 AND NVL(sls.fri,0)=0 THEN 0
WHEN NVL(wge.fri,0)=0 THEN 0 WHEN NVL(sls.fri,0)=0 THEN 0 
ELSE ROUND((wge.fri / sls.fri)*100,2) END as Fri,
CASE WHEN NVL(wge.sat,0)=0 AND NVL(sls.sat,0)=0 THEN 0
WHEN NVL(wge.sat,0)=0 THEN 0 WHEN NVL(sls.sat,0)=0 THEN 0 
ELSE ROUND((wge.sat / sls.sat)*100,2) END as Sat,
CASE WHEN NVL(wge.sun,0)=0 AND NVL(sls.sun,0)=0 THEN 0
WHEN NVL(wge.sun,0)=0 THEN 0 WHEN NVL(sls.sun,0)=0 THEN 0 
ELSE ROUND((wge.sun / sls.sun)*100,2) END as Sun from
(select lc.div_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.ar_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.PLN_WGE_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_WGE_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_WGE_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_WGE_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_WGE_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_WGE_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_WGE_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_WGE_DTS),0) as PLN_WGE_TOT_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select lc.div_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from 
(select distinct div_no from ww_wlp.loc where div_no='Division'
and wlp_live_ind in ('Y','N')) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no) sls 
where wge.div_no=sls.div_no order by wge.div_no]]>
	</PlannedWagesPercentageTotal>
	<PlannedWagesPercentageWkToDt>
	<![CDATA[select wge.rgn_no,
	CASE WHEN NVL(wge.WTD,0)=0 AND NVL(sls.WTD,0)=0 THEN 0 
	WHEN NVL(wge.WTD,0)=0 THEN 0 WHEN NVL(sls.WTD,0)=0 THEN 0 
	ELSE NVL(ROUND((wge.WTD / sls.WTD)*100,2),0) END as PLN_WGEPCT_WTD_DTSBU from	
(select lc.rgn_no,NVL(ROUND(wge.PLN_WAGE_DTS,0),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'
order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,sls.wtd from 
(select distinct rgn_no from ww_wlp.loc where div_no='Division' 
and wlp_live_ind in ('Y','N') order by rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no ]]>
	</PlannedWagesPercentageWkToDt>
	<PlannedWagesPercentageWkToDtTotal>
	<![CDATA[select wge.div_no,
	CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
	WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 0 
	ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as PLN_WGEPCT_WTDTOT_DTSBU from
(select lc.div_no,ROUND(wge.PLN_WAGE_TOT_DTG,0) as wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DTG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DTG from 
(select b.div_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no) wge,
(select lc.div_no,sls.wtd from 
(select distinct div_no from ww_wlp.loc where div_no='Division'  and wlp_live_ind in ('Y','N')) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no) sls 
where wge.div_no=sls.div_no order by wge.div_no]]>
	</PlannedWagesPercentageWkToDtTotal>	
	
	
<BudgetWagePercentage>
	<![CDATA[select wge.rgn_no,
	CASE WHEN NVL(wge.BDGT_WGE_DTSBU,0)=0 AND NVL(sls.BDGT_SLS_DTSBU,0)=0 THEN 0 
WHEN NVL(wge.BDGT_WGE_DTSBU,0)=0 THEN 0 WHEN NVL(sls.BDGT_SLS_DTSBU,0)=0 THEN 100 
ELSE NVL(ROUND((wge.BDGT_WGE_DTSBU / sls.BDGT_SLS_DTSBU)*100,2),0) END as BDGT_WGEPCT_DTSBU from 
(select lc.rgn_no,bdgt.BDGT_WAGE_DTSBU as BDGT_WGE_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='3' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.bdgt_wage_amt) as BDGT_WAGE_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,bdgt.BDGT_SALES_DTSBU as BDGT_SLS_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.bdgt_sls) as BDGT_SALES_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no ]]>
	</BudgetWagePercentage>
	<BudgetWagePercentageTotal>
	<![CDATA[select wge.div_no,
	CASE WHEN NVL(wge.BDGT_WGE_TOT_DTSBU,0)=0 AND NVL(sls.BDGT_SLS_TOT_DTSBU,0)=0 THEN 0 
WHEN NVL(wge.BDGT_WGE_TOT_DTSBU,0)=0 THEN 0 WHEN NVL(sls.BDGT_SLS_TOT_DTSBU,0)=0 THEN 100 
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_DTSBU / sls.BDGT_SLS_TOT_DTSBU)*100,2),0) END as BDGT_WGEPCT_TOT_DTSBU from  
(select lc.div_no,bdgt.BDGT_WAGE_TOT_DTSBU as BDGT_WGE_TOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.bdgt_wage_amt) as BDGT_WAGE_TOT_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) bdgt
on lc.div_no=bdgt.div_no order by lc.div_no) wge,
(select lc.div_no,bdgt.BDGT_SALES_TOT_DTSBU as BDGT_SLS_TOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.bdgt_sls) as BDGT_SALES_TOT_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) bdgt
on lc.div_no=bdgt.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no]]>
	</BudgetWagePercentageTotal>
	
	<ForecastWagePercentage>
	<![CDATA[select wge.rgn_no,
	CASE WHEN NVL(wge.FCST_WGE_DTSBU,0)=0 AND NVL(sls.FCST_SLS_DTSBU,0)=0 THEN 0 
WHEN NVL(wge.FCST_WGE_DTSBU,0)=0 THEN 0 WHEN NVL(sls.FCST_SLS_DTSBU,0)=0 THEN 100 
ELSE NVL(ROUND((wge.FCST_WGE_DTSBU / sls.FCST_SLS_DTSBU)*100,2),0) END as FCST_WGEPCT_DTSBU from 
(select lc.rgn_no,bdgt.BDGT_WAGE_DTSBU as FCST_WGE_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.frcst_wage_amt) as BDGT_WAGE_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,bdgt.BDGT_SALES_DTSBU as FCST_SLS_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.frcst_sls) as BDGT_SALES_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no ]]>
	</ForecastWagePercentage>
	<ForecastWagePercentageTotal>
	<![CDATA[select wge.div_no,
	CASE WHEN NVL(wge.FCST_WGE_TOT_DTSR,0)=0 AND NVL(sls.FCST_SLS_TOT_DTSR,0)=0 THEN 0 
WHEN NVL(wge.FCST_WGE_TOT_DTSR,0)=0 THEN 0 WHEN NVL(sls.FCST_SLS_TOT_DTSR,0)=0 THEN 100 
ELSE NVL(ROUND((wge.FCST_WGE_TOT_DTSR / sls.FCST_SLS_TOT_DTSR)*100,2),0) END as FCST_WGEPCT_TOT_DTSBU from 
(select lc.div_no,fcst.FCST_WAGE_TOT_DTSR as FCST_WGE_TOT_DTSR from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.frcst_wage_amt) as FCST_WAGE_TOT_DTSR from 
(select b.rgn_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) fcst
on lc.div_no=fcst.div_no order by lc.div_no) wge,
(select lc.div_no,fcst.FCST_SALES_TOT_DTSR as FCST_SLS_TOT_DTSR from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.frcst_sls) as FCST_SALES_TOT_DTSR from 
(select b.rgn_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) fcst
on lc.div_no=fcst.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no]]>
	</ForecastWagePercentageTotal>

	
	<PastWeekActualWagesPercentage>
	<![CDATA[select wge.rgn_no,
	CASE WHEN NVL(wge.mon,0) = 0 AND NVL(sls.mon,0) = 0 THEN 0
WHEN NVL(wge.mon,0) = 0 THEN 0 WHEN NVL(sls.mon,0) = 0 THEN 100
ELSE ROUND((wge.mon / sls.mon)*100,2) END as Mon,
CASE WHEN NVL(wge.tue,0) = 0 AND NVL(sls.tue,0) = 0 THEN 0
WHEN NVL(wge.tue,0) = 0 THEN 0 WHEN NVL(sls.tue,0) = 0 THEN 100
ELSE ROUND((wge.tue / sls.tue)*100,2) END as Tue,
CASE WHEN NVL(wge.wed,0) = 0 AND NVL(sls.wed,0) = 0 THEN 0
WHEN NVL(wge.wed,0) = 0 THEN 0 WHEN NVL(sls.wed,0) = 0 THEN 100
ELSE ROUND((wge.wed / sls.wed)*100,2) END as Wed,
CASE WHEN NVL(wge.thu,0) = 0 AND NVL(sls.thu,0) = 0 THEN 0
WHEN NVL(wge.thu,0) = 0 THEN 0 WHEN NVL(sls.thu,0) = 0 THEN 100
ELSE ROUND((wge.thu / sls.thu)*100,2) END as Thu,
CASE WHEN NVL(wge.fri,0) = 0 AND NVL(sls.fri,0) = 0 THEN 0
WHEN NVL(wge.fri,0) = 0 THEN 0 WHEN NVL(sls.fri,0) = 0 THEN 100
ELSE ROUND((wge.fri / sls.fri)*100,2) END as Fri,
CASE WHEN NVL(wge.sat,0) = 0 AND NVL(sls.sat,0) = 0 THEN 0
WHEN NVL(wge.sat,0) = 0 THEN 0 WHEN NVL(sls.sat,0) = 0 THEN 100
ELSE ROUND((wge.sat / sls.sat)*100,2) END as Sat,
CASE WHEN NVL(wge.sun,0) = 0 AND NVL(sls.sun,0) = 0 THEN 0
WHEN NVL(wge.sun,0) = 0 THEN 0 WHEN NVL(sls.sun,0) = 0 THEN 100
ELSE ROUND((wge.sun / sls.sun)*100,2) END as Sun from
(select lc.rgn_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no ]]>
	</PastWeekActualWagesPercentage>
	
	<PastWeekActualWagesPercentageTotal>
	<![CDATA[select wge.div_no,
	CASE WHEN NVL(wge.mon,0) = 0 AND NVL(sls.mon,0) = 0 THEN 0
WHEN NVL(wge.mon,0) = 0 THEN 0 WHEN NVL(sls.mon,0) = 0 THEN 100
ELSE ROUND((wge.mon / sls.mon)*100,2) END as Mon,
CASE WHEN NVL(wge.tue,0) = 0 AND NVL(sls.tue,0) = 0 THEN 0
WHEN NVL(wge.tue,0) = 0 THEN 0 WHEN NVL(sls.tue,0) = 0 THEN 100
ELSE ROUND((wge.tue / sls.tue)*100,2) END as Tue,
CASE WHEN NVL(wge.wed,0) = 0 AND NVL(sls.wed,0) = 0 THEN 0
WHEN NVL(wge.wed,0) = 0 THEN 0 WHEN NVL(sls.wed,0) = 0 THEN 100
ELSE ROUND((wge.wed / sls.wed)*100,2) END as Wed,
CASE WHEN NVL(wge.thu,0) = 0 AND NVL(sls.thu,0) = 0 THEN 0
WHEN NVL(wge.thu,0) = 0 THEN 0 WHEN NVL(sls.thu,0) = 0 THEN 100
ELSE ROUND((wge.thu / sls.thu)*100,2) END as Thu,
CASE WHEN NVL(wge.fri,0) = 0 AND NVL(sls.fri,0) = 0 THEN 0
WHEN NVL(wge.fri,0) = 0 THEN 0 WHEN NVL(sls.fri,0) = 0 THEN 100
ELSE ROUND((wge.fri / sls.fri)*100,2) END as Fri,
CASE WHEN NVL(wge.sat,0) = 0 AND NVL(sls.sat,0) = 0 THEN 0
WHEN NVL(wge.sat,0) = 0 THEN 0 WHEN NVL(sls.sat,0) = 0 THEN 100
ELSE ROUND((wge.sat / sls.sat)*100,2) END as Sat,
CASE WHEN NVL(wge.sun,0) = 0 AND NVL(sls.sun,0) = 0 THEN 0
WHEN NVL(wge.sun,0) = 0 THEN 0 WHEN NVL(sls.sun,0) = 0 THEN 100
ELSE ROUND((wge.sun / sls.sun)*100,2) END as Sun from
(select lc.div_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select lc.div_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no]]>
	</PastWeekActualWagesPercentageTotal>	
	
	<PastWeekActualWagesPercentageWkToDt>
	<![CDATA[select wge.rgn_no,
	CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
	WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
	ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as ACTL_WGEPCT_WTD_DTSBU from  
(select lc.rgn_no,wge.ACTL_WGE_DTSBU as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,sls.wtd as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e )  */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no ]]>
	</PastWeekActualWagesPercentageWkToDt>
	<PastWeekActualWagesPercentageWkToDtTotal>
	<![CDATA[select wge.div_no,
	CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
	WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
	ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as ACTL_WGEPCT_WTDTOT_DTSBU from 
(select lc.div_no,wge.ACTL_WGE_TOT_DTSBU as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select lc.div_no,sls.wtd as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no]]>
	</PastWeekActualWagesPercentageWkToDtTotal>	
	
	
	<PastWeekVarWagesPercentageWkToDt>
	<![CDATA[select pln.rgn_no,ROUND(actl.wtd - pln.wtd,2) as VAR_WGEPCT_WTD_DTSBU from 
(select wge.rgn_no,
CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
	WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
	ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as wtd from
(select lc.rgn_no,ROUND(wge.PLN_WAGE_DTS,0) as wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'
order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no) wge,
(select lc.rgn_no,sls.wtd from 
(select distinct rgn_no from ww_wlp.loc where div_no='Division' 
and wlp_live_ind in ('Y','N') order by rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no) sls
where wge.rgn_no=sls.rgn_no) pln,
(select wge.rgn_no,NVL((wge.wtd / sls.wtd)*100,0) as WTD from 
(select lc.rgn_no,wge.ACTL_WGE_DTSBU as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,sls.wtd as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no ]]>
	</PastWeekVarWagesPercentageWkToDt>
	<PastWeekVarWagesPercentageWkToDtTotal>
	<![CDATA[select pln.div_no,ROUND(actl.wtd - pln.wtd,2) as VAR_WGEPCT_WTDTOT_DTSBU from 
(select wge.div_no,
CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.WTD,0)=0 THEN 0 
WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.WTD,0)=0 THEN 100 
ELSE NVL(ROUND(((wge.wtd / sls.WTD)*100),2),0) END as wtd from
(select lc.div_no,wge.PLN_WAGE_TOT_DTG as wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DTG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DTG from 
(select b.div_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no) wge,
(select lc.div_no,sls.wtd from 
(select distinct div_no from ww_wlp.loc where div_no='Division'  and wlp_live_ind in ('Y','N')) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no) sls 
where wge.div_no=sls.div_no order by wge.div_no) pln,
(select wge.div_no,NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) as wtd from 
(select lc.div_no,wge.ACTL_WGE_TOT_DTSBU as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select lc.div_no,sls.wtd as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no) actl
where pln.div_no=actl.div_no order by pln.div_no ]]>
	</PastWeekVarWagesPercentageWkToDtTotal>
	
	
	
	<PastWeekEstimatedFcstWagePrcnt>
	<![CDATA[select wge.rgn_no,
	CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as ESTD_WGEPCT_DTSBU from
(select lc.rgn_no,NVL(ROUND(wge.ACTL_WGE_DTSBU,0),0) as WTD from 
(select distinct b.rgn_no from loc b where b.div_no='3'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSR) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSR) as ACTL_HOURS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSR,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSR from 
(select e.zone_no,e.rgn_no,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no order by e.zone_no,e.rgn_no) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSR,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSR from 
(select e.zone_no,e.rgn_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.zone_no,e.rgn_no order by e.zone_no,e.rgn_no) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,sls.wtd as WTD from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSR)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSR from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) f
UNION
select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.zone_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no ]]>
	</PastWeekEstimatedFcstWagePrcnt>
	<PastWeekEstimatedFcstWagePrcntTotal>
	<![CDATA[select wge.div_no,
	CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as ESTD_WGEPCT_TOT_DTSBU from 
(select lc.div_no,NVL(ROUND(wge.ACTL_WGE_TOT_DTSBU,0),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSR) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSR) as ACTL_HRS_TOT_DTSR from 
(select * from 
(select h.rgn_no,h.div_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSR,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSR from 
(select e.rgn_no,e.div_no,e.ar_no,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.ar_no order by e.rgn_no,e.div_no,e.ar_no) h
group by h.rgn_no,h.div_no order by h.rgn_no,h.div_no) f
/* UNION
select * from 
(select h.rgn_no,h.div_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSR,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSR from 
(select e.rgn_no,e.div_no,e.ar_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no,b.div_no) NOT IN 
(select distinct b.rgn_no,b.div_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.div_no,e.ar_no order by e.rgn_no,e.div_no,e.ar_no) h
group by h.rgn_no,h.div_no order by h.rgn_no,h.div_no) g 
UNION
select * from 
(select e.rgn_no,e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no,b.div_no) NOT IN 
(select distinct b.rgn_no,b.div_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no,b.div_no) NOT IN 
(select distinct b.rgn_no,b.div_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no,e.div_no order by e.rgn_no,e.div_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select lc.div_no,sls.wtd as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSR)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSR from 
(select * from 
(select e.rgn_no,e.div_no,e.ar_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.div_no,e.ar_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.div_no,e.ar_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.div_no,e.ar_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.div_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.div_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no]]>
	</PastWeekEstimatedFcstWagePrcntTotal>
	
	
	<PastWeekVarWagesPrecentage>
	<![CDATA[select estd_fcst.rgn_no,ROUND((estd_fcst.ESTD_FCST_WGE_PCT_DTSBU - bdgt.BDGT_WGE_PCT_DTSBU),2) as BDGT_VAR_WGE_PCT_DTSBU from 
(select wge.rgn_no,
CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
ELSE NVL(ROUND(((wge.wtd / sls.wtd)*100),2),0) END as ESTD_FCST_WGE_PCT_DTSBU from  
(select lc.rgn_no,wge.wtd from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSR)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_DTSR from 
(select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) f
/* UNION
select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and (b.zone_no,dy.day_of_wk) NOT IN 
(select distinct b.zone_no,dy.day_of_wk from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) g */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no) wge,
(select lc.rgn_no,sls.wtd as WTD from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSR)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSR from 
(select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk 
order by e.zone_no,e.rgn_no,e.day_of_wk) f
/*UNION
select * from 
(select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk 
order by e.zone_no,e.rgn_no,e.day_of_wk) f
UNION
select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.div_no=b.div_no and a.loc_no=b.loc_no and b.div_no='Division'  )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) g) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no) sls
where wge.rgn_no=sls.rgn_no) estd_fcst,
(select wge.rgn_no,
CASE WHEN NVL(wge.BDGT_WGE_DTSR,0)=0 AND NVL(sls.BDGT_SLS_DTSR,0)=0 THEN 0 
WHEN NVL(wge.BDGT_WGE_DTSR,0)=0 THEN 0 WHEN NVL(sls.BDGT_SLS_DTSR,0)=0 THEN 100 
ELSE NVL(ROUND((wge.BDGT_WGE_DTSR / sls.BDGT_SLS_DTSR)*100,2),0) END as BDGT_WGE_PCT_DTSBU from  
(select lc.rgn_no,sum(bdgt.bdgt_wage_amt) as BDGT_WGE_DTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no and lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,sum(bdgt.bdgt_sls) as BDGT_SLS_DTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.zone_no,b.rgn_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'   
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no and lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no) bdgt
where estd_fcst.rgn_no=bdgt.rgn_no order by estd_fcst.rgn_no]]>
	</PastWeekVarWagesPrecentage>
	<PastWeekVarWagesPrecentageTotal>
	<![CDATA[select estd_fcst.div_no,ROUND((estd_fcst.ESTD_FCST_WGE_PCT_TOT_DTSBU - bdgt.BDGT_WGE_PCT_TOT_DTSBU),2) as BDGT_VAR_WGE_PCT_TOT_DTSBU from 
(select wge.div_no,
CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
ELSE NVL(ROUND(((wge.wtd / sls.wtd)*100),2),0) END as ESTD_FCST_WGE_PCT_TOT_DTSBU from
(select lc.div_no,wge.wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSR)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTSR from 
(select * from 
(select e.rgn_no,e.div_no,e.ar_no,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk) f
/* UNION
select * from 
(select e.rgn_no,e.div_no,e.ar_no,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and (b.rgn_no,b.div_no,dy.day_of_wk) NOT IN 
(select distinct b.rgn_no,b.div_no,dy.day_of_wk from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk) g */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no) wge,
(select lc.div_no,sls.wtd as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSR)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSR from 
(select * from 
(select e.rgn_no,e.div_no,e.ar_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.div_no,e.ar_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.div_no,e.ar_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.div_no=b.div_no and a.loc_no=b.loc_no and b.div_no='Division'  )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk) g) pln_sls 
where (pln_sls.rgn_no,pln_sls.div_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.div_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no) sls
where wge.div_no=sls.div_no) estd_fcst,
(select wge.div_no,
CASE WHEN NVL(wge.BDGT_WGE_TOT_DTSR,0)=0 AND NVL(sls.BDGT_SLS_TOT_DTSR,0)=0 THEN 0 
WHEN NVL(wge.BDGT_WGE_TOT_DTSR,0)=0 THEN 0 WHEN NVL(sls.BDGT_SLS_TOT_DTSR,0)=0 THEN 100 
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_DTSR / sls.BDGT_SLS_TOT_DTSR)*100,2),0) END as BDGT_WGE_PCT_TOT_DTSBU from 
(select lc.div_no,sum(bdgt.bdgt_wage_amt) as BDGT_WGE_TOT_DTSR from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.div_no=bdgt.div_no group by lc.div_no order by lc.div_no) wge,
(select lc.div_no,sum(bdgt.bdgt_sls) as BDGT_SLS_TOT_DTSR from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'   
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.div_no=bdgt.div_no group by lc.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no) bdgt
where estd_fcst.div_no=bdgt.div_no order by estd_fcst.div_no]]>
	</PastWeekVarWagesPrecentageTotal>
	
	<PastWeekForecastVarWagesPrecentage>
	<![CDATA[select estd_fcst.rgn_no,ROUND((estd_fcst.ESTD_FCST_WGEPCT_DTSBU - bdgt.FCST_WGEPCT_DTSBU),2) as FCST_VAR_WGEPCT_DTSBU from 
(select wge.rgn_no,
CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as ESTD_FCST_WGEPCT_DTSBU from 
(select lc.rgn_no,wge.ACTL_WGE_DTSR as WTD from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSR) as ACTL_WGE_DTSR,sum(j.ACTL_HOURS_DTSR) as ACTL_HRS_DTSR from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSR,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSR from 
(select e.zone_no,e.rgn_no,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no order by e.zone_no,e.rgn_no) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSR,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSR from 
(select e.zone_no,e.rgn_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.zone_no,e.rgn_no order by e.zone_no,e.rgn_no) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,sls.wtd as WTD from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSR)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSR from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) f
UNION
select * from 
(select e.zone_no,e.rgn_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.zone_no,e.rgn_no,e.day_of_wk order by e.zone_no,e.rgn_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.zone_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no) estd_fcst,
(select wge.rgn_no,
CASE WHEN NVL(wge.FCST_WGE_DTSBU,0)=0 AND NVL(sls.FCST_SLS_DTSBU,0)=0 THEN 0 
WHEN NVL(wge.FCST_WGE_DTSBU,0)=0 THEN 0 WHEN NVL(sls.FCST_SLS_DTSBU,0)=0 THEN 100 
ELSE NVL(ROUND((wge.FCST_WGE_DTSBU / sls.FCST_SLS_DTSBU)*100,2),0) END as FCST_WGEPCT_DTSBU from  
(select lc.rgn_no,bdgt.BDGT_WAGE_DTSBU as FCST_WGE_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.frcst_wage_amt) as BDGT_WAGE_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,bdgt.FCST_SLS_DTSBU as FCST_SLS_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,sum(e.frcst_sls) as FCST_SLS_DTSBU from 
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division' 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.rgn_no order by e.rgn_no) bdgt
on lc.rgn_no=bdgt.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no) bdgt
where estd_fcst.rgn_no=bdgt.rgn_no]]>
	</PastWeekForecastVarWagesPrecentage>
	<PastWeekForecastVarWagesPrecentageTotal>
	<![CDATA[select estd_fcst.div_no,ROUND((estd_fcst.ESTD_FCST_WGE_PCT_TOT_DTSBU - bdgt.fcst_WGE_PCT_TOT_DTSBU),2) as BDGT_VAR_WGE_PCT_TOT_DTSBU from 
(select wge.div_no,
CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as ESTD_FCST_WGE_PCT_TOT_DTSBU from  
(select lc.div_no,wge.ACTL_WGE_TOT_DTSR as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSR) as ACTL_WGE_TOT_DTSR,sum(j.ACTL_HOURS_DTSR) as ACTL_HRS_TOT_DTSR from 
(select * from 
(select h.rgn_no,h.div_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSR,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSR from 
(select e.rgn_no,e.div_no,e.ar_no,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.ar_no order by e.rgn_no,e.div_no,e.ar_no) h
group by h.rgn_no,h.div_no order by h.rgn_no,h.div_no) f
/* UNION
select * from 
(select h.rgn_no,h.div_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSR,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSR from 
(select e.rgn_no,e.div_no,e.ar_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no,b.div_no) NOT IN 
(select distinct b.rgn_no,b.div_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.div_no,e.ar_no order by e.rgn_no,e.div_no,e.ar_no) h
group by h.rgn_no,h.div_no order by h.rgn_no,h.div_no) g 
UNION
select * from 
(select e.rgn_no,e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSR,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSR from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no,b.div_no) NOT IN 
(select distinct b.rgn_no,b.div_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0)
and (b.rgn_no,b.div_no) NOT IN 
(select distinct b.rgn_no,b.div_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no,e.div_no order by e.rgn_no,e.div_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select lc.div_no,sls.wtd as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSR)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSR from 
(select * from 
(select e.rgn_no,e.div_no,e.ar_no,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.div_no,e.ar_no,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.div_no,e.ar_no,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.div_no,e.ar_no,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.div_no,e.ar_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.ar_no,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.div_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.div_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no) estd_fcst,
(select wge.div_no,
CASE WHEN NVL(wge.FCST_WGE_TOT_DTSR,0)=0 AND NVL(sls.FCST_SLS_TOT_DTSR,0)=0 THEN 0 
WHEN NVL(wge.FCST_WGE_TOT_DTSR,0)=0 THEN 0 WHEN NVL(sls.FCST_SLS_TOT_DTSR,0)=0 THEN 100 
ELSE NVL(ROUND((wge.FCST_WGE_TOT_DTSR / sls.FCST_SLS_TOT_DTSR)*100,2),0) END as fcst_WGE_PCT_TOT_DTSBU from
(select lc.div_no,fcst.FCST_WAGE_TOT_DTSR as FCST_WGE_TOT_DTSR from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.frcst_wage_amt) as FCST_WAGE_TOT_DTSR from 
(select b.rgn_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) fcst
on lc.div_no=fcst.div_no order by lc.div_no) wge,
(select lc.div_no,fcst.FCST_SALES_TOT_DTSR as FCST_SLS_TOT_DTSR from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,sum(e.frcst_sls) as FCST_SALES_TOT_DTSR from 
(select b.rgn_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) e
group by e.div_no order by e.div_no) fcst
on lc.div_no=fcst.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no) bdgt
where estd_fcst.div_no=bdgt.div_no order by estd_fcst.div_no ]]>
	</PastWeekForecastVarWagesPrecentageTotal>
	
	
	<CurrentWeekActualWagesPercentage>
	<![CDATA[select wge.rgn_no,
CASE WHEN NVL(wge.mon,0) = 0 AND NVL(sls.mon,0) = 0 THEN 0
WHEN NVL(wge.mon,0) = 0 THEN 0 WHEN NVL(sls.mon,0) = 0 THEN 100
ELSE ROUND((wge.mon / sls.mon)*100,2) END as Mon,
CASE WHEN NVL(wge.tue,0) = 0 AND NVL(sls.tue,0) = 0 THEN 0
WHEN NVL(wge.tue,0) = 0 THEN 0 WHEN NVL(sls.tue,0) = 0 THEN 100
ELSE ROUND((wge.tue / sls.tue)*100,2) END as Tue,
CASE WHEN NVL(wge.wed,0) = 0 AND NVL(sls.wed,0) = 0 THEN 0
WHEN NVL(wge.wed,0) = 0 THEN 0 WHEN NVL(sls.wed,0) = 0 THEN 100
ELSE ROUND((wge.wed / sls.wed)*100,2) END as Wed,
CASE WHEN NVL(wge.thu,0) = 0 AND NVL(sls.thu,0) = 0 THEN 0
WHEN NVL(wge.thu,0) = 0 THEN 0 WHEN NVL(sls.thu,0) = 0 THEN 100
ELSE ROUND((wge.thu / sls.thu)*100,2) END as Thu,
CASE WHEN NVL(wge.fri,0) = 0 AND NVL(sls.fri,0) = 0 THEN 0
WHEN NVL(wge.fri,0) = 0 THEN 0 WHEN NVL(sls.fri,0) = 0 THEN 100
ELSE ROUND((wge.fri / sls.fri)*100,2) END as Fri,
CASE WHEN NVL(wge.sat,0) = 0 AND NVL(sls.sat,0) = 0 THEN 0
WHEN NVL(wge.sat,0) = 0 THEN 0 WHEN NVL(sls.sat,0) = 0 THEN 100
ELSE ROUND((wge.sat / sls.sat)*100,2) END as Sat,
CASE WHEN NVL(wge.sun,0) = 0 AND NVL(sls.sun,0) = 0 THEN 0
WHEN NVL(wge.sun,0) = 0 THEN 0 WHEN NVL(sls.sun,0) = 0 THEN 100
ELSE ROUND((wge.sun / sls.sun)*100,2) END as Sun from
(select lc.rgn_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e )*/) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no ]]>
	</CurrentWeekActualWagesPercentage>
	<CurrentWeekActualWagesPercentageTotal>
	<![CDATA[select wge.div_no,
	CASE WHEN NVL(wge.mon,0) = 0 AND NVL(sls.mon,0) = 0 THEN 0
WHEN NVL(wge.mon,0) = 0 THEN 0 WHEN NVL(sls.mon,0) = 0 THEN 100
ELSE ROUND((wge.mon / sls.mon)*100,2) END as Mon,
CASE WHEN NVL(wge.tue,0) = 0 AND NVL(sls.tue,0) = 0 THEN 0
WHEN NVL(wge.tue,0) = 0 THEN 0 WHEN NVL(sls.tue,0) = 0 THEN 100
ELSE ROUND((wge.tue / sls.tue)*100,2) END as Tue,
CASE WHEN NVL(wge.wed,0) = 0 AND NVL(sls.wed,0) = 0 THEN 0
WHEN NVL(wge.wed,0) = 0 THEN 0 WHEN NVL(sls.wed,0) = 0 THEN 100
ELSE ROUND((wge.wed / sls.wed)*100,2) END as Wed,
CASE WHEN NVL(wge.thu,0) = 0 AND NVL(sls.thu,0) = 0 THEN 0
WHEN NVL(wge.thu,0) = 0 THEN 0 WHEN NVL(sls.thu,0) = 0 THEN 100
ELSE ROUND((wge.thu / sls.thu)*100,2) END as Thu,
CASE WHEN NVL(wge.fri,0) = 0 AND NVL(sls.fri,0) = 0 THEN 0
WHEN NVL(wge.fri,0) = 0 THEN 0 WHEN NVL(sls.fri,0) = 0 THEN 100
ELSE ROUND((wge.fri / sls.fri)*100,2) END as Fri,
CASE WHEN NVL(wge.sat,0) = 0 AND NVL(sls.sat,0) = 0 THEN 0
WHEN NVL(wge.sat,0) = 0 THEN 0 WHEN NVL(sls.sat,0) = 0 THEN 100
ELSE ROUND((wge.sat / sls.sat)*100,2) END as Sat,
CASE WHEN NVL(wge.sun,0) = 0 AND NVL(sls.sun,0) = 0 THEN 0
WHEN NVL(wge.sun,0) = 0 THEN 0 WHEN NVL(sls.sun,0) = 0 THEN 100
ELSE ROUND((wge.sun / sls.sun)*100,2) END as Sun from
(select lc.div_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_WGE_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_WGE_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_WGE_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_WGE_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_WGE_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_WGE_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_WGE_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_WGE_DTS) as ACTL_WGE_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_amt is NOT NULL and a.actl_amt!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) wge,
(select lc.div_no,sls.mon,sls.tue,sls.wed,sls.thu,sls.fri,sls.sat,sls.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and sysdate-1 and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and sysdate-1 and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no]]>
	</CurrentWeekActualWagesPercentageTotal>



	<CurrentWeekActualWagesPercentageWkToDt>
	<![CDATA[select wge.rgn_no,
	CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
	WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
	ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as ACTL_WGEPCT_WTD_DTSBU from 
(select lc.rgn_no,wge.ACTL_WGE_DTSBU as WTD from 	
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g  */) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no) wge,
(select lc.rgn_no,sls.wtd as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no ]]>
	</CurrentWeekActualWagesPercentageWkToDt>
	<CurrentWeekActualWagesPercentageWkToDtTotal>
	<![CDATA[select wge.div_no,
    CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
	WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
	ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as ACTL_WGEPCT_WTDTOT_DTSBU from 
(select lc.div_no,wge.ACTL_WGE_TOT_DTSBU as WTD from
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28)
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) g */ ) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no) wge,
(select lc.div_no,sls.wtd as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no ]]>
	</CurrentWeekActualWagesPercentageWkToDtTotal>
	
	
	
	<CurrentWeekVarWagesPercentageWkToDt>
	<![CDATA[select pln.rgn_no,ROUND(actl.ACTL_WGEPCT_WTD_DTSBU - pln.PLN_WGEPCT_WTD_DTSBU,2) as VAR_WGEPCT_WTD_DTSBU from 
(select wge.rgn_no,
CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
ELSE NVL(ROUND(((wge.wtd / sls.wtd)*100),2),0) END as PLN_WGEPCT_WTD_DTSBU from
(select lc.rgn_no,wge.PLN_WAGE_DTS as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'
order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) wge
on wge.rgn_no=lc.rgn_no) wge,
(select lc.rgn_no,sls.wtd from 
(select distinct rgn_no from ww_wlp.loc where div_no='Division' 
and wlp_live_ind in ('Y','N') order by rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SLS_DTS) as PLN_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' )
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no ) pln,
(select wge.rgn_no,
CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.WTD,0)=0 THEN 0 
WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.WTD,0)=0 THEN 100 
ELSE NVL(ROUND(((wge.wtd / sls.WTD)*100),2),0) END as ACTL_WGEPCT_WTD_DTSBU from 
(select lc.rgn_no,NVL(wge.ACTL_WGE_DTSBU,0) as WTD from 
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g  */) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no) wge,
(select lc.rgn_no,sls.wtd as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]>
	</CurrentWeekVarWagesPercentageWkToDt>
	<CurrentWeekVarWagesPercentageWkToDtTotal>
	<![CDATA[select pln.div_no,ROUND(actl.wtd - pln.wtd,2) as VAR_WGEPCT_WTDTOT_DTSBU from 
(select wge.div_no,
CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.WTD,0)=0 THEN 0 
WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.WTD,0)=0 THEN 100 
ELSE NVL(ROUND(((wge.wtd / sls.WTD)*100),2),0) END as WTD from
(select lc.div_no,ROUND(wge.PLN_WAGE_TOT_DTG,0) as wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_TOT_DTG,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_TOT_DTG from 
(select b.div_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no order by e.div_no) wge
on wge.div_no=lc.div_no) wge,
(select lc.div_no,sls.wtd from 
(select distinct div_no from ww_wlp.loc where div_no='Division'  and wlp_live_ind in ('Y','N')) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SLS_DTS),0) as PLN_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no) sls 
where wge.div_no=sls.div_no order by wge.div_no) pln,
(select wge.div_no,
CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.WTD,0)=0 THEN 0 
WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.WTD,0)=0 THEN 100 
ELSE NVL(ROUND(((wge.wtd / sls.WTD)*100),2),0) END as WTD from 
(select lc.div_no,wge.ACTL_WGE_TOT_DTSBU as WTD from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.div_no) NOT IN 
(select distinct a.div_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) g */ ) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no) wge,
(select lc.div_no,sls.wtd as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no) actl
where pln.div_no=actl.div_no]]>
	</CurrentWeekVarWagesPercentageWkToDtTotal>
	
	
	
	<CurrentWeekEstimatedFcstWagePrcnt>
	<![CDATA[select wge.rgn_no,
	CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as ESTD_WGEPCT_DTSBU from 
(select lc.rgn_no,NVL(ROUND(wge.ACTL_WGE_DTSBU,0),0) as WTD from 
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g  */) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no) wge,
(select lc.rgn_no,sls.wtd as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no]]>
	</CurrentWeekEstimatedFcstWagePrcnt>
	<CurrentWeekEstimatedFcstWagePrcntTotal>
	<![CDATA[select wge.div_no,
	CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as ESTD_WGEPCT_TOT_DTSBU from  
(select lc.div_no,NVL(ROUND(wge.ACTL_WGE_TOT_DTSBU,0),0) as WTD from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28)
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) g  */) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no order by wge.div_no ) wge,
(select lc.div_no,sls.wtd as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no ]]>
	</CurrentWeekEstimatedFcstWagePrcntTotal>
	
	
	
	<CurrentWeekVarWagesPrecentage>
	<![CDATA[select estd_fcst.rgn_no,ROUND((estd_fcst.ESTD_WGEPCT_DTSBU - bdgt.BDGT_WGEPCT_DTSBU),2) as BDGT_VAR_WGEPCT_DTSBU from 
(select wge.rgn_no,
CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
ELSE NVL(ROUND(((wge.wtd / sls.wtd)*100),2),0) END as ESTD_WGEPCT_DTSBU from  
(select lc.rgn_no,NVL(ROUND(wge.ACTL_WGE_DTSBU,0),0) as WTD from 
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g  */) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no) wge,
(select lc.rgn_no,sls.wtd as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSBU from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no) estd_fcst,
(select wge.rgn_no,
CASE WHEN NVL(wge.BDGT_WGE_DTSR,0)=0 AND NVL(sls.BDGT_SLS_DTSR,0)=0 THEN 0 
WHEN NVL(wge.BDGT_WGE_DTSR,0)=0 THEN 0 WHEN NVL(sls.BDGT_SLS_DTSR,0)=0 THEN 100 
ELSE NVL(ROUND((wge.BDGT_WGE_DTSR / sls.BDGT_SLS_DTSR)*100,2),0) END as BDGT_WGEPCT_DTSBU from 
(select lc.rgn_no,sum(bdgt.bdgt_wage_amt) as BDGT_WGE_DTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no and lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,sum(bdgt.bdgt_sls) as BDGT_SLS_DTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'   
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no and lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no) bdgt
where estd_fcst.rgn_no=bdgt.rgn_no order by estd_fcst.rgn_no ]]>
	</CurrentWeekVarWagesPrecentage>
	<CurrentWeekVarWagesPrecentageTotal>
	<![CDATA[select estd_fcst.div_no,ROUND((estd_fcst.ESTD_WGEPCT_TOT_DTSBU - bdgt.BDGT_WGEPCT_TOT_DTSBU),2) as BDGT_VAR_WGEPCT_TOT_DTSBU from 
(select wge.div_no,
CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
ELSE NVL(ROUND(((wge.wtd / sls.wtd)*100),2),0) END as ESTD_WGEPCT_TOT_DTSBU from
(select lc.div_no,NVL(ROUND(wge.ACTL_WGE_TOT_DTSBU,0),0) as WTD from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28)
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) g */ ) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no) wge,
(select lc.div_no,sls.wtd as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no) estd_fcst,
(select wge.div_no,
CASE WHEN NVL(wge.BDGT_WGE_TOT_DTSR,0)=0 AND NVL(sls.BDGT_SLS_TOT_DTSR,0)=0 THEN 0 
WHEN NVL(wge.BDGT_WGE_TOT_DTSR,0)=0 THEN 0 WHEN NVL(sls.BDGT_SLS_TOT_DTSR,0)=0 THEN 100 
ELSE NVL(ROUND((wge.BDGT_WGE_TOT_DTSR / sls.BDGT_SLS_TOT_DTSR)*100,2),0) END as BDGT_WGEPCT_TOT_DTSBU from 
(select lc.div_no,sum(bdgt.bdgt_wage_amt) as BDGT_WGE_TOT_DTSR from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.div_no=bdgt.div_no group by lc.div_no order by lc.div_no) wge,
(select lc.div_no,sum(bdgt.bdgt_sls) as BDGT_SLS_TOT_DTSR from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from wky_bdgt a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'   
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.div_no=bdgt.div_no group by lc.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no) bdgt
where estd_fcst.div_no=bdgt.div_no order by estd_fcst.div_no ]]>
	</CurrentWeekVarWagesPrecentageTotal>
	
	<CurrentWeekForecastVarWagesPrecentage>
	<![CDATA[select estd_fcst.rgn_no,ROUND((estd_fcst.ESTD_FCST_WGEPCT_DTSBU - bdgt.FCST_WGEPCT_DTSBU),2) as FCST_VAR_WGEPCT_DTSBU from 
(select wge.rgn_no,
CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as ESTD_FCST_WGEPCT_DTSBU from  
(select lc.rgn_no,NVL(sum(wge.ACTL_WAGE_DTS),0) as ACTL_WGE_DTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.zone_no,e.rgn_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.zone_no,e.rgn_no order by e.zone_no,e.rgn_no) wge
on wge.rgn_no=lc.rgn_no group by lc.rgn_no) wge,
(select lc.rgn_no,sls.wtd as wtd from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_DTSR)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_DTSR from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) sls
on lc.rgn_no=sls.rgn_no) sls
where wge.rgn_no=sls.rgn_no) estd_fcst,
(select wge.rgn_no,
CASE WHEN NVL(wge.FCST_WGE_DTSR,0)=0 AND NVL(sls.FCST_SLS_DTSR,0)=0 THEN 0 
WHEN NVL(wge.FCST_WGE_DTSR,0)=0 THEN 0 WHEN NVL(sls.FCST_SLS_DTSR,0)=0 THEN 100 
ELSE NVL(ROUND((wge.FCST_WGE_DTSR / sls.FCST_SLS_DTSR)*100,2),0) END as FCST_WGEPCT_DTSBU from 
(select lc.rgn_no,sum(bdgt.frcst_wage_amt) as BDGT_WGE_DTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no and lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) wge,
(select lc.rgn_no,sum(bdgt.frcst_sls) as BDGT_SLS_DTSR from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.zone_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'   
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.rgn_no=bdgt.rgn_no and lc.rgn_no=bdgt.rgn_no
group by lc.rgn_no order by lc.rgn_no) sls
where wge.rgn_no=sls.rgn_no order by wge.rgn_no) bdgt
where estd_fcst.rgn_no=bdgt.rgn_no order by estd_fcst.rgn_no ]]>
	</CurrentWeekForecastVarWagesPrecentage>
	<CurrentWeekForecastVarWagesPrecentageTotal>
	<![CDATA[select estd_fcst.div_no,ROUND((estd_fcst.ACTL_WGE_PRCNT_TOT_DTSR - bdgt.BDGT_WGE_PCT_TOT_DTSR),2) as FCST_VAR_WGEPCT_TOT_DTSBU from 
(select wge.div_no,
CASE WHEN NVL(wge.wtd,0)=0 AND NVL(sls.wtd,0)=0 THEN 0 
WHEN NVL(wge.wtd,0)=0 THEN 0 WHEN NVL(sls.wtd,0)=0 THEN 100 
ELSE NVL(ROUND((wge.wtd / sls.wtd)*100,2),0) END as ESTD_FCST_WGEPCT_TOT_DTSBU from 
(select lc.div_no,NVL(sum(wge.ACTL_WAGE_DTS),0) as ACTL_WGE_TOT_DTSR from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select e.rgn_no,e.div_no,e.ar_no,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.div_no,e.ar_no order by e.rgn_no,e.div_no,e.ar_no) wge
on wge.div_no=lc.div_no group by lc.div_no) wge,
(select lc.div_no,sls.wtd as ACTL_SLS_TOT_DTSR from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_SLS_TOT_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_SLS_TOT_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_SLS_TOT_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_SLS_TOT_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_SLS_TOT_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_SLS_TOT_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_SLS_TOT_DTSR)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_SLS_DTS) as ACTL_SLS_TOT_DTSR from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_sls) as ACTL_SLS_DTS,sum(e.actl_itm_cnt) as ACTL_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.refcst_sls) as PLN_SLS_DTS,sum(e.refcst_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk,
nvl(a.refcst_sls,0) as refcst_sls,nvl(a.refcst_itm_cnt,0) as refcst_itm_cnt,nvl(a.refcst_cust_cnt,0) as refcst_cust_cnt
from ww_wlp.mgr_dly_refcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.pln_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.pln_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) pri_prty
UNION
select * from (select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.mgr_pln_sls) as PLN_SLS_DTS,sum(e.mgr_pln_itm_cnt) as PLN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk,
nvl(a.mgr_pln_sls,0) as mgr_pln_sls,nvl(a.mgr_pln_itm_cnt,0) as mgr_pln_itm_cnt,nvl(a.mgr_pln_cust_cnt,0) as mgr_pln_cust_cnt
from ww_wlp.mgr_dly_pln a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.mgr_pln_sls_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.mgr_pln_sls_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.mgr_pln_sls_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.gnrt_sls) as GEN_SLS_DTS,sum(e.gnrt_itm) as GEN_ITM_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,b.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk,
nvl(a.gnrt_sls,0) as gnrt_sls,nvl(a.gnrt_itm,0) as gnrt_itm,nvl(a.gnrt_cust,0) as gnrt_cust from ww_wlp.fcst a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20)
and a.fcst_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.fcst_dte>=trunc(sysdate) 
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.mgr_pln_sls_dte from mgr_dly_pln a, loc b, wk c 
where a.mgr_pln_sls_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.mgr_pln_sls_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and (a.loc_no,a.dept_no,a.fcst_dte) NOT IN (select a.loc_no,a.dept_no,a.pln_dte from mgr_dly_refcst a, loc b, wk c 
where a.pln_dte between c.wk_strt and c.wk_end and c.wk_id='Week' and a.pln_dte>=trunc(sysdate)  
and a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division')
and a.fcst_dte=dy.day_dte and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.fcst_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g) sec_prty) pln_sls 
/* where (pln_sls.div_no,pln_sls.rgn_no,pln_sls.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.txn_dte,dy.day_of_wk,
nvl(a.actl_sls,0) as actl_sls,nvl(a.actl_itm_cnt,0) as actl_itm_cnt,nvl(a.actl_cust_cnt,0) as actl_cust_cnt
from ww_wlp.dly_sls a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (0,90,20) 
and a.txn_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.txn_dte=dy.day_dte and c.wk_id=dy.wk_id 
and a.actl_sls is NOT NULL and a.actl_sls!=0) e ) */ ) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) sls
on lc.div_no=sls.div_no) sls
where wge.div_no=sls.div_no) estd_fcst,
(select wge.div_no,
CASE WHEN NVL(wge.FCST_WGE_TOT_DTSR,0)=0 AND NVL(sls.FCST_SLS_TOT_DTSR,0)=0 THEN 0 
WHEN NVL(wge.FCST_WGE_TOT_DTSR,0)=0 THEN 0 WHEN NVL(sls.FCST_SLS_TOT_DTSR,0)=0 THEN 100 
ELSE NVL(ROUND((wge.FCST_WGE_TOT_DTSR / sls.FCST_SLS_TOT_DTSR)*100,2),0) END as FCST_WGEPCT_TOT_DTSBU from
(select lc.div_no,sum(bdgt.frcst_wage_amt) as BDGT_WGE_TOT_DTSR from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'  
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (20,27,28) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.div_no=bdgt.div_no group by lc.div_no order by lc.div_no) wge,
(select lc.div_no,sum(bdgt.frcst_sls) as BDGT_SLS_TOT_DTSR from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division'  order by b.div_no) lc
LEFT OUTER JOIN
(select b.rgn_no,b.ar_no,b.loc_nm,a.*,c.perd_desc,d.dply_seq,d.dept_nm 
from mnth_fcst a, loc b, wk c, dept d 
where a.loc_no=b.loc_no and a.div_no=b.div_no and a.div_no='Division'   
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and a.dept_no NOT IN (0,90,20) 
order by a.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,c.wk_id,d.dply_seq) bdgt
on lc.div_no=bdgt.div_no group by lc.div_no order by lc.div_no) sls
where wge.div_no=sls.div_no order by wge.div_no) bdgt
where estd_fcst.div_no=bdgt.div_no order by estd_fcst.div_no ]]>
	</CurrentWeekForecastVarWagesPrecentageTotal>
	
	
	</TCName>






<TCName name = "SMSColumnValidation" >
	<PlannedSMS>
	<![CDATA[select lc.rgn_no,NVL(sms.mon,0),NVL(sms.tue,0),NVL(sms.wed,0),NVL(sms.thu,0),NVL(sms.fri,0),NVL(sms.sat,0),NVL(sms.sun,0) from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z ) sms
on sms.rgn_no=lc.rgn_no order by lc.rgn_no]]>
	</PlannedSMS>
	<PlannedSMSTotal>
	<![CDATA[select lc.div_no,NVL(sms.mon,0),NVL(sms.tue,0),NVL(sms.wed,0),NVL(sms.thu,0),NVL(sms.fri,0),NVL(sms.sat,0),NVL(sms.sun,0) from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_TOT_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z ) sms
on sms.div_no=lc.div_no order by sms.div_no ]]>
	</PlannedSMSTotal>	
	
	<PlannedSMSWkToDt>
	<![CDATA[select lc.rgn_no,NVL(sms.wtd,0) as PLN_SMS_WTD_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z ) sms
on sms.rgn_no=lc.rgn_no order by lc.rgn_no]]>
	</PlannedSMSWkToDt>
	
	<PlannedSMSWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(sms.wtd,0) as PLN_SMS_WTDTOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_TOT_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z ) sms
on sms.div_no=lc.div_no order by sms.div_no ]]>
	</PlannedSMSWkToDtTotal>
	
	
	
	
	
	<PastWeekActualSMS>
	<![CDATA[select lc.rgn_no,
NVL(xy.Monday,0) as mon,NVL(xy.Tuesday,0) as tue,NVL(xy.Wednesday,0) as wed,NVL(xy.Thursday,0) as thu,
NVL(xy.Friday,0) as fri,NVL(xy.Saturday,0) as sat,NVL(xy.Sunday,0) as sun from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select rgn_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSBU )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSBU )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSBU )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSBU )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSBU )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSBU )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSBU )),0) Sunday 
from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
/* UNION 
select * from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) */) xyz 
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no]]>
	</PastWeekActualSMS>
	
	<PastWeekActualSMSTotal>
	<![CDATA[select lc.div_no,
NVL(xy.Monday,0) as mon,NVL(xy.Tuesday,0) as tue,NVL(xy.Wednesday,0) as wed,NVL(xy.Thursday,0) as thu,
NVL(xy.Friday,0) as fri,NVL(xy.Saturday,0) as sat,NVL(xy.Sunday,0) as sun from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select div_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSBU )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSBU )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSBU )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSBU )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSBU )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSBU )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSBU )),0) Sunday 
from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,
A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
/* UNION 
select * from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,
A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) */) xyz 
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no]]>
	</PastWeekActualSMSTotal>	
	
	<PastWeekActualSMSWkToDt>
	<![CDATA[select lc.rgn_no,NVL(xy.ACTL_SMS_DTSBU,0) as ACTL_SMS_WTD_DTSBU from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select rgn_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU 
from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
/* UNION
select * from 
(select h.rgn_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no order by h.rgn_no) */) xyz
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no]]>
	</PastWeekActualSMSWkToDt>
	
	<PastWeekActualSMSWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(xy.ACTL_SMS_DTSBU,0) as ACTL_SMS_WTDTOT_DTSBU from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select div_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
/* UNION
select * from 
(select h.div_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no order by h.div_no) */) xyz
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no]]>
	</PastWeekActualSMSWkToDtTotal>
	
	
	
	
	
	<PastWeekVarSMSWkToDt>
	<![CDATA[select pln.rgn_no,(actl.wtd - pln.wtd) as VAR_SMS_WTD_DTSBU from 
(select lc.rgn_no,NVL(sms.wtd,0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z ) sms
on sms.rgn_no=lc.rgn_no order by lc.rgn_no) pln,
(select lc.rgn_no,NVL(xy.ACTL_SMS_DTSBU,0) as WTD from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select rgn_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU 
from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
/* UNION
select * from 
(select h.rgn_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no order by h.rgn_no) */) xyz
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]>
	</PastWeekVarSMSWkToDt>
	
	<PastWeekVarSMSWkToDtTotal>
	<![CDATA[select pln.div_no,(actl.wtd - pln.wtd) as VAR_SMS_WTDTOT_DTSBU from 
(select lc.div_no,NVL(sms.wtd,0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_TOT_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z ) sms
on sms.div_no=lc.div_no order by sms.div_no) pln,
(select lc.div_no,NVL(xy.ACTL_SMS_DTSBU,0) as wtd from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select div_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
/* UNION
select * from 
(select h.div_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no order by h.div_no) */) xyz
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no) actl
where pln.div_no=actl.div_no order by pln.div_no]]>
	</PastWeekVarSMSWkToDtTotal>
	
	
	
	
	
	
	<CurrentWeekActualSMS>
	<![CDATA[select lc.rgn_no,
NVL(xy.Monday,0) as mon,NVL(xy.Tuesday,0) as tue,NVL(xy.Wednesday,0) as wed,NVL(xy.Thursday,0) as thu,
NVL(xy.Friday,0) as fri,NVL(xy.Saturday,0) as sat,NVL(xy.Sunday,0) as sun from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select rgn_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSBU )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSBU )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSBU )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSBU )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSBU )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSBU )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSBU )),0) Sunday 
from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='FinYr' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='FinYr' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
/* UNION 
select * from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) */) xyz 
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no]]>
	</CurrentWeekActualSMS>
	
	<CurrentWeekActualSMSTotal>
	<![CDATA[select lc.div_no,
NVL(xy.Monday,0) as mon,NVL(xy.Tuesday,0) as tue,NVL(xy.Wednesday,0) as wed,NVL(xy.Thursday,0) as thu,
NVL(xy.Friday,0) as fri,NVL(xy.Saturday,0) as sat,NVL(xy.Sunday,0) as sun from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select div_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSBU )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSBU )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSBU )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSBU )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSBU )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSBU )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSBU )),0) Sunday 
from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='FinYr' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='FinYr' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,
A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
/* UNION 
select * from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,
A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) */) xyz 
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no]]>
	</CurrentWeekActualSMSTotal>
	
	<CurrentWeekActualSMSWkToDt>
	<![CDATA[select lc.rgn_no,NVL(xy.ACTL_SMS_DTSBU,0) as ACTL_SMS_WTD_DTSBU from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select rgn_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU 
from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='FinYr' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='FinYr' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
UNION
select * from 
(select h.rgn_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end and dy.day_dte>=trunc(sysdate) 
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no order by h.rgn_no)) xyz
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no]]>
	</CurrentWeekActualSMSWkToDt>
	
	<CurrentWeekActualSMSWkToDtTotal>
	<![CDATA[select lc.div_no,NVL(xy.ACTL_SMS_DTSBU,0) as ACTL_SMS_WTDTOT_DTSBU from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select div_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='FinYr' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='FinYr' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
UNION
select * from 
(select h.div_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end and dy.day_dte>=trunc(sysdate) 
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no order by h.div_no)) xyz
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no]]>
	</CurrentWeekActualSMSWkToDtTotal>
	
		
	<CurrentWeekVarSMSWkToDt>
	<![CDATA[select pln.rgn_no,(actl.ACTL_SMS_WTD_DTSBU - pln.PLN_SMS_WTD_DTSBU) as VAR_SMS_WTD_DTSBU from 
(select lc.rgn_no,NVL(sms.wtd,0) as PLN_SMS_WTD_DTSBU from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z ) sms
on sms.rgn_no=lc.rgn_no order by lc.rgn_no) pln,
(select lc.rgn_no,NVL(xy.ACTL_SMS_DTSBU,0) as ACTL_SMS_WTD_DTSBU from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select rgn_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU 
from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='FinYr' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='FinYr' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
UNION
select * from 
(select h.rgn_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end and dy.day_dte>=trunc(sysdate) 
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no order by h.rgn_no)) xyz
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no) actl
where pln.rgn_no=actl.zone_no order by pln.rgn_no]]>
	</CurrentWeekVarSMSWkToDt>
	
	<CurrentWeekVarSMSWkToDtTotal>
	<![CDATA[select pln.rgn_no,(actl.ACTL_SMS_WTDTOT_DTSBU - pln.PLN_SMS_WTDTOT_DTSBU) as VAR_SMS_WTDTOT_DTSBU from 
(select lc.div_no,NVL(sms.wtd,0) as PLN_SMS_WTDTOT_DTSBU from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_TOT_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z ) sms
on sms.div_no=lc.div_no order by sms.div_no) pln,
(select lc.div_no,NVL(xy.ACTL_SMS_DTSBU,0) as ACTL_SMS_WTDTOT_DTSBU from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select div_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='FinYr' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='FinYr' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
UNION
select * from 
(select h.div_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end and dy.day_dte>=trunc(sysdate) 
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no order by h.div_no)) xyz
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]>
	</CurrentWeekVarSMSWkToDtTotal>	
		
	
	

</TCName>






<TCName name = "ORColumnValidation" >
	
	<PlannedOR>
	<![CDATA[select sms_hrs.rgn_no,
case when sms_hrs.mon=0 and pln_hrs.mon=0 then 0 when sms_hrs.mon=0 then 0 when pln_hrs.mon=0 then 0
else NVL(ROUND((sms_hrs.mon / pln_hrs.mon)*100,1),0) end as Mon,
case when sms_hrs.tue=0 and pln_hrs.tue=0 then 0 when sms_hrs.tue=0 then 0 when pln_hrs.tue=0 then 0
else NVL(ROUND((sms_hrs.tue / pln_hrs.tue)*100,1),0) end as tue,
case when sms_hrs.wed=0 and pln_hrs.wed=0 then 0 when sms_hrs.wed=0 then 0 when pln_hrs.wed=0 then 0
else NVL(ROUND((sms_hrs.wed / pln_hrs.wed)*100,1),0) end as wed,
case when sms_hrs.thu=0 and pln_hrs.thu=0 then 0 when sms_hrs.thu=0 then 0 when pln_hrs.thu=0 then 0
else NVL(ROUND((sms_hrs.thu / pln_hrs.thu)*100,1),0) end as thu,
case when sms_hrs.fri=0 and pln_hrs.fri=0 then 0 when sms_hrs.fri=0 then 0 when pln_hrs.fri=0 then 0
else NVL(ROUND((sms_hrs.fri / pln_hrs.fri)*100,1),0) end as fri,
case when sms_hrs.sat=0 and pln_hrs.sat=0 then 0 when sms_hrs.sat=0 then 0 when pln_hrs.sat=0 then 0
else NVL(ROUND((sms_hrs.sat / pln_hrs.sat)*100,1),0) end as sat,
case when sms_hrs.sun=0 and pln_hrs.sun=0 then 0 when sms_hrs.sun=0 then 0 when pln_hrs.sun=0 then 0
else NVL(ROUND((sms_hrs.sun / pln_hrs.sun)*100,1),0) end as sun from  
(select lc.rgn_no,sms.mon,sms.tue,sms.wed,sms.thu,sms.fri,sms.sat,sms.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z ) sms
on sms.rgn_no=lc.rgn_no order by lc.rgn_no) sms_hrs,
(select lc.rgn_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_DTSBU)) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_HRS_DTS),2) as PLN_HRS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) pln_hrs 
where sms_hrs.rgn_no=pln_hrs.rgn_no order by sms_hrs.rgn_no ]]>
	</PlannedOR>
	<PlannedORTotal>
	<![CDATA[select sms_hrs.div_no,
	case when sms_hrs.mon=0 and pln_hrs.mon=0 then 0 when sms_hrs.mon=0 then 0 when pln_hrs.mon=0 then 0
else NVL(ROUND((sms_hrs.mon / pln_hrs.mon)*100,1),0) end as Mon,
case when sms_hrs.tue=0 and pln_hrs.tue=0 then 0 when sms_hrs.tue=0 then 0 when pln_hrs.tue=0 then 0
else NVL(ROUND((sms_hrs.tue / pln_hrs.tue)*100,1),0) end as tue,
case when sms_hrs.wed=0 and pln_hrs.wed=0 then 0 when sms_hrs.wed=0 then 0 when pln_hrs.wed=0 then 0
else NVL(ROUND((sms_hrs.wed / pln_hrs.wed)*100,1),0) end as wed,
case when sms_hrs.thu=0 and pln_hrs.thu=0 then 0 when sms_hrs.thu=0 then 0 when pln_hrs.thu=0 then 0
else NVL(ROUND((sms_hrs.thu / pln_hrs.thu)*100,1),0) end as thu,
case when sms_hrs.fri=0 and pln_hrs.fri=0 then 0 when sms_hrs.fri=0 then 0 when pln_hrs.fri=0 then 0
else NVL(ROUND((sms_hrs.fri / pln_hrs.fri)*100,1),0) end as fri,
case when sms_hrs.sat=0 and pln_hrs.sat=0 then 0 when sms_hrs.sat=0 then 0 when pln_hrs.sat=0 then 0
else NVL(ROUND((sms_hrs.sat / pln_hrs.sat)*100,1),0) end as sat,
case when sms_hrs.sun=0 and pln_hrs.sun=0 then 0 when sms_hrs.sun=0 then 0 when pln_hrs.sun=0 then 0
else NVL(ROUND((sms_hrs.sun / pln_hrs.sun)*100,1),0) end as sun from
(select lc.div_no,sms.mon,sms.tue,sms.wed,sms.thu,sms.fri,sms.sat,sms.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_TOT_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z ) sms
on sms.div_no=lc.div_no) sms_hrs,
(select lc.div_no,wge.mon,wge.tue,wge.wed,wge.thu,wge.fri,wge.sat,wge.sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
sum(DECODE(b.dte_of_wk,00,b.PLN_HRS_TOT_DTSBU)) Mon,
sum(DECODE(b.dte_of_wk,01,b.PLN_HRS_TOT_DTSBU)) Tue,
sum(DECODE(b.dte_of_wk,02,b.PLN_HRS_TOT_DTSBU)) Wed,
sum(DECODE(b.dte_of_wk,03,b.PLN_HRS_TOT_DTSBU)) Thu,
sum(DECODE(b.dte_of_wk,04,b.PLN_HRS_TOT_DTSBU)) Fri,
sum(DECODE(b.dte_of_wk,05,b.PLN_HRS_TOT_DTSBU)) Sat,
sum(DECODE(b.dte_of_wk,06,b.PLN_HRS_TOT_DTSBU)) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_HRS_DTS),2) as PLN_HRS_TOT_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no) pln_hrs 
where sms_hrs.div_no=pln_hrs.div_no order by sms_hrs.div_no]]>
	</PlannedORTotal>	
	
	
	<PlannedORWkToDt>
	<![CDATA[select sms_hrs.rgn_no,
	case when sms_hrs.wtd=0 and pln_hrs.wtd=0 then 0 when sms_hrs.wtd=0 then 0 when pln_hrs.wtd=0 then 0 
	else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end as PLN_OR_WTD_DTSBU from 
(select lc.rgn_no,sms.wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'
order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z ) sms
on sms.rgn_no=lc.rgn_no) sms_hrs,
(select lc.rgn_no,ROUND(sum(wge.PLN_HOURS_DTS),2) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,e.zone_no,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no,e.zone_no,e.dply_seq,e.dept_nm order by e.rgn_no,e.zone_no,e.dply_seq) wge
on wge.rgn_no=lc.rgn_no group by lc.rgn_no order by lc.rgn_no) pln_hrs 
where sms_hrs.rgn_no=pln_hrs.rgn_no order by pln_hrs.rgn_no]]>
	</PlannedORWkToDt>
	<PlannedORWkToDtTotal>
	<![CDATA[select sms_hrs.div_no,
	case when sms_hrs.wtd=0 and pln_hrs.wtd=0 then 0 when sms_hrs.wtd=0 then 0 when pln_hrs.wtd=0 then 0 
	else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end as PLN_OR_WTDTOT_DTSBU from  
(select lc.div_no,sms.wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_TOT_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z ) sms
on sms.div_no=lc.div_no) sms_hrs,
(select lc.div_no,ROUND(sum(wge.PLN_HOURS_DTS),2) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm order by e.div_no,e.rgn_no,e.dply_seq) wge
on wge.div_no=lc.div_no group by lc.div_no order by lc.div_no) pln_hrs 
where sms_hrs.div_no=pln_hrs.div_no order by sms_hrs.div_no]]>
	</PlannedORWkToDtTotal>	
	
	
	<PastWeekActualOR>
	<![CDATA[select sms.rgn_no,
case when NVL(sms.mon,0)=0 and NVL(krn.mon,0)=0 then 0 when NVL(sms.mon,0)=0 then 0 when NVL(krn.mon,0)=0 then 0
else ROUND((sms.mon / krn.mon)*100,1) end as MON,
case when NVL(sms.tue,0)=0 and NVL(krn.tue,0)=0 then 0 when NVL(sms.tue,0)=0 then 0 when NVL(krn.tue,0)=0 then 0
else ROUND((sms.tue / krn.tue)*100,1) end as TUE,
case when NVL(sms.wed,0)=0 and NVL(krn.wed,0)=0 then 0 when NVL(sms.wed,0)=0 then 0 when NVL(krn.wed,0)=0 then 0
else ROUND((sms.wed / krn.wed)*100,1) end as WED,
case when NVL(sms.thu,0)=0 and NVL(krn.thu,0)=0 then 0 when NVL(sms.thu,0)=0 then 0 when NVL(krn.thu,0)=0 then 0
else ROUND((sms.thu / krn.thu)*100,1) end as THU,
case when NVL(sms.fri,0)=0 and NVL(krn.fri,0)=0 then 0 when NVL(sms.fri,0)=0 then 0 when NVL(krn.fri,0)=0 then 0
else ROUND((sms.fri / krn.fri)*100,1) end as FRI,
case when NVL(sms.sat,0)=0 and NVL(krn.sat,0)=0 then 0 when NVL(sms.sat,0)=0 then 0 when NVL(krn.sat,0)=0 then 0
else ROUND((sms.sat / krn.sat)*100,1) end as SAT,
case when NVL(sms.sun,0)=0 and NVL(krn.sun,0)=0 then 0 when NVL(sms.sun,0)=0 then 0 when NVL(krn.sun,0)=0 then 0
else ROUND((sms.sun / krn.sun)*100,1) end as SUN from 
(select lc.rgn_no,
NVL(xy.Monday,0) as mon,NVL(xy.Tuesday,0) as tue,NVL(xy.Wednesday,0) as wed,NVL(xy.Thursday,0) as thu,
NVL(xy.Friday,0) as fri,NVL(xy.Saturday,0) as sat,NVL(xy.Sunday,0) as sun from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select rgn_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSBU )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSBU )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSBU )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSBU )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSBU )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSBU )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSBU )),0) Sunday 
from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
/* UNION 
select * from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) */) xyz 
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no) sms,
(select lc.rgn_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSR)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_DTSR from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/* UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) krn
where sms.rgn_no=krn.rgn_no order by sms.rgn_no ]]>
	</PastWeekActualOR>
	<PastWeekActualORTotal>
	<![CDATA[select sms.div_no,
case when NVL(sms.mon,0)=0 and NVL(krn.mon,0)=0 then 0 when NVL(sms.mon,0)=0 then 0 when NVL(krn.mon,0)=0 then 0
else ROUND((sms.mon / krn.mon)*100,1) end as MON,
case when NVL(sms.tue,0)=0 and NVL(krn.tue,0)=0 then 0 when NVL(sms.tue,0)=0 then 0 when NVL(krn.tue,0)=0 then 0
else ROUND((sms.tue / krn.tue)*100,1) end as TUE,
case when NVL(sms.wed,0)=0 and NVL(krn.wed,0)=0 then 0 when NVL(sms.wed,0)=0 then 0 when NVL(krn.wed,0)=0 then 0
else ROUND((sms.wed / krn.wed)*100,1) end as WED,
case when NVL(sms.thu,0)=0 and NVL(krn.thu,0)=0 then 0 when NVL(sms.thu,0)=0 then 0 when NVL(krn.thu,0)=0 then 0
else ROUND((sms.thu / krn.thu)*100,1) end as THU,
case when NVL(sms.fri,0)=0 and NVL(krn.fri,0)=0 then 0 when NVL(sms.fri,0)=0 then 0 when NVL(krn.fri,0)=0 then 0
else ROUND((sms.fri / krn.fri)*100,1) end as FRI,
case when NVL(sms.sat,0)=0 and NVL(krn.sat,0)=0 then 0 when NVL(sms.sat,0)=0 then 0 when NVL(krn.sat,0)=0 then 0
else ROUND((sms.sat / krn.sat)*100,1) end as SAT,
case when NVL(sms.sun,0)=0 and NVL(krn.sun,0)=0 then 0 when NVL(sms.sun,0)=0 then 0 when NVL(krn.sun,0)=0 then 0
else ROUND((sms.sun / krn.sun)*100,1) end as SUN from 
(select lc.div_no,
NVL(xy.Monday,0) as mon,NVL(xy.Tuesday,0) as tue,NVL(xy.Wednesday,0) as wed,NVL(xy.Thursday,0) as thu,
NVL(xy.Friday,0) as fri,NVL(xy.Saturday,0) as sat,NVL(xy.Sunday,0) as sun from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select div_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSBU )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSBU )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSBU )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSBU )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSBU )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSBU )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSBU )),0) Sunday 
from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,
A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
/* UNION 
select * from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,
A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) */) xyz 
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no) sms,
(select lc.div_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and sysdate-1 and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) krn
where sms.div_no=krn.div_no order by sms.div_no]]>
	</PastWeekActualORTotal>


	<PastWeekActualORWkToDt>
	<![CDATA[select sms.rgn_no,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 
when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as WTD from 
(select lc.rgn_no,NVL(xy.ACTL_SMS_DTSBU,0) as wtd from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select rgn_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU 
from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
/* UNION
select * from 
(select h.rgn_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no order by h.rgn_no) */) xyz
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no) sms,
(select lc.rgn_no,NVL(ROUND(wge.ACTL_HRS_DTSBU,2),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) krn
where sms.rgn_no=krn.rgn_no order by sms.rgn_no ]]>
	</PastWeekActualORWkToDt>
	<PastWeekActualORWkToDtTotal>
	<![CDATA[select sms.div_no,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as WTD from 
(select lc.div_no,NVL(xy.ACTL_SMS_DTSBU,0) as wtd from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select div_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
/* UNION
select * from 
(select h.div_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no order by h.div_no) */) xyz
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no) sms,
(select lc.div_no,NVL(ROUND(wge.ACTL_HRS_TOT_DTSBU,2),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) krn
where sms.div_no=krn.div_no order by sms.div_no ]]>
	</PastWeekActualORWkToDtTotal>	
	
	
	<PastWeekVarORWkToDt>
	<![CDATA[select pln.rgn_no,(actl.wtd - pln.wtd) as VAR_OR_WTD_DTSBU from 
(select sms_hrs.rgn_no,
case when sms_hrs.wtd=0 and pln_hrs.wtd=0 then 0 when sms_hrs.wtd=0 then 0 when pln_hrs.wtd=0 then 0 
	else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end as VAR_OR_WTD_DTSBU from  
(select lc.rgn_no,sms.wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'
order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z ) sms
on sms.rgn_no=lc.rgn_no) sms_hrs,
(select lc.rgn_no,ROUND(sum(wge.PLN_HOURS_DTS),2) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,e.zone_no,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no,e.zone_no,e.dply_seq,e.dept_nm order by e.rgn_no,e.zone_no,e.dply_seq) wge
on wge.rgn_no=lc.rgn_no group by lc.rgn_no order by lc.rgn_no) pln_hrs 
where sms_hrs.rgn_no=pln_hrs.rgn_no order by pln_hrs.rgn_no) pln,
(select sms.rgn_no,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as WTD from 
(select lc.rgn_no,NVL(xy.ACTL_SMS_DTSBU,0) as wtd from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select rgn_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU 
from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
/* UNION
select * from 
(select h.rgn_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no order by h.rgn_no) */) xyz
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no) sms,
(select lc.rgn_no,NVL(ROUND(wge.ACTL_HRS_DTSBU,2),0) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select j.rgn_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) g 
UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) i */) j
group by j.rgn_no order by j.rgn_no) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) krn
where sms.rgn_no=krn.rgn_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]>
	</PastWeekVarORWkToDt>
	
	<PastWeekVarORWkToDtTotal>
	<![CDATA[select pln.div_no,(actl.wtd - pln.wtd) as VAR_OR_WTDTOT_DTSBU from 
(select sms_hrs.div_no,
case when sms_hrs.wtd=0 and pln_hrs.wtd=0 then 0 when sms_hrs.wtd=0 then 0 when pln_hrs.wtd=0 then 0 
	else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end as VAR_OR_WTDTOT_DTSBU from   
(select lc.div_no,sms.wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_TOT_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z ) sms
on sms.div_no=lc.div_no) sms_hrs,
(select lc.div_no,ROUND(sum(wge.PLN_HOURS_DTS),2) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm order by e.div_no,e.rgn_no,e.dply_seq) wge
on wge.div_no=lc.div_no group by lc.div_no order by lc.div_no) pln_hrs 
where sms_hrs.div_no=pln_hrs.div_no order by sms_hrs.div_no) pln,
(select sms.div_no,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as WTD from 
(select lc.div_no,NVL(xy.ACTL_SMS_DTSBU,0) as wtd from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select div_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='Year' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='Year' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
/* UNION
select * from 
(select h.div_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='Year' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='Year' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no order by h.div_no) */) xyz
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no) sms,
(select lc.div_no,NVL(ROUND(wge.ACTL_HRS_TOT_DTSBU,2),0) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select j.div_no,sum(j.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(j.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,sum(e.actl_amt) as ACTL_WAGE_DTS,sum(e.actl_hrs) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) g 
UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0)
and (b.div_no,b.rgn_no) NOT IN 
(select distinct b.div_no,b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
 where dly_wage_dte between c.wk_strt and c.wk_end and c.wk_id='Week' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) i */) j
group by j.div_no order by j.div_no) wge
on wge.div_no=lc.div_no order by lc.div_no) krn
where sms.div_no=krn.div_no order by sms.div_no) actl
where pln.div_no=actl.div_no order by pln.div_no]]>
	</PastWeekVarORWkToDtTotal>
	
	
	
	
	<CurrentWeekActualOR>
	<![CDATA[select sms.rgn_no,
case when NVL(sms.mon,0)=0 and NVL(krn.mon,0)=0 then 0 when NVL(sms.mon,0)=0 then 0 when NVL(krn.mon,0)=0 then 0
else ROUND((sms.mon / krn.mon)*100,1) end as MON,
case when NVL(sms.tue,0)=0 and NVL(krn.tue,0)=0 then 0 when NVL(sms.tue,0)=0 then 0 when NVL(krn.tue,0)=0 then 0
else ROUND((sms.tue / krn.tue)*100,1) end as TUE,
case when NVL(sms.wed,0)=0 and NVL(krn.wed,0)=0 then 0 when NVL(sms.wed,0)=0 then 0 when NVL(krn.wed,0)=0 then 0
else ROUND((sms.wed / krn.wed)*100,1) end as WED,
case when NVL(sms.thu,0)=0 and NVL(krn.thu,0)=0 then 0 when NVL(sms.thu,0)=0 then 0 when NVL(krn.thu,0)=0 then 0
else ROUND((sms.thu / krn.thu)*100,1) end as THU,
case when NVL(sms.fri,0)=0 and NVL(krn.fri,0)=0 then 0 when NVL(sms.fri,0)=0 then 0 when NVL(krn.fri,0)=0 then 0
else ROUND((sms.fri / krn.fri)*100,1) end as FRI,
case when NVL(sms.sat,0)=0 and NVL(krn.sat,0)=0 then 0 when NVL(sms.sat,0)=0 then 0 when NVL(krn.sat,0)=0 then 0
else ROUND((sms.sat / krn.sat)*100,1) end as SAT,
case when NVL(sms.sun,0)=0 and NVL(krn.sun,0)=0 then 0 when NVL(sms.sun,0)=0 then 0 when NVL(krn.sun,0)=0 then 0
else ROUND((sms.sun / krn.sun)*100,1) end as SUN from 
(select lc.rgn_no,
NVL(xy.Monday,0) as mon,NVL(xy.Tuesday,0) as tue,NVL(xy.Wednesday,0) as wed,NVL(xy.Thursday,0) as thu,
NVL(xy.Friday,0) as fri,NVL(xy.Saturday,0) as sat,NVL(xy.Sunday,0) as sun from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select rgn_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSBU )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSBU )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSBU )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSBU )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSBU )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSBU )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSBU )),0) Sunday 
from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='FinYr' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='FinYr' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
/* UNION 
select * from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) */) xyz 
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no) sms,
(select lc.rgn_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.rgn_no from loc b where b.div_no='Division'  order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_DTSR)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_DTSR)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_DTSR)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_DTSR)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_DTSR)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_DTSR)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_DTSR)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_DTSR from 
(select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) f
/* UNION
select * from 
(select e.rgn_no,e.zone_no,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and sysdate-1 and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.rgn_no,e.zone_no,e.day_of_wk order by e.rgn_no,e.zone_no,e.day_of_wk) g 
where (g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division'  and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z) wge
on wge.rgn_no=lc.rgn_no order by lc.rgn_no) krn
where sms.rgn_no=krn.rgn_no order by sms.rgn_no ]]>
</CurrentWeekActualOR>


<CurrentWeekActualORTotal>
	<![CDATA[select sms.div_no,
case when NVL(sms.mon,0)=0 and NVL(krn.mon,0)=0 then 0 when NVL(sms.mon,0)=0 then 0 when NVL(krn.mon,0)=0 then 0
else ROUND((sms.mon / krn.mon)*100,1) end as MON,
case when NVL(sms.tue,0)=0 and NVL(krn.tue,0)=0 then 0 when NVL(sms.tue,0)=0 then 0 when NVL(krn.tue,0)=0 then 0
else ROUND((sms.tue / krn.tue)*100,1) end as TUE,
case when NVL(sms.wed,0)=0 and NVL(krn.wed,0)=0 then 0 when NVL(sms.wed,0)=0 then 0 when NVL(krn.wed,0)=0 then 0
else ROUND((sms.wed / krn.wed)*100,1) end as WED,
case when NVL(sms.thu,0)=0 and NVL(krn.thu,0)=0 then 0 when NVL(sms.thu,0)=0 then 0 when NVL(krn.thu,0)=0 then 0
else ROUND((sms.thu / krn.thu)*100,1) end as THU,
case when NVL(sms.fri,0)=0 and NVL(krn.fri,0)=0 then 0 when NVL(sms.fri,0)=0 then 0 when NVL(krn.fri,0)=0 then 0
else ROUND((sms.fri / krn.fri)*100,1) end as FRI,
case when NVL(sms.sat,0)=0 and NVL(krn.sat,0)=0 then 0 when NVL(sms.sat,0)=0 then 0 when NVL(krn.sat,0)=0 then 0
else ROUND((sms.sat / krn.sat)*100,1) end as SAT,
case when NVL(sms.sun,0)=0 and NVL(krn.sun,0)=0 then 0 when NVL(sms.sun,0)=0 then 0 when NVL(krn.sun,0)=0 then 0
else ROUND((sms.sun / krn.sun)*100,1) end as SUN from 
(select lc.div_no,
NVL(xy.Monday,0) as mon,NVL(xy.Tuesday,0) as tue,NVL(xy.Wednesday,0) as wed,NVL(xy.Thursday,0) as thu,
NVL(xy.Friday,0) as fri,NVL(xy.Saturday,0) as sat,NVL(xy.Sunday,0) as sun from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.monday) as Monday,sum(xyz.tuesday) as Tuesday,sum(xyz.wednesday) as Wednesday,sum(xyz.thursday) as Thursday,
sum(xyz.friday) as Friday,sum(xyz.saturday) as Saturday,sum(xyz.sunday) as Sunday from 
(select * from 
(select div_no,
NVL(Sum(decode(day_of_wk, 0 , ACTL_SMS_DTSBU )),0) Monday,
NVL(sum(decode(day_of_wk, 1 , ACTL_SMS_DTSBU )),0) Tuesday,
NVL(sum(decode(day_of_wk, 2 , ACTL_SMS_DTSBU )),0) Wednesday,
NVL(sum(decode(day_of_wk, 3 , ACTL_SMS_DTSBU )),0) Thursday,
NVL(sum(decode(day_of_wk, 4 , ACTL_SMS_DTSBU )),0) Friday,
NVL(sum(decode(day_of_wk, 5 , ACTL_SMS_DTSBU )),0) Saturday,
NVL(sum(decode(day_of_wk, 6 , ACTL_SMS_DTSBU )),0) Sunday 
from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='FinYr' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='FinYr' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,
A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X ) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
/* UNION 
select * from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and sysdate-1
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,
A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' ) 
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) */) xyz 
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no) sms,
(select lc.div_no,NVL(wge.mon,0) as Mon,NVL(wge.tue,0) as Tue,NVL(wge.wed,0) as Wed,NVL(wge.thu,0) as Thu,
NVL(wge.fri,0) as Fri,NVL(wge.sat,0) as Sat,NVL(wge.sun,0) as Sun from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.mon,z.tue,z.wed,z.thu,z.fri,z.sat,z.sun,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.ACTL_HRS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.ACTL_HRS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.ACTL_HRS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.ACTL_HRS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.ACTL_HRS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.ACTL_HRS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.ACTL_HRS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,sum(h.ACTL_HRS_DTS) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.actl_amt) as ACTL_WGE_DTS,sum(e.actl_hrs) as ACTL_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk,sum(e.ta_pln_wage_amt) as PLN_WGE_DTS,sum(e.ta_pln_hrs) as PLN_HRS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs
from ww_wlp.krn_schd a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and sysdate-1 and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e
group by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk order by e.div_no,e.rgn_no,e.dply_seq,e.day_of_wk) g 
where (g.div_no,g.rgn_no,g.day_of_wk) NOT IN 
(select distinct e.div_no,e.rgn_no,e.day_of_wk from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk,
nvl(a.actl_amt,0) as actl_amt,nvl(a.actl_hrs,0) as actl_hrs
from ww_wlp.actl_dly_wage_krn a, loc b, wk c , dept d, day dy
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
and a.dly_wage_dte=dy.day_dte and c.wk_id=dy.wk_id
and a.actl_hrs is NOT NULL and a.actl_hrs!=0
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.dly_wage_dte,dy.day_of_wk) e) */) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z) wge
on wge.div_no=lc.div_no order by lc.div_no) krn
where sms.div_no=krn.div_no order by sms.div_no ]]>
	</CurrentWeekActualORTotal>

	<CurrentWeekActualORWkToDt>
	<![CDATA[select sms.rgn_no,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as ACTL_OR_WTD_DTSBU from 
(select lc.rgn_no,NVL(xy.ACTL_SMS_DTSBU,0) as wtd from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select rgn_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU 
from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='FinYr' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='FinYr' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
UNION
select * from 
(select h.rgn_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end and dy.day_dte>=trunc(sysdate) 
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no order by h.rgn_no)) xyz
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no) sms,
(select lc.rgn_no,NVL(wge.ACTL_HRS_DTSBU,0) as WTD from 
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g */ ) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no) krn
where sms.rgn_no=krn.rgn_no order by sms.rgn_no ]]>
</CurrentWeekActualORWkToDt>



<CurrentWeekActualORWkToDtTotal>
	<![CDATA[select sms.div_no,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as ACTL_OR_WTDTOT_DTSBU from 
(select lc.div_no,NVL(xy.ACTL_SMS_DTSBU,0) as wtd from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select div_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='FinYr' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='FinYr' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
UNION
select * from 
(select h.div_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end and dy.day_dte>=trunc(sysdate) 
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no order by h.div_no)) xyz
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no) sms,
(select lc.div_no,NVL(wge.ACTL_HRS_TOT_DTSBU,0) as WTD from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) g  */) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no) krn
where sms.div_no=krn.div_no order by sms.div_no ]]>
	</CurrentWeekActualORWkToDtTotal>
	
	
	<CurrentWeekVarORWkToDt>
	<![CDATA[select pln.rgn_no,(actl.wtd - pln.wtd) as VAR_OR_WTD_DTSBU from 
(select sms_hrs.rgn_no,
case when sms_hrs.wtd=0 and pln_hrs.wtd=0 then 0 when sms_hrs.wtd=0 then 0 when pln_hrs.wtd=0 then 0 
	else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end as VAR_OR_WTD_DTSBU from  
(select lc.rgn_no,sms.wtd from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division'
order by b.rgn_no) lc
LEFT OUTER JOIN
(select z.rgn_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.rgn_no,'Store Total' as STR_TOT,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_DTSBU)),0) Sun from 
(select h.rgn_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk 
order by e.dply_seq,e.day_of_wk) h group by h.rgn_no,h.day_of_wk order by h.rgn_no,h.day_of_wk) b
group by b.rgn_no order by b.rgn_no) x ) z ) sms
on sms.rgn_no=lc.rgn_no) sms_hrs,
(select lc.rgn_no,ROUND(sum(wge.PLN_HOURS_DTS),2) as WTD from 
(select distinct b.rgn_no from ww_wlp.loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select e.rgn_no,e.zone_no,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no,e.zone_no,e.dply_seq,e.dept_nm order by e.rgn_no,e.zone_no,e.dply_seq) wge
on wge.rgn_no=lc.rgn_no group by lc.rgn_no order by lc.rgn_no) pln_hrs 
where sms_hrs.rgn_no=pln_hrs.rgn_no order by pln_hrs.rgn_no) pln,
(select sms.rgn_no,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as WTD from 
(select lc.rgn_no,NVL(xy.ACTL_SMS_DTSBU,0) as wtd from 
(select distinct rgn_no from loc where div_no='Division' order by rgn_no) lc
LEFT OUTER JOIN
(select xyz.rgn_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select rgn_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU 
from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='FinYr' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='FinYr' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by rgn_no order by rgn_no) xy
UNION
select * from 
(select h.rgn_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end and dy.day_dte>=trunc(sysdate) 
and (b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.rgn_no,e.dply_seq,e.day_of_wk) h 
group by h.rgn_no order by h.rgn_no)) xyz
group by xyz.rgn_no order by xyz.rgn_no) xy
on lc.rgn_no=xy.rgn_no order by lc.rgn_no) sms,
(select lc.rgn_no,NVL(wge.ACTL_HRS_DTSBU,0) as WTD from 
(select distinct rgn_no,'Store Total' as STR_TOT from loc b where b.div_no='Division' order by b.rgn_no) lc
LEFT OUTER JOIN
(select actl_pln.rgn_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_DTSBU from 
(select * from 
(select h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.rgn_no,e.dply_seq order by e.rgn_no,e.dply_seq) h
group by h.rgn_no order by h.rgn_no) f
/* UNION
select * from 
(select e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.rgn_no order by e.rgn_no) g  */) actl_pln
group by actl_pln.rgn_no order by actl_pln.rgn_no) wge
on wge.rgn_no=lc.rgn_no) krn
where sms.rgn_no=krn.rgn_no) actl
where pln.rgn_no=actl.rgn_no order by pln.rgn_no]]>
	</CurrentWeekVarORWkToDt>
	
	<CurrentWeekVarORWkToDtTotal>
	<![CDATA[select pln.div_no,(actl.wtd - pln.wtd) as VAR_OR_WTDTOT_DTSBU from 
(select sms_hrs.div_no,
case when sms_hrs.wtd=0 and pln_hrs.wtd=0 then 0 when sms_hrs.wtd=0 then 0 when pln_hrs.wtd=0 then 0 
	else NVL(ROUND((sms_hrs.wtd / pln_hrs.wtd)*100,1),0) end as VAR_OR_WTDTOT_DTSBU from
(select lc.div_no,sms.wtd from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select z.div_no,z.wtd from 
(select x.*,(x.Mon + x.Tue + x.Wed + x.Thu + x.Fri + x.Sat + x.Sun) as WTD from 
(select b.div_no,
NVL(sum(DECODE(b.dte_of_wk,00,b.PLN_SMS_TOT_DTSBU)),0) Mon,
NVL(sum(DECODE(b.dte_of_wk,01,b.PLN_SMS_TOT_DTSBU)),0) Tue,
NVL(sum(DECODE(b.dte_of_wk,02,b.PLN_SMS_TOT_DTSBU)),0) Wed,
NVL(sum(DECODE(b.dte_of_wk,03,b.PLN_SMS_TOT_DTSBU)),0) Thu,
NVL(sum(DECODE(b.dte_of_wk,04,b.PLN_SMS_TOT_DTSBU)),0) Fri,
NVL(sum(DECODE(b.dte_of_wk,05,b.PLN_SMS_TOT_DTSBU)),0) Sat,
NVL(sum(DECODE(b.dte_of_wk,06,b.PLN_SMS_TOT_DTSBU)),0) Sun from 
(select h.div_no,SUBSTR(h.day_of_wk,0,2) as dte_of_wk,ROUND(sum(h.PLN_SMS_DTS),2) as PLN_SMS_TOT_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and dy.day_dte between c.wk_strt and c.wk_end
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.ar_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no,h.day_of_wk order by h.div_no,h.day_of_wk) b
group by b.div_no order by b.div_no) x ) z ) sms
on sms.div_no=lc.div_no) sms_hrs,
(select lc.div_no,ROUND(sum(wge.PLN_HOURS_DTS),2) as WTD from 
(select distinct b.div_no from ww_wlp.loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select e.div_no,e.rgn_no,e.dply_seq,e.dept_nm,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTS,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.wk_id='Week'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no,e.dply_seq,e.dept_nm order by e.div_no,e.rgn_no,e.dply_seq) wge
on wge.div_no=lc.div_no group by lc.div_no order by lc.div_no) pln_hrs 
where sms_hrs.div_no=pln_hrs.div_no order by sms_hrs.div_no) pln,
(select sms.div_no,
case when NVL(sms.wtd,0)=0 and NVL(krn.wtd,0)=0 then 0 
when NVL(sms.wtd,0)=0 then 0 when NVL(krn.wtd,0)=0 then 0
else ROUND((sms.wtd / krn.wtd)*100,1) end as ACTL_OR_WTDTOT_DTSBU from 
(select lc.div_no,NVL(xy.ACTL_SMS_DTSBU,0) as wtd from 
(select distinct div_no from loc where div_no='Division' order by div_no) lc
LEFT OUTER JOIN
(select xyz.div_no,sum(xyz.ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select * from 
(select div_no,Sum(ACTL_SMS_DTSBU) as ACTL_SMS_DTSBU from 
(select distinct src.*,
(CASE
When task_nm='Major Fill' Then ((((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000)) * src.fix_hrs_pct)/100) + src.fix_hrs)
when task_nm<>'Major Fill' and dept_no in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
when task_nm<>'Major Fill' and dept_no not in (5,10,15) Then ((((src.var_per_mtrc_type_cd * NVL(src.itm_cnt,0))/1000))+src.fix_hrs)
END) as ACTL_SMS_DTSBU
from
(select LL.task_no,LL.task_nm,ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,LL.dept_no,LL.dept_nm,LL.wk_id,LL.day_of_wk,LL.FIX_HRS,LL.VAR_PER_MTRC_TYPE_CD,LL.VOL_HRS,LL.FIX_HRS_PCT , LL.txn_dte,
(case when LL.task_nm = 'Major Fill' then (select sum(actl_itm_cnt) from pln_actl_vw where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte between 
(select wk_strt from wk where fin_yr='FinYr' and fin_wk_no='FinWk') and (select wk_end from wk where fin_yr='FinYr' and fin_wk_no='FinWk') ) 
When LL.task_nm <> 'Major Fill' and LL.dept_no in (5,10,15) then (select sum(actl_itm_cnt) from dly_sls where loc_no=LL.loc_no and dept_no in (5,10,15) and txn_dte = LL.txn_dte) 
When LL.task_nm <> 'Major Fill' and LL.dept_no not in (5,10,15) then (select actl_itm_cnt from dly_sls where loc_no=LL.loc_no and dept_no=LL.dept_no and txn_dte = LL.txn_dte) 
end ) as itm_cnt
from 
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) LL
group by LL.task_nm, LL.task_no, ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no, LL.dept_no,LL.dept_nm, LL.wk_id, 
LL.day_of_wk, LL.FIX_HRS, LL.VAR_PER_MTRC_TYPE_CD, LL.VOL_HRS, LL.FIX_HRS_PCT , LL.txn_dte
order by ll.div_no,ll.rgn_no,ll.zone_no,ll.ar_no,LL.loc_no,ll.day_of_wk) src where dept_no not in (20,27,28)
order by src.loc_no,src.dept_no,src.task_no) sms_src
group by div_no order by div_no) xy
UNION
select * from 
(select h.div_no,sum(h.PLN_SMS_DTS) as PLN_SMS_DTSBU from 
(select e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk,(sum(e.fix_hrs) + sum(e.vol_hrs)) as PLN_SMS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,d.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte,
nvl(a.fix_hrs,0) as fix_hrs,nvl(a.vol_hrs,0) as vol_hrs from ww_wlp.lbr_std a, loc b, wk c , dept d, task tsk, day dy
where a.loc_no=b.loc_no and b.div_no='Division' and b.loc_no IN (select loc_no from loc where div_no='Division' ) and tsk.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and tsk.dept_no=d.dept_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division' and a.task_no=tsk.task_no 
and a.wk_id=dy.wk_id and a.day_of_wk=dy.day_of_wk and c.wk_id=dy.wk_id 
and dy.day_dte between c.wk_strt and c.wk_end and dy.day_dte>=trunc(sysdate) 
and (b.div_no,b.rgn_no,a.wk_id,dy.day_of_wk) NOT IN 
(select distinct src.div_no,src.rgn_no,src.wk_id,src.day_of_wk from
(select Y.task_no,Y.task_nm,y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.dept_no,Y.dept_nm,Y.wk_id,Y.day_of_wk,Y.FIX_HRS,Y.VAR_PER_MTRC_TYPE_CD,Y.VOL_HRS,Y.FIX_HRS_PCT , 
ds.actl_itm_cnt,ds.txn_dte as txn_dte
from
(select distinct A.task_no,tk.task_nm,lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no, dt.dept_nm,A.wk_id,A.day_of_wk,dy.day_dte,A.FIX_HRS,A.VAR_PER_MTRC_TYPE_CD,A.VOL_HRS,sg.FIX_HRS_PCT , w.wk_strt , w.wk_end ,tk.dept_no,
decode(A.day_of_wk,0,w.wk_strt,1,w.wk_strt+1,2,w.wk_strt+2,3,w.wk_strt+3,4,w.wk_strt+4,5,w.wk_strt+5,6,w.WK_END) as X
from
ww_Wlp.lbr_Std A inner join
ww_wlp.wk w
on A.wk_id=w.wk_id inner join
ww_wlp.task tk
on A.task_No=tk.task_No inner join
ww_wlp.loc lc 
on lc.loc_no=a.loc_no and lc.div_no='Division' 
left outer join ww_Wlp.fix_hrs_wky_sprd_gbl sg
on A.loc_No=sg.loc_no
and A.task_No=sg.task_no
and A.day_of_Wk=sg.day_of_wk
inner join dept dt
on dt.dept_no=tk.dept_no
inner join loc_dept ld
on dt.dept_no=ld.dept_no and lc.loc_no=ld.loc_no and dt.div_no ='Division'
inner join day dy
on a.day_of_wk=dy.day_of_wk and dy.wk_id=w.wk_id and dy.day_dte between w.wk_strt and sysdate-1
where w.fin_yr='FinYr' and w.fin_wk_no='FinWk' and A.loc_no IN (select loc_no from loc where div_no='Division' )
order by lc.div_no,lc.rgn_no,lc.zone_no,lc.ar_no,A.loc_no,A.task_no,tk.dept_no,dt.dept_nm,a.day_of_wk) Y
left outer join ww_wlp.dly_sls ds
on Y.loc_No=ds.loc_no and Y.dept_no=ds.dept_no and ds.txn_dte = X 
order by y.div_no,y.rgn_no,y.zone_no,y.ar_no,Y.loc_no,Y.task_no,Y.dept_no, y.X) src where dept_no NOT IN (20,27,28))
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id,a.day_of_wk,dy.day_dte) e
group by e.div_no,e.dply_seq,e.dept_nm,e.day_of_wk order by e.div_no,e.dply_seq,e.day_of_wk) h 
group by h.div_no order by h.div_no)) xyz
group by xyz.div_no order by xyz.div_no) xy
on lc.div_no=xy.div_no order by lc.div_no) sms,
(select lc.div_no,NVL(wge.ACTL_HRS_TOT_DTSBU,0) as WTD from 
(select distinct b.div_no from loc b where b.div_no='Division' order by b.div_no) lc
LEFT OUTER JOIN
(select actl_pln.div_no,sum(actl_pln.ACTL_WAGE_DTSBU) as ACTL_WGE_TOT_DTSBU,sum(actl_pln.ACTL_HOURS_DTSBU) as ACTL_HRS_TOT_DTSBU from 
(select * from 
(select h.div_no,h.rgn_no,sum(h.ACTL_WAGE_DTS) as ACTL_WAGE_DTSBU,sum(h.ACTL_HOURS_DTS) as ACTL_HOURS_DTSBU from 
(select e.div_no,e.rgn_no,e.dply_seq,(sum(e.actl_wage_amt) + sum(e.actl_wage_adj_amt)) as ACTL_WAGE_DTS,
(sum(e.actl_hrs) + sum(e.actl_wage_adj_hrs)) as ACTL_HOURS_DTS from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,a.dept_no,d.dept_nm,d.dply_seq,a.dly_wage_dte,
nvl(a.actl_wage_amt,0) as actl_wage_amt,nvl(a.actl_wage_adj_amt,0) as actl_wage_adj_amt,
nvl(a.actl_hrs,0) as actl_hrs,nvl(a.actl_wage_adj_hrs,0) as actl_wage_adj_hrs
from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,a.dly_wage_dte) e
group by e.div_no,e.rgn_no,e.dply_seq order by e.div_no,e.rgn_no,e.dply_seq) h
group by h.div_no,h.rgn_no order by h.div_no,h.rgn_no) f
/* UNION
select * from 
(select e.div_no,e.rgn_no,(sum(e.ta_pln_wage_amt) + sum(e.wage_adj_amt)) as PLN_WAGE_DTSBU,
(sum(e.ta_pln_hrs) + sum(e.wage_adj_hrs)) as PLN_HOURS_DTSBU from 
(select b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,b.loc_nm,a.dept_no,d.dept_nm,d.dply_seq,c.perd_desc,c.wk_id,
nvl(a.ta_pln_wage_amt,0) as ta_pln_wage_amt,nvl(a.wage_adj_amt,0) as wage_adj_amt,nvl(a.ta_pln_hrs,0) as ta_pln_hrs,nvl(a.wage_adj_hrs,0) as wage_adj_hrs 
from ww_wlp.wky_dept_pln a, loc b, wk c , dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and a.wk_id=c.wk_id and c.fin_yr='FinYr' and c.fin_wk_no='FinWk'
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division'
and (b.rgn_no) NOT IN 
(select distinct b.rgn_no from ww_wlp.dly_wage a, loc b, dept d
where a.loc_no=b.loc_no and a.div_no=b.div_no and b.div_no='Division' and a.dept_no NOT IN (20,27,28) 
and (a.loc_no,a.dept_no,a.dly_wage_dte) in (select loc_no,dept_no,max(a.dly_wage_dte) as ltst_dte from dly_wage a, wk c 
where dly_wage_dte between c.wk_strt and c.wk_end and c.fin_yr='Year' and c.fin_wk_no='FinWk' group by loc_no,dept_no)
and a.dept_no=d.dept_no and a.div_no=d.div_no and d.dply_seq is not null and d.div_no='Division' and d.div_no='Division')
order by b.div_no,b.rgn_no,b.zone_no,b.ar_no,a.loc_no,d.dply_seq,c.perd_desc,c.wk_id) e
group by e.div_no,e.rgn_no order by e.div_no,e.rgn_no) g  */) actl_pln
group by actl_pln.div_no order by actl_pln.div_no) wge
on wge.div_no=lc.div_no) krn
where sms.div_no=krn.div_no order by sms.div_no) actl
where pln.div_no=actl.div_no order by pln.div_no]]>
	</CurrentWeekVarORWkToDtTotal>
		
</TCName>

</configuration>


